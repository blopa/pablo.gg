{"html":"<p>Apenas na semana passada eu postei sobre <a href=\"/pt-br/blog/coding/publicando-reels-no-instagram-usando-nodejs-e-a-arte-de-superar-limitacoes/\">como fazer upload de Reels para o Instagram usando Node.js</a>, e no código era possível fazer upload de um thumbnail para o vídeo também, mas eu não expliquei como criar esse thumbnail.</p>\n<p>I mean, claro que você pode ir para no <a href=\"https://www.photopea.com/\" target=\"_blank\" rel=\"noreferrer\">Photopea</a> e criar um thumbnail para o seu vídeo, mas e se você quiser automatizar esse processo? E se você quiser criar um thumbnail diferente para todos os seus vídeos automaticamente?</p>\n<p>Bem, é isso que eu vou te mostrar hoje.</p>\n<p></p><figure class=\"gatsby-resp-image-figure\" style=\"\">\n    <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1024px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 57.03125%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAAsTAAALEwEAmpwYAAACdklEQVQozxXQu27TUACA4RPbcXx8ObaPj+9O7DiXNiRNUqcpzQXVtEFtgBZISUsZ6JWFAaR2oEUVEoKyMQALQkgIgZB4AAYkZgpvgMTEBhti7QDqv3/LDzJyTlOxJkhIwgwvMgJKESNFdK1ey9QaaKIjFcdhJqsJrqd4rkZUETEMTVMnAdkPHC9r6cSUtRTkoJOG/bly3F3vnFmNop34fK/Y5KImKtctwyI2EXgOQi7FJk+wK+YDbcTHPuZlybGMVie8Opg+1azLwXRQXa1EIs3xVoEMh07UUlSDRwqEMEFRAAAQ4BFH8TCUpSSHwtC4NH86OxH5uYtxayxXmBqvtJsNjPJm7zKOY8XIknToYEfhcZJlgeNWMG9CSpQoQRovkelOGYdPb20cf3/769vL4x/vv757OOpNpsbG8EzbhJjnOchBHvI8zwPbCV3X1kQNcaLcLHNxA7BMvzKIq93Pzw9uLsz368u+kgOjWXu2l04XdFOj6QSgAM3QILRyGYOwKTYBgJDzxZV+M2rcXdvffnz45+j1kxeHd+4/W47OWutLdq2mY8siro5MldWSVBIUUclNZpBiasTl83lpZeHKcOPD7Z1/vz9+ebD/9+jNz0+vds+tlW4MFN/VdUMUDVkwECtTgAIuDhRT51VMVMUqBnh+1tvf6PbOHizObcUze4ML16e6+c1luz1t2CWVOFDioAQTicTJbZR1FN3UkYNVJBGN1CfNa4tgb8mz9dnqaMv3wUwV3Vs3i/WQ8wuGZxNTEmU2xdJJBmRRwU55FrKwqqgKQpYRxl3t0ZbT7gMARMHUdjfR9tAOqg7x1EA3DWJgRUEiQzP/AerQaSbt1hVqAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"Ilustração\" title=\"Ilustração\" src=\"/static/f8272dae5fedf81e3304107e04988bdb/42a19/instagram-reels-thumbnail-illustration.png\" srcset=\"/static/f8272dae5fedf81e3304107e04988bdb/e3135/instagram-reels-thumbnail-illustration.png 256w,\n/static/f8272dae5fedf81e3304107e04988bdb/06341/instagram-reels-thumbnail-illustration.png 512w,\n/static/f8272dae5fedf81e3304107e04988bdb/42a19/instagram-reels-thumbnail-illustration.png 1024w,\n/static/f8272dae5fedf81e3304107e04988bdb/e8464/instagram-reels-thumbnail-illustration.png 1536w,\n/static/f8272dae5fedf81e3304107e04988bdb/445c6/instagram-reels-thumbnail-illustration.png 1792w\" sizes=\"(max-width: 1024px) 100vw, 1024px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\">Ilustração</figcaption>\n  </figure><p></p>\n<h2 id=\"encontrando-o-package-certo\" style=\"position:relative;\"><a href=\"#encontrando-o-package-certo\" aria-label=\"encontrando o package certo permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Encontrando o package certo</h2>\n<p>Como um desenvolvedor frontend, a única coisa que eu sei sobre manipulação de imagens é usando canvas, e felizmente existe um package para Node.js que nos permite fazer isso, ele se chama <a href=\"https://www.npmjs.com/package/canvas\" target=\"_blank\" rel=\"noreferrer\">node-canvas</a>.</p>\n<p>Com ele, nós podemos criar um canvas, desenhar imagens, textos, formas, etc. É bem legal, dê uma olhada no exemplo abaixo:</p>\n<div class=\"copy-code-block\"><button tabindex=\"0\" type=\"button\" class=\"MuiButtonBase-root MuiButton-root MuiButton-contained MuiButton-containedPrimary copy-code-button\"><span class=\"MuiButton-label\">Copiar</span></button><div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> createCanvas<span class=\"token punctuation\">,</span> loadImage <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'canvas'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> writeFileSync <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'fs'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> canvas <span class=\"token operator\">=</span> <span class=\"token function\">createCanvas</span><span class=\"token punctuation\">(</span><span class=\"token number\">200</span><span class=\"token punctuation\">,</span> <span class=\"token number\">200</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> ctx <span class=\"token operator\">=</span> canvas<span class=\"token punctuation\">.</span><span class=\"token function\">getContext</span><span class=\"token punctuation\">(</span><span class=\"token string\">'2d'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nctx<span class=\"token punctuation\">.</span>font <span class=\"token operator\">=</span> <span class=\"token string\">'30px Impact'</span><span class=\"token punctuation\">;</span>\nctx<span class=\"token punctuation\">.</span>fillStyle <span class=\"token operator\">=</span> <span class=\"token string\">'#000'</span><span class=\"token punctuation\">;</span>\nctx<span class=\"token punctuation\">.</span><span class=\"token function\">fillText</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Hello World!'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\ncanvas<span class=\"token punctuation\">.</span><span class=\"token function\">toBuffer</span><span class=\"token punctuation\">(</span><span class=\"token string\">'image/png'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">err<span class=\"token punctuation\">,</span> buffer</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">writeFileSync</span><span class=\"token punctuation\">(</span><span class=\"token string\">'./hello-world.png'</span><span class=\"token punctuation\">,</span> buffer<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div></div>\n<h2 id=\"criando-um-design\" style=\"position:relative;\"><a href=\"#criando-um-design\" aria-label=\"criando um design permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Criando um design</h2>\n<p>Eu não sou um designer, então eu não vou te ensinar como criar um bom design, mas eu posso te mostrar como eu criei o design para as minhas thumbnails.</p>\n<p>Eu comecei criando um novo arquivo no Photopea com o mesmo tamanho do vídeo do Instagram Reels, que é 1080x1920px. Então eu adicionei uma imagem de fundo e um texto com o título do vídeo, e também uma cor de fundo para o texto com um pouco de opacidade.</p>\n<p>E para finalizar, eu adicionei uma imagem com fundo transparente com uma imagem minha em pixel art.</p>\n<p></p><figure class=\"gatsby-resp-image-figure\" style=\"\">\n    <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1024px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 177.734375%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,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'); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"Thumbnail para Reels\" title=\"Thumbnail para Reels\" src=\"/static/352db45cb6eb4b617148e7cfaf35c1dd/42a19/instagram-reels-thumbnail.png\" srcset=\"/static/352db45cb6eb4b617148e7cfaf35c1dd/e3135/instagram-reels-thumbnail.png 256w,\n/static/352db45cb6eb4b617148e7cfaf35c1dd/06341/instagram-reels-thumbnail.png 512w,\n/static/352db45cb6eb4b617148e7cfaf35c1dd/42a19/instagram-reels-thumbnail.png 1024w,\n/static/352db45cb6eb4b617148e7cfaf35c1dd/b4ad3/instagram-reels-thumbnail.png 1080w\" sizes=\"(max-width: 1024px) 100vw, 1024px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\">Thumbnail para Reels</figcaption>\n  </figure><p></p>\n<h2 id=\"criando-a-thumbnail\" style=\"position:relative;\"><a href=\"#criando-a-thumbnail\" aria-label=\"criando a thumbnail permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Criando a thumbnail</h2>\n<p>Agora que nós temos o design, nós podemos começar a programar. Primeiro, nós precisamos criar uma função que irá criar a thumbnail para nós, e ela irá receber uma imagem de fundo, uma imagem de primeiro plano, um título e o caminho para salvar a thumbnail como parâmetros.</p>\n<div class=\"copy-code-block\"><button tabindex=\"1\" type=\"button\" class=\"MuiButtonBase-root MuiButton-root MuiButton-contained MuiButton-containedPrimary copy-code-button\"><span class=\"MuiButton-label\">Copiar</span></button><div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">generateImageForPost</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span>\n  <span class=\"token parameter\">backgroundImagePath<span class=\"token punctuation\">,</span>\n  foregroundImagePath<span class=\"token punctuation\">,</span>\n  title<span class=\"token punctuation\">,</span>\n  outputPath</span>\n<span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> backgroundImage <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">loadImage</span><span class=\"token punctuation\">(</span>backgroundImagePath<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> foregroundImage <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">loadImage</span><span class=\"token punctuation\">(</span>foregroundImagePath<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">const</span> canvas <span class=\"token operator\">=</span> <span class=\"token function\">createCanvas</span><span class=\"token punctuation\">(</span>backgroundImage<span class=\"token punctuation\">.</span>width<span class=\"token punctuation\">,</span> backgroundImage<span class=\"token punctuation\">.</span>height<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> ctx <span class=\"token operator\">=</span> canvas<span class=\"token punctuation\">.</span><span class=\"token function\">getContext</span><span class=\"token punctuation\">(</span><span class=\"token string\">'2d'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  ctx<span class=\"token punctuation\">.</span><span class=\"token function\">drawImage</span><span class=\"token punctuation\">(</span>foregroundImage<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// TODO add text</span>\n  <span class=\"token comment\">// addCenteredTextWithBackground(ctx, title, canvas.width, canvas.height);</span>\n\n  <span class=\"token keyword\">await</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Promise</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">resolve<span class=\"token punctuation\">,</span> reject</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> out <span class=\"token operator\">=</span> <span class=\"token function\">createWriteStream</span><span class=\"token punctuation\">(</span>outputPath<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">const</span> stream <span class=\"token operator\">=</span> canvas<span class=\"token punctuation\">.</span><span class=\"token function\">createPNGStream</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    stream<span class=\"token punctuation\">.</span><span class=\"token function\">pipe</span><span class=\"token punctuation\">(</span>out<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    out<span class=\"token punctuation\">.</span><span class=\"token function\">on</span><span class=\"token punctuation\">(</span><span class=\"token string\">'finish'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n      console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'The PNG file was created.'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    out<span class=\"token punctuation\">.</span><span class=\"token function\">on</span><span class=\"token punctuation\">(</span><span class=\"token string\">'error'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">err</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token function\">reject</span><span class=\"token punctuation\">(</span>err<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div></div>\n<p>Esse código irá carregar as imagens de fundo e primeiro plano, criar um canvas com o mesmo tamanho da imagem de fundo, desenhar a imagem de primeiro plano no canvas, e salvar o canvas como um arquivo PNG. Essa foi a parte fácil, agora nós precisamos adicionar o texto.</p>\n<p>O desafio aqui é adicionar o texto no centro do canvas, e garantir que ele não irá ultrapassar o canvas. Vamos ver como podemos fazer isso.</p>\n<h2 id=\"adicionando-o-texto\" style=\"position:relative;\"><a href=\"#adicionando-o-texto\" aria-label=\"adicionando o texto permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Adicionando o texto</h2>\n<p>Primeiro, nós precisamos criar uma função que irá adicionar o texto no centro do canvas, e ela irá receber o texto e o canvas como parâmetros. Nós iremos fazer isso na função <code class=\"language-text\">addCenteredTextWithBackground</code>.</p>\n<div class=\"copy-code-block\"><button tabindex=\"2\" type=\"button\" class=\"MuiButtonBase-root MuiButton-root MuiButton-contained MuiButton-containedPrimary copy-code-button\"><span class=\"MuiButton-label\">Copiar</span></button><div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">addCenteredTextWithBackground</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>\n  <span class=\"token parameter\">ctx<span class=\"token punctuation\">,</span>\n  text<span class=\"token punctuation\">,</span>\n  canvasWidth<span class=\"token punctuation\">,</span>\n  canvasHeight</span>\n<span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> fontSize <span class=\"token operator\">=</span> <span class=\"token number\">150</span><span class=\"token punctuation\">;</span>\n  ctx<span class=\"token punctuation\">.</span>font <span class=\"token operator\">=</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>fontSize<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">px Impact</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> lines <span class=\"token operator\">=</span> text<span class=\"token punctuation\">.</span><span class=\"token function\">split</span><span class=\"token punctuation\">(</span><span class=\"token string\">' '</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">const</span> textHeight <span class=\"token operator\">=</span> fontSize <span class=\"token operator\">*</span> lines<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> rectWidth <span class=\"token operator\">=</span> canvasWidth<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> rectHeight <span class=\"token operator\">=</span> textHeight <span class=\"token operator\">+</span> <span class=\"token number\">60</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">const</span> rectX <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>canvasWidth <span class=\"token operator\">-</span> rectWidth<span class=\"token punctuation\">)</span> <span class=\"token operator\">/</span> <span class=\"token number\">2</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> rectY <span class=\"token operator\">=</span> <span class=\"token number\">300</span><span class=\"token punctuation\">;</span>\n\n  ctx<span class=\"token punctuation\">.</span>fillStyle <span class=\"token operator\">=</span> <span class=\"token string\">'rgba(0, 0, 0, 0.5)'</span><span class=\"token punctuation\">;</span>\n  ctx<span class=\"token punctuation\">.</span><span class=\"token function\">fillRect</span><span class=\"token punctuation\">(</span>rectX<span class=\"token punctuation\">,</span> rectY<span class=\"token punctuation\">,</span> rectWidth<span class=\"token punctuation\">,</span> rectHeight<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  ctx<span class=\"token punctuation\">.</span>fillStyle <span class=\"token operator\">=</span> <span class=\"token string\">'white'</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">,</span> line<span class=\"token punctuation\">]</span> <span class=\"token keyword\">of</span> lines<span class=\"token punctuation\">.</span><span class=\"token function\">entries</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> textX <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>canvasWidth <span class=\"token operator\">-</span> ctx<span class=\"token punctuation\">.</span><span class=\"token function\">measureText</span><span class=\"token punctuation\">(</span>line<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>width<span class=\"token punctuation\">)</span> <span class=\"token operator\">/</span> <span class=\"token number\">2</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">const</span> textY <span class=\"token operator\">=</span> rectY <span class=\"token operator\">+</span> fontSize <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span>i <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    ctx<span class=\"token punctuation\">.</span><span class=\"token function\">fillText</span><span class=\"token punctuation\">(</span>line<span class=\"token punctuation\">,</span> textX<span class=\"token punctuation\">,</span> textY<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div></div>\n<p>Essa função irá calcular o tamanho do retângulo que será o fundo do texto, e então irá desenhar o retângulo e o texto no canvas. Infelizmente, apenas fazer <code class=\"language-text\">text.split(' ');</code> não irá funcionar, porque dividir o texto por espaços irá simplesmente aumentar a altura do texto, mas não necessariamente irá fazer o texto caber no canvas.</p>\n<p>Então vamos criar uma função chamada <code class=\"language-text\">breakTextToFitCanvas</code> que irá receber o texto, o contexto do canvas e uma largura máxima como parâmetros, e irá retornar um array de strings com o texto dividido em linhas que irão caber no canvas.</p>\n<div class=\"copy-code-block\"><button tabindex=\"3\" type=\"button\" class=\"MuiButtonBase-root MuiButton-root MuiButton-contained MuiButton-containedPrimary copy-code-button\"><span class=\"MuiButton-label\">Copiar</span></button><div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">breakTextToFitCanvas</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">ctx<span class=\"token punctuation\">,</span> text<span class=\"token punctuation\">,</span> maxWidth</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> words <span class=\"token operator\">=</span> text<span class=\"token punctuation\">.</span><span class=\"token function\">split</span><span class=\"token punctuation\">(</span><span class=\"token string\">' '</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> lines <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">let</span> currentLine <span class=\"token operator\">=</span> words<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">let</span> i <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> words<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> word <span class=\"token operator\">=</span> words<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> width <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> ctx<span class=\"token punctuation\">.</span><span class=\"token function\">measureText</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>currentLine<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\"> </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>word<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>width <span class=\"token operator\">&lt;</span> maxWidth<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      currentLine <span class=\"token operator\">+=</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\"> </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>word<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n      lines<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span>currentLine<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      currentLine <span class=\"token operator\">=</span> word<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n\n  lines<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span>currentLine<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">return</span> lines<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div></div>\n<h2 id=\"juntando-tudo\" style=\"position:relative;\"><a href=\"#juntando-tudo\" aria-label=\"juntando tudo permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Juntando tudo</h2>\n<p>Agora que nós temos todas as funções que precisamos, nós podemos juntar tudo e criar a thumbnail. Vamos criar uma função chamada <code class=\"language-text\">generateThumbnail</code> que irá receber o título do vídeo e o caminho para salvar a thumbnail como parâmetros.</p>\n<div class=\"copy-code-block\"><button tabindex=\"4\" type=\"button\" class=\"MuiButtonBase-root MuiButton-root MuiButton-contained MuiButton-containedPrimary copy-code-button\"><span class=\"MuiButton-label\">Copiar</span></button><div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">generateThumbnail</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">title<span class=\"token punctuation\">,</span> outputPath</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> backgroundImagePath <span class=\"token operator\">=</span> <span class=\"token string\">'./background.png'</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> foregroundImagePath <span class=\"token operator\">=</span> <span class=\"token string\">'./foreground.png'</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">await</span> <span class=\"token function\">generateImageForPost</span><span class=\"token punctuation\">(</span>\n    backgroundImagePath<span class=\"token punctuation\">,</span>\n    foregroundImagePath<span class=\"token punctuation\">,</span>\n    title<span class=\"token punctuation\">,</span>\n    outputPath\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div></div>\n<p>E agora nós podemos chamar essa função e criar a thumbnail.</p>\n<div class=\"copy-code-block\"><button tabindex=\"5\" type=\"button\" class=\"MuiButtonBase-root MuiButton-root MuiButton-contained MuiButton-containedPrimary copy-code-button\"><span class=\"MuiButton-label\">Copiar</span></button><div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token function\">generateThumbnail</span><span class=\"token punctuation\">(</span><span class=\"token string\">'How to create thumbnails for your videos with Node.js'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'./thumbnail.png'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div></div>\n<h2 id=\"conclusao\" style=\"position:relative;\"><a href=\"#conclusao\" aria-label=\"conclusao permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Conclusão</h2>\n<p>E é isso! Agora você pode criar thumbnails para seus vídeos automaticamente. Eu espero que você tenha gostado desse post, e não se esqueça de ver como <a href=\"/pt-br/blog/coding/publicando-reels-no-instagram-usando-nodejs-e-a-arte-de-superar-limitacoes/\">fazer upload de Reels para o Instagram usando Node.js</a>.</p>\n<p>Até a próxima!</p>","path":"/pt-br/blog/coding/como-criar-thumbnails-para-seus-videos-automaticamente-com-nodejs/","title":"Como criar thumbnails para seus vídeos automaticamente com Node.js","language":"pt-br","postHashId":"Y29kaW5ndHJ1ZW51bGwyMDIzLTEwLTI1VDAwOjAwOjAwLjAwMFo=","comments":[],"relatedPosts":[{"path":"/pt-br/blog/coding/como-automatizar-a-criacao-de-instagram-reels-usando-gpt-da-openai/","postHashId":"Y29kaW5ndHJ1ZW51bGwyMDIzLTEyLTIwVDAwOjAwOjAwLjAwMFo=","title":"Como automatizar a criação de Instagram Reels usando GPT da OpenAI","date":"2023-12-20T00:00:00.000Z"},{"path":"/pt-br/blog/coding/publicando-reels-no-instagram-usando-nodejs-e-a-arte-de-superar-limitacoes/","postHashId":"Y29kaW5ndHJ1ZW51bGwyMDIzLTEwLTE0VDAwOjAwOjAwLjAwMFo=","title":"Publicando Reels no Instagram usando Node.js e a arte de superar limitações","date":"2023-10-14T00:00:00.000Z"},{"path":"/pt-br/blog/coding/usando-google-fitness-api-para-calcular-meu-tdee-e-mais/","postHashId":"Y29kaW5ndHJ1ZW51bGwyMDIzLTA4LTAyVDAwOjAwOjAwLjAwMFo=","title":"Usando Google Fitness API para calcular meu TDEE e mais","date":"2023-08-02T00:00:00.000Z"},{"path":"/pt-br/blog/coding/adicionando-botao-para-copiar-code-snippets-no-gatsby-gambiarra/","postHashId":"Y29kaW5ndHJ1ZW51bGwyMDIyLTA1LTA1VDAwOjAwOjAwLjAwMFo=","title":"Adicionando botão para copiar code snippets no Gatsby (gambiarra)","date":"2022-05-05T00:00:00.000Z"},{"path":"/pt-br/blog/coding/como-o-webpack-resolve-imports-dinamicos-com-paths-variaveis/","postHashId":"Y29kaW5ndHJ1ZW51bGwyMDIyLTA0LTExVDAwOjAwOjAwLjAwMFo=","title":"Como o Webpack resolve imports dinâmicos com paths variáveis","date":"2022-04-11T00:00:00.000Z"},{"path":"/pt-br/blog/coding/crie-videos-dos-seus-codigos-de-programacao-com-esse-script-de-nodejs/","postHashId":"Y29kaW5ndHJ1ZW51bGwyMDIyLTAxLTA0VDAwOjAwOjAwLjAwMFo=","title":"Crie videos dos seus códigos de programação com esse script de Node.js","date":"2022-01-04T00:00:00.000Z"},{"path":"/pt-br/blog/games/atualize-automaticamente-o-tileset-embutido-do-seu-mapa-no-tiled-com-um-script-nodejs/","postHashId":"Z2FtZXN0cnVlbnVsbDIwMjEtMTAtMDJUMDA6MDA6MDAuMDAwWg==","title":"Atualize automaticamente o Tileset embutido do seu mapa no Tiled com um script Node.js.","date":"2021-10-02T00:00:00.000Z"},{"path":"/pt-br/blog/games/como-gerar-sprite-sheets-automaticamente-para-o-seu-jogo-feito-com-phaser-js/","postHashId":"Z2FtZXN0cnVlbnVsbDIwMjEtMDYtMjJUMDA6MDA6MDAuMDAwWg==","title":"Como gerar sprite sheets automaticamente para o seu jogo feito com Phaser JS","date":"2021-06-22T00:00:00.000Z"},{"path":"/pt-br/blog/general/tinha-que-ser-o-telegram-de-novo/","postHashId":"Z2VuZXJhbHRydWVudWxsMjAyMS0wMS0zMVQwMDowMDowMC4wMDBa","title":"Tinha que ser o Telegram de novo!","date":"2021-01-31T00:00:00.000Z"},{"path":"/pt-br/blog/coding/calculando-minhas-horas-de-trabalho-em-projetos-pessoais-usando-nodejs/","postHashId":"Y29kaW5ndHJ1ZW51bGwyMDI0LTA2LTE2VDAwOjAwOjAwLjAwMFo=","title":"Calculando minhas horas de trabalho em projetos pessoais usando Node.js","date":"2024-06-16T00:00:00.000Z"}]}