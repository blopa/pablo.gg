{"html":"<p>Fala galera, segundo post em menos de uma semana, inacreditável.</p>\n<p></p><div class=\"gatsby-resp-iframe-wrapper\" style=\"padding-bottom: 56.42857142857143%; position: relative; height: 0; overflow: hidden; margin-bottom: 1.0725rem\"> <div class=\"embedVideo-container\"> <iframe title=\"\" src=\"https://www.youtube.com/embed/6kpWc6VR0sA?rel=0\" class=\"embedVideo-iframe\" style=\"border:0; position: absolute; top: 0; left: 0; width: 100%; height: 100%; \" loading=\"eager\" allowfullscreen=\"\" sandbox=\"allow-same-origin allow-scripts allow-popups\"></iframe> </div> </div><p></p>\n<p>No gameplay não temos muitas novidades desde o último video, apenas algumas mudanças no build do jogo, nas quais gostaria de compartilhar aqui com vocês.</p>\n<p>Primeiro tenho que pegar todos os arquivos de tileset, sprites e os arquivos das fases feitas no Tiled.</p>\n<div class=\"copy-code-block\"><button tabindex=\"0\" type=\"button\" class=\"MuiButtonBase-root MuiButton-root MuiButton-contained MuiButton-containedPrimary copy-code-button\"><span class=\"MuiButton-label\">Copiar</span></button><div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> stageFiles <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> fs<span class=\"token punctuation\">.</span><span class=\"token function\">readdir</span><span class=\"token punctuation\">(</span><span class=\"token constant\">STAGES_PATH</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> tilesetFiles <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> fs<span class=\"token punctuation\">.</span><span class=\"token function\">readdir</span><span class=\"token punctuation\">(</span><span class=\"token constant\">TILESETS_PATH</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> tilesetImageFiles <span class=\"token operator\">=</span> tilesetFiles\n    <span class=\"token punctuation\">.</span><span class=\"token function\">filter</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">tilesetFile</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> supportedImageTypes<span class=\"token punctuation\">.</span><span class=\"token function\">includes</span><span class=\"token punctuation\">(</span>tilesetFile<span class=\"token punctuation\">.</span><span class=\"token function\">split</span><span class=\"token punctuation\">(</span><span class=\"token string\">'.'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> spritesFolders <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> fs<span class=\"token punctuation\">.</span><span class=\"token function\">readdir</span><span class=\"token punctuation\">(</span><span class=\"token constant\">SPRITES_PATH</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div></div>\n<p>Na pasta dos sprites tem uma imagem para cada frame da animação:</p>\n<p></p><figure class=\"gatsby-resp-image-figure\" style=\"\">\n    <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 351px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 51.953125%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABgUlEQVQoz6WSzWsbMRDF/f9DayitoYVeeigJDiSYJjk0UJrkUAr5IBBqd3el1WptJ16v3ZJZydJImla7Tgi99h10eMxj5jejHv2HeiEEIpoWbO/dazSGiEII3nsiOj/ev/z6hYi8c13Zuq523rzQANTWbcO5yD98HAI0j+Fojg4PPx2dxHAI2/Cv5eDt+/n9oivrGa3GPyZSTjkTopClkES0mN8lSVqWs4wJlmVVVRNROklEUYpcpozzjFmLsbMxxlpb16sQAlpLRNiqaRSACt4jOiIyxqDDVb1G59Da8DT2vGAXJ0fdMPFtma/OPo+/f2tNT62PaE4Pdn9X1Za5283NzXW/P0DE58y7w7390XFk9lvmRsHLV4Oci0fmjc7StJCz2zHPMjaVJREtq0XOOROzSSJEzup6HZfKmJDlz1QmGRecW3Q97xw8AADczUqttGoUEW20bpRaLau6Wm7MxrQnhAfQSs+nJQCopomdu3PHVbUzP5ePCv+YiNgh/P0kfwBddzORj2NQxgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"Animação de idle\" title=\"Animação de idle\" src=\"/static/35b7d402d7a2888797de66c7269007e8/7ecec/skate-platformer-idle-sprites.png\" srcset=\"/static/35b7d402d7a2888797de66c7269007e8/e3135/skate-platformer-idle-sprites.png 256w,\n/static/35b7d402d7a2888797de66c7269007e8/7ecec/skate-platformer-idle-sprites.png 351w\" sizes=\"(max-width: 351px) 100vw, 351px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\">Animação de idle</figcaption>\n  </figure><p></p>\n<p>Agora eu passo o caminho dessa pasta para o plugin <code class=\"language-text\">WebpackFreeTexPacker</code> com algumas configurações básicas:</p>\n<div class=\"copy-code-block\"><button tabindex=\"1\" type=\"button\" class=\"MuiButtonBase-root MuiButton-root MuiButton-contained MuiButton-containedPrimary copy-code-button\"><span class=\"MuiButton-label\">Copiar</span></button><div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> textPackerPlugin <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">const</span> spritesFolder <span class=\"token keyword\">of</span> spritesFolders<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    texPackerPlugin<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span>\n        <span class=\"token keyword\">new</span> <span class=\"token class-name\">WebpackFreeTexPacker</span><span class=\"token punctuation\">(</span>\n            path<span class=\"token punctuation\">.</span><span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span>__dirname<span class=\"token punctuation\">,</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token constant\">SPRITES_PATH</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">/</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>spritesFolder<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">'../assets/atlases'</span><span class=\"token punctuation\">,</span>\n            <span class=\"token punctuation\">{</span>\n                <span class=\"token literal-property property\">height</span><span class=\"token operator\">:</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span>\n                <span class=\"token literal-property property\">textureName</span><span class=\"token operator\">:</span> spritesFolder<span class=\"token punctuation\">,</span>\n                <span class=\"token literal-property property\">fixedSize</span><span class=\"token operator\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\n                <span class=\"token literal-property property\">padding</span><span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span>\n                <span class=\"token literal-property property\">allowRotation</span><span class=\"token operator\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\n                <span class=\"token literal-property property\">detectIdentical</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n                <span class=\"token literal-property property\">allowTrim</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n                <span class=\"token literal-property property\">exporter</span><span class=\"token operator\">:</span> <span class=\"token string\">'Phaser3'</span><span class=\"token punctuation\">,</span>\n                <span class=\"token literal-property property\">removeFileExtension</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n                <span class=\"token literal-property property\">prependFolderName</span><span class=\"token operator\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div></div>\n<p>E para cada uma das imagens de tilesets vou processá-las pelo plugin de extrude:</p>\n<div class=\"copy-code-block\"><button tabindex=\"2\" type=\"button\" class=\"MuiButtonBase-root MuiButton-root MuiButton-contained MuiButton-containedPrimary copy-code-button\"><span class=\"MuiButton-label\">Copiar</span></button><div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">const</span> tilesetFile <span class=\"token keyword\">of</span> tilesetImageFiles<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">await</span> <span class=\"token function\">extrudeTilesetToImage</span><span class=\"token punctuation\">(</span>\n        tileWidth<span class=\"token punctuation\">,</span>\n        tileHeight<span class=\"token punctuation\">,</span>\n        <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token constant\">TILESETS_PATH</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">/</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>tilesetFile<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\n        <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token constant\">DIST_PATH</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">/assets/tilesets/</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>tilesetFile<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">{</span>\n            <span class=\"token literal-property property\">margin</span><span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span>\n            <span class=\"token literal-property property\">spacing</span><span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div></div>\n<p>E a última coisa que fiz foi pegar os arquivos das fases criadas no Tiled e envia-las para o frontend usando o plugin <code class=\"language-text\">webpack.DefinePlugin</code> para que seja possível carregar as fases dinamicamente:</p>\n<div class=\"copy-code-block\"><button tabindex=\"3\" type=\"button\" class=\"MuiButtonBase-root MuiButton-root MuiButton-contained MuiButton-containedPrimary copy-code-button\"><span class=\"MuiButton-label\">Copiar</span></button><div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> <span class=\"token constant\">STAGES</span> <span class=\"token operator\">=</span> <span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">stringify</span><span class=\"token punctuation\">(</span>\n    stageFiles\n        <span class=\"token punctuation\">.</span><span class=\"token function\">filter</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">stage</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> stage<span class=\"token punctuation\">.</span><span class=\"token function\">split</span><span class=\"token punctuation\">(</span><span class=\"token string\">'.'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">===</span> <span class=\"token string\">'json'</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">stage</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> stage<span class=\"token punctuation\">.</span><span class=\"token function\">split</span><span class=\"token punctuation\">(</span><span class=\"token string\">'.'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token operator\">...</span><span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">plugins</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n        <span class=\"token keyword\">new</span> <span class=\"token class-name\">webpack<span class=\"token punctuation\">.</span>DefinePlugin</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n            <span class=\"token constant\">CANVAS_RENDERER</span><span class=\"token operator\">:</span> <span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">stringify</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n            <span class=\"token constant\">WEBGL_RENDERER</span><span class=\"token operator\">:</span> <span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">stringify</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n            <span class=\"token constant\">IS_DEV</span><span class=\"token operator\">:</span> <span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">stringify</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n            <span class=\"token constant\">VERSION</span><span class=\"token operator\">:</span> <span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">stringify</span><span class=\"token punctuation\">(</span>packageJson<span class=\"token punctuation\">.</span>version<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n            <span class=\"token constant\">STAGES</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token operator\">...</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div></div>\n<p>E agora toda vez que eu faço o build do jogo eu consigo carregar fases dinamicamente com a constante <code class=\"language-text\">STAGES</code> e todos os meus sprites e tilesets estão prontos para serem usados.</p>\n<p>É isso que eu tenho para vocês hoje pessoal, espero que tenham gostado desse formato de vídeo e post no blog, até a próxima.</p>","path":"/pt-br/blog/games/segundo-game-devlog-do-skate-platformer/","title":"Melhorando o build de sprite sheets no Phaser JS com Webpack 4 - Skate Platformer Game Devlog #02","language":"pt-br","postHashId":"Z2FtZXN0cnVlbnVsbDIwMjAtMDktMDlUMDA6MDA6MDAuMDAwWg==","comments":[{"comment":"Daora, valeu por compartilhar!","name":"Pedro","date":"9/12/2020 16:12:34"}],"relatedPosts":[{"path":"/pt-br/blog/games/criando-um-build-para-celular-para-o-meu-jogo-com-o-phaser-js-game-devlog-23/","postHashId":"Z2FtZXN0cnVlbnVsbDIwMjEtMDktMDlUMDA6MDA6MDAuMDAwWg==","title":"Criando um build para celular para o meu jogo com o Phaser JS - Game Devlog #23","date":"2021-09-09T00:00:00.000Z"},{"path":"/pt-br/blog/games/criando-plataformas-para-o-meu-jogo-em-phaser-js-game-devlog-22/","postHashId":"Z2FtZXN0cnVlbnVsbDIwMjEtMDgtMjhUMDA6MDA6MDAuMDAwWg==","title":"Criando plataformas para o meu jogo em Phaser JS - Game Devlog #22","date":"2021-08-28T00:00:00.000Z"},{"path":"/pt-br/blog/games/escondendo-partes-do-mapa-com-o-phaser-js-game-devlog-21/","postHashId":"Z2FtZXN0cnVlbnVsbDIwMjEtMDctMDZUMDA6MDA6MDAuMDAwWg==","title":"Escondendo partes do mapa com o Phaser JS - Game Devlog #21","date":"2021-07-06T00:00:00.000Z"},{"path":"/pt-br/blog/games/criando-estalactites-que-caem-com-phaser-js-game-devlog-20/","postHashId":"Z2FtZXN0cnVlbnVsbDIwMjEtMDYtMjhUMDA6MDA6MDAuMDAwWg==","title":"Criando estalactites que caem com Phaser JS - Game Devlog #20","date":"2021-06-28T00:00:00.000Z"},{"path":"/pt-br/blog/games/criando-uma-monkey-bar-para-se-pendurar-com-o-phaser-js-game-devlog-19/","postHashId":"Z2FtZXN0cnVlbnVsbDIwMjEtMDYtMTlUMDA6MDA6MDAuMDAwWg==","title":"Criando uma \"Monkey Bar\" para se pendurar com o Phaser JS - Game Devlog #19","date":"2021-06-19T00:00:00.000Z"},{"path":"/pt-br/blog/games/criando-um-pogo-attack-com-o-phaser-js-game-devlog-17/","postHashId":"Z2FtZXN0cnVlbnVsbDIwMjEtMDQtMjRUMDA6MDA6MDAuMDAwWg==","title":"Criando um \"pogo-attack\" com o Phaser JS - Game Devlog #17","date":"2021-04-24T00:00:00.000Z"},{"path":"/pt-br/blog/games/adicionando-transicao-ao-carregar-uma-fase-no-phaser-js-skate-platformer-game-devlog-16/","postHashId":"Z2FtZXN0cnVlbnVsbDIwMjAtMTItMjlUMDA6MDA6MDAuMDAwWg==","title":"Adicionando transição ao carregar uma fase no Phaser JS - Game Devlog #16","date":"2020-12-29T00:00:00.000Z"},{"path":"/pt-br/blog/games/criando-uma-ai-mais-inteligente-e-performatica-no-phaser-js-skate-platformer-game-devlog-15/","postHashId":"Z2FtZXN0cnVlbnVsbDIwMjAtMTItMTVUMDA6MDA6MDAuMDAwWg==","title":"Criando uma AI mais inteligente e performática no Phaser JS - Game Devlog #15","date":"2020-12-15T00:00:00.000Z"},{"path":"/pt-br/blog/games/criando-clima-chuvoso-no-phaser-js-skate-platformer-game-devlog-14/","postHashId":"Z2FtZXN0cnVlbnVsbDIwMjAtMTItMDlUMDA6MDA6MDAuMDAwWg==","title":"Criando clima chuvoso no Phaser JS - Skate Platformer Game Devlog #14","date":"2020-12-09T00:00:00.000Z"},{"path":"/pt-br/blog/games/criando-uma-loading-screen-e-traduzindo-o-meu-jogo-no-phaser-js-skate-platformer-game-devlog-13/","postHashId":"Z2FtZXN0cnVlbnVsbDIwMjAtMTEtMjlUMDA6MDA6MDAuMDAwWg==","title":"Criando uma loading screen e traduzindo o meu jogo no Phaser JS - Skate Platformer Game Devlog #13","date":"2020-11-29T00:00:00.000Z"}]}