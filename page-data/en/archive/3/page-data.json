{
    "componentChunkName": "component---src-templates-archive-jsx",
    "path": "/en/archive/3",
    "result": {"data":{"site":{"siteMetadata":{"siteUrl":"https://pablo.gg"}},"allMarkdownRemark":{"edges":[{"node":{"excerpt":"I often have friends asking me, ‚ÄúPablo, how do you manage to‚Ä¶","fields":{"slug":"/2024/2024-10-25-sharing-encrypted-laravel-cookies-with-next-js.en/","path":"/blog/coding/sharing-encrypted-laravel-cookies-with-next-js/","locale":"en"},"readingTime":{"minutes":8.525},"frontmatter":{"date":"2024-10-25T00:00:00.000Z","title":"Sharing encrypted Laravel cookies with Next.js","hideExcerpt":false}}},{"node":{"excerpt":"I constantly have that feeling of ‚ÄùYou become the very thing‚Ä¶","fields":{"slug":"/2024/2024-09-21-musclog-leveraging-my-reactjs-experience-to-build-a-react-native-app.en/","path":"/blog/coding/musclog-leveraging-my-reactjs-experience-to-build-a-react-native-app/","locale":"en"},"readingTime":{"minutes":17.685},"frontmatter":{"date":"2024-09-21T00:00:00.000Z","title":"Musclog: Leveraging my React.js experience to build a React Native App","hideExcerpt":false}}},{"node":{"excerpt":"As a developer fully committed (pun intended, and not the‚Ä¶","fields":{"slug":"/2024/2024-06-16-tracking-my-working-hours-on-personal-projects-ssing-nodejs.en/","path":"/blog/coding/tracking-my-working-hours-on-personal-projects-ssing-nodejs/","locale":"en"},"readingTime":{"minutes":5.265},"frontmatter":{"date":"2024-06-16T00:00:00.000Z","title":"Tracking my working hours on personal projects using Node.js","hideExcerpt":false}}},{"node":{"excerpt":"Navigating the intricacies of manga as a Western reader can‚Ä¶","fields":{"slug":"/2024/2024-05-01-transforming-manga-pages-for-western-readers.en/","path":"/blog/coding/transforming-manga-pages-for-western-readers/","locale":"en"},"readingTime":{"minutes":7.605},"frontmatter":{"date":"2024-05-01T00:00:00.000Z","title":"Transforming manga pages for lazy western readers","hideExcerpt":false}}},{"node":{"excerpt":"After creating a Node.js script to automatically post‚Ä¶","fields":{"slug":"/2023/2023-12-20-creating-instagram-reels-coding-tutorials-automatically-with-openais-gpt.en/","path":"/blog/coding/creating-instagram-reels-coding-tutorials-automatically-with-openais-gpt/","locale":"en"},"readingTime":{"minutes":6.64},"frontmatter":{"date":"2023-12-20T00:00:00.000Z","title":"Creating Instagram Reels coding tutorials automatically with OpenAI's GPT","hideExcerpt":false}}},{"node":{"excerpt":"Just last week I posted about how to create upload reels to‚Ä¶","fields":{"slug":"/2023/2023-10-25-how-to-automatically-create-thumbnails-for-your-videos-with-nodejs.en/","path":"/blog/coding/how-to-automatically-create-thumbnails-for-your-videos-with-nodejs/","locale":"en"},"readingTime":{"minutes":4.74},"frontmatter":{"date":"2023-10-25T00:00:00.000Z","title":"How to automatically create thumbnails for your videos with Node.js","hideExcerpt":false}}},{"node":{"excerpt":"Hey guys! It‚Äôs hard to be a geek these days, so many events‚Ä¶","fields":{"slug":"/2023/2023-10-14-posting-instagram-reels-using-nodejs-and-the-art-of-overcoming-limitations.en/","path":"/blog/coding/posting-instagram-reels-using-nodejs-and-the-art-of-overcoming-limitations/","locale":"en"},"readingTime":{"minutes":7.485},"frontmatter":{"date":"2023-10-14T00:00:00.000Z","title":"Posting Instagram Reels using Node.js and the art of overcoming limitations","hideExcerpt":false}}},{"node":{"excerpt":"In a world dominated by social media platforms, where‚Ä¶","fields":{"slug":"/2023/2023-09-04-my-blog-now-has-stories-and-im-not-sure-why.en/","path":"/blog/coding/my-blog-now-has-stories-and-im-not-sure-why/","locale":"en"},"readingTime":{"minutes":9},"frontmatter":{"date":"2023-09-04T00:00:00.000Z","title":"My blog now has Stories, and I'm not sure why","hideExcerpt":false}}},{"node":{"excerpt":"Looking to achieve your fitness goals, such as losing some‚Ä¶","fields":{"slug":"/2023/2023-08-02-using-google-fitness-api-to-calculate-my-tdee-and-more.en/","path":"/blog/coding/using-google-fitness-api-to-calculate-my-tdee-and-more/","locale":"en"},"readingTime":{"minutes":16.2},"frontmatter":{"date":"2023-08-02T00:00:00.000Z","title":"Using Google Fitness API to calculate my TDEE and more","hideExcerpt":false}}},{"node":{"excerpt":"Gatsby is a popular static site generator that is built on‚Ä¶","fields":{"slug":"/2023/2023-01-22-creating-rest-api-endpoints-to-my-gatsby-blog.en/","path":"/blog/coding/creating-rest-api-endpoints-to-my-gatsby-blog/","locale":"en"},"readingTime":{"minutes":2.57},"frontmatter":{"date":"2023-01-22T00:00:00.000Z","title":"Creating Rest API endpoints to my Gatsby blog","hideExcerpt":false}}},{"node":{"excerpt":"Last year, I wrote a blog post about where to find the best‚Ä¶","fields":{"slug":"/2022/2022-12-28-a-guide-to-cliff-diving-in-amsterdam.en/","path":"/blog/general/a-guide-to-cliff-diving-in-amsterdam/","locale":"en"},"readingTime":{"minutes":3.325},"frontmatter":{"date":"2022-12-28T00:00:00.000Z","title":"A guide to \"cliff\" diving in Amsterdam","hideExcerpt":false}}},{"node":{"excerpt":"It‚Äôs happening, it‚Äôs finally happening - After 3 years of‚Ä¶","fields":{"slug":"/2022/2022-09-27-e3-2023-dates-revealed.en/","path":"/blog/games/e3-2023-dates-revealed/","locale":"en"},"readingTime":{"minutes":1.345},"frontmatter":{"date":"2022-09-27T00:00:00.000Z","title":"E3 2023 dates revealed","hideExcerpt":false}}},{"node":{"excerpt":"The housing market in Amsterdam is crazy, so crazy that‚Ä¶","fields":{"slug":"/2022/2022-09-13-creating-a-startup-with-github-actions-and-google-forms.en/","path":"/blog/coding/creating-a-startup-with-github-actions-and-google-forms/","locale":"en"},"readingTime":{"minutes":7.87},"frontmatter":{"date":"2022-09-13T00:00:00.000Z","title":"Creating a Startup with GitHub Actions and Google Forms","hideExcerpt":false}}},{"node":{"excerpt":"A few months ago, I published a blog post discussing the‚Ä¶","fields":{"slug":"/2022/2022-08-21-how-to-get-the-redux-state-from-a-react-18-production-build-via-the-browsers-console.en/","path":"/blog/coding/how-to-get-the-redux-state-from-a-react-18-production-build-via-the-browsers-console/","locale":"en"},"readingTime":{"minutes":2.995},"frontmatter":{"date":"2022-08-21T00:00:00.000Z","title":"How to get the Redux State in a React 18 production build via the browser's console","hideExcerpt":false}}},{"node":{"excerpt":"I still remember the first time I planned to go to E3 with‚Ä¶","fields":{"slug":"/2022/2022-06-01-10-years-anniversary-of-my-first-e3.en/","path":"/blog/games/10-years-anniversary-of-my-first-e3/","locale":"en"},"readingTime":{"minutes":17.19},"frontmatter":{"date":"2022-06-01T00:00:00.000Z","title":"10 years anniversary of my first E3","hideExcerpt":false}}},{"node":{"excerpt":"I constantly write about code and share code snippets in my‚Ä¶","fields":{"slug":"/2022/2022-05-05-adding-a-copy-button-to-code-snippets-on-gatsby-the-lazy-way.en/","path":"/blog/coding/adding-a-copy-button-to-code-snippets-on-gatsby-the-lazy-way/","locale":"en"},"readingTime":{"minutes":2.41},"frontmatter":{"date":"2022-05-05T00:00:00.000Z","title":"Adding a copy button to code snippets on Gatsby: The lazy way","hideExcerpt":false}}},{"node":{"excerpt":"Webpack is the most popular module bundler for JavaScript‚Ä¶","fields":{"slug":"/2022/2022-04-11-how-webpack-handles-dynamic-imports-with-variable-paths.en/","path":"/blog/coding/how-webpack-handles-dynamic-imports-with-variable-paths/","locale":"en"},"readingTime":{"minutes":3.025},"frontmatter":{"date":"2022-04-11T00:00:00.000Z","title":"How Webpack handles dynamic imports with variable paths","hideExcerpt":false}}},{"node":{"excerpt":"If you want to rent or buy a house in the Netherlands, you‚Ä¶","fields":{"slug":"/2022/2022-03-12-using-nodejs-and-github-action-to-find-a-house-on-fundanl.en/","path":"/blog/coding/using-nodejs-and-github-action-to-find-a-house-on-fundanl/","locale":"en"},"readingTime":{"minutes":3.645},"frontmatter":{"date":"2022-03-12T00:00:00.000Z","title":"Using Node.js and GitHub Action to find a house on Funda.nl","hideExcerpt":false}}},{"node":{"excerpt":"EDIT: This only works for React 17 or lower, for React 1‚Ä¶","fields":{"slug":"/2022/2022-02-20-how-to-get-the-redux-state-from-a-production-build-via-the-browsers-console.en/","path":"/blog/coding/how-to-get-the-redux-state-from-a-production-build-via-the-browsers-console/","locale":"en"},"readingTime":{"minutes":1.21},"frontmatter":{"date":"2022-02-20T00:00:00.000Z","title":"How to get the Redux State in production via the browser's console","hideExcerpt":false}}},{"node":{"excerpt":"When I was working on my Game Devlog videos, I wondered if‚Ä¶","fields":{"slug":"/2022/2022-01-04-create-videos-from-code-snippets-with-this-nodejs-script.en/","path":"/blog/coding/create-videos-from-code-snippets-with-this-nodejs-script/","locale":"en"},"readingTime":{"minutes":6.475},"frontmatter":{"date":"2022-01-04T00:00:00.000Z","title":"Create videos from code snippets with this Node.js script","hideExcerpt":false}}},{"node":{"excerpt":"On Phaser 3 you can pre-load your assets in a function‚Ä¶","fields":{"slug":"/2021/2021-11-18-how-to-load-assets-asynchronously-with-phaser-3.en/","path":"/blog/games/how-to-load-assets-asynchronously-with-phaser-3/","locale":"en"},"readingTime":{"minutes":1.435},"frontmatter":{"date":"2021-11-18T00:00:00.000Z","title":"How to load assets asynchronously with Phaser 3","hideExcerpt":false}}},{"node":{"excerpt":"After all these years of anticipation, rumors, and even some‚Ä¶","fields":{"slug":"/2021/2021-11-07-buy-metroid-dread.en/","path":"/blog/games/buy-metroid-dread/","locale":"en"},"readingTime":{"minutes":9.45},"frontmatter":{"date":"2021-11-07T00:00:00.000Z","title":"Buy Metroid Dread","hideExcerpt":false}}},{"node":{"excerpt":"Medium is a great platform to share your blog posts with a‚Ä¶","fields":{"slug":"/2021/2021-10-24-how-to-import-gatsby-posts-into-medium-with-gist-code-snippets.en/","path":"/blog/coding/how-to-import-gatsby-posts-into-medium-with-gist-code-snippets/","locale":"en"},"readingTime":{"minutes":4.65},"frontmatter":{"date":"2021-10-24T00:00:00.000Z","title":"How to import Gatsby posts into Medium with Gist code snippets","hideExcerpt":false}}},{"node":{"excerpt":"Yes, that‚Äôs right, there is now a game version of this‚Ä¶","fields":{"slug":"/2021/2021-10-12-i-made-a-top-down-game-version-of-my-blog-with-phaser-and-react.en/","path":"/blog/coding/i-made-a-top-down-game-version-of-my-blog-with-phaser-and-react/","locale":"en"},"readingTime":{"minutes":8.995},"frontmatter":{"date":"2021-10-12T00:00:00.000Z","title":"I made a top-down game version of my blog with Phaser and React","hideExcerpt":null}}},{"node":{"excerpt":"My first experience in ‚Äúprogramming‚Äù started in 2002, when I‚Ä¶","fields":{"slug":"/2021/2021-10-08-how-to-create-a-top-down-rpg-maker-like-game-with-phaser-js-and-react.en/","path":"/blog/coding/how-to-create-a-top-down-rpg-maker-like-game-with-phaser-js-and-react/","locale":"en"},"readingTime":{"minutes":15.69},"frontmatter":{"date":"2021-10-08T00:00:00.000Z","title":"How to create a top-down RPG Maker like game with Phaser JS and React","hideExcerpt":null}}},{"node":{"excerpt":"Phaser works by rendering pixels inside a  element in the‚Ä¶","fields":{"slug":"/2021/2021-10-06-creating-a-dialog-box-with-react-for-a-phaser-game.en/","path":"/blog/coding/creating-a-dialog-box-with-react-for-a-phaser-game/","locale":"en"},"readingTime":{"minutes":3.945},"frontmatter":{"date":"2021-10-06T00:00:00.000Z","title":"Creating a dialog box with React for a Phaser game","hideExcerpt":null}}},{"node":{"excerpt":"Creating maps with Tiled is great, and you can use them in‚Ä¶","fields":{"slug":"/2021/2021-10-02-automatically-update-the-embedded-tileset-for-all-your-tiled-game-with-a-nodejs-script.en/","path":"/blog/games/automatically-update-the-embedded-tileset-for-all-your-tiled-game-with-a-nodejs-script/","locale":"en"},"readingTime":{"minutes":2.78},"frontmatter":{"date":"2021-10-02T00:00:00.000Z","title":"Automatically update the embedded Tileset for all your Tiled maps a Node.js script","hideExcerpt":null}}},{"node":{"excerpt":"To celebrate the release of the Matrix 4 trailer, I want to‚Ä¶","fields":{"slug":"/2021/2021-09-16-creating-a-matrix-source-code-effect-background-for-my-website-with-react.en/","path":"/blog/coding/creating-a-matrix-source-code-effect-background-for-my-website-with-react/","locale":"en"},"readingTime":{"minutes":2.07},"frontmatter":{"date":"2021-09-16T00:00:00.000Z","title":"Creating a Matrix Source-Code effect background for my website with React","hideExcerpt":false}}},{"node":{"excerpt":"Hey everyone, here we are again with another game devlog for‚Ä¶","fields":{"slug":"/2021/2021-09-09-creating-a-mobile-build-of-my-phaser-js-game-game-devlog-23.en/","path":"/blog/games/creating-a-mobile-build-of-my-phaser-js-game-game-devlog-23/","locale":"en"},"readingTime":{"minutes":5.05},"frontmatter":{"date":"2021-09-09T00:00:00.000Z","title":"Creating a mobile build of my Phaser JS game - Game Devlog #23","hideExcerpt":false}}},{"node":{"excerpt":"Last month I traveled to the region of Algarve in Portugal‚Ä¶","fields":{"slug":"/2021/2021-09-02-a-guide-to-cliff-diving-in-benagil.en/","path":"/blog/general/a-guide-to-cliff-diving-in-benagil/","locale":"en"},"readingTime":{"minutes":4.115},"frontmatter":{"date":"2021-09-02T00:00:00.000Z","title":"A guide to cliff diving in Benagil","hideExcerpt":false}}},{"node":{"excerpt":"Hello everyone, welcome to another game devlog for my game‚Ä¶","fields":{"slug":"/2021/2021-08-28-creating-moving-platforms-for-my-phaser-js-game-game-devlog-22.en/","path":"/blog/games/creating-moving-platforms-for-my-phaser-js-game-game-devlog-22/","locale":"en"},"readingTime":{"minutes":10.3},"frontmatter":{"date":"2021-08-28T00:00:00.000Z","title":"Creating moving platforms for my Phaser JS game - Game Devlog #22","hideExcerpt":false}}},{"node":{"excerpt":"This year marks the 35th anniversary of The Legend of Zelda‚Ä¶","fields":{"slug":"/2021/2021-07-14-creating-my-dream-skyward-sword-hd-switch-accessories.en/","path":"/blog/games/creating-my-dream-skyward-sword-hd-switch-accessories/","locale":"en"},"readingTime":{"minutes":2.95},"frontmatter":{"date":"2021-07-14T00:00:00.000Z","title":"Creating my dream Skyward Sword HD Switch accessories","hideExcerpt":null}}},{"node":{"excerpt":"For those of you that don‚Äôt know, Metroidvania is probably‚Ä¶","fields":{"slug":"/2021/2021-07-06-hiding-parts-of-the-map-on-phaser-js-game-devlog-21.en/","path":"/blog/games/hiding-parts-of-the-map-on-phaser-js-game-devlog-21/","locale":"en"},"readingTime":{"minutes":2.985},"frontmatter":{"date":"2021-07-06T00:00:00.000Z","title":"Hiding parts of the map on Phaser JS - Game Devlog #21","hideExcerpt":null}}},{"node":{"excerpt":"Hey everyone! Today I‚Äôm finally back with another game‚Ä¶","fields":{"slug":"/2021/2021-06-28-creating-falling-spikes-with-phaser-js-game-devlog-20.en/","path":"/blog/games/creating-falling-spikes-with-phaser-js-game-devlog-20/","locale":"en"},"readingTime":{"minutes":3.895},"frontmatter":{"date":"2021-06-28T00:00:00.000Z","title":"Creating falling spikes with Phaser JS - Game Devlog #20","hideExcerpt":null}}},{"node":{"excerpt":"In one of my first game devlogs, I explained how to automate‚Ä¶","fields":{"slug":"/2021/2021-06-22-automatically-generate-sprite-sheet-atlas-files-for-your-phaser-js-game-with-a-nodejs-script.en/","path":"/blog/games/automatically-generate-sprite-sheet-atlas-files-for-your-phaser-js-game-with-a-nodejs-script/","locale":"en"},"readingTime":{"minutes":2.495},"frontmatter":{"date":"2021-06-22T00:00:00.000Z","title":"Automatically generate sprite sheet atlas files for your Phaser JS game with a Node.js script","hideExcerpt":null}}},{"node":{"excerpt":"Hey everyone, today‚Äôs devlog will be very similar to the‚Ä¶","fields":{"slug":"/2021/2021-06-19-hanging-on-a-monkey-bar-on-phaser-js-game-devlog-19.en/","path":"/blog/games/hanging-on-a-monkey-bar-on-phaser-js-game-devlog-19/","locale":"en"},"readingTime":{"minutes":1.71},"frontmatter":{"date":"2021-06-19T00:00:00.000Z","title":"Hanging on a monkey bar Phaser JS - Game Devlog #19","hideExcerpt":null}}},{"node":{"excerpt":"6785 days, that‚Äôs how long ago Metroid 4 (aka Metroid Fusion‚Ä¶","fields":{"slug":"/2021/2021-06-16-metroid-5-is-finally-announced-19-years-later.en/","path":"/blog/games/metroid-5-is-finally-announced-19-years-later/","locale":"en"},"readingTime":{"minutes":1.715},"frontmatter":{"date":"2021-06-16T00:00:00.000Z","title":"Metroid 5 is finally announced, 19 years later","hideExcerpt":null}}},{"node":{"excerpt":"Hey everyone, I‚Äôm back with another devlog for Super Ollie‚Ä¶","fields":{"slug":"/2021/2021-06-05-creating-ladders-for-platformer-with-phaser-js-game-devlog-18.en/","path":"/blog/games/creating-ladders-for-platformer-with-phaser-js-game-devlog-18/","locale":"en"},"readingTime":{"minutes":1.9},"frontmatter":{"date":"2021-06-05T00:00:00.000Z","title":"Creating ladders for platformer with Phaser JS - Game Devlog #18","hideExcerpt":false}}},{"node":{"excerpt":"When making a JAMStack website, some compromises need to be‚Ä¶","fields":{"slug":"/2021/2021-05-29-how-to-create-an-offline-search-page-with-gatsby.en/","path":"/blog/coding/how-to-create-an-offline-search-page-with-gatsby/","locale":"en"},"readingTime":{"minutes":3.285},"frontmatter":{"date":"2021-05-29T00:00:00.000Z","title":"How to create an offline search page with Gatsby","hideExcerpt":false}}},{"node":{"excerpt":"Around 2 months ago, Gatsby v3 was released, and I was‚Ä¶","fields":{"slug":"/2021/2021-05-21-building-a-dynamic-form-from-a-json-schema.en/","path":"/blog/coding/building-a-dynamic-form-from-a-json-schema/","locale":"en"},"readingTime":{"minutes":4.84},"frontmatter":{"date":"2021-05-21T00:00:00.000Z","title":"Building a dynamic form from a JSON schema","hideExcerpt":false}}},{"node":{"excerpt":"Today I decided to deploy my blog to my GitHub Pages address‚Ä¶","fields":{"slug":"/2021/2021-05-15-using-github-actions-to-deploy-my-blog-into-different-domains.en/","path":"/blog/coding/using-github-actions-to-deploy-my-blog-into-different-domains/","locale":"en"},"readingTime":{"minutes":1.395},"frontmatter":{"date":"2021-05-15T00:00:00.000Z","title":"Using GitHub Actions to deploy my blog into different domains","hideExcerpt":false}}},{"node":{"excerpt":"Today I needed to know the accumulated inflation of the last‚Ä¶","fields":{"slug":"/2021/2021-05-13-how-to-calculate-brazils-annual-inflation-using-javascript.en/","path":"/blog/coding/how-to-calculate-brazils-annual-inflation-using-javascript/","locale":"en"},"readingTime":{"minutes":1.875},"frontmatter":{"date":"2021-05-13T00:00:00.000Z","title":"How to calculate the annual inflation in Brazil using JavaScript","hideExcerpt":false}}},{"node":{"excerpt":"This week I was working on my project Resume Builder and I‚Ä¶","fields":{"slug":"/2021/2021-05-09-how-to-create-a-json-download-link-using-html-only.en/","path":"/blog/coding/how-to-create-a-json-download-link-using-html-only/","locale":"en"},"readingTime":{"minutes":1.675},"frontmatter":{"date":"2021-05-09T00:00:00.000Z","title":"How to create a JSON download link using HTML only","hideExcerpt":false}}},{"node":{"excerpt":"Get in contact with your local nutritionist. GG EZ.","fields":{"slug":"/2021/2021-05-02-i-lost-14kg-this-year-here-is-how-you-can-too.en/","path":"/blog/general/i-lost-14kg-this-year-here-is-how-you-can-too/","locale":"en"},"readingTime":{"minutes":0.045},"frontmatter":{"date":"2021-05-02T00:00:00.000Z","title":"I lost 14kg this year, here is how you can too","hideExcerpt":true}}},{"node":{"excerpt":"Well, this is awkward‚Ä¶ It‚Äôs been four months since my last‚Ä¶","fields":{"slug":"/2021/2021-04-24-creating-a-pogo-attack-with-phaser-js-game-devlog-17.en/","path":"/blog/games/creating-a-pogo-attack-with-phaser-js-game-devlog-17/","locale":"en"},"readingTime":{"minutes":0.925},"frontmatter":{"date":"2021-04-24T00:00:00.000Z","title":"Creating a pogo-attack with Phaser JS - Game Devlog #17","hideExcerpt":false}}},{"node":{"excerpt":"When I was in college, web development wasn‚Äôt a major part‚Ä¶","fields":{"slug":"/2021/2021-04-17-i-pay-0-in-hosting-for-this-website.en/","path":"/blog/coding/i-pay-0-in-hosting-for-this-website/","locale":"en"},"readingTime":{"minutes":10.57},"frontmatter":{"date":"2021-04-17T00:00:00.000Z","title":"I pay $0.00 in hosting for this website","hideExcerpt":false}}},{"node":{"excerpt":"Happy #quarantineversary! Oh yeah, it‚Äôs been one year, one‚Ä¶","fields":{"slug":"/2021/2021-03-12-one-year-of-working-from-home.en/","path":"/blog/general/one-year-of-working-from-home/","locale":"en"},"readingTime":{"minutes":0.755},"frontmatter":{"date":"2021-03-12T00:00:00.000Z","title":"One year of working from home","hideExcerpt":false}}},{"node":{"excerpt":"Well isn‚Äôt that something? Less than 7 days after failing to‚Ä¶","fields":{"slug":"/2021/2021-01-31-godammit-telegram.en/","path":"/blog/general/godammit-telegram/","locale":"en"},"readingTime":{"minutes":2.305},"frontmatter":{"date":"2021-01-31T00:00:00.000Z","title":"Godammit Telegram!","hideExcerpt":false}}},{"node":{"excerpt":"Whatsapp was in all news outlets recently due to its new‚Ä¶","fields":{"slug":"/2021/2021-01-24-godammit-whatsapp.en/","path":"/blog/general/godammit-whatsapp/","locale":"en"},"readingTime":{"minutes":4.325},"frontmatter":{"date":"2021-01-24T00:00:00.000Z","title":"Godammit Whatsapp!","hideExcerpt":false}}},{"node":{"excerpt":"Wassup everyone, I‚Äôm once again late with my ‚Äúweekly‚Äù devlog‚Ä¶","fields":{"slug":"/2020/2020-29-12-adding-transition-when-entering-a-stage-on-phaser-js-skate-platformer-game-devlog-16.en/","path":"/blog/games/adding-transition-when-entering-a-stage-on-phaser-js-skate-platformer-game-devlog-16/","locale":"en"},"readingTime":{"minutes":0.975},"frontmatter":{"date":"2020-12-29T00:00:00.000Z","title":"Adding transition when entering a stage on Phaser JS - Game Devlog #16","hideExcerpt":false}}},{"node":{"excerpt":"Alright, get comfortable because today‚Äôs devlog is long, but‚Ä¶","fields":{"slug":"/2020/2020-15-12-creating-a-smarter-and-more-performing-ai-on-phaser-js-skate-platformer-game-devlog-15.en/","path":"/blog/games/creating-a-smarter-and-more-performing-ai-on-phaser-js-skate-platformer-game-devlog-15/","locale":"en"},"readingTime":{"minutes":4.495},"frontmatter":{"date":"2020-12-15T00:00:00.000Z","title":"Creating a smarter and more performing AI on Phaser JS - Game Devlog #15","hideExcerpt":false}}},{"node":{"excerpt":"Hey, y‚Äôall. This week I bring another tiny devlog due to‚Ä¶","fields":{"slug":"/2020/2020-09-12-creating-custom-weather-on-phaser-js-skate-platformer-game-devlog-14.en/","path":"/blog/games/creating-custom-weather-on-phaser-js-skate-platformer-game-devlog-14/","locale":"en"},"readingTime":{"minutes":1.025},"frontmatter":{"date":"2020-12-09T00:00:00.000Z","title":"Creating custom weather on Phaser JS - Skate Platformer Game Devlog #14","hideExcerpt":false}}},{"node":{"excerpt":"Hey guys, in today‚Äôs game devlog I‚Äôll add a loading screen‚Ä¶","fields":{"slug":"/2020/2020-29-11-creating-a-loading-screen-and-adding-translation-on-phaser-js-skate-platformer-game-devlog-13.en/","path":"/blog/games/creating-a-loading-screen-and-adding-translation-on-phaser-js-skate-platformer-game-devlog-13/","locale":"en"},"readingTime":{"minutes":1.395},"frontmatter":{"date":"2020-11-29T00:00:00.000Z","title":"Creating a loading screen and adding translation on Phaser JS - Skate Platformer Game Devlog #13","hideExcerpt":false}}},{"node":{"excerpt":"Hey guys! In today‚Äôs video, I will show you how I created a‚Ä¶","fields":{"slug":"/2020/2020-19-11-saving-player-progress-with-checkpoints-with-phaser-js-skate-platformer-game-devlog-12.en/","path":"/blog/games/saving-player-progress-with-checkpoints-with-phaser-js-skate-platformer-game-devlog-12/","locale":"en"},"readingTime":{"minutes":1.04},"frontmatter":{"date":"2020-11-19T00:00:00.000Z","title":"Saving player progress with checkpoints with Phaser JS - Skate Platformer Game Devlog #12","hideExcerpt":false}}},{"node":{"excerpt":"Hey guys, in today‚Äôs devlog I‚Äôm going to make something‚Ä¶","fields":{"slug":"/2020/2020-11-11-loading-user-created-tiled-stages-on-phaser-js-skate-platformer-game-devlog-11.en/","path":"/blog/games/loading-user-created-tiled-stages-on-phaser-js-skate-platformer-game-devlog-11/","locale":"en"},"readingTime":{"minutes":2.76},"frontmatter":{"date":"2020-11-11T00:00:00.000Z","title":"Loading user-created Tiled stages on Phaser JS - Skate Platformer Game Devlog #11","hideExcerpt":false}}},{"node":{"excerpt":"Hey guys, in today‚Äôs game devlog I‚Äôll show you how I did to‚Ä¶","fields":{"slug":"/2020/2020-05-11-creating-hero-hud-on-phaser-js-skate-platformer-game-devlog-10.en/","path":"/blog/games/creating-hero-hud-on-phaser-js-skate-platformer-game-devlog-10/","locale":"en"},"readingTime":{"minutes":2.8},"frontmatter":{"date":"2020-11-05T00:00:00.000Z","title":"Creating hero HUD on Phaser JS - Skate Platformer Game Devlog #10","hideExcerpt":false}}},{"node":{"excerpt":"Hey guys! For today‚Äôs game devlog I‚Äôm going to show more‚Ä¶","fields":{"slug":"/2020/2020-30-10-creating-enemies-artificial-intelligence-on-phaser-js-skate-platformer-game-devlog-9.en/","path":"/blog/games/creating-enemies-artificial-intelligence-on-phaser-js-skate-platformer-game-devlog-9/","locale":"en"},"readingTime":{"minutes":1.975},"frontmatter":{"date":"2020-10-30T00:00:00.000Z","title":"Creating enemies artificial intelligence on Phaser JS - Skate Platformer Game Devlog #09","hideExcerpt":false}}},{"node":{"excerpt":"Hey guys, I‚Äôm back with another game devlog, it took me a‚Ä¶","fields":{"slug":"/2020/2020-22-10-creating-enemies-and-collectable-items-on-phaser-js-skate-platformer-game-devlog-8.en/","path":"/blog/games/creating-enemies-and-collectable-items-on-phaser-js-skate-platformer-game-devlog-8/","locale":"en"},"readingTime":{"minutes":2.78},"frontmatter":{"date":"2020-10-22T00:00:00.000Z","title":"Creating enemies and collectable items on Phaser JS - Skate Platformer Game Devlog #08","hideExcerpt":false}}},{"node":{"excerpt":"Loading external tileset files Tiled is a powerful open‚Ä¶","fields":{"slug":"/2020/2020-08-10-loading-external-tileset-file-on-phaser-js-using-webpack-skate-platformer-game-devlog-7.en/","path":"/blog/games/loading-external-tileset-file-on-phaser-js-using-webpack-skate-platformer-game-devlog-7/","locale":"en"},"readingTime":{"minutes":3.905},"frontmatter":{"date":"2020-10-08T00:00:00.000Z","title":"Loading external tileset file on Phaser JS using Webpack - Skate Platformer Game Devlog #07","hideExcerpt":false}}},{"node":{"excerpt":"Hey guys! Today‚Äôs Game Devlog is a bit long, 15 minutes, but‚Ä¶","fields":{"slug":"/2020/2020-01-10-falling-off-platforms-with-arcade-physics-on-phaser-js-skate-platformer-game-devlog-6.en/","path":"/blog/games/falling-off-platforms-with-arcade-physics-on-phaser-js-skate-platformer-game-devlog-6/","locale":"en"},"readingTime":{"minutes":3.125},"frontmatter":{"date":"2020-10-01T00:00:00.000Z","title":"Falling off platforms with Arcade Physics on Phaser JS - Skate Platformer Game Devlog #06","hideExcerpt":false}}},{"node":{"excerpt":"Hey guys, in this week‚Äôs Game Devlog I‚Äôll show you how I‚Ä¶","fields":{"slug":"/2020/2020-26-09-using-a-button-to-run-with-phaser-js-skate-platformer-game-devlog-5.en/","path":"/blog/games/using-a-button-to-run-with-phaser-js-skate-platformer-game-devlog-5/","locale":"en"},"readingTime":{"minutes":0.73},"frontmatter":{"date":"2020-09-26T00:00:00.000Z","title":"Using a button to run with Phaser JS - Skate Platformer Game Devlog #05","hideExcerpt":false}}},{"node":{"excerpt":"As a software developer, it‚Äôs common to move around the‚Ä¶","fields":{"slug":"/2020/2020-23-09-how-an-open-source-project-landed-me-a-job-abroad.en/","path":"/blog/coding/how-an-open-source-project-landed-me-a-job-abroad/","locale":"en"},"readingTime":{"minutes":4.21},"frontmatter":{"date":"2020-09-23T00:00:00.000Z","title":"How an open source project landed me a job abroad","hideExcerpt":false}}},{"node":{"excerpt":"Hey, I‚Äôm back with another Game Devlog. In today‚Äôs devlog we‚Ä¶","fields":{"slug":"/2020/2020-21-09-skate-platformer-game-devlog-4.en/","path":"/blog/games/skate-platformer-game-devlog-4/","locale":"en"},"readingTime":{"minutes":0.96},"frontmatter":{"date":"2020-09-21T00:00:00.000Z","title":"Holding button to jump higher with Phaser JS - Skate Platformer Game Devlog #04","hideExcerpt":false}}},{"node":{"excerpt":"Hey guys, another game devlog of skate platformer, this time‚Ä¶","fields":{"slug":"/2020/2020-17-09-third-game-devlog-of-skate-platformer.en/","path":"/blog/games/third-game-devlog-of-skate-platformer/","locale":"en"},"readingTime":{"minutes":1.405},"frontmatter":{"date":"2020-09-17T00:00:00.000Z","title":"Creating precise custom colliders for Arcade Physics on Phaser JS - Skate Platformer Game Devlog #03","hideExcerpt":false}}},{"node":{"excerpt":"So that‚Äôs me, standing in front of the grand opening of the‚Ä¶","fields":{"slug":"/2020/2020-14-09-me-san-francisco-and-metallica.en/","path":"/blog/events/me-san-francisco-and-metallica/","locale":"en"},"readingTime":{"minutes":6.245},"frontmatter":{"date":"2020-09-14T00:00:00.000Z","title":"Me, San Francisco and Metallica","hideExcerpt":false}}},{"node":{"excerpt":"Hey guys, second post in less than a week, unbelievable.  In‚Ä¶","fields":{"slug":"/2020/2020-09-09-second-game-devlog-of-skate-platformer.en/","path":"/blog/games/second-game-devlog-of-skate-platformer/","locale":"en"},"readingTime":{"minutes":1.59},"frontmatter":{"date":"2020-09-09T00:00:00.000Z","title":"Improving sprite sheets generation for Phaser JS game with Webpack 4 - Skate Platformer Game Devlog #02","hideExcerpt":false}}},{"node":{"excerpt":"Hey guys, quite some time since I don‚Äôt post anything, right‚Ä¶","fields":{"slug":"/2020/2020-02-09-first-game-devlog-of-my-game.en/","path":"/blog/games/first-game-devlog-of-my-game/","locale":"en"},"readingTime":{"minutes":0.695},"frontmatter":{"date":"2020-09-02T00:00:00.000Z","title":"Trying out Phaser JS Arcade Physics - Skate Platformer Game Devlog #01","hideExcerpt":false}}},{"node":{"excerpt":"Word! Att.","fields":{"slug":"/2016/2016-02-16-an-open-letter-to-mark-manson.en/","path":"/blog/general/an-open-letter-to-mark-manson/","locale":"en"},"readingTime":{"minutes":0.01},"frontmatter":{"date":"2016-02-16T00:00:00.000Z","title":"An open letter to Mark Manson","hideExcerpt":false}}},{"node":{"excerpt":"Well, recently I found out that Google had created the‚Ä¶","fields":{"slug":"/2015/2015-05-31-google-flights-op.en/","path":"/blog/tips/google-flights-op/","locale":"en"},"readingTime":{"minutes":0.715},"frontmatter":{"date":"2015-05-31T00:00:00.000Z","title":"Google Flights OP","hideExcerpt":false}}},{"node":{"excerpt":"Another year I had the privilege to participate in the E‚Ä¶","fields":{"slug":"/2014/2014-08-08-trip-to-la-e3-2014.en/","path":"/blog/events/trip-to-la-e3-2014/","locale":"en"},"readingTime":{"minutes":0.14},"frontmatter":{"date":"2014-08-08T00:00:00.000Z","title":"Trip to LA - E3 2014","hideExcerpt":false}}},{"node":{"excerpt":"Lately I fell in love with Lego again, which was my favorite‚Ä¶","fields":{"slug":"/2013/2013-02-09-lego-love.en/","path":"/blog/toys/lego-love/","locale":"en"},"readingTime":{"minutes":0.435},"frontmatter":{"date":"2013-02-09T00:00:00.000Z","title":"Lego love","hideExcerpt":false}}},{"node":{"excerpt":"Fala galera! Beleza? Muitos leitores aqui no meu blog‚Ä¶","fields":{"slug":"/2013/2013-02-09-new-handheld-revo-k101-gba-clone.en/","path":"/blog/games/new-handheld-revo-k101-gba-clone/","locale":"en"},"readingTime":{"minutes":1.825},"frontmatter":{"date":"2013-02-09T00:00:00.000Z","title":"New handheld: Revo K101 (GBA clone)","hideExcerpt":false}}},{"node":{"excerpt":"Woohoooo!!! Completing 6 months of E3, and practically‚Ä¶","fields":{"slug":"/2012/2012-12-20-trip-to-e3-2012.en/","path":"/blog/events/trip-to-e3-2012/","locale":"en"},"readingTime":{"minutes":0.36},"frontmatter":{"date":"2012-12-20T00:00:00.000Z","title":"Trip to E3 2012","hideExcerpt":false}}},{"node":{"excerpt":"BACK FROM THE DEAD? Hardly. It just arrived at a time when I‚Ä¶","fields":{"slug":"/2012/2012-05-31-e3-2012-and-here-we-go.en/","path":"/blog/events/e3-2012-and-here-we-go/","locale":"en"},"readingTime":{"minutes":2.025},"frontmatter":{"date":"2012-05-31T00:00:00.000Z","title":"E3 2012 - And here we... Go","hideExcerpt":false}}},{"node":{"excerpt":"Well, it is been a few months since I decided to dedicate a‚Ä¶","fields":{"slug":"/2010/2010-07-03-zelda-timeline-and-skyward-sword-placement.en/","path":"/blog/games/zelda-timeline-and-skyward-sword-placement/","locale":"en"},"readingTime":{"minutes":13.77},"frontmatter":{"date":"2010-07-03T00:00:00.000Z","title":"Zelda timeline and Skyward Sword placement","hideExcerpt":false}}},{"node":{"excerpt":"I realized that there aren‚Äôt many videos about it, so I made‚Ä¶","fields":{"slug":"/2010/2010-04-07-unboxing-white-chocolate-easter-egg.en/","path":"/blog/tips/unboxing-white-chocolate-easter-egg/","locale":"en"},"readingTime":{"minutes":0.125},"frontmatter":{"date":"2010-04-07T00:00:00.000Z","title":"Unboxing white chocolate easter egg","hideExcerpt":false}}},{"node":{"excerpt":"Waking up early and being left with nothing to do is awesome‚Ä¶","fields":{"slug":"/2010/2010-03-23-having-fun-with-sony-vegas.en/","path":"/blog/funny/having-fun-with-sony-vegas/","locale":"en"},"readingTime":{"minutes":0.2},"frontmatter":{"date":"2010-03-23T00:00:00.000Z","title":"Having fun with Sony Vegas","hideExcerpt":false}}},{"node":{"excerpt":"As you may already know, a special Jirachi distribution‚Ä¶","fields":{"slug":"/2010/2010-03-22-jirachi-from-latamel-event.en/","path":"/blog/events/jirachi-from-latamel-event/","locale":"en"},"readingTime":{"minutes":1.36},"frontmatter":{"date":"2010-03-22T00:00:00.000Z","title":"Jirachi from Latamel event","hideExcerpt":false}}},{"node":{"excerpt":"MY POKEMON CARTRIDGE IS HERE! YAAAAAY!!! The Pok√©walker is‚Ä¶","fields":{"slug":"/2010/2010-03-21-pokemon-soul-silver-unboxing.en/","path":"/blog/games/pokemon-soul-silver-unboxing/","locale":"en"},"readingTime":{"minutes":0.195},"frontmatter":{"date":"2010-03-21T00:00:00.000Z","title":"Pok√©mon Soul Silver Unboxing","hideExcerpt":false}}},{"node":{"excerpt":"After a long wait, my Wii guitar arrived. I paid a measly R‚Ä¶","fields":{"slug":"/2010/2010-03-05-unboxing-the-wireless-guitar-for-wii.en/","path":"/blog/tips/unboxing-the-wireless-guitar-for-wii/","locale":"en"},"readingTime":{"minutes":0.14},"frontmatter":{"date":"2010-03-05T00:00:00.000Z","title":"Unboxing the Wireless Guitar for Wii","hideExcerpt":false}}},{"node":{"excerpt":"Can‚Äôt handle the will to be able to control Link in his new‚Ä¶","fields":{"slug":"/2010/2010-02-18-camy-hero-pack-for-those-who-cannot-wait-for-the-new-zelda.en/","path":"/blog/games/camy-hero-pack-for-those-who-cannot-wait-for-the-new-zelda/","locale":"en"},"readingTime":{"minutes":1.65},"frontmatter":{"date":"2010-02-18T00:00:00.000Z","title":"Camy Hero Pack - For those who cannot wait for the next Zelda","hideExcerpt":false}}},{"node":{"excerpt":"Go to http://www.planalto.gov.br/ccivil_03/leis/l9609.htm","fields":{"slug":"/2010/2010-01-24-softwares-law-in-brazil.en/","path":"/blog/tips/softwares-law-in-brazil/","locale":"en"},"readingTime":{"minutes":0.015},"frontmatter":{"date":"2010-01-24T00:00:00.000Z","title":"Softwares law in Brazil","hideExcerpt":false}}},{"node":{"excerpt":"2009 was a kick ass year! Several new games, cellphones and‚Ä¶","fields":{"slug":"/2009/2009-12-31-2010-is-coming.en/","path":"/blog/general/2010-is-coming/","locale":"en"},"readingTime":{"minutes":1.245},"frontmatter":{"date":"2009-12-31T00:00:00.000Z","title":"2010 is coming","hideExcerpt":false}}},{"node":{"excerpt":"Seriously, if you like pasta and want to spend part of your‚Ä¶","fields":{"slug":"/2009/2009-12-24-donatello-pasta-an-awesome-new-restaurant-in-buzios.en/","path":"/blog/tips/donatello-pasta-an-awesome-new-restaurant-in-buzios/","locale":"en"},"readingTime":{"minutes":0.475},"frontmatter":{"date":"2009-12-24T00:00:00.000Z","title":"Donatello Pasta - An awesome new restaurant in B√∫zios","hideExcerpt":false}}},{"node":{"excerpt":"Did you see this post‚Äôs title? Yes, I‚Äôm going to talk about‚Ä¶","fields":{"slug":"/2009/2009-09-15-zelda-timeline.en/","path":"/blog/games/zelda-timeline/","locale":"en"},"readingTime":{"minutes":6.165},"frontmatter":{"date":"2009-09-15T00:00:00.000Z","title":"Zelda timeline?","hideExcerpt":false}}},{"node":{"excerpt":"Sometimes I realize that I‚Äôm not just a useless information‚Ä¶","fields":{"slug":"/2009/2009-07-08-special-effects.en/","path":"/blog/general/special-effects/","locale":"en"},"readingTime":{"minutes":0.65},"frontmatter":{"date":"2009-07-08T00:00:00.000Z","title":"Special effects","hideExcerpt":false}}},{"node":{"excerpt":"Yesterday my beautiful Samsung SC-MX20B arrived, which a‚Ä¶","fields":{"slug":"/2009/2009-06-23-hands-on-samsung-scmx20b.en/","path":"/blog/gadgets/hands-on-samsung-scmx20b/","locale":"en"},"readingTime":{"minutes":0.785},"frontmatter":{"date":"2009-06-23T00:00:00.000Z","title":"Hands on Samsung SC-MX20B!","hideExcerpt":false}}},{"node":{"excerpt":"Since My Name is Earl was canceled in the EUA, lots of fans‚Ä¶","fields":{"slug":"/2009/2009-06-21-save-earl.en/","path":"/blog/general/save-earl/","locale":"en"},"readingTime":{"minutes":0.47},"frontmatter":{"date":"2009-06-21T00:00:00.000Z","title":"Save Earl","hideExcerpt":false}}},{"node":{"excerpt":"When I bought Zeemote I got surprised at first sight: The‚Ä¶","fields":{"slug":"/2009/2009-06-10-review-zeemote-js1.en/","path":"/blog/gadgets/review-zeemote-js1/","locale":"en"},"readingTime":{"minutes":3.795},"frontmatter":{"date":"2009-06-10T00:00:00.000Z","title":"Review: Zeemote JS1","hideExcerpt":false}}},{"node":{"excerpt":"These days I was at the market, choosing what to eat with‚Ä¶","fields":{"slug":"/2009/2009-06-01-review-hot-pocket-burger.en/","path":"/blog/tips/review-hot-pocket-burger/","locale":"en"},"readingTime":{"minutes":1.685},"frontmatter":{"date":"2009-06-01T00:00:00.000Z","title":"Review: Hot Pocket Burger","hideExcerpt":false}}},{"node":{"excerpt":"After several hours searching, I finally found a practical‚Ä¶","fields":{"slug":"/2009/2009-05-13-blog-in-english.en/","path":"/blog/general/blog-in-english/","locale":"en"},"readingTime":{"minutes":0.165},"frontmatter":{"date":"2009-05-13T00:00:00.000Z","title":"Blog in english","hideExcerpt":false}}},{"node":{"excerpt":"Today I found a really old video of some fingerboard tricks‚Ä¶","fields":{"slug":"/2009/2009-05-12-fingerboard-old-times.en/","path":"/blog/general/fingerboard-old-times/","locale":"en"},"readingTime":{"minutes":0.355},"frontmatter":{"date":"2009-05-12T00:00:00.000Z","title":"Fingerboard old times","hideExcerpt":false}}},{"node":{"excerpt":"Did you know that in every product you buy, you‚Äôre paying‚Ä¶","fields":{"slug":"/2009/2009-04-18-brazilian-taxes.en/","path":"/blog/general/brazilian-taxes/","locale":"en"},"readingTime":{"minutes":2.205},"frontmatter":{"date":"2009-04-18T00:00:00.000Z","title":"Brazilian taxes","hideExcerpt":false}}},{"node":{"excerpt":"After practically 4 years of wanting to watch this clip‚Ä¶","fields":{"slug":"/2008/2008-11-11-nada-by-los-pirata.en/","path":"/blog/funny/nada-by-los-pirata/","locale":"en"},"readingTime":{"minutes":0.325},"frontmatter":{"date":"2008-11-11T00:00:00.000Z","title":"Nada by Los Pirata","hideExcerpt":false}}},{"node":{"excerpt":"","fields":{"slug":"/2008/2008-10-02-idol-steve-oedekerk.en/","path":"/blog/funny/idol-steve-oedekerk/","locale":"en"},"readingTime":{"minutes":0.01},"frontmatter":{"date":"2008-10-02T00:00:00.000Z","title":"Idol: Steve Oedekerk","hideExcerpt":false}}},{"node":{"excerpt":"Well, I don‚Äôt really know how to have this blog thing, it‚Ä¶","fields":{"slug":"/2008/2008-09-28-first-post.en/","path":"/blog/general/first-post/","locale":"en"},"readingTime":{"minutes":0.34},"frontmatter":{"date":"2008-09-28T00:00:00.000Z","title":"First Post","hideExcerpt":false}}}]}},"pageContext":{"currentPageNumber":3,"totalPageNumber":5,"pageType":"archive","posts":[{"node":{"excerpt":"Hoje eu decidi fazer o deploy do meu blog no meu endere√ßo do‚Ä¶","html":"<p>Hoje eu decidi fazer o deploy do meu blog no meu endere√ßo do GitHub Pages, <a href=\"https://blopa.github.io/\" target=\"_blank\" rel=\"noreferrer\">blopa.github.io</a>, al√©m do meu deploy normal no <a href=\"https://pablo.gg/\" target=\"_blank\" rel=\"noreferrer\">pablo.gg</a>, mas como fazer isso?</p>\n<p>Primeiro eu criei um reposit√≥rio chamado <code class=\"language-text\">username.github.io</code>, onde <code class=\"language-text\">username</code> √© o seu nome de usu√°rio GitHub:</p>\n<p><figure class=\"gatsby-resp-image-figure\" style=\"\">\n    <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 872px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 75.390625%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAPABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAIF/8QAFAEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEAMQAAAB3KmwD//EABUQAQEAAAAAAAAAAAAAAAAAABBB/9oACAEBAAEFAmn/xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAUEAEAAAAAAAAAAAAAAAAAAAAg/9oACAEBAAY/Al//xAAZEAACAwEAAAAAAAAAAAAAAAABEQAQIUH/2gAIAQEAAT8hW8m02Yv/2gAMAwEAAgADAAAAEMPP/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPxA//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPxA//8QAGxABAAICAwAAAAAAAAAAAAAAARExABAhQZH/2gAIAQEAAT8QUqCU24IsPdEBETviMBC9f//Z'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Imagem do site do GitHub Pages\"\n        title=\"Imagem do site do GitHub Pages\"\n        src=\"/static/d564a27692cc9b7425ac9fd8bdbcf339/ffc01/username-github-io.jpg\"\n        srcset=\"/static/d564a27692cc9b7425ac9fd8bdbcf339/db830/username-github-io.jpg 256w,\n/static/d564a27692cc9b7425ac9fd8bdbcf339/8102f/username-github-io.jpg 512w,\n/static/d564a27692cc9b7425ac9fd8bdbcf339/ffc01/username-github-io.jpg 872w\"\n        sizes=\"(max-width: 872px) 100vw, 872px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\">Imagem do site do GitHub Pages</figcaption>\n  </figure></p>\n<p>Agora, no reposit√≥rio onde est√£o os meus arquivos fonte, eu preciso adicionar um novo arquivo do GitHub Actions, vamos cham√°-lo de <code class=\"language-text\">deploy-to-github.io.yml</code>:</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> deploy<span class=\"token punctuation\">-</span>to<span class=\"token punctuation\">-</span>github.io.yml\r\n<span class=\"token key atrule\">on</span><span class=\"token punctuation\">:</span>\r\n  <span class=\"token key atrule\">workflow_dispatch</span><span class=\"token punctuation\">:</span>\r\n  <span class=\"token key atrule\">push</span><span class=\"token punctuation\">:</span>\r\n    <span class=\"token key atrule\">branches</span><span class=\"token punctuation\">:</span>\r\n      <span class=\"token punctuation\">-</span> main\r\n\r\n<span class=\"token key atrule\">jobs</span><span class=\"token punctuation\">:</span>\r\n  <span class=\"token key atrule\">build-and-deploy</span><span class=\"token punctuation\">:</span>\r\n    <span class=\"token key atrule\">runs-on</span><span class=\"token punctuation\">:</span> ubuntu<span class=\"token punctuation\">-</span>latest\r\n    <span class=\"token key atrule\">steps</span><span class=\"token punctuation\">:</span>\r\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Checkout\r\n        <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> actions/checkout@v2.3.4\r\n        <span class=\"token key atrule\">with</span><span class=\"token punctuation\">:</span>\r\n          <span class=\"token key atrule\">persist-credentials</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">false</span>\r\n\r\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Install and Build üöß\r\n        <span class=\"token key atrule\">run</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">|</span><span class=\"token scalar string\">\r\n          npm cache clean --force\r\n          npm install\r\n          npm run clean\r\n          npm run build\r\n          rm -rf CNAME</span>\r\n\r\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Deploy üöÄ\r\n        <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> JamesIves/github<span class=\"token punctuation\">-</span>pages<span class=\"token punctuation\">-</span>deploy<span class=\"token punctuation\">-</span>action@4.1.3\r\n        <span class=\"token key atrule\">with</span><span class=\"token punctuation\">:</span>\r\n          <span class=\"token key atrule\">token</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> secrets.ACCESS_TOKEN <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\r\n          <span class=\"token key atrule\">repository-name</span><span class=\"token punctuation\">:</span> blopa/blopa.github.io\r\n          <span class=\"token key atrule\">branch</span><span class=\"token punctuation\">:</span> gh<span class=\"token punctuation\">-</span>pages\r\n          <span class=\"token key atrule\">folder</span><span class=\"token punctuation\">:</span> public\r\n          <span class=\"token key atrule\">clean</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">true</span>\r\n          <span class=\"token key atrule\">single-commit</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">true</span></code></pre></div>\n<p>Isso ir√° buildar e fazer o deploy do meu c√≥digo em outro reposit√≥rio do GitHub chamado <code class=\"language-text\">blopa/pablo.gg</code>. Para que isso funcione, eu preciso <a href=\"https://docs.github.com/pt/github/authenticating-to-github/creating-a-personal-access-token\" target=\"_blank\" rel=\"noreferrer\">criar um token de acesso pessoal</a> e ent√£o <a href=\"https://docs.github.com/pt/actions/reference/encrypted-secrets\" target=\"_blank\" rel=\"noreferrer\">adicion√°-lo nos secrets do reposit√≥rio</a> com o nome <code class=\"language-text\">ACCESS_TOKEN</code>.</p>\n<p>Como eu tamb√©m fa√ßo o deploy normal do meu blog em outro reposit√≥rio, este √© meu arquivo do GitHub Actions para isso:</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> deploy<span class=\"token punctuation\">-</span>to<span class=\"token punctuation\">-</span>gg.yml\r\n<span class=\"token key atrule\">on</span><span class=\"token punctuation\">:</span>\r\n  <span class=\"token key atrule\">workflow_dispatch</span><span class=\"token punctuation\">:</span>\r\n  <span class=\"token key atrule\">push</span><span class=\"token punctuation\">:</span>\r\n    <span class=\"token key atrule\">branches</span><span class=\"token punctuation\">:</span>\r\n      <span class=\"token punctuation\">-</span> main\r\n\r\n<span class=\"token key atrule\">jobs</span><span class=\"token punctuation\">:</span>\r\n  <span class=\"token key atrule\">build-and-deploy</span><span class=\"token punctuation\">:</span>\r\n    <span class=\"token key atrule\">runs-on</span><span class=\"token punctuation\">:</span> ubuntu<span class=\"token punctuation\">-</span>latest\r\n    <span class=\"token key atrule\">steps</span><span class=\"token punctuation\">:</span>\r\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Checkout\r\n        <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> actions/checkout@v2.3.4\r\n        <span class=\"token key atrule\">with</span><span class=\"token punctuation\">:</span>\r\n          <span class=\"token key atrule\">persist-credentials</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">false</span>\r\n\r\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Install and Build üöß\r\n        <span class=\"token key atrule\">run</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">|</span><span class=\"token scalar string\">\r\n          npm cache clean --force\r\n          npm install\r\n          npm run clean\r\n          npm run build</span>\r\n\r\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Deploy üöÄ\r\n        <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> JamesIves/github<span class=\"token punctuation\">-</span>pages<span class=\"token punctuation\">-</span>deploy<span class=\"token punctuation\">-</span>action@4.1.3\r\n        <span class=\"token key atrule\">with</span><span class=\"token punctuation\">:</span>\r\n          <span class=\"token key atrule\">token</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> secrets.ACCESS_TOKEN <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\r\n          <span class=\"token key atrule\">repository-name</span><span class=\"token punctuation\">:</span> blopa/pablo.gg\r\n          <span class=\"token key atrule\">branch</span><span class=\"token punctuation\">:</span> gh<span class=\"token punctuation\">-</span>pages\r\n          <span class=\"token key atrule\">folder</span><span class=\"token punctuation\">:</span> public\r\n          <span class=\"token key atrule\">clean</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">true</span>\r\n          <span class=\"token key atrule\">single-commit</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">true</span></code></pre></div>\n<p>Pronto! Agora, sempre que eu atualizar o branch <code class=\"language-text\">main</code> no meu reposit√≥rio, ele far√° o deploy do meu blog nos meus reposit√≥rios <a href=\"https://github.com/blopa/pablo.gg\" target=\"_blank\" rel=\"noreferrer\">github.com/blopa/pablo.gg</a> e <a href=\"https://github.com/blopa/blopa.github.io\" target=\"_blank\" rel=\"noreferrer\">github.com/blopa/blopa.github.io</a> no branch <code class=\"language-text\">gh-pages</code>.</p>","fields":{"postHashId":"Y29kaW5ndHJ1ZW51bGwyMDIxLTA1LTE1VDAwOjAwOjAwLjAwMFo=","slug":"/2021/2021-05-15-usando-o-github-actions-para-fazer-o-deploy-do-meu-blog-em-dois-dominios-diferentes.pt-br/","path":"/blog/coding/usando-o-github-actions-para-fazer-o-deploy-do-meu-blog-em-dois-dominios-diferentes/","locale":"pt-br"},"rawMarkdownBody":"Hoje eu decidi fazer o deploy do meu blog no meu endere√ßo do GitHub Pages, [blopa.github.io](https://blopa.github.io/), al√©m do meu deploy normal no [pablo.gg](https://pablo.gg/), mas como fazer isso?\r\n\r\nPrimeiro eu criei um reposit√≥rio chamado `username.github.io`, onde `username` √© o seu nome de usu√°rio GitHub:\r\n\r\n![Imagem do site do GitHub Pages](../../uploads/blog/2021/05/username-github-io.jpg)\r\n\r\nAgora, no reposit√≥rio onde est√£o os meus arquivos fonte, eu preciso adicionar um novo arquivo do GitHub Actions, vamos cham√°-lo de `deploy-to-github.io.yml`:\r\n\r\n```yaml\r\nname: deploy-to-github.io.yml\r\non:\r\n  workflow_dispatch:\r\n  push:\r\n    branches:\r\n      - main\r\n\r\njobs:\r\n  build-and-deploy:\r\n    runs-on: ubuntu-latest\r\n    steps:\r\n      - name: Checkout\r\n        uses: actions/checkout@v2.3.4\r\n        with:\r\n          persist-credentials: false\r\n\r\n      - name: Install and Build üöß\r\n        run: |\r\n          npm cache clean --force\r\n          npm install\r\n          npm run clean\r\n          npm run build\r\n          rm -rf CNAME\r\n\r\n      - name: Deploy üöÄ\r\n        uses: JamesIves/github-pages-deploy-action@4.1.3\r\n        with:\r\n          token: ${{ secrets.ACCESS_TOKEN }}\r\n          repository-name: blopa/blopa.github.io\r\n          branch: gh-pages\r\n          folder: public\r\n          clean: true\r\n          single-commit: true\r\n```\r\n\r\nIsso ir√° buildar e fazer o deploy do meu c√≥digo em outro reposit√≥rio do GitHub chamado `blopa/pablo.gg`. Para que isso funcione, eu preciso [criar um token de acesso pessoal](https://docs.github.com/pt/github/authenticating-to-github/creating-a-personal-access-token) e ent√£o [adicion√°-lo nos secrets do reposit√≥rio](https://docs.github.com/pt/actions/reference/encrypted-secrets) com o nome `ACCESS_TOKEN`.\r\n\r\nComo eu tamb√©m fa√ßo o deploy normal do meu blog em outro reposit√≥rio, este √© meu arquivo do GitHub Actions para isso:\r\n\r\n```yaml\r\nname: deploy-to-gg.yml\r\non:\r\n  workflow_dispatch:\r\n  push:\r\n    branches:\r\n      - main\r\n\r\njobs:\r\n  build-and-deploy:\r\n    runs-on: ubuntu-latest\r\n    steps:\r\n      - name: Checkout\r\n        uses: actions/checkout@v2.3.4\r\n        with:\r\n          persist-credentials: false\r\n\r\n      - name: Install and Build üöß\r\n        run: |\r\n          npm cache clean --force\r\n          npm install\r\n          npm run clean\r\n          npm run build\r\n\r\n      - name: Deploy üöÄ\r\n        uses: JamesIves/github-pages-deploy-action@4.1.3\r\n        with:\r\n          token: ${{ secrets.ACCESS_TOKEN }}\r\n          repository-name: blopa/pablo.gg\r\n          branch: gh-pages\r\n          folder: public\r\n          clean: true\r\n          single-commit: true\r\n```\r\n\r\nPronto! Agora, sempre que eu atualizar o branch `main` no meu reposit√≥rio, ele far√° o deploy do meu blog nos meus reposit√≥rios [github.com/blopa/pablo.gg](https://github.com/blopa/pablo.gg) e [github.com/blopa/blopa.github.io](https://github.com/blopa/blopa.github.io) no branch `gh-pages`.\r\n","frontmatter":{"tags":["github actions","gatsby","javascript","deploy","reactjs"],"categories":["coding"],"allowComments":true,"publishOnMedium":false,"cover":null,"date":"2021-05-15T00:00:00.000Z","id":null,"path":"usando-o-github-actions-para-fazer-o-deploy-do-meu-blog-em-dois-dominios-diferentes","show":true,"title":"Usando o GitHub Actions para fazer o deploy do meu blog em dom√≠nios diferentes","hideExcerpt":false,"subtitle":""}}},{"node":{"excerpt":"Today I decided to deploy my blog to my GitHub Pages address‚Ä¶","html":"<p>Today I decided to deploy my blog to my GitHub Pages address, <a href=\"https://blopa.github.io/\" target=\"_blank\" rel=\"noreferrer\">blopa.github.io</a>, in addition to my normal <a href=\"https://pablo.gg/\" target=\"_blank\" rel=\"noreferrer\">pablo.gg</a> deploy, but how can I do that?</p>\n<p>First I created a repo called <code class=\"language-text\">username.github.io</code>, where <code class=\"language-text\">username</code> is your GitHub username:</p>\n<p><figure class=\"gatsby-resp-image-figure\" style=\"\">\n    <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 872px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 75.390625%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAPABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAIF/8QAFAEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEAMQAAAB3KmwD//EABUQAQEAAAAAAAAAAAAAAAAAABBB/9oACAEBAAEFAmn/xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAUEAEAAAAAAAAAAAAAAAAAAAAg/9oACAEBAAY/Al//xAAZEAACAwEAAAAAAAAAAAAAAAABEQAQIUH/2gAIAQEAAT8hW8m02Yv/2gAMAwEAAgADAAAAEMPP/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPxA//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPxA//8QAGxABAAICAwAAAAAAAAAAAAAAARExABAhQZH/2gAIAQEAAT8QUqCU24IsPdEBETviMBC9f//Z'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Photo from the GitHu Pages website\"\n        title=\"Photo from the GitHu Pages website\"\n        src=\"/static/d564a27692cc9b7425ac9fd8bdbcf339/ffc01/username-github-io.jpg\"\n        srcset=\"/static/d564a27692cc9b7425ac9fd8bdbcf339/db830/username-github-io.jpg 256w,\n/static/d564a27692cc9b7425ac9fd8bdbcf339/8102f/username-github-io.jpg 512w,\n/static/d564a27692cc9b7425ac9fd8bdbcf339/ffc01/username-github-io.jpg 872w\"\n        sizes=\"(max-width: 872px) 100vw, 872px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\">Photo from the GitHu Pages website</figcaption>\n  </figure></p>\n<p>Now on the repo where my source files are I need to add a new GitHub Actions file, let‚Äôs call it <code class=\"language-text\">deploy-to-github.io.yml</code>:</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> deploy<span class=\"token punctuation\">-</span>to<span class=\"token punctuation\">-</span>github.io.yml\r\n<span class=\"token key atrule\">on</span><span class=\"token punctuation\">:</span>\r\n  <span class=\"token key atrule\">workflow_dispatch</span><span class=\"token punctuation\">:</span>\r\n  <span class=\"token key atrule\">push</span><span class=\"token punctuation\">:</span>\r\n    <span class=\"token key atrule\">branches</span><span class=\"token punctuation\">:</span>\r\n      <span class=\"token punctuation\">-</span> main\r\n\r\n<span class=\"token key atrule\">jobs</span><span class=\"token punctuation\">:</span>\r\n  <span class=\"token key atrule\">build-and-deploy</span><span class=\"token punctuation\">:</span>\r\n    <span class=\"token key atrule\">runs-on</span><span class=\"token punctuation\">:</span> ubuntu<span class=\"token punctuation\">-</span>latest\r\n    <span class=\"token key atrule\">steps</span><span class=\"token punctuation\">:</span>\r\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Checkout\r\n        <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> actions/checkout@v2.3.4\r\n        <span class=\"token key atrule\">with</span><span class=\"token punctuation\">:</span>\r\n          <span class=\"token key atrule\">persist-credentials</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">false</span>\r\n\r\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Install and Build üöß\r\n        <span class=\"token key atrule\">run</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">|</span><span class=\"token scalar string\">\r\n          npm cache clean --force\r\n          npm install\r\n          npm run clean\r\n          npm run build\r\n          rm -rf CNAME</span>\r\n\r\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Deploy üöÄ\r\n        <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> JamesIves/github<span class=\"token punctuation\">-</span>pages<span class=\"token punctuation\">-</span>deploy<span class=\"token punctuation\">-</span>action@4.1.3\r\n        <span class=\"token key atrule\">with</span><span class=\"token punctuation\">:</span>\r\n          <span class=\"token key atrule\">token</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> secrets.ACCESS_TOKEN <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\r\n          <span class=\"token key atrule\">repository-name</span><span class=\"token punctuation\">:</span> blopa/blopa.github.io\r\n          <span class=\"token key atrule\">branch</span><span class=\"token punctuation\">:</span> gh<span class=\"token punctuation\">-</span>pages\r\n          <span class=\"token key atrule\">folder</span><span class=\"token punctuation\">:</span> public\r\n          <span class=\"token key atrule\">clean</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">true</span>\r\n          <span class=\"token key atrule\">single-commit</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">true</span></code></pre></div>\n<p>This will build and deploy my code into another GitHub repo called <code class=\"language-text\">blopa/pablo.gg</code>. For this to work I needed to <a href=\"https://docs.github.com/en/github/authenticating-to-github/creating-a-personal-access-token\" target=\"_blank\" rel=\"noreferrer\">create a personal access token</a> and then <a href=\"https://docs.github.com/en/actions/reference/encrypted-secrets\" target=\"_blank\" rel=\"noreferrer\">add it to my repo secrets</a> as <code class=\"language-text\">ACCESS_TOKEN</code>.</p>\n<p>Since I also deploy my regular build to another GitHub repo, this is my GitHub Action file for that:</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> deploy<span class=\"token punctuation\">-</span>to<span class=\"token punctuation\">-</span>gg.yml\r\n<span class=\"token key atrule\">on</span><span class=\"token punctuation\">:</span>\r\n  <span class=\"token key atrule\">workflow_dispatch</span><span class=\"token punctuation\">:</span>\r\n  <span class=\"token key atrule\">push</span><span class=\"token punctuation\">:</span>\r\n    <span class=\"token key atrule\">branches</span><span class=\"token punctuation\">:</span>\r\n      <span class=\"token punctuation\">-</span> main\r\n\r\n<span class=\"token key atrule\">jobs</span><span class=\"token punctuation\">:</span>\r\n  <span class=\"token key atrule\">build-and-deploy</span><span class=\"token punctuation\">:</span>\r\n    <span class=\"token key atrule\">runs-on</span><span class=\"token punctuation\">:</span> ubuntu<span class=\"token punctuation\">-</span>latest\r\n    <span class=\"token key atrule\">steps</span><span class=\"token punctuation\">:</span>\r\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Checkout\r\n        <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> actions/checkout@v2.3.4\r\n        <span class=\"token key atrule\">with</span><span class=\"token punctuation\">:</span>\r\n          <span class=\"token key atrule\">persist-credentials</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">false</span>\r\n\r\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Install and Build üöß\r\n        <span class=\"token key atrule\">run</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">|</span><span class=\"token scalar string\">\r\n          npm cache clean --force\r\n          npm install\r\n          npm run clean\r\n          npm run build</span>\r\n\r\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Deploy üöÄ\r\n        <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> JamesIves/github<span class=\"token punctuation\">-</span>pages<span class=\"token punctuation\">-</span>deploy<span class=\"token punctuation\">-</span>action@4.1.3\r\n        <span class=\"token key atrule\">with</span><span class=\"token punctuation\">:</span>\r\n          <span class=\"token key atrule\">token</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> secrets.ACCESS_TOKEN <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\r\n          <span class=\"token key atrule\">repository-name</span><span class=\"token punctuation\">:</span> blopa/pablo.gg\r\n          <span class=\"token key atrule\">branch</span><span class=\"token punctuation\">:</span> gh<span class=\"token punctuation\">-</span>pages\r\n          <span class=\"token key atrule\">folder</span><span class=\"token punctuation\">:</span> public\r\n          <span class=\"token key atrule\">clean</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">true</span>\r\n          <span class=\"token key atrule\">single-commit</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">true</span></code></pre></div>\n<p>That‚Äôs it! Now whenever I push to the <code class=\"language-text\">main</code> branch in my source repo, it will deploy my website to <a href=\"https://github.com/blopa/pablo.gg\" target=\"_blank\" rel=\"noreferrer\">github.com/blopa/pablo.gg</a> and <a href=\"https://github.com/blopa/blopa.github.io\" target=\"_blank\" rel=\"noreferrer\">github.com/blopa/blopa.github.io</a> in the <code class=\"language-text\">gh-pages</code> branch.</p>","fields":{"postHashId":"Y29kaW5ndHJ1ZW51bGwyMDIxLTA1LTE1VDAwOjAwOjAwLjAwMFo=","slug":"/2021/2021-05-15-using-github-actions-to-deploy-my-blog-into-different-domains.en/","path":"/blog/coding/using-github-actions-to-deploy-my-blog-into-different-domains/","locale":"en"},"rawMarkdownBody":"Today I decided to deploy my blog to my GitHub Pages address, [blopa.github.io](https://blopa.github.io/), in addition to my normal [pablo.gg](https://pablo.gg/) deploy, but how can I do that?\r\n\r\nFirst I created a repo called `username.github.io`, where `username` is your GitHub username:\r\n\r\n![Photo from the GitHu Pages website](../../uploads/blog/2021/05/username-github-io.jpg)\r\n\r\nNow on the repo where my source files are I need to add a new GitHub Actions file, let's call it `deploy-to-github.io.yml`:\r\n\r\n```yaml\r\nname: deploy-to-github.io.yml\r\non:\r\n  workflow_dispatch:\r\n  push:\r\n    branches:\r\n      - main\r\n\r\njobs:\r\n  build-and-deploy:\r\n    runs-on: ubuntu-latest\r\n    steps:\r\n      - name: Checkout\r\n        uses: actions/checkout@v2.3.4\r\n        with:\r\n          persist-credentials: false\r\n\r\n      - name: Install and Build üöß\r\n        run: |\r\n          npm cache clean --force\r\n          npm install\r\n          npm run clean\r\n          npm run build\r\n          rm -rf CNAME\r\n\r\n      - name: Deploy üöÄ\r\n        uses: JamesIves/github-pages-deploy-action@4.1.3\r\n        with:\r\n          token: ${{ secrets.ACCESS_TOKEN }}\r\n          repository-name: blopa/blopa.github.io\r\n          branch: gh-pages\r\n          folder: public\r\n          clean: true\r\n          single-commit: true\r\n```\r\n\r\nThis will build and deploy my code into another GitHub repo called `blopa/pablo.gg`. For this to work I needed to [create a personal access token](https://docs.github.com/en/github/authenticating-to-github/creating-a-personal-access-token) and then [add it to my repo secrets](https://docs.github.com/en/actions/reference/encrypted-secrets) as `ACCESS_TOKEN`.\r\n\r\nSince I also deploy my regular build to another GitHub repo, this is my GitHub Action file for that:\r\n\r\n```yaml\r\nname: deploy-to-gg.yml\r\non:\r\n  workflow_dispatch:\r\n  push:\r\n    branches:\r\n      - main\r\n\r\njobs:\r\n  build-and-deploy:\r\n    runs-on: ubuntu-latest\r\n    steps:\r\n      - name: Checkout\r\n        uses: actions/checkout@v2.3.4\r\n        with:\r\n          persist-credentials: false\r\n\r\n      - name: Install and Build üöß\r\n        run: |\r\n          npm cache clean --force\r\n          npm install\r\n          npm run clean\r\n          npm run build\r\n\r\n      - name: Deploy üöÄ\r\n        uses: JamesIves/github-pages-deploy-action@4.1.3\r\n        with:\r\n          token: ${{ secrets.ACCESS_TOKEN }}\r\n          repository-name: blopa/pablo.gg\r\n          branch: gh-pages\r\n          folder: public\r\n          clean: true\r\n          single-commit: true\r\n```\r\n\r\nThat's it! Now whenever I push to the `main` branch in my source repo, it will deploy my website to [github.com/blopa/pablo.gg](https://github.com/blopa/pablo.gg) and [github.com/blopa/blopa.github.io](https://github.com/blopa/blopa.github.io) in the `gh-pages` branch.\r\n","frontmatter":{"tags":["github actions","gatsby","javascript","deploy","reactjs"],"categories":["coding"],"allowComments":true,"publishOnMedium":false,"cover":null,"date":"2021-05-15T00:00:00.000Z","id":null,"path":"using-github-actions-to-deploy-my-blog-into-different-domains","show":true,"title":"Using GitHub Actions to deploy my blog into different domains","hideExcerpt":false,"subtitle":""}}},{"node":{"excerpt":"Hoje eu precisei saber a infla√ß√£o acumulada dos √∫ltimos 1‚Ä¶","html":"<p>Hoje eu precisei saber a infla√ß√£o acumulada dos √∫ltimos 12 meses para um c√°lculo em um projeto que eu estou trabalhando, informa√ß√£o que pode ser facilmente acessada no <a href=\"https://www.ibge.gov.br/explica/inflacao.php\" target=\"_blank\" rel=\"noreferrer\">site do IBGE</a>, porem eu precisava desses dados em <code class=\"language-text\">JSON</code> ou pelo menos <code class=\"language-text\">XML</code>.</p>\n<p><figure class=\"gatsby-resp-image-figure\" style=\"\">\n    <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 635px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 45.70312499999999%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAJABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAQCA//EABYBAQEBAAAAAAAAAAAAAAAAAAABAv/aAAwDAQACEAMQAAABt13XE6gf/8QAGRAAAQUAAAAAAAAAAAAAAAAAIwADERIg/9oACAEBAAEFAizZ5Fx//8QAFREBAQAAAAAAAAAAAAAAAAAAABL/2gAIAQMBAT8BlL//xAAVEQEBAAAAAAAAAAAAAAAAAAAAEf/aAAgBAgEBPwGq/8QAGBAAAwEBAAAAAAAAAAAAAAAAAAIxESD/2gAIAQEABj8Cq6VSrx//xAAbEAABBQEBAAAAAAAAAAAAAAARAAEhMWEggf/aAAgBAQABPyFhNvEiVFinNucf/9oADAMBAAIAAwAAABAM/wD/xAAZEQACAwEAAAAAAAAAAAAAAAAAARFRcZH/2gAIAQMBAT8Q0+kLZ//EABYRAQEBAAAAAAAAAAAAAAAAAABxAf/aAAgBAgEBPxCU4//EABsQAAICAwEAAAAAAAAAAAAAAAERACEQMUHh/9oACAEBAAE/EARhdvCAaGz8QGv2NrwMf//Z'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Infla√ß√£o\"\n        title=\"Infla√ß√£o\"\n        src=\"/static/e3e2aaf1472fe90ed2248507cb20f4fa/22ee5/inflation-pt-br.jpg\"\n        srcset=\"/static/e3e2aaf1472fe90ed2248507cb20f4fa/db830/inflation-pt-br.jpg 256w,\n/static/e3e2aaf1472fe90ed2248507cb20f4fa/8102f/inflation-pt-br.jpg 512w,\n/static/e3e2aaf1472fe90ed2248507cb20f4fa/22ee5/inflation-pt-br.jpg 635w\"\n        sizes=\"(max-width: 635px) 100vw, 635px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\">Infla√ß√£o</figcaption>\n  </figure></p>\n<p>Por incr√≠vel que pare√ßa, apenas pesquisar por ‚Äù<a href=\"https://www.google.com/search?q=API+infla%C3%A7%C3%A3o+acumulada+2021\" target=\"_blank\" rel=\"noreferrer\">API infla√ß√£o acumulada 2021</a>‚Äù n√£o me retornou nenhum resultado √∫til. Eu at√© tentei ‚Äù<a href=\"https://www.google.com/search?q=como+calcular+a+infla%C3%A7%C3%A3o+acumulada+%22javascript%22\" target=\"_blank\" rel=\"noreferrer\">como calcular a infla√ß√£o acumulada ‚Äújavascript‚Äù</a>‚Äù e nada, e √© por isso que eu estou fazendo esse post.</p>\n<p>O Banco Central fornece diversos end-points com dados relacionados √† economia brasileira, porem para uma pessoa que n√£o entende muito do assunto como eu, √© dif√≠cil saber qual √© o endpoint correto para pegar os dados corretos.</p>\n<p>O Banco Central possu√≠ end-points no formato <code class=\"language-text\">https://api.bcb.gov.br/dados/serie/bcdata.sgs.XXX/dados</code>, no qual <code class=\"language-text\">XXX</code> √© o c√≥digo de refer√™ncia dos dados. Primeiro eu encontrei <a href=\"https://api.bcb.gov.br/dados/serie/bcdata.sgs.10844/dados?formato=json\" target=\"_blank\" rel=\"noreferrer\">esse end-point</a>, que parecia ser correto, porem o valor de Abril de 2021 √© <code class=\"language-text\">0.05</code> e no <a href=\"https://www.ibge.gov.br/explica/inflacao.php\" target=\"_blank\" rel=\"noreferrer\">site do IBGE</a> o valor √© <code class=\"language-text\">0.31</code>, ou seja n√£o √© isso que eu preciso.</p>\n<p>Depois de tentar alguns c√≥digos diferentes que eu achei pesquisando no Google, eu encontrei <a href=\"https://api.bcb.gov.br/dados/serie/bcdata.sgs.433/dados?formato=json\" target=\"_blank\" rel=\"noreferrer\">esse end-point</a>, no qual o valor de Abril de 2021 √© <code class=\"language-text\">0.31</code>. Yay!</p>\n<p>√â poss√≠vel filtrar os resultados desse end-point usando <code class=\"language-text\">https://api.bcb.gov.br/dados/serie/bcdata.sgs.433/dados/ultimos/12?formato=json</code>, que me retorna os valores dos √∫ltimos 12 meses.</p>\n<p>Agora podemos usar esses dados para calcular a infla√ß√£o acumulada dos √∫ltimos 12 meses:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">fetchBacenData</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">const</span> url <span class=\"token operator\">=</span> <span class=\"token string\">'https://api.bcb.gov.br/dados/serie/bcdata.sgs.433/dados/ultimos/12?formato=json'</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">const</span> result <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">fetch</span><span class=\"token punctuation\">(</span>url<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token literal-property property\">method</span><span class=\"token operator\">:</span> <span class=\"token string\">'GET'</span><span class=\"token punctuation\">,</span>\r\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">response</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token keyword\">await</span> response<span class=\"token punctuation\">.</span><span class=\"token function\">text</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n    <span class=\"token keyword\">return</span> <span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">parse</span><span class=\"token punctuation\">(</span>result<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token keyword\">const</span> data <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">fetchBacenData</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Para calcular a infla√ß√£o acumulada usamos a seguinte f√≥rmula: <code class=\"language-text\">infla√ß√£o acumulada = ((1 + infla√ß√£o mensal anterior) * (1 + infla√ß√£o mensal atual)) - 1</code> (formulada fornecida pelo meu grande amigo matem√°tico sinistro Leandro). E como acumulamos dados usando JavaScript? Usando <code class=\"language-text\">reduce</code>:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> inflation <span class=\"token operator\">=</span>\r\n    data<span class=\"token punctuation\">.</span><span class=\"token function\">reduce</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">acc<span class=\"token punctuation\">,</span> curr</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span> <span class=\"token operator\">+</span> <span class=\"token function\">parseFloat</span><span class=\"token punctuation\">(</span>acc<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1</span> <span class=\"token operator\">+</span> <span class=\"token function\">parseFloat</span><span class=\"token punctuation\">(</span>curr<span class=\"token punctuation\">.</span>valor<span class=\"token punctuation\">)</span> <span class=\"token operator\">/</span> <span class=\"token number\">100</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Isso nos resultar√° em <code class=\"language-text\">0,06759188526903293</code>, que arredondando chegaremos ao valor de 6,76%, exatamente como est√° no site do IBGE. GG!</p>\n<p>Espero que a pr√≥xima pessoa que pesquisar no Google por ‚ÄúAPI infla√ß√£o acumulada 2021‚Äù encontre esse post üòä</p>\n<p>Isso √© tudo por hoje, at√© a pr√≥xima!</p>","fields":{"postHashId":"Y29kaW5ndHJ1ZW51bGwyMDIxLTA1LTEzVDAwOjAwOjAwLjAwMFo=","slug":"/2021/2021-05-13-como-calcular-a-inflacao-acumulada-dos-ultimos-12-meses-com-javascript.pt-br/","path":"/blog/coding/como-calcular-a-inflacao-acumulada-dos-ultimos-12-meses-com-javascript/","locale":"pt-br"},"rawMarkdownBody":"Hoje eu precisei saber a infla√ß√£o acumulada dos √∫ltimos 12 meses para um c√°lculo em um projeto que eu estou trabalhando, informa√ß√£o que pode ser facilmente acessada no [site do IBGE](https://www.ibge.gov.br/explica/inflacao.php), porem eu precisava desses dados em `JSON` ou pelo menos `XML`.\r\n\r\n![Infla√ß√£o](../../uploads/blog/2021/05/inflation-pt-br.jpg)\r\n\r\nPor incr√≠vel que pare√ßa, apenas pesquisar por \"[API infla√ß√£o acumulada 2021](https://www.google.com/search?q=API+infla%C3%A7%C3%A3o+acumulada+2021)\" n√£o me retornou nenhum resultado √∫til. Eu at√© tentei \"[como calcular a infla√ß√£o acumulada \"javascript\"](https://www.google.com/search?q=como+calcular+a+infla%C3%A7%C3%A3o+acumulada+%22javascript%22)\" e nada, e √© por isso que eu estou fazendo esse post.\r\n\r\nO Banco Central fornece diversos end-points com dados relacionados √† economia brasileira, porem para uma pessoa que n√£o entende muito do assunto como eu, √© dif√≠cil saber qual √© o endpoint correto para pegar os dados corretos.\r\n\r\nO Banco Central possu√≠ end-points no formato `https://api.bcb.gov.br/dados/serie/bcdata.sgs.XXX/dados`, no qual `XXX` √© o c√≥digo de refer√™ncia dos dados. Primeiro eu encontrei [esse end-point](https://api.bcb.gov.br/dados/serie/bcdata.sgs.10844/dados?formato=json), que parecia ser correto, porem o valor de Abril de 2021 √© `0.05` e no [site do IBGE](https://www.ibge.gov.br/explica/inflacao.php) o valor √© `0.31`, ou seja n√£o √© isso que eu preciso.\r\n\r\nDepois de tentar alguns c√≥digos diferentes que eu achei pesquisando no Google, eu encontrei [esse end-point](https://api.bcb.gov.br/dados/serie/bcdata.sgs.433/dados?formato=json), no qual o valor de Abril de 2021 √© `0.31`. Yay!\r\n\r\n√â poss√≠vel filtrar os resultados desse end-point usando `https://api.bcb.gov.br/dados/serie/bcdata.sgs.433/dados/ultimos/12?formato=json`, que me retorna os valores dos √∫ltimos 12 meses.\r\n\r\nAgora podemos usar esses dados para calcular a infla√ß√£o acumulada dos √∫ltimos 12 meses:\r\n\r\n```javascript\r\nconst fetchBacenData = async () => {\r\n    const url = 'https://api.bcb.gov.br/dados/serie/bcdata.sgs.433/dados/ultimos/12?formato=json';\r\n    const result = await fetch(url, {\r\n        method: 'GET',\r\n    }).then(async (response) => await response.text());\r\n\r\n    return JSON.parse(result);\r\n};\r\n\r\nconst data = await fetchBacenData();\r\n```\r\n\r\nPara calcular a infla√ß√£o acumulada usamos a seguinte f√≥rmula: `infla√ß√£o acumulada = ((1 + infla√ß√£o mensal anterior) * (1 + infla√ß√£o mensal atual)) - 1` (formulada fornecida pelo meu grande amigo matem√°tico sinistro Leandro). E como acumulamos dados usando JavaScript? Usando `reduce`:\r\n\r\n```javascript\r\nconst inflation =\r\n    data.reduce((acc, curr) => ((1 + parseFloat(acc)) * (1 + parseFloat(curr.valor) / 100)) - 1, 0);\r\n```\r\n\r\nIsso nos resultar√° em `0,06759188526903293`, que arredondando chegaremos ao valor de 6,76%, exatamente como est√° no site do IBGE. GG!\r\n\r\nEspero que a pr√≥xima pessoa que pesquisar no Google por \"API infla√ß√£o acumulada 2021\" encontre esse post üòä\r\n\r\nIsso √© tudo por hoje, at√© a pr√≥xima!\r\n","frontmatter":{"tags":["json","banco central","brasil","infla√ß√£o","reduce","infla√ß√£o acumulada","javascript","infla√ß√£o anual"],"categories":["coding"],"allowComments":true,"publishOnMedium":false,"cover":null,"date":"2021-05-13T00:00:00.000Z","id":null,"path":"como-calcular-a-inflacao-acumulada-dos-ultimos-12-meses-com-javascript","show":true,"title":"Como calcular a infla√ß√£o acumulada dos √∫ltimos 12 meses com JavaScript","hideExcerpt":false,"subtitle":""}}},{"node":{"excerpt":"Today I needed to know the accumulated inflation of the last‚Ä¶","html":"<p>Today I needed to know the accumulated inflation of the last year for Brazil for a project I am working on, information that can be easily accessed on the <a href=\"https://www.ibge.gov.br/explica/inflacao.php\" target=\"_blank\" rel=\"noreferrer\">IBGE website</a>, however, I needed this data in <code class=\"language-text\">JSON</code> or at least <code class=\"language-text\">XML</code> format.</p>\n<p><figure class=\"gatsby-resp-image-figure\" style=\"\">\n    <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 635px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 45.70312499999999%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAJABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAQCA//EABYBAQEBAAAAAAAAAAAAAAAAAAABAv/aAAwDAQACEAMQAAABt13XE6gf/8QAGRAAAQUAAAAAAAAAAAAAAAAAIwADERIg/9oACAEBAAEFAizZ5Fx//8QAFREBAQAAAAAAAAAAAAAAAAAAABL/2gAIAQMBAT8BlL//xAAVEQEBAAAAAAAAAAAAAAAAAAAAEf/aAAgBAgEBPwGq/8QAGBAAAwEBAAAAAAAAAAAAAAAAAAIxESD/2gAIAQEABj8Cq6VSrx//xAAaEAABBQEAAAAAAAAAAAAAAAAhABEgMWGR/9oACAEBAAE/IRfxJyhYjNuQ/9oADAMBAAIAAwAAABAMP//EABkRAAIDAQAAAAAAAAAAAAAAAAABEVFxkf/aAAgBAwEBPxDT6Qtn/8QAFhEBAQEAAAAAAAAAAAAAAAAAAHEB/9oACAECAQE/EJTj/8QAGxAAAgIDAQAAAAAAAAAAAAAAAREAIRAxQcH/2gAIAQEAAT8QFHR28IBobNvIC8exteBj/9k='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Inflation\"\n        title=\"Inflation\"\n        src=\"/static/5ce7f9eb74f084154a6a87817127ccc8/22ee5/inflation-en.jpg\"\n        srcset=\"/static/5ce7f9eb74f084154a6a87817127ccc8/db830/inflation-en.jpg 256w,\n/static/5ce7f9eb74f084154a6a87817127ccc8/8102f/inflation-en.jpg 512w,\n/static/5ce7f9eb74f084154a6a87817127ccc8/22ee5/inflation-en.jpg 635w\"\n        sizes=\"(max-width: 635px) 100vw, 635px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\">Inflation</figcaption>\n  </figure></p>\n<p>Incredibly, just searching for ‚Äù<a href=\"https://www.google.com/search?q=API+accumulated+inflation+2021+brazil\" target=\"_blank\" rel=\"noreferrer\">API accumulated inflation 2021 brazil</a>‚Äù did not return any useful results. I even tried ‚Äù<a href=\"https://www.google.com/search?q=how+to+calculate+the+accumulated+inflation+%22javascript%22\" target=\"_blank\" rel=\"noreferrer\">how to calculate the accumulated inflation ‚Äújavascript‚Äù</a>‚Äù and nothing, which is why I‚Äôm writing this post.</p>\n<p>The Central Bank of Brazil provides several end-points with data related to the Brazilian economy, but for a person who does not understand economics like myself, it is difficult to know which is the correct endpoint to get the correct data.</p>\n<p>The Central Bank of Brazil has end-points in the format <code class=\"language-text\">https://api.bcb.gov.br/dados/serie/bcdata.sgs.XXX/dados</code>, in which <code class=\"language-text\">XXX</code> is the data reference code. First I found <a href=\"https://api.bcb.gov.br/dados/serie/bcdata.sgs.10844/dados?formato=json\" target=\"_blank\" rel=\"noreferrer\">this end-point</a>, which seemed to be correct, but the value of April 2021 is <code class=\"language-text\">0.05</code> and on the <a href=\"https://www.ibge.gov.br/explica/inflacao.php\" target=\"_blank\" rel=\"noreferrer\">IBGE website</a> the value is <code class=\"language-text\">0.31</code>, which is not what I need.</p>\n<p>After trying a few different codes that I found searching on Google, I found <a href=\"https://api.bcb.gov.br/dados/serie/bcdata.sgs.433/dados?formato=json\" target=\"_blank\" rel=\"noreferrer\">this end-point</a>, in which the April 2021 value is <code class=\"language-text\">0.31</code>. Yay!</p>\n<p>It is possible to filter the results of this end-point using <code class=\"language-text\">https://api.bcb.gov.br/dados/serie/bcdata.sgs.433/dados/ultimos/12?formato=json</code>, which returns the values of the last 12 months.</p>\n<p>Now we can use this data to calculate the accumulated inflation for the last year:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">fetchBacenData</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">const</span> url <span class=\"token operator\">=</span> <span class=\"token string\">'https://api.bcb.gov.br/dados/serie/bcdata.sgs.433/dados/ultimos/12?formato=json'</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">const</span> result <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">fetch</span><span class=\"token punctuation\">(</span>url<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token literal-property property\">method</span><span class=\"token operator\">:</span> <span class=\"token string\">'GET'</span><span class=\"token punctuation\">,</span>\r\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">response</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token keyword\">await</span> response<span class=\"token punctuation\">.</span><span class=\"token function\">text</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n    <span class=\"token keyword\">return</span> <span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">parse</span><span class=\"token punctuation\">(</span>result<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token keyword\">const</span> data <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">fetchBacenData</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>To calculate the annual inflation we use the following formula: <code class=\"language-text\">accumulated inflation = ((1 + previous monthly inflation) * (1 + current monthly inflation)) - 1</code> (provided by my great mathematician friend Leandro). And how do we accumulate data using JavaScript? By using <code class=\"language-text\">reduce</code>:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> inflation <span class=\"token operator\">=</span>\r\n    data<span class=\"token punctuation\">.</span><span class=\"token function\">reduce</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">acc<span class=\"token punctuation\">,</span> curr</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span> <span class=\"token operator\">+</span> <span class=\"token function\">parseFloat</span><span class=\"token punctuation\">(</span>acc<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1</span> <span class=\"token operator\">+</span> <span class=\"token function\">parseFloat</span><span class=\"token punctuation\">(</span>curr<span class=\"token punctuation\">.</span>valor<span class=\"token punctuation\">)</span> <span class=\"token operator\">/</span> <span class=\"token number\">100</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>This will give us <code class=\"language-text\">0.06759188526903293</code>, which by rounding we get to the amount of 6,76%, just like it is on the IBGE website. Noice!</p>\n<p>I hope the next person who Googles ‚ÄúAPI accumulated inflation 2021 brazil‚Äù find this post üòä</p>\n<p>That‚Äôs all for today, cheers!</p>","fields":{"postHashId":"Y29kaW5ndHJ1ZW51bGwyMDIxLTA1LTEzVDAwOjAwOjAwLjAwMFo=","slug":"/2021/2021-05-13-how-to-calculate-brazils-annual-inflation-using-javascript.en/","path":"/blog/coding/how-to-calculate-brazils-annual-inflation-using-javascript/","locale":"en"},"rawMarkdownBody":"Today I needed to know the accumulated inflation of the last year for Brazil for a project I am working on, information that can be easily accessed on the [IBGE website](https://www.ibge.gov.br/explica/inflacao.php), however, I needed this data in `JSON` or at least `XML` format.\r\n\r\n![Inflation](../../uploads/blog/2021/05/inflation-en.jpg)\r\n\r\nIncredibly, just searching for \"[API accumulated inflation 2021 brazil](https://www.google.com/search?q=API+accumulated+inflation+2021+brazil)\" did not return any useful results. I even tried \"[how to calculate the accumulated inflation \"javascript\"](https://www.google.com/search?q=how+to+calculate+the+accumulated+inflation+%22javascript%22)\" and nothing, which is why I'm writing this post.\r\n\r\nThe Central Bank of Brazil provides several end-points with data related to the Brazilian economy, but for a person who does not understand economics like myself, it is difficult to know which is the correct endpoint to get the correct data.\r\n\r\nThe Central Bank of Brazil has end-points in the format `https://api.bcb.gov.br/dados/serie/bcdata.sgs.XXX/dados`, in which `XXX` is the data reference code. First I found [this end-point](https://api.bcb.gov.br/dados/serie/bcdata.sgs.10844/dados?formato=json), which seemed to be correct, but the value of April 2021 is `0.05` and on the [IBGE website](https://www.ibge.gov.br/explica/inflacao.php) the value is `0.31`, which is not what I need.\r\n\r\nAfter trying a few different codes that I found searching on Google, I found [this end-point](https://api.bcb.gov.br/dados/serie/bcdata.sgs.433/dados?formato=json), in which the April 2021 value is `0.31`. Yay!\r\n\r\nIt is possible to filter the results of this end-point using `https://api.bcb.gov.br/dados/serie/bcdata.sgs.433/dados/ultimos/12?formato=json`, which returns the values of the last 12 months.\r\n\r\nNow we can use this data to calculate the accumulated inflation for the last year:\r\n\r\n```javascript\r\nconst fetchBacenData = async () => {\r\n    const url = 'https://api.bcb.gov.br/dados/serie/bcdata.sgs.433/dados/ultimos/12?formato=json';\r\n    const result = await fetch(url, {\r\n        method: 'GET',\r\n    }).then(async (response) => await response.text());\r\n\r\n    return JSON.parse(result);\r\n};\r\n\r\nconst data = await fetchBacenData();\r\n```\r\n\r\nTo calculate the annual inflation we use the following formula: `accumulated inflation = ((1 + previous monthly inflation) * (1 + current monthly inflation)) - 1` (provided by my great mathematician friend Leandro). And how do we accumulate data using JavaScript? By using `reduce`:\r\n\r\n```javascript\r\nconst inflation =\r\n    data.reduce((acc, curr) => ((1 + parseFloat(acc)) * (1 + parseFloat(curr.valor) / 100)) - 1, 0);\r\n```\r\n\r\nThis will give us `0.06759188526903293`, which by rounding we get to the amount of 6,76%, just like it is on the IBGE website. Noice!\r\n\r\nI hope the next person who Googles \"API accumulated inflation 2021 brazil\" find this post üòä\r\n\r\nThat's all for today, cheers!\r\n","frontmatter":{"tags":["json","central bank","brazil","inflation","reduce","accumulated inflation","javascript","annual inflation"],"categories":["coding"],"allowComments":true,"publishOnMedium":false,"cover":null,"date":"2021-05-13T00:00:00.000Z","id":null,"path":"how-to-calculate-brazils-annual-inflation-using-javascript","show":true,"title":"How to calculate the annual inflation in Brazil using JavaScript","hideExcerpt":false,"subtitle":""}}},{"node":{"excerpt":"Essa semana eu estava trabalhando no meu projeto Resume‚Ä¶","html":"<p>Essa semana eu estava trabalhando no meu projeto <a href=\"https://github.com/blopa/Resume-Builder\" target=\"_blank\" rel=\"noreferrer\">Resume Builder</a> e eu queria poder criar um bot√£o que fizesse o download de um JSON sem usar JavaScript.</p>\n<p>A √∫nica maneira que eu sabia fazer isso era usando <code class=\"language-text\">URL.createObjectURL</code> em um arquivo <code class=\"language-text\">blob</code>, mas isso n√£o funcionaria para mim, porque este link estaria dentro de um arquivo PDF.</p>\n<p>Ent√£o eu fiz a primeira coisa que qualquer millennial faria, pesquisei no Stack Overflow, mas n√£o consegui encontrar nada‚Ä¶ como isso √© poss√≠vel? Bom, de qualquer maneira, depois de algumas tentativas, consegui fazer o que eu queria usando Base 64.</p>\n<p>Digamos que eu queira criar um bot√£o de download que baixar√° JSON <code class=\"language-text\">{foo: 'bar'}</code>, primeiro precisamos convert√™-lo para uma string em Base 64, podemos fazer isso com a fun√ß√£o <code class=\"language-text\">btoa</code> do JavaScript:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> json <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">foo</span><span class=\"token operator\">:</span> <span class=\"token string\">'bar'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">const</span> jsonString <span class=\"token operator\">=</span> <span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">stringify</span><span class=\"token punctuation\">(</span>json<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">const</span> base64Json <span class=\"token operator\">=</span> <span class=\"token function\">btoa</span><span class=\"token punctuation\">(</span>jsonString<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// eyJmb28iOiJiYXIifQ==</span></code></pre></div>\n<p>Ok, agora que sei qual √© o valor Base 64 para o objeto <code class=\"language-text\">{foo: 'bar'}</code>, posso criar um elemento <code class=\"language-text\">anchor</code> da seguinte maneira:</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>a</span> <span class=\"token attr-name\">href</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>data:application/json;base64,eyJmb28iOiJiYXIifQ==<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">download</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>object.json<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>download<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>a</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>E isso √© tudo. No meu caso, eu s√≥ precisava que o c√≥digo fosse servido como HTML e, como estou usando Gatsby, o c√≥digo real que eu fiz foi um elemento React que ser√° pre-renderizado usando SSR para o meu arquivo PDF:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> DownloadJsonLink <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\r\n    children<span class=\"token punctuation\">,</span>\r\n    json <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\r\n    name <span class=\"token operator\">=</span> <span class=\"token string\">'object.json'</span><span class=\"token punctuation\">,</span>\r\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">const</span> href <span class=\"token operator\">=</span> <span class=\"token function\">useMemo</span><span class=\"token punctuation\">(</span>\r\n        <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">typeof</span> window <span class=\"token operator\">!==</span> <span class=\"token string\">'undefined'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n                <span class=\"token keyword\">const</span> base64Data <span class=\"token operator\">=</span> <span class=\"token function\">btoa</span><span class=\"token punctuation\">(</span><span class=\"token function\">unescape</span><span class=\"token punctuation\">(</span><span class=\"token function\">encodeURIComponent</span><span class=\"token punctuation\">(</span><span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">stringify</span><span class=\"token punctuation\">(</span>json<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                <span class=\"token keyword\">return</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">data:application/json;base64,</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>base64Data<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span>\r\n            <span class=\"token punctuation\">}</span>\r\n\r\n            <span class=\"token keyword\">return</span> <span class=\"token string\">'#'</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\r\n        <span class=\"token punctuation\">[</span>json<span class=\"token punctuation\">]</span>\r\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\r\n        <span class=\"token operator\">&lt;</span>a\r\n            href<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>href<span class=\"token punctuation\">}</span>\r\n            download<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>name<span class=\"token punctuation\">}</span>\r\n            target<span class=\"token operator\">=</span><span class=\"token string\">\"_blank\"</span>\r\n        <span class=\"token operator\">></span>\r\n            <span class=\"token punctuation\">{</span>children<span class=\"token punctuation\">}</span>\r\n        <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>a<span class=\"token operator\">></span>\r\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> DownloadJsonLink<span class=\"token punctuation\">;</span></code></pre></div>\n<p>Eu sabia que era poss√≠vel fazer isso para baixar uma imagem, mas nunca tinha tentado para outros tipos de arquivos.</p>\n<p>Incr√≠vel ainda aprender coisas de HTML mesmo depois de muitos anos de experi√™ncia e espero que mais algu√©m aprenda algo novo com esse post, at√© a pr√≥xima pessoal.</p>","fields":{"postHashId":"Y29kaW5ndHJ1ZW51bGwyMDIxLTA1LTA5VDAwOjAwOjAwLjAwMFo=","slug":"/2021/2021-05-09-como-criar-um-link-para-download-de-um-json-apenas-com-html.pt-br/","path":"/blog/coding/como-criar-um-link-para-download-de-um-json-apenas-com-html/","locale":"pt-br"},"rawMarkdownBody":"Essa semana eu estava trabalhando no meu projeto [Resume Builder](https://github.com/blopa/Resume-Builder) e eu queria poder criar um bot√£o que fizesse o download de um JSON sem usar JavaScript.\r\n\r\nA √∫nica maneira que eu sabia fazer isso era usando `URL.createObjectURL` em um arquivo `blob`, mas isso n√£o funcionaria para mim, porque este link estaria dentro de um arquivo PDF.\r\n\r\nEnt√£o eu fiz a primeira coisa que qualquer millennial faria, pesquisei no Stack Overflow, mas n√£o consegui encontrar nada... como isso √© poss√≠vel? Bom, de qualquer maneira, depois de algumas tentativas, consegui fazer o que eu queria usando Base 64.\r\n\r\nDigamos que eu queira criar um bot√£o de download que baixar√° JSON `{foo: 'bar'}`, primeiro precisamos convert√™-lo para uma string em Base 64, podemos fazer isso com a fun√ß√£o `btoa` do JavaScript:\r\n\r\n```javascript\r\nconst json = { foo: 'bar' };\r\nconst jsonString = JSON.stringify(json);\r\nconst base64Json = btoa(jsonString); // eyJmb28iOiJiYXIifQ==\r\n```\r\n\r\nOk, agora que sei qual √© o valor Base 64 para o objeto `{foo: 'bar'}`, posso criar um elemento `anchor` da seguinte maneira:\r\n\r\n```html\r\n<a href=\"data:application/json;base64,eyJmb28iOiJiYXIifQ==\" download=\"object.json\">download</a>\r\n```\r\n\r\nE isso √© tudo. No meu caso, eu s√≥ precisava que o c√≥digo fosse servido como HTML e, como estou usando Gatsby, o c√≥digo real que eu fiz foi um elemento React que ser√° pre-renderizado usando SSR para o meu arquivo PDF:\r\n\r\n```javascript\r\nconst DownloadJsonLink = ({\r\n    children,\r\n    json = {},\r\n    name = 'object.json',\r\n}) => {\r\n    const href = useMemo(\r\n        () => {\r\n            if (typeof window !== 'undefined') {\r\n                const base64Data = btoa(unescape(encodeURIComponent(JSON.stringify(json))));\r\n                return `data:application/json;base64,${base64Data}`;\r\n            }\r\n\r\n            return '#';\r\n        },\r\n        [json]\r\n    );\r\n\r\n    return (\r\n        <a\r\n            href={href}\r\n            download={name}\r\n            target=\"_blank\"\r\n        >\r\n            {children}\r\n        </a>\r\n    );\r\n};\r\n\r\nexport default DownloadJsonLink;\r\n```\r\n\r\nEu sabia que era poss√≠vel fazer isso para baixar uma imagem, mas nunca tinha tentado para outros tipos de arquivos.\r\n\r\nIncr√≠vel ainda aprender coisas de HTML mesmo depois de muitos anos de experi√™ncia e espero que mais algu√©m aprenda algo novo com esse post, at√© a pr√≥xima pessoal.\r\n","frontmatter":{"tags":["json","html","download","base64","resume builder"],"categories":["coding"],"allowComments":true,"publishOnMedium":false,"cover":null,"date":"2021-05-09T00:00:00.000Z","id":null,"path":"como-criar-um-link-para-download-de-um-json-apenas-com-html","show":true,"title":"Como criar um link para download de um JSON apenas com HTML","hideExcerpt":false,"subtitle":""}}},{"node":{"excerpt":"This week I was working on my project Resume Builder and I‚Ä¶","html":"<p>This week I was working on my project <a href=\"https://github.com/blopa/Resume-Builder\" target=\"_blank\" rel=\"noreferrer\">Resume Builder</a> and I wanted to be able to create a button that downloads a JSON without using JavaScript.</p>\n<p>The only way I knew how to do that was by using <code class=\"language-text\">URL.createObjectURL</code> in a <code class=\"language-text\">blob</code> file, but that wouldn‚Äôt work for me, because this link would be inside a PDF file.</p>\n<p>Then I did the first thing any millennial would do, I searched on Stack Overflow, but I couldn‚Äôt find anything‚Ä¶ how is that even possible? Well anyway, with some trial and error I was able to do it by using Base 64.</p>\n<p>Let‚Äôs say I want to create a download button that will download a JSON like <code class=\"language-text\">{ foo: 'bar' }</code>, first we need to convert it to a Base 64 string, we can do that with the native <code class=\"language-text\">btoa</code> JavaScript function:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> json <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">foo</span><span class=\"token operator\">:</span> <span class=\"token string\">'bar'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">const</span> jsonString <span class=\"token operator\">=</span> <span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">stringify</span><span class=\"token punctuation\">(</span>json<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">const</span> base64Json <span class=\"token operator\">=</span> <span class=\"token function\">btoa</span><span class=\"token punctuation\">(</span>jsonString<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// eyJmb28iOiJiYXIifQ==</span></code></pre></div>\n<p>Ok now that I know what is the Base 64 value for the <code class=\"language-text\">{ foo: 'bar' }</code> object, I can create an <code class=\"language-text\">anchor</code> element like the following:</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>a</span> <span class=\"token attr-name\">href</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>data:application/json;base64,eyJmb28iOiJiYXIifQ==<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">download</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>object.json<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>download<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>a</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>And that‚Äôs all. In my case, I just needed the code to be served as HTML, and since I‚Äôm using Gatsby, my actual code is a React element that will be SSR for my PDF file:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> DownloadJsonLink <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\r\n    children<span class=\"token punctuation\">,</span>\r\n    json <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\r\n    name <span class=\"token operator\">=</span> <span class=\"token string\">'object.json'</span><span class=\"token punctuation\">,</span>\r\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">const</span> href <span class=\"token operator\">=</span> <span class=\"token function\">useMemo</span><span class=\"token punctuation\">(</span>\r\n        <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">typeof</span> window <span class=\"token operator\">!==</span> <span class=\"token string\">'undefined'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n                <span class=\"token keyword\">const</span> base64Data <span class=\"token operator\">=</span> <span class=\"token function\">btoa</span><span class=\"token punctuation\">(</span><span class=\"token function\">unescape</span><span class=\"token punctuation\">(</span><span class=\"token function\">encodeURIComponent</span><span class=\"token punctuation\">(</span><span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">stringify</span><span class=\"token punctuation\">(</span>json<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                <span class=\"token keyword\">return</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">data:application/json;base64,</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>base64Data<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span>\r\n            <span class=\"token punctuation\">}</span>\r\n\r\n            <span class=\"token keyword\">return</span> <span class=\"token string\">'#'</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\r\n        <span class=\"token punctuation\">[</span>json<span class=\"token punctuation\">]</span>\r\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\r\n        <span class=\"token operator\">&lt;</span>a\r\n            href<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>href<span class=\"token punctuation\">}</span>\r\n            download<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>name<span class=\"token punctuation\">}</span>\r\n            target<span class=\"token operator\">=</span><span class=\"token string\">\"_blank\"</span>\r\n        <span class=\"token operator\">></span>\r\n            <span class=\"token punctuation\">{</span>children<span class=\"token punctuation\">}</span>\r\n        <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>a<span class=\"token operator\">></span>\r\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> DownloadJsonLink<span class=\"token punctuation\">;</span></code></pre></div>\n<p>I knew it was possible to do this to download an image, but I had never tried for other types of files.</p>\n<p>It is amazing to still learn HTML things even after many years of experience, and I hope that someone else learns something new with this post. See you next time.</p>","fields":{"postHashId":"Y29kaW5ndHJ1ZW51bGwyMDIxLTA1LTA5VDAwOjAwOjAwLjAwMFo=","slug":"/2021/2021-05-09-how-to-create-a-json-download-link-using-html-only.en/","path":"/blog/coding/how-to-create-a-json-download-link-using-html-only/","locale":"en"},"rawMarkdownBody":"This week I was working on my project [Resume Builder](https://github.com/blopa/Resume-Builder) and I wanted to be able to create a button that downloads a JSON without using JavaScript.\r\n\r\nThe only way I knew how to do that was by using `URL.createObjectURL` in a `blob` file, but that wouldn't work for me, because this link would be inside a PDF file.\r\n\r\nThen I did the first thing any millennial would do, I searched on Stack Overflow, but I couldn't find anything... how is that even possible? Well anyway, with some trial and error I was able to do it by using Base 64.\r\n\r\nLet's say I want to create a download button that will download a JSON like `{ foo: 'bar' }`, first we need to convert it to a Base 64 string, we can do that with the native `btoa` JavaScript function:\r\n\r\n```javascript\r\nconst json = { foo: 'bar' };\r\nconst jsonString = JSON.stringify(json);\r\nconst base64Json = btoa(jsonString); // eyJmb28iOiJiYXIifQ==\r\n```\r\n\r\nOk now that I know what is the Base 64 value for the `{ foo: 'bar' }` object, I can create an `anchor` element like the following:\r\n\r\n```html\r\n<a href=\"data:application/json;base64,eyJmb28iOiJiYXIifQ==\" download=\"object.json\">download</a>\r\n```\r\n\r\nAnd that's all. In my case, I just needed the code to be served as HTML, and since I'm using Gatsby, my actual code is a React element that will be SSR for my PDF file:\r\n\r\n```javascript\r\nconst DownloadJsonLink = ({\r\n    children,\r\n    json = {},\r\n    name = 'object.json',\r\n}) => {\r\n    const href = useMemo(\r\n        () => {\r\n            if (typeof window !== 'undefined') {\r\n                const base64Data = btoa(unescape(encodeURIComponent(JSON.stringify(json))));\r\n                return `data:application/json;base64,${base64Data}`;\r\n            }\r\n\r\n            return '#';\r\n        },\r\n        [json]\r\n    );\r\n\r\n    return (\r\n        <a\r\n            href={href}\r\n            download={name}\r\n            target=\"_blank\"\r\n        >\r\n            {children}\r\n        </a>\r\n    );\r\n};\r\n\r\nexport default DownloadJsonLink;\r\n```\r\n\r\nI knew it was possible to do this to download an image, but I had never tried for other types of files.\r\n\r\nIt is amazing to still learn HTML things even after many years of experience, and I hope that someone else learns something new with this post. See you next time.\r\n","frontmatter":{"tags":["json","html","download","base64","resume builder"],"categories":["coding"],"allowComments":true,"publishOnMedium":false,"cover":null,"date":"2021-05-09T00:00:00.000Z","id":null,"path":"how-to-create-a-json-download-link-using-html-only","show":true,"title":"How to create a JSON download link using HTML only","hideExcerpt":false,"subtitle":""}}},{"node":{"excerpt":"Entre em contato com o profissional de nutri√ß√£o da sua‚Ä¶","html":"<p>Entre em contato com o profissional de nutri√ß√£o da sua cidade. GG IZI.</p>","fields":{"postHashId":"Z2VuZXJhbHRydWVudWxsMjAyMS0wNS0wMlQwMDowMDowMC4wMDBa","slug":"/2021/2021-05-02-eu-perdi-14kg-esse-ano-saiba-como-voce-pode-fazer-o-mesmo.pt-br/","path":"/blog/general/eu-perdi-14kg-esse-ano-saiba-como-voce-pode-fazer-o-mesmo/","locale":"pt-br"},"rawMarkdownBody":"Entre em contato com o profissional de nutri√ß√£o da sua cidade. GG IZI.\r\n","frontmatter":{"tags":["life hack","peso"],"categories":["general"],"allowComments":true,"publishOnMedium":false,"cover":null,"date":"2021-05-02T00:00:00.000Z","id":null,"path":"eu-perdi-14kg-esse-ano-saiba-como-voce-pode-fazer-o-mesmo","show":true,"title":"Eu perdi 14kg esse ano, saiba como voc√™ pode fazer o mesmo","hideExcerpt":true,"subtitle":""}}},{"node":{"excerpt":"Get in contact with your local nutritionist. GG EZ.","html":"<p>Get in contact with your local nutritionist. GG EZ.</p>","fields":{"postHashId":"Z2VuZXJhbHRydWVudWxsMjAyMS0wNS0wMlQwMDowMDowMC4wMDBa","slug":"/2021/2021-05-02-i-lost-14kg-this-year-here-is-how-you-can-too.en/","path":"/blog/general/i-lost-14kg-this-year-here-is-how-you-can-too/","locale":"en"},"rawMarkdownBody":"Get in contact with your local nutritionist. GG EZ.\r\n","frontmatter":{"tags":["life hack","weight"],"categories":["general"],"allowComments":true,"publishOnMedium":false,"cover":null,"date":"2021-05-02T00:00:00.000Z","id":null,"path":"i-lost-14kg-this-year-here-is-how-you-can-too","show":true,"title":"I lost 14kg this year, here is how you can too","hideExcerpt":true,"subtitle":""}}},{"node":{"excerpt":"Well, this is awkward‚Ä¶ It‚Äôs been four months since my last‚Ä¶","html":"<p>Well, this is awkward‚Ä¶ It‚Äôs been four months since my last devlog on the skate platformer game, but you know life is complicated sometimes.</p>\n<p>Today I want to show how I created the pogo-attack with Phaser for my game.</p>\n<p><img src=\"/d9e1edab738bb1d7378e2f71f4b2b23d/pogo-attack.gif\" alt=\"pogo-attack\"></p>\n<p>First we need to check if the hero can perform the attack, and since we‚Äôre planning in having some stages where you can‚Äôt use your skate, this is the check for the pogo-attack:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">// Handle hero using down attack</span>\r\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>\r\n    <span class=\"token operator\">!</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">isHeroOnGround</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\r\n    <span class=\"token operator\">&amp;&amp;</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">isDownJustDown</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\r\n    <span class=\"token operator\">&amp;&amp;</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>canUseSkate\r\n<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setHeroState</span><span class=\"token punctuation\">(</span><span class=\"token constant\">ATTACKING_DOWN_START</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// Don't handle any other state</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>After setting the proper attacking state, I need to handle the hero moving sideways while performing the attack:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>\r\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">isHeroAttackingDown</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\r\n    <span class=\"token operator\">&amp;&amp;</span> <span class=\"token operator\">!</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">isHeroOnGround</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">isRightDown</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setHeroState</span><span class=\"token punctuation\">(</span><span class=\"token constant\">ATTACKING_DOWN_RIGHT</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">isLeftDown</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setHeroState</span><span class=\"token punctuation\">(</span><span class=\"token constant\">ATTACKING_DOWN_LEFT</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setHeroState</span><span class=\"token punctuation\">(</span><span class=\"token constant\">ATTACKING_DOWN_START</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span>\r\n\r\n    <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Then, inside the enemy collider callback function, simply add:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>player<span class=\"token punctuation\">.</span><span class=\"token function\">isHeroAttackingDown</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;&amp;</span> player<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span>touching<span class=\"token punctuation\">.</span>down<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    player<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span><span class=\"token function\">setVelocityY</span><span class=\"token punctuation\">(</span><span class=\"token operator\">-</span><span class=\"token number\">200</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>And there you have it, really simple to do and adds a lot of possibilities to the game. See you in the next one!</p>","fields":{"postHashId":"Z2FtZXN0cnVlbnVsbDIwMjEtMDQtMjRUMDA6MDA6MDAuMDAwWg==","slug":"/2021/2021-04-24-creating-a-pogo-attack-with-phaser-js-game-devlog-17.en/","path":"/blog/games/creating-a-pogo-attack-with-phaser-js-game-devlog-17/","locale":"en"},"rawMarkdownBody":"Well, this is awkward... It's been four months since my last devlog on the skate platformer game, but you know life is complicated sometimes.\r\n\r\nToday I want to show how I created the pogo-attack with Phaser for my game.\r\n\r\n![pogo-attack](../../uploads/blog/2021/04/pogo-attack.gif)\r\n\r\nFirst we need to check if the hero can perform the attack, and since we're planning in having some stages where you can't use your skate, this is the check for the pogo-attack:\r\n\r\n```javascript\r\n// Handle hero using down attack\r\nif (\r\n    !this.isHeroOnGround()\r\n    && this.isDownJustDown()\r\n    && this.canUseSkate\r\n) {\r\n    this.setHeroState(ATTACKING_DOWN_START);\r\n    return; // Don't handle any other state\r\n}\r\n```\r\n\r\nAfter setting the proper attacking state, I need to handle the hero moving sideways while performing the attack:\r\n\r\n```javascript\r\nif (\r\n    this.isHeroAttackingDown()\r\n    && !this.isHeroOnGround()\r\n) {\r\n    if (this.isRightDown()) {\r\n        this.setHeroState(ATTACKING_DOWN_RIGHT);\r\n    } else if (this.isLeftDown()) {\r\n        this.setHeroState(ATTACKING_DOWN_LEFT);\r\n    } else {\r\n        this.setHeroState(ATTACKING_DOWN_START);\r\n    }\r\n\r\n    return;\r\n}\r\n```\r\n\r\nThen, inside the enemy collider callback function, simply add:\r\n\r\n```javascript\r\nif (player.isHeroAttackingDown() && player.body.touching.down) {\r\n    player.body.setVelocityY(-200);\r\n}\r\n```\r\n\r\nAnd there you have it, really simple to do and adds a lot of possibilities to the game. See you in the next one!\r\n","frontmatter":{"tags":["coding","games","javascript","phaser","phaser 3","game devlog","gamedev","skate platformer","super ollie vs pebble corp","webpack","tiled"],"categories":["games"],"allowComments":true,"publishOnMedium":false,"cover":null,"date":"2021-04-24T00:00:00.000Z","id":null,"path":"creating-a-pogo-attack-with-phaser-js-game-devlog-17","show":true,"title":"Creating a pogo-attack with Phaser JS - Game Devlog #17","hideExcerpt":false,"subtitle":""}}},{"node":{"excerpt":"Bom‚Ä¶ por onde come√ßar, n√©? J√° se passaram quatro meses desde‚Ä¶","html":"<p>Bom‚Ä¶ por onde come√ßar, n√©? J√° se passaram quatro meses desde o √∫ltimo devlog sobre o Super Ollie, mas sabe como √©, a vida √†s vezes √© complicada.</p>\n<p>Anyway, hoje quero mostrar como criei o <a href=\"https://www.youtube.com/watch?v=_g0hm6TeD0s\" target=\"_blank\" rel=\"noreferrer\">pogo-attack</a> com Phaser para o meu jogo.</p>\n<p><img src=\"/d9e1edab738bb1d7378e2f71f4b2b23d/pogo-attack.gif\" alt=\"pogo-attack\"></p>\n<p>Primeiro precisamos verificar se o her√≥i pode realizar o ataque, e como estamos planejando ter algumas fases onde voc√™ n√£o pode usar seu skate, esta √© a verifica√ß√£o para o pogo-ataque:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">// Handle hero using down attack</span>\r\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>\r\n    <span class=\"token operator\">!</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">isHeroOnGround</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\r\n    <span class=\"token operator\">&amp;&amp;</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">isDownJustDown</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\r\n    <span class=\"token operator\">&amp;&amp;</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>canUseSkate\r\n<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setHeroState</span><span class=\"token punctuation\">(</span><span class=\"token constant\">ATTACKING_DOWN_START</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// Don't handle any other state</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Depois de definir o estado do pogo-attack, preciso controlar o movimento do her√≥i para os lados durante o ataque:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>\r\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">isHeroAttackingDown</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\r\n    <span class=\"token operator\">&amp;&amp;</span> <span class=\"token operator\">!</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">isHeroOnGround</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">isRightDown</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setHeroState</span><span class=\"token punctuation\">(</span><span class=\"token constant\">ATTACKING_DOWN_RIGHT</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">isLeftDown</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setHeroState</span><span class=\"token punctuation\">(</span><span class=\"token constant\">ATTACKING_DOWN_LEFT</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setHeroState</span><span class=\"token punctuation\">(</span><span class=\"token constant\">ATTACKING_DOWN_START</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span>\r\n\r\n    <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Em seguida, dentro da fun√ß√£o de callback do collider com o inimigo, basta adicionar:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>player<span class=\"token punctuation\">.</span><span class=\"token function\">isHeroAttackingDown</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;&amp;</span> player<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span>touching<span class=\"token punctuation\">.</span>down<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    player<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span><span class=\"token function\">setVelocityY</span><span class=\"token punctuation\">(</span><span class=\"token operator\">-</span><span class=\"token number\">200</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>E a√≠ est√°, um ataque novo que adiciona muitas possibilidades ao jogo e muito simples de fazer. Vejo voc√™s no pr√≥ximo devlog!</p>","fields":{"postHashId":"Z2FtZXN0cnVlbnVsbDIwMjEtMDQtMjRUMDA6MDA6MDAuMDAwWg==","slug":"/2021/2021-04-24-criando-um-pogo-attack-com-o-phaser-js-game-devlog-17.pt-br/","path":"/blog/games/criando-um-pogo-attack-com-o-phaser-js-game-devlog-17/","locale":"pt-br"},"rawMarkdownBody":"Bom... por onde come√ßar, n√©? J√° se passaram quatro meses desde o √∫ltimo devlog sobre o Super Ollie, mas sabe como √©, a vida √†s vezes √© complicada.\r\n\r\nAnyway, hoje quero mostrar como criei o [pogo-attack](https://www.youtube.com/watch?v=_g0hm6TeD0s) com Phaser para o meu jogo.\r\n\r\n![pogo-attack](../../uploads/blog/2021/04/pogo-attack.gif)\r\n\r\nPrimeiro precisamos verificar se o her√≥i pode realizar o ataque, e como estamos planejando ter algumas fases onde voc√™ n√£o pode usar seu skate, esta √© a verifica√ß√£o para o pogo-ataque:\r\n\r\n```javascript\r\n// Handle hero using down attack\r\nif (\r\n    !this.isHeroOnGround()\r\n    && this.isDownJustDown()\r\n    && this.canUseSkate\r\n) {\r\n    this.setHeroState(ATTACKING_DOWN_START);\r\n    return; // Don't handle any other state\r\n}\r\n```\r\n\r\nDepois de definir o estado do pogo-attack, preciso controlar o movimento do her√≥i para os lados durante o ataque:\r\n\r\n```javascript\r\nif (\r\n    this.isHeroAttackingDown()\r\n    && !this.isHeroOnGround()\r\n) {\r\n    if (this.isRightDown()) {\r\n        this.setHeroState(ATTACKING_DOWN_RIGHT);\r\n    } else if (this.isLeftDown()) {\r\n        this.setHeroState(ATTACKING_DOWN_LEFT);\r\n    } else {\r\n        this.setHeroState(ATTACKING_DOWN_START);\r\n    }\r\n\r\n    return;\r\n}\r\n```\r\n\r\nEm seguida, dentro da fun√ß√£o de callback do collider com o inimigo, basta adicionar:\r\n\r\n```javascript\r\nif (player.isHeroAttackingDown() && player.body.touching.down) {\r\n    player.body.setVelocityY(-200);\r\n}\r\n```\r\n\r\nE a√≠ est√°, um ataque novo que adiciona muitas possibilidades ao jogo e muito simples de fazer. Vejo voc√™s no pr√≥ximo devlog!\r\n","frontmatter":{"tags":["programa√ß√£o","jogos","javascript","phaser","phaser 3","game devlog","gamedev","skate platformer","super ollie vs pebble corp","webpack","tiled"],"categories":["games"],"allowComments":true,"publishOnMedium":false,"cover":null,"date":"2021-04-24T00:00:00.000Z","id":null,"path":"criando-um-pogo-attack-com-o-phaser-js-game-devlog-17","show":true,"title":"Criando um \"pogo-attack\" com o Phaser JS - Game Devlog #17","hideExcerpt":false,"subtitle":""}}},{"node":{"excerpt":"Quando eu estava na faculdade, web development n√£o era uma‚Ä¶","html":"<p>Quando eu estava na faculdade, web development n√£o era uma parte importante da programa√ß√£o como √© hoje, eu n√£o tive uma √∫nica aula sobre web e agora trabalho com isso todos os dias. Quem diria.</p>\n<p>Eu lembro que aprendi um pouco de HTML na escola, por volta de 1999, e ficava fazendo sites incr√≠veis tipo o gif abaixo:</p>\n<p><img src=\"/e896371a7e308e9c9abee35bb587b61d/my-website.gif\" alt=\"My website\"></p>\n<h2 id=\"the-old-ways\" style=\"position:relative;\"><a href=\"#the-old-ways\" aria-label=\"the old ways permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>The old ways</h2>\n<p>Antigamente (na √©poca do Dreamweaver), se eu quisesse fazer um site, eu teria algo assim:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">- website\r\n  - index.html\r\n  - about.html\r\n  - contact.html</code></pre></div>\n<p>E a√≠ para cada um desses arquivos, eu teria que escrever o HTML completo para aquela p√°gina, mesmo se todas elas tivessem o mesmo header ou logo etc. Neste exemplo n√£o h√° banco de dados, dados din√¢micos e nem compila√ß√£o, o site √© 100% est√°tico, eu posso simplesmente abrir esses arquivos no meu browser localmente e tudo funcionar√° sem a necessidade de servidores, porque HTML √© praticamente um texto com ester√≥ides.</p>\n<p>Claro que isso est√° longe de ser o ideal, ent√£o outras solu√ß√µes como o PHP surgiram com a possibilidade de deixar as coisas mais din√¢micas.</p>\n<h2 id=\"not-that-old-ways\" style=\"position:relative;\"><a href=\"#not-that-old-ways\" aria-label=\"not that old ways permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Not that old ways</h2>\n<p>Com o PHP, eu posso dividir o meu template de HTML em peda√ßos reutiliz√°veis, ent√£o eu poderia facilmente inicializar um framework tipo WordPress e me concentrar apenas na cria√ß√£o do conte√∫do do site.</p>\n<p>O problema √© que o meu browser n√£o entende PHP, ent√£o eu preciso de um servidor para converter toda a l√≥gica do PHP em HTML est√°tico, ent√£o toda a vez que algu√©m faz uma solicita√ß√£o para ver uma p√°gina no meu site, a solicita√ß√£o vai para o meu servidor, que vai processar o c√≥digo PHP e servir uma p√°gina HTML e, claro, isso custa muito mais do que simplesmente servir arquivos HTML est√°ticos.</p>\n<p>Uma estrutura de arquivos de um site em PHP seria algo assim:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">- website\r\n      - index.php\r\n      - header.php\r\n      - footer.php\r\n  - content\r\n      - home.php\r\n      - about.php\r\n      - contact.php</code></pre></div>\n<p>√â aqui que se encontra a maior parte dos sites agora, e por um bom motivo, a Web 2.0 √© complexa e toda esse dinamismo √© necess√°rio‚Ä¶ pelo menos na maioria dos casos, mas e os sites que quase n√£o mudam, como blogs ou portf√≥lios?</p>\n<h2 id=\"the-new-way---jamstack\" style=\"position:relative;\"><a href=\"#the-new-way---jamstack\" aria-label=\"the new way   jamstack permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>The new way - JAMStack</h2>\n<p>JAMStack significa <code class=\"language-text\">JavaScript, API &amp; Markup - Stack</code> e est√° aqui para trazer o melhor dos velhos tempos para nossas vidas. Com JAMStack eu posso criar meu site da mesma forma que faria usando PHP, mas em vez de ter os dados processados em cada solicita√ß√£o, eu posso programar o meu site inteiro em m√≥dulos, pr√©-compil√°-lo apenas uma vez e depois servi-lo como HTML est√°tico + JavaScript. Isso √© muito √∫til para sites como este, e essa t√©cnica n√£o √© nova, todos os nossos aplicativos de desktop s√£o pr√©-compilados e servidos ‚Äúestaticamente‚Äù - vamos esquecer o SaaS por um segundo, ok?</p>\n<p>Por exemplo, neste site eu tenho um template para uma p√°gina de posts do blog e eu preencho esse template com dados vindo de um arquivo Markdown, a estrutura do projeto √© algo tipo:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">- website\r\n      - index.html\r\n  - pages\r\n      - home.html\r\n      - contact.html\r\n  - templates\r\n      - blog-posts.html\r\n  - content\r\n      - my-first-post.md\r\n      - my-second-post.md</code></pre></div>\n<p>Eu estou usando o Gatsby para fazer <a href=\"https://pablo.gg/\" target=\"_blank\" rel=\"noreferrer\">esse</a> site, ent√£o posso escrever tudo usando componentes React, e o Gatsby compila tudo em um monte de arquivos HTML que s√£o servidos ao navegador.</p>\n<h2 id=\"por-onde-comecar\" style=\"position:relative;\"><a href=\"#por-onde-comecar\" aria-label=\"por onde comecar permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Por onde come√ßar?</h2>\n<p>Antes de testar o Gatsby, eu comecei com o <a href=\"https://jekyllrb.com/\" target=\"_blank\" rel=\"noreferrer\">Jekyll</a>, que √© uma forma de <a href=\"https://jekyllrb.com/docs/github-pages/\" target=\"_blank\" rel=\"noreferrer\">criar um blog JAMStack e hospeda-lo gratuitamente no GitHub Pages</a>, era tudo que eu precisava, mas primeiro tive que converter todos os meus 12 anos de posts no WordPress em arquivos Markdown com <a href=\"https://hexo.io/pt-br/docs/front-matter.html\" target=\"_blank\" rel=\"noreferrer\">frontmatter</a>.</p>\n<p>Os posts do WordPress s√£o (geralmente) armazenados em um banco de dados, ent√£o preciso extrair esses dados e salv√°-los como um arquivo Markdown, e a maneira mais f√°cil de fazer isso √© simplesmente usar um plugin do WordPress, como o <a href=\"https://github.com/benbalter/wordpress-to-jekyll-exporter\" target=\"_blank\" rel=\"noreferrer\">wordpress-to-jekyll-exporter</a>. Se voc√™ n√£o tem mais acesso ao seu blog, mas ainda tem o arquivo <code class=\"language-text\">database.sql</code> (como eu üòÖ) apenas <a href=\"https://imasters.com.br/back-end/instalando-wordpress-em-ambiente-local\" target=\"_blank\" rel=\"noreferrer\">inicialize uma vers√£o local do WordPress</a> para exportar seus posts.</p>\n<p>Eu tamb√©m criei um <a href=\"https://gist.github.com/blopa/a6e49c798cf0fd5c875025c6ae282064\" target=\"_blank\" rel=\"noreferrer\">script em Python</a> para alterar alguns dados dos arquivos Markdown gerados para atender algumas das minhas necessidades.</p>\n<p>Eu tinha mais de 100 posts no meu blog, ent√£o foi uma surpresa para mim, descobrir que <a href=\"https://pages.github.com/versions/\" target=\"_blank\" rel=\"noreferrer\">n√£o tinha como usar o plugin de pagina√ß√£o v2 do Jekyll</a> e fazer o deploy automaticamente no GitHub Pages, ent√£o decidi procurar outras solu√ß√µes.</p>\n<h2 id=\"o-grande-gatsby\" style=\"position:relative;\"><a href=\"#o-grande-gatsby\" aria-label=\"o grande gatsby permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>O Grande Gatsby</h2>\n<p>Como eu j√° conhe√ßo bem React, usar o Gatsby √© praticamente um <em>no-brainer</em>, e eles t√™m uma excelente documenta√ß√£o e muitos plugins e tutoriais e com o lan√ßamento do <a href=\"https://github.com/features/actions\" target=\"_blank\" rel=\"noreferrer\">GitHub Actions</a>, √© poss√≠vel fazer o build e deploy do Gatsby no pr√≥prio GitHub sem precisar de servi√ßos externos como <a href=\"https://travis-ci.org/\" target=\"_blank\" rel=\"noreferrer\">travis-ci.org</a>. N√£o s√≥ isso, mas eu poderia at√© mesmo ter meu c√≥digo em um reposit√≥rio privado e fazer o deploy em outro reposit√≥rio p√∫blico, dessa forma eu posso ter posts que s√£o rascunho e que n√£o quero que fiquem p√∫blicos.</p>\n<p>Primeiro eu fiz <a href=\"https://github.com/blopa/gatsby-material-ui-starter\" target=\"_blank\" rel=\"noreferrer\">este</a> reposit√≥rio com base nas instru√ß√µes <a href=\"https://github.com/mui-org/material-ui/tree/master/examples/gatsby\" target=\"_blank\" rel=\"noreferrer\">deste</a> reposit√≥rio do Material UI. Tudo o que ele faz √© vincular a biblioteca Material UI React ao Gatsby.</p>\n<p>A pr√≥xima etapa foi pegar o <a href=\"https://github.com/blopa/gatsby-material-ui-starter\" target=\"_blank\" rel=\"noreferrer\">gatsby-material-ui-starter</a> como base para adicionar toda a l√≥gica do meu blog, mas primeiro eu precisava de uma lista de todos os recursos que eu queria que o meu blog tivesse, e esses eram:</p>\n<ul>\n<li>P√°gina inicial com lista de posts</li>\n<li>P√°gina de blog com lista de posts</li>\n<li>P√°gina de posts do blog com posts relacionados</li>\n<li>P√°gina de arquivo com pagina√ß√£o</li>\n<li>Coment√°rios</li>\n<li>P√°gina de contato</li>\n<li>P√°gina de √°lbuns com fotos do Google Photos</li>\n<li>Caixa de busca</li>\n<li>SEM SERVIDORES</li>\n</ul>\n<p>Tudo parece bastante razo√°vel at√© que voc√™ lembrar que tudo isso precisa ser feito com JAMStack e sem servidores. Isso √© mesmo poss√≠vel? SIM. Gatsby e React s√£o ferramentas realmente poderosas.</p>\n<h2 id=\"lista-de-posts-e-posts-relacionados\" style=\"position:relative;\"><a href=\"#lista-de-posts-e-posts-relacionados\" aria-label=\"lista de posts e posts relacionados permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Lista de posts e posts relacionados</h2>\n<p>O Gatsby fornece uma API de GraphQL bem simples para obter dados dos arquivos Markdown, e isso pode ser feito facilmente usando o plugin <a href=\"https://github.com/gatsbyjs/gatsby/tree/master/packages/gatsby-transformer-remark\" target=\"_blank\" rel=\"noreferrer\">gatsby-transformer-remark</a> e uma query de GraphQL como a abaixo:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> pageQuery <span class=\"token operator\">=</span> graphql<span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">\r\n    query Posts($locale: String) {\r\n        allMarkdownRemark(\r\n            filter: {\r\n                fields: { locale: { eq: $locale } }\r\n                frontmatter: { show: { eq: true } }\r\n            }\r\n            sort: { fields: [frontmatter___date], order: DESC }\r\n        ) {\r\n            edges {\r\n                node {\r\n                    excerpt\r\n                    fields {\r\n                        slug\r\n                        path\r\n                        locale\r\n                    }\r\n                    frontmatter {\r\n                        date\r\n                        title\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Se voc√™ quiser saber mais sobre como criar seu pr√≥prio blog com o Gatsby do zero, siga <a href=\"https://www.gatsbyjs.com/blog/2017-07-19-creating-a-blog-with-gatsby/\" target=\"_blank\" rel=\"noreferrer\">o tutorial oficial</a>.</p>\n<p>Para os posts relacionados, decidi pegar todos os meus posts e verificar em cada um deles quais outros posts tem as mesmas tags, e ent√£o ordena-los por quantidade de tags iguais. Esta pode n√£o ser a maneira eficiente de fazer isso, mas lembre-se de que s√≥ estou compilando o site uma vez, ent√£o tudo bem üòä</p>\n<h2 id=\"paginacao\" style=\"position:relative;\"><a href=\"#paginacao\" aria-label=\"paginacao permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Pagina√ß√£o</h2>\n<p>O Material UI j√° tem um <a href=\"https://material-ui.com/components/pagination/\" target=\"_blank\" rel=\"noreferrer\">componente de pagina√ß√£o</a>, ent√£o eu criei um template <code class=\"language-text\">Archive.jsx</code> que recebe uma lista de posts, um n√∫mero total de p√°ginas e o n√∫mero da p√°gina atual e durante o <a href=\"https://www.gatsbyjs.com/docs/reference/config-files/gatsby-node/\" target=\"_blank\" rel=\"noreferrer\">processo de compila√ß√£o de Gatsby</a>, eu crio v√°rias p√°ginas de arquivo usando o meu template e √© isso. F√°cil demais.</p>\n<h2 id=\"busca\" style=\"position:relative;\"><a href=\"#busca\" aria-label=\"busca permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Busca</h2>\n<p>J√° que o Gatsby usa tecnologias de JavaScript ultra-modernas, criar uma pesquisa local deve ser muito f√°cil, certo? SIM! Existe at√© <a href=\"https://github.com/angeloashmore/gatsby-plugin-local-search\" target=\"_blank\" rel=\"noreferrer\">um plugin</a> para isso j√°! Show!</p>\n<p>Basta seguir <a href=\"https://labs.walltowall.com/easy-client-side-search-for-gatsby-sites/\" target=\"_blank\" rel=\"noreferrer\">esse tutorial</a> e combinar o c√≥digo com o <a href=\"https://material-ui.com/components/autocomplete/\" target=\"_blank\" rel=\"noreferrer\">componente de autocomplete do Material UI</a> para criar um componente <code class=\"language-text\">SearchBar</code> igual ao desse blog.</p>\n<h2 id=\"integracao-com-google-photos\" style=\"position:relative;\"><a href=\"#integracao-com-google-photos\" aria-label=\"integracao com google photos permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Integra√ß√£o com Google Photos</h2>\n<p>A parte ruim do JAMStack √© que meu reposit√≥rio git conter√° n√£o apenas todo o meu c√≥digo-fonte, mas tamb√©m todos os meus dados de conte√∫do, incluindo fotos, etc, e isso acaba deixando o meu reposit√≥rio muito grande.</p>\n<p>Claro que eu poderia consumir meus dados via uma API externa em vez de arquivos Markdown e isso j√° vai ajudar um pouco, mas poder n√£o armazenar fotos no reposit√≥rio vai economizar muito espa√ßo.</p>\n<p>Gra√ßas a <a href=\"https://medium.com/@ValentinHervieu/how-i-used-google-photos-to-host-my-website-pictures-gallery-d49f037c8e3c\" target=\"_blank\" rel=\"noreferrer\">este belo post</a> feita pelo <a href=\"https://medium.com/@ValentinHervieu\" target=\"_blank\" rel=\"noreferrer\">@ValentinHervieu</a> podemos ter uma ideia de como obter a URL das imagens de um √°lbum do Google Photos, eu posso simplesmente seguir esse post e adicionar o c√≥digo no meu processo de build do Gatsby.</p>\n<h2 id=\"multi-linguas\" style=\"position:relative;\"><a href=\"#multi-linguas\" aria-label=\"multi linguas permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Multi-l√≠nguas</h2>\n<p>Bom como portugu√™s √© a minha l√≠ngua nativa, e eu moro fora do Brasil, √© √∫til poder escrever posts em m√∫ltiplos idiomas para poder compartilhar com meus amigos aqui e no Brasil, e para isso eu preciso adicionar uma funcionalidade de poder criar posts em l√≠nguas diferentes, e √≥bviamente <a href=\"https://github.com/wiziple/gatsby-plugin-intl\" target=\"_blank\" rel=\"noreferrer\">existe um plugin do Gatsby para isso</a>.</p>\n<p>Esse plugin √© baseado no famoso <a href=\"https://formatjs.io/docs/react-intl/\" target=\"_blank\" rel=\"noreferrer\">React Intl</a>, e √© bem simples de usar, basta adicionar um novo objeto nas configura√ß√µes de plugin do Gatsby a passar uma array com os c√≥digos das l√≠nguas que voc√™ quer adicionar e um path para onde ficar√£o as tradu√ß√µes para essas l√≠nguas. Veja abaixo como √© esse objeto para esse blog:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\">module<span class=\"token punctuation\">.</span>exports <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token operator\">...</span>config<span class=\"token punctuation\">,</span>\r\n    <span class=\"token literal-property property\">plugins</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">{</span>\r\n        <span class=\"token literal-property property\">resolve</span><span class=\"token operator\">:</span> <span class=\"token string\">'gatsby-plugin-intl'</span><span class=\"token punctuation\">,</span>\r\n        <span class=\"token literal-property property\">options</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\r\n            <span class=\"token literal-property property\">path</span><span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>__dirname<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">/src/intl</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\r\n            <span class=\"token literal-property property\">languages</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'en'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'pt-br'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\r\n            <span class=\"token literal-property property\">defaultLanguage</span><span class=\"token operator\">:</span> <span class=\"token string\">'en'</span><span class=\"token punctuation\">,</span>\r\n            <span class=\"token literal-property property\">redirect</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\r\n            <span class=\"token literal-property property\">redirectComponent</span><span class=\"token operator\">:</span> require<span class=\"token punctuation\">.</span><span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span><span class=\"token string\">'./src/utils/redirect.js'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\r\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\r\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\r\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>O que isso far√° √© que sempre que voc√™ criar uma p√°gina tipo <code class=\"language-text\">/contact/</code>, ele criar√° uma p√°gina para cada um dos idiomas para os quais voc√™ configurou, tipo <code class=\"language-text\">/en/contact/</code> e <code class=\"language-text\">/pt-br/contact/</code>. Maneiro! Mas, e os posts do blog? N√£o quero paths tipo <code class=\"language-text\">/en/hello-world/</code> e <code class=\"language-text\">/pt-br/hello-world/</code>, eu quero <code class=\"language-text\">/en/hello-world/</code> e <code class=\"language-text\">/pt-br/ola-mundo/</code>.</p>\n<p>Para ter o mesmo post em diferentes idiomas, eu crio arquivos de markdown tipo <code class=\"language-text\">hello-world.en.md</code> e <code class=\"language-text\">hello-world.pt-br.md</code> e, em seguida, conecto eles pelo t√≠tulo e a data do post, dessa forma √© poss√≠vel mudar o idioma na p√°gina do post e ver o mesmo post em outro idioma.</p>\n<p><img src=\"/2105ea55eebac25b4267be0420fbb6e5/language-switcher.gif\" alt=\"Language switcher\"></p>\n<h2 id=\"pagina-de-contato-e-sistema-de-comentarios\" style=\"position:relative;\"><a href=\"#pagina-de-contato-e-sistema-de-comentarios\" aria-label=\"pagina de contato e sistema de comentarios permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>P√°gina de contato e sistema de coment√°rios</h2>\n<p>Existem alguns servi√ßos que oferecem sistemas de coment√°rios para o seu site, como <a href=\"https://disqus.com/\" target=\"_blank\" rel=\"noreferrer\">disqus.com</a> e o <a href=\"https://developers.facebook.com/docs/plugins/comments/\" target=\"_blank\" rel=\"noreferrer\">Facebook Comments</a>, mas o plano gratuito do Disqus adicionar√° an√∫ncios ao seu site, e o Facebook exigir√° que os usu√°rios tenham uma conta no Facebook para us√°-lo.</p>\n<p>Depois de um tempo pesquisando eu descobri ser poss√≠vel usar o <a href=\"https://blog.webjeda.com/google-form-customize/\" target=\"_blank\" rel=\"noreferrer\">Google Forms como um sistema de coment√°rios</a> para o meu blog em JAMStack.</p>\n<p>Os dados dos coment√°rios s√£o armazenados em uma planilha do Google no seu Google Drive, que pode ent√£o ser acessada no processo de build do Gatsby para passar todos os coment√°rios para os devidos posts do blog.</p>\n<p>Um problema de usar este sistema √© que se eu quiser que os novos coment√°rios apare√ßam no blog, eu preciso buildar o site todo novamente, mas vamos pensar nisso como um processo para aprovar / desaprovar coment√°rios üòÑ e tamb√©m <a href=\"https://www.gatsbyjs.com/docs/reference/release-notes/v3.0/#incremental-builds-in-oss\" target=\"_blank\" rel=\"noreferrer\">se voc√™ configurar o Gatsby direitinho, fazer re-builds n√£o √© um grande problema</a>.</p>\n<h2 id=\"github-actions\" style=\"position:relative;\"><a href=\"#github-actions\" aria-label=\"github actions permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>GitHub Actions</h2>\n<p>Ap√≥s programar tudo isso (incluindo algumas gambiarras), tudo o que resta √© usar GitHub Actions para fazer o build e o deploy do meu site, e para isso eu simplesmente crio um arquivo <code class=\"language-text\">.github/workflows/deploy.yml</code> no meu reposit√≥rio do GitHub com as seguintes configura√ß√µes:</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Deploy to GitHub Pages\r\n<span class=\"token key atrule\">on</span><span class=\"token punctuation\">:</span>\r\n  <span class=\"token key atrule\">workflow_dispatch</span><span class=\"token punctuation\">:</span>\r\n  <span class=\"token key atrule\">push</span><span class=\"token punctuation\">:</span>\r\n    <span class=\"token key atrule\">branches</span><span class=\"token punctuation\">:</span>\r\n      <span class=\"token punctuation\">-</span> main\r\n\r\n<span class=\"token key atrule\">jobs</span><span class=\"token punctuation\">:</span>\r\n  <span class=\"token key atrule\">build-and-deploy</span><span class=\"token punctuation\">:</span>\r\n    <span class=\"token key atrule\">runs-on</span><span class=\"token punctuation\">:</span> ubuntu<span class=\"token punctuation\">-</span>latest\r\n    <span class=\"token key atrule\">steps</span><span class=\"token punctuation\">:</span>\r\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Checkout\r\n        <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> actions/checkout@v2.3.4\r\n        <span class=\"token key atrule\">with</span><span class=\"token punctuation\">:</span>\r\n          <span class=\"token key atrule\">persist-credentials</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">false</span>\r\n\r\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Install and Build üöß\r\n        <span class=\"token key atrule\">run</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">|</span><span class=\"token scalar string\">\r\n          npm cache clean --force\r\n          npm install\r\n          npm run clean\r\n          npm run build</span>\r\n\r\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Deploy üöÄ\r\n        <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> JamesIves/github<span class=\"token punctuation\">-</span>pages<span class=\"token punctuation\">-</span>deploy<span class=\"token punctuation\">-</span>action@4.1.1\r\n        <span class=\"token key atrule\">with</span><span class=\"token punctuation\">:</span>\r\n          <span class=\"token key atrule\">token</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> secrets.ACCESS_TOKEN <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\r\n          <span class=\"token key atrule\">repository-name</span><span class=\"token punctuation\">:</span> blopa/pablo.gg\r\n          <span class=\"token key atrule\">branch</span><span class=\"token punctuation\">:</span> gh<span class=\"token punctuation\">-</span>pages\r\n          <span class=\"token key atrule\">folder</span><span class=\"token punctuation\">:</span> public\r\n          <span class=\"token key atrule\">clean</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">true</span>\r\n          <span class=\"token key atrule\">single-commit</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">true</span></code></pre></div>\n<p>Isso ir√° buildar o site toda vez que eu commitar no branch <code class=\"language-text\">main</code> e depois far√° o deploy no meu reposit√≥rio p√∫blico <a href=\"https://github.com/blopa/pablo.gg\" target=\"_blank\" rel=\"noreferrer\">github.com/blopa/pablo.gg</a> para que possa ser acessado via <a href=\"https://pablo.gg/\" target=\"_blank\" rel=\"noreferrer\">https://pablo.gg/</a>.</p>\n<h2 id=\"por-que\" style=\"position:relative;\"><a href=\"#por-que\" aria-label=\"por que permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Por qu√™?</h2>\n<p>Voc√™ pode estar se perguntando ‚Äúpor que voc√™ simplesmente n√£o pega um servidor de R$5,00 por mes e roda um WordPress nele?‚Äù, e eu digo por que, n√£o √© apenas uma quest√£o de economizar dinheiro, mas tamb√©m √© uma coisa a menos com que se preocupar, e se eu morrer ou entrar em coma sei la, meu site ainda estar√° online - desde que o GitHub Pages ainda exista e seja gratuito. E ao usar o JAMStack voc√™ automaticamente diminuir√° o poder de processamento usado para servir o seu site, o que tamb√©m diminuir√° as emiss√µes de CO2 e salvar√° o planeta (ou pelo menos ajudar√° um pouquinho).</p>\n<h2 id=\"conclusao\" style=\"position:relative;\"><a href=\"#conclusao\" aria-label=\"conclusao permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Conclus√£o</h2>\n<p>Eu n√£o s√≥ aprendi um novo framework em React, mas tamb√©m criei um blog pessoal ultra leve com custo de hospedagem de R$0,00, e mesmo que o GitHub Actions ou o GitHub Pages deixe de existir um dia, eu posso simplesmente buildar o meu blog localmente e depois hospeda-lo em algum servidor de arquivos est√°ticos e isso me custaria muito pouco por ano, ent√£o yay!</p>\n<p>Claro que eu acabo pagando pelo <a href=\"https://pt.godaddy.com/tlds/gg-domain\" target=\"_blank\" rel=\"noreferrer\">dom√≠nio .gg</a>, mas se voc√™ quiser ir <em><a href=\"https://pt.wikipedia.org/wiki/Frugalidade\" target=\"_blank\" rel=\"noreferrer\">full frugal</a></em>, voc√™ pode simplesmente hospedar o seu site usando dom√≠nios gratuitos como o <a href=\"https://pages.github.com/\" target=\"_blank\" rel=\"noreferrer\">github.io</a> ou o <a href=\"https://freenom.com\" target=\"_blank\" rel=\"noreferrer\">freenom.com</a>.</p>","fields":{"postHashId":"Y29kaW5ndHJ1ZW51bGwyMDIxLTA0LTE3VDAwOjAwOjAwLjAwMFo=","slug":"/2021/2021-04-17-eu-pago-0-em-hospedagem-para-esse-site.pt-br/","path":"/blog/coding/eu-pago-0-em-hospedagem-para-esse-site/","locale":"pt-br"},"rawMarkdownBody":"Quando eu estava na faculdade, web development n√£o era uma parte importante da programa√ß√£o como √© hoje, eu n√£o tive uma √∫nica aula sobre web e agora trabalho com isso todos os dias. Quem diria.\r\n\r\nEu lembro que aprendi um pouco de HTML na escola, por volta de 1999, e ficava fazendo sites incr√≠veis tipo o gif abaixo:\r\n\r\n![My website](../../uploads/blog/2021/04/my-website.gif)\r\n\r\n## The old ways\r\nAntigamente (na √©poca do Dreamweaver), se eu quisesse fazer um site, eu teria algo assim:\r\n\r\n```shell\r\n- website\r\n  - index.html\r\n  - about.html\r\n  - contact.html\r\n```\r\n\r\nE a√≠ para cada um desses arquivos, eu teria que escrever o HTML completo para aquela p√°gina, mesmo se todas elas tivessem o mesmo header ou logo etc. Neste exemplo n√£o h√° banco de dados, dados din√¢micos e nem compila√ß√£o, o site √© 100% est√°tico, eu posso simplesmente abrir esses arquivos no meu browser localmente e tudo funcionar√° sem a necessidade de servidores, porque HTML √© praticamente um texto com ester√≥ides.\r\n\r\nClaro que isso est√° longe de ser o ideal, ent√£o outras solu√ß√µes como o PHP surgiram com a possibilidade de deixar as coisas mais din√¢micas.\r\n## Not that old ways\r\n\r\nCom o PHP, eu posso dividir o meu template de HTML em peda√ßos reutiliz√°veis, ent√£o eu poderia facilmente inicializar um framework tipo WordPress e me concentrar apenas na cria√ß√£o do conte√∫do do site.\r\n\r\nO problema √© que o meu browser n√£o entende PHP, ent√£o eu preciso de um servidor para converter toda a l√≥gica do PHP em HTML est√°tico, ent√£o toda a vez que algu√©m faz uma solicita√ß√£o para ver uma p√°gina no meu site, a solicita√ß√£o vai para o meu servidor, que vai processar o c√≥digo PHP e servir uma p√°gina HTML e, claro, isso custa muito mais do que simplesmente servir arquivos HTML est√°ticos.\r\n\r\nUma estrutura de arquivos de um site em PHP seria algo assim:\r\n\r\n```shell\r\n- website\r\n      - index.php\r\n      - header.php\r\n      - footer.php\r\n  - content\r\n      - home.php\r\n      - about.php\r\n      - contact.php\r\n```\r\n\r\n√â aqui que se encontra a maior parte dos sites agora, e por um bom motivo, a Web 2.0 √© complexa e toda esse dinamismo √© necess√°rio... pelo menos na maioria dos casos, mas e os sites que quase n√£o mudam, como blogs ou portf√≥lios?\r\n\r\n## The new way - JAMStack\r\nJAMStack significa `JavaScript, API & Markup - Stack` e est√° aqui para trazer o melhor dos velhos tempos para nossas vidas. Com JAMStack eu posso criar meu site da mesma forma que faria usando PHP, mas em vez de ter os dados processados em cada solicita√ß√£o, eu posso programar o meu site inteiro em m√≥dulos, pr√©-compil√°-lo apenas uma vez e depois servi-lo como HTML est√°tico + JavaScript. Isso √© muito √∫til para sites como este, e essa t√©cnica n√£o √© nova, todos os nossos aplicativos de desktop s√£o pr√©-compilados e servidos \"estaticamente\" - vamos esquecer o SaaS por um segundo, ok?\r\n\r\nPor exemplo, neste site eu tenho um template para uma p√°gina de posts do blog e eu preencho esse template com dados vindo de um arquivo Markdown, a estrutura do projeto √© algo tipo:\r\n\r\n```shell\r\n- website\r\n      - index.html\r\n  - pages\r\n      - home.html\r\n      - contact.html\r\n  - templates\r\n      - blog-posts.html\r\n  - content\r\n      - my-first-post.md\r\n      - my-second-post.md\r\n```\r\n\r\nEu estou usando o Gatsby para fazer [esse](https://pablo.gg/) site, ent√£o posso escrever tudo usando componentes React, e o Gatsby compila tudo em um monte de arquivos HTML que s√£o servidos ao navegador.\r\n\r\n## Por onde come√ßar?\r\nAntes de testar o Gatsby, eu comecei com o [Jekyll](https://jekyllrb.com/), que √© uma forma de [criar um blog JAMStack e hospeda-lo gratuitamente no GitHub Pages](https://jekyllrb.com/docs/github-pages/), era tudo que eu precisava, mas primeiro tive que converter todos os meus 12 anos de posts no WordPress em arquivos Markdown com [frontmatter](https://hexo.io/pt-br/docs/front-matter.html).\r\n\r\nOs posts do WordPress s√£o (geralmente) armazenados em um banco de dados, ent√£o preciso extrair esses dados e salv√°-los como um arquivo Markdown, e a maneira mais f√°cil de fazer isso √© simplesmente usar um plugin do WordPress, como o [wordpress-to-jekyll-exporter](https://github.com/benbalter/wordpress-to-jekyll-exporter). Se voc√™ n√£o tem mais acesso ao seu blog, mas ainda tem o arquivo `database.sql` (como eu üòÖ) apenas [inicialize uma vers√£o local do WordPress](https://imasters.com.br/back-end/instalando-wordpress-em-ambiente-local) para exportar seus posts.\r\n\r\nEu tamb√©m criei um [script em Python](https://gist.github.com/blopa/a6e49c798cf0fd5c875025c6ae282064) para alterar alguns dados dos arquivos Markdown gerados para atender algumas das minhas necessidades.\r\n\r\nEu tinha mais de 100 posts no meu blog, ent√£o foi uma surpresa para mim, descobrir que [n√£o tinha como usar o plugin de pagina√ß√£o v2 do Jekyll](https://pages.github.com/versions/) e fazer o deploy automaticamente no GitHub Pages, ent√£o decidi procurar outras solu√ß√µes.\r\n\r\n## O Grande Gatsby\r\nComo eu j√° conhe√ßo bem React, usar o Gatsby √© praticamente um _no-brainer_, e eles t√™m uma excelente documenta√ß√£o e muitos plugins e tutoriais e com o lan√ßamento do [GitHub Actions](https://github.com/features/actions), √© poss√≠vel fazer o build e deploy do Gatsby no pr√≥prio GitHub sem precisar de servi√ßos externos como [travis-ci.org](https://travis-ci.org/). N√£o s√≥ isso, mas eu poderia at√© mesmo ter meu c√≥digo em um reposit√≥rio privado e fazer o deploy em outro reposit√≥rio p√∫blico, dessa forma eu posso ter posts que s√£o rascunho e que n√£o quero que fiquem p√∫blicos.\r\n\r\nPrimeiro eu fiz [este](https://github.com/blopa/gatsby-material-ui-starter) reposit√≥rio com base nas instru√ß√µes [deste](https://github.com/mui-org/material-ui/tree/master/examples/gatsby) reposit√≥rio do Material UI. Tudo o que ele faz √© vincular a biblioteca Material UI React ao Gatsby.\r\n\r\nA pr√≥xima etapa foi pegar o [gatsby-material-ui-starter](https://github.com/blopa/gatsby-material-ui-starter) como base para adicionar toda a l√≥gica do meu blog, mas primeiro eu precisava de uma lista de todos os recursos que eu queria que o meu blog tivesse, e esses eram:\r\n\r\n- P√°gina inicial com lista de posts\r\n- P√°gina de blog com lista de posts\r\n- P√°gina de posts do blog com posts relacionados\r\n- P√°gina de arquivo com pagina√ß√£o\r\n- Coment√°rios\r\n- P√°gina de contato\r\n- P√°gina de √°lbuns com fotos do Google Photos\r\n- Caixa de busca\r\n- SEM SERVIDORES\r\n\r\nTudo parece bastante razo√°vel at√© que voc√™ lembrar que tudo isso precisa ser feito com JAMStack e sem servidores. Isso √© mesmo poss√≠vel? SIM. Gatsby e React s√£o ferramentas realmente poderosas.\r\n\r\n## Lista de posts e posts relacionados\r\nO Gatsby fornece uma API de GraphQL bem simples para obter dados dos arquivos Markdown, e isso pode ser feito facilmente usando o plugin [gatsby-transformer-remark](https://github.com/gatsbyjs/gatsby/tree/master/packages/gatsby-transformer-remark) e uma query de GraphQL como a abaixo:\r\n\r\n```javascript\r\nexport const pageQuery = graphql`\r\n    query Posts($locale: String) {\r\n        allMarkdownRemark(\r\n            filter: {\r\n                fields: { locale: { eq: $locale } }\r\n                frontmatter: { show: { eq: true } }\r\n            }\r\n            sort: { fields: [frontmatter___date], order: DESC }\r\n        ) {\r\n            edges {\r\n                node {\r\n                    excerpt\r\n                    fields {\r\n                        slug\r\n                        path\r\n                        locale\r\n                    }\r\n                    frontmatter {\r\n                        date\r\n                        title\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n`;\r\n```\r\n\r\nSe voc√™ quiser saber mais sobre como criar seu pr√≥prio blog com o Gatsby do zero, siga [o tutorial oficial](https://www.gatsbyjs.com/blog/2017-07-19-creating-a-blog-with-gatsby/).\r\n\r\nPara os posts relacionados, decidi pegar todos os meus posts e verificar em cada um deles quais outros posts tem as mesmas tags, e ent√£o ordena-los por quantidade de tags iguais. Esta pode n√£o ser a maneira eficiente de fazer isso, mas lembre-se de que s√≥ estou compilando o site uma vez, ent√£o tudo bem üòä\r\n\r\n## Pagina√ß√£o\r\nO Material UI j√° tem um [componente de pagina√ß√£o](https://material-ui.com/components/pagination/), ent√£o eu criei um template `Archive.jsx` que recebe uma lista de posts, um n√∫mero total de p√°ginas e o n√∫mero da p√°gina atual e durante o [processo de compila√ß√£o de Gatsby](https://www.gatsbyjs.com/docs/reference/config-files/gatsby-node/), eu crio v√°rias p√°ginas de arquivo usando o meu template e √© isso. F√°cil demais.\r\n\r\n## Busca\r\nJ√° que o Gatsby usa tecnologias de JavaScript ultra-modernas, criar uma pesquisa local deve ser muito f√°cil, certo? SIM! Existe at√© [um plugin](https://github.com/angeloashmore/gatsby-plugin-local-search) para isso j√°! Show!\r\n\r\nBasta seguir [esse tutorial](https://labs.walltowall.com/easy-client-side-search-for-gatsby-sites/) e combinar o c√≥digo com o [componente de autocomplete do Material UI](https://material-ui.com/components/autocomplete/) para criar um componente `SearchBar` igual ao desse blog.\r\n\r\n## Integra√ß√£o com Google Photos\r\nA parte ruim do JAMStack √© que meu reposit√≥rio git conter√° n√£o apenas todo o meu c√≥digo-fonte, mas tamb√©m todos os meus dados de conte√∫do, incluindo fotos, etc, e isso acaba deixando o meu reposit√≥rio muito grande.\r\n\r\nClaro que eu poderia consumir meus dados via uma API externa em vez de arquivos Markdown e isso j√° vai ajudar um pouco, mas poder n√£o armazenar fotos no reposit√≥rio vai economizar muito espa√ßo.\r\n\r\nGra√ßas a [este belo post](https://medium.com/@ValentinHervieu/how-i-used-google-photos-to-host-my-website-pictures-gallery-d49f037c8e3c) feita pelo [@ValentinHervieu](https://medium.com/@ValentinHervieu) podemos ter uma ideia de como obter a URL das imagens de um √°lbum do Google Photos, eu posso simplesmente seguir esse post e adicionar o c√≥digo no meu processo de build do Gatsby.\r\n\r\n## Multi-l√≠nguas\r\nBom como portugu√™s √© a minha l√≠ngua nativa, e eu moro fora do Brasil, √© √∫til poder escrever posts em m√∫ltiplos idiomas para poder compartilhar com meus amigos aqui e no Brasil, e para isso eu preciso adicionar uma funcionalidade de poder criar posts em l√≠nguas diferentes, e √≥bviamente [existe um plugin do Gatsby para isso](https://github.com/wiziple/gatsby-plugin-intl).\r\n\r\nEsse plugin √© baseado no famoso [React Intl](https://formatjs.io/docs/react-intl/), e √© bem simples de usar, basta adicionar um novo objeto nas configura√ß√µes de plugin do Gatsby a passar uma array com os c√≥digos das l√≠nguas que voc√™ quer adicionar e um path para onde ficar√£o as tradu√ß√µes para essas l√≠nguas. Veja abaixo como √© esse objeto para esse blog:\r\n\r\n```javascript\r\nmodule.exports = {\r\n    ...config,\r\n    plugins: [{\r\n        resolve: 'gatsby-plugin-intl',\r\n        options: {\r\n            path: `${__dirname}/src/intl`,\r\n            languages: ['en', 'pt-br'],\r\n            defaultLanguage: 'en',\r\n            redirect: true,\r\n            redirectComponent: require.resolve('./src/utils/redirect.js'),\r\n        },\r\n    }],\r\n};\r\n```\r\n\r\nO que isso far√° √© que sempre que voc√™ criar uma p√°gina tipo `/contact/`, ele criar√° uma p√°gina para cada um dos idiomas para os quais voc√™ configurou, tipo `/en/contact/` e `/pt-br/contact/`. Maneiro! Mas, e os posts do blog? N√£o quero paths tipo `/en/hello-world/` e `/pt-br/hello-world/`, eu quero `/en/hello-world/` e `/pt-br/ola-mundo/`.\r\n\r\nPara ter o mesmo post em diferentes idiomas, eu crio arquivos de markdown tipo `hello-world.en.md` e `hello-world.pt-br.md` e, em seguida, conecto eles pelo t√≠tulo e a data do post, dessa forma √© poss√≠vel mudar o idioma na p√°gina do post e ver o mesmo post em outro idioma.\r\n\r\n![Language switcher](../../uploads/blog/2021/04/language-switcher.gif)\r\n\r\n## P√°gina de contato e sistema de coment√°rios\r\nExistem alguns servi√ßos que oferecem sistemas de coment√°rios para o seu site, como [disqus.com](https://disqus.com/) e o [Facebook Comments](https://developers.facebook.com/docs/plugins/comments/), mas o plano gratuito do Disqus adicionar√° an√∫ncios ao seu site, e o Facebook exigir√° que os usu√°rios tenham uma conta no Facebook para us√°-lo.\r\n\r\nDepois de um tempo pesquisando eu descobri ser poss√≠vel usar o [Google Forms como um sistema de coment√°rios](https://blog.webjeda.com/google-form-customize/) para o meu blog em JAMStack.\r\n\r\nOs dados dos coment√°rios s√£o armazenados em uma planilha do Google no seu Google Drive, que pode ent√£o ser acessada no processo de build do Gatsby para passar todos os coment√°rios para os devidos posts do blog.\r\n\r\nUm problema de usar este sistema √© que se eu quiser que os novos coment√°rios apare√ßam no blog, eu preciso buildar o site todo novamente, mas vamos pensar nisso como um processo para aprovar / desaprovar coment√°rios üòÑ e tamb√©m [se voc√™ configurar o Gatsby direitinho, fazer re-builds n√£o √© um grande problema](https://www.gatsbyjs.com/docs/reference/release-notes/v3.0/#incremental-builds-in-oss).\r\n\r\n## GitHub Actions\r\nAp√≥s programar tudo isso (incluindo algumas gambiarras), tudo o que resta √© usar GitHub Actions para fazer o build e o deploy do meu site, e para isso eu simplesmente crio um arquivo `.github/workflows/deploy.yml` no meu reposit√≥rio do GitHub com as seguintes configura√ß√µes:\r\n\r\n```yaml\r\nname: Deploy to GitHub Pages\r\non:\r\n  workflow_dispatch:\r\n  push:\r\n    branches:\r\n      - main\r\n\r\njobs:\r\n  build-and-deploy:\r\n    runs-on: ubuntu-latest\r\n    steps:\r\n      - name: Checkout\r\n        uses: actions/checkout@v2.3.4\r\n        with:\r\n          persist-credentials: false\r\n\r\n      - name: Install and Build üöß\r\n        run: |\r\n          npm cache clean --force\r\n          npm install\r\n          npm run clean\r\n          npm run build\r\n\r\n      - name: Deploy üöÄ\r\n        uses: JamesIves/github-pages-deploy-action@4.1.1\r\n        with:\r\n          token: ${{ secrets.ACCESS_TOKEN }}\r\n          repository-name: blopa/pablo.gg\r\n          branch: gh-pages\r\n          folder: public\r\n          clean: true\r\n          single-commit: true\r\n```\r\n\r\nIsso ir√° buildar o site toda vez que eu commitar no branch `main` e depois far√° o deploy no meu reposit√≥rio p√∫blico [github.com/blopa/pablo.gg](https://github.com/blopa/pablo.gg) para que possa ser acessado via [https://pablo.gg/](https://pablo.gg/).\r\n\r\n## Por qu√™?\r\nVoc√™ pode estar se perguntando \"por que voc√™ simplesmente n√£o pega um servidor de R$5,00 por mes e roda um WordPress nele?\", e eu digo por que, n√£o √© apenas uma quest√£o de economizar dinheiro, mas tamb√©m √© uma coisa a menos com que se preocupar, e se eu morrer ou entrar em coma sei la, meu site ainda estar√° online - desde que o GitHub Pages ainda exista e seja gratuito. E ao usar o JAMStack voc√™ automaticamente diminuir√° o poder de processamento usado para servir o seu site, o que tamb√©m diminuir√° as emiss√µes de CO2 e salvar√° o planeta (ou pelo menos ajudar√° um pouquinho).\r\n\r\n## Conclus√£o\r\nEu n√£o s√≥ aprendi um novo framework em React, mas tamb√©m criei um blog pessoal ultra leve com custo de hospedagem de R$0,00, e mesmo que o GitHub Actions ou o GitHub Pages deixe de existir um dia, eu posso simplesmente buildar o meu blog localmente e depois hospeda-lo em algum servidor de arquivos est√°ticos e isso me custaria muito pouco por ano, ent√£o yay!\r\n\r\nClaro que eu acabo pagando pelo [dom√≠nio .gg](https://pt.godaddy.com/tlds/gg-domain), mas se voc√™ quiser ir *[full frugal](https://pt.wikipedia.org/wiki/Frugalidade)*, voc√™ pode simplesmente hospedar o seu site usando dom√≠nios gratuitos como o [github.io](https://pages.github.com/) ou o [freenom.com](https://freenom.com).\r\n","frontmatter":{"tags":["jamstack","javascript","gatsby","reactjs","github","github pages","github actions","frugal","multi-l√≠nguas","multi-idiomas","flexsearch","google photos","markdown"],"categories":["coding"],"allowComments":true,"publishOnMedium":false,"cover":null,"date":"2021-04-17T00:00:00.000Z","id":null,"path":"eu-pago-0-em-hospedagem-para-esse-site","show":true,"title":"Eu pago R$0,00 em hospedagem para esse site","hideExcerpt":false,"subtitle":""}}},{"node":{"excerpt":"When I was in college, web development wasn‚Äôt a major part‚Ä¶","html":"<p>When I was in college, web development wasn‚Äôt a major part of programming as it is these days, I didn‚Äôt have a single class on the web, and now I work with it every day. Pretty crazy.</p>\n<p>I remember learning some basic HTML back in school, around 1999, and making awesome looking websites like:</p>\n<p><img src=\"/e896371a7e308e9c9abee35bb587b61d/my-website.gif\" alt=\"My website\"></p>\n<h2 id=\"the-old-ways\" style=\"position:relative;\"><a href=\"#the-old-ways\" aria-label=\"the old ways permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>The old ways</h2>\n<p>Back in the old (Dreamweaver) days if I wanted to make a website, I would have something like this:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">- website\r\n  - index.html\r\n  - about.html\r\n  - contact.html</code></pre></div>\n<p>Then for each of those files, I would have to write the full HTML for that page, even if all of them had the same header or logo, etc. In this example, there is no database, no dynamic data, no compilation, the website is 100% static, I can simply open these files in my browser locally and everything will work without the need of servers because HTML is pretty much just a plain text with steroids.</p>\n<p>Of course, this is far from ideal, so other solutions like PHP came in to allow us to make things a bit more dynamic.</p>\n<h2 id=\"not-that-old-ways\" style=\"position:relative;\"><a href=\"#not-that-old-ways\" aria-label=\"not that old ways permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Not that old ways</h2>\n<p>With PHP, I can split my HTML template into re-usable chunks, so I could easily boot up a WordPress website and set up the whole header layout, and then focus only on creating the content for the website.</p>\n<p>The problem is that my browser doesn‚Äôt understand PHP, so I need a server to convert all the PHP logic into static HTML, so every time someone requested to see a page on my website, the request would go to my server, which will process the PHP code and serve an HTML page and of course, this costs way more than simply serving static HTML files.</p>\n<p>A PHP website file structure would have something like this:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">- website\r\n      - index.php\r\n      - header.php\r\n      - footer.php\r\n  - content\r\n      - home.php\r\n      - about.php\r\n      - contact.php</code></pre></div>\n<p>This is where most of the websites are now, and with a good reason, Web 2.0 is complex and dynamics is needed‚Ä¶ for most cases at least, but what about sites that barely change like blogs or portfolios?</p>\n<h2 id=\"the-new-way---jamstack\" style=\"position:relative;\"><a href=\"#the-new-way---jamstack\" aria-label=\"the new way   jamstack permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>The new way - JAMStack</h2>\n<p>JAMStack stands for <code class=\"language-text\">JavaScript, API &amp; Markup - Stack</code> and it‚Äôs here to bring the best of the old ways into our lives. With JAMStack I can create my website the same way I‚Äôd do it using PHP, but instead of having the data processed on every request, I can code my whole website, pre-compile it once, and then serve it as static HTML + JavaScript files. This is super useful for websites like this one, and this technique is nothing new, all our desktop apps are pre-compiled and served ‚Äústatically‚Äù - let‚Äôs forget about SaaS for a second ok?</p>\n<p>For example on this website, I have a template for a blog post page, and then I fill this template with data from a Markdown file. This file structure is something like this:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">- website\r\n      - index.html\r\n  - pages\r\n      - home.html\r\n      - contact.html\r\n  - templates\r\n      - blog-posts.html\r\n  - content\r\n      - my-first-post.md\r\n      - my-second-post.md</code></pre></div>\n<p>I‚Äôm using Gatsby to make <a href=\"https://pablo.gg/\" target=\"_blank\" rel=\"noreferrer\">this</a> website, so I can write everything using React components, and the Gatsby framework compiles everything into a bunch of HTML files that are served to the browser.</p>\n<h2 id=\"where-to-start\" style=\"position:relative;\"><a href=\"#where-to-start\" aria-label=\"where to start permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Where to start?</h2>\n<p>Before trying Gatsby, I started with <a href=\"https://jekyllrb.com/\" target=\"_blank\" rel=\"noreferrer\">Jekyll</a>, which was a way to create a <a href=\"https://jekyllrb.com/docs/github-pages/\" target=\"_blank\" rel=\"noreferrer\">JAMStack blog and deploy it for free on GitHub Pages</a>, that‚Äôs all I needed, but first I had to convert all my posts from my 12 years old WordPress blog into Markdown files with <a href=\"https://hexo.io/docs/front-matter.html\" target=\"_blank\" rel=\"noreferrer\">frontmatter</a> variables.</p>\n<p>WordPress posts are (generally) stored in a database, so I need a way to pull these data and save it as a Markdown file, and the easiest way is to simply use a WordPress plugin, like <a href=\"https://github.com/benbalter/wordpress-to-jekyll-exporter\" target=\"_blank\" rel=\"noreferrer\">wordpress-to-jekyll-exporter</a>. If you don‚Äôt have access to your blog anymore, but still have your <code class=\"language-text\">database.sql</code> file (like me üòÖ) just <a href=\"https://wordpress.org/support/article/installing-wordpress-on-your-own-computer/\" target=\"_blank\" rel=\"noreferrer\">boot up a local version of WordPress</a> to exports your posts.</p>\n<p>I also created a <a href=\"https://gist.github.com/blopa/a6e49c798cf0fd5c875025c6ae282064\" target=\"_blank\" rel=\"noreferrer\">Python script</a> to change some data from the generated Markdown files to fit some of my needs.</p>\n<p>I had over 100 posts in my old blog, so it was a big surprise to me to know that there was <a href=\"https://pages.github.com/versions/\" target=\"_blank\" rel=\"noreferrer\">no way to use a Jekyll pagination plugin v2</a> and automatically deploy it to GitHub Pages, so I decided to look for other solutions.</p>\n<h2 id=\"the-great-gatsby\" style=\"position:relative;\"><a href=\"#the-great-gatsby\" aria-label=\"the great gatsby permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>The Great Gatsby</h2>\n<p>Since I already know React, going with Gatsby was a no-brainer, and they have excellent documentation and lots of plugins and tutorials and with the release of <a href=\"https://github.com/features/actions\" target=\"_blank\" rel=\"noreferrer\">GitHub Actions</a>, it was possible to build and deploy Gatsby within the GitHub environment without having to use an external service like <a href=\"https://travis-ci.org/\" target=\"_blank\" rel=\"noreferrer\">travis-ci.org</a>. Not only that, but I could even have my source-code in a private repo and deploy it to a public repo, this way I can have draft posts without them being public in the codebase.</p>\n<p>First I made <a href=\"https://github.com/blopa/gatsby-material-ui-starter\" target=\"_blank\" rel=\"noreferrer\">this</a> repo based on the instructions from <a href=\"https://github.com/mui-org/material-ui/tree/master/examples/gatsby\" target=\"_blank\" rel=\"noreferrer\">this</a> MUI repo. All it does is link together the Material UI React library into Gatsby.</p>\n<p>The next step was getting the <a href=\"https://github.com/blopa/gatsby-material-ui-starter\" target=\"_blank\" rel=\"noreferrer\">gatsby-material-ui-starter</a> as a template to add all my blog logic, but first I needed a list of all the features I wanted in my blog, and those were:</p>\n<ul>\n<li>Home page with posts listing</li>\n<li>Blog page with posts listing</li>\n<li>Blog post page with related posts</li>\n<li>Archive page with pagination</li>\n<li>Comments section</li>\n<li>Contact page</li>\n<li>Albums page with photos from Google Photos</li>\n<li>Search</li>\n<li>NO SERVERS</li>\n</ul>\n<p>Everything sounds pretty reasonable until you remember this all needs to be done with JAMStack and no servers. Is this even possible? Yes, it is. Gatsby and React are really powerful tools.</p>\n<h2 id=\"posts-listing-and-related-posts\" style=\"position:relative;\"><a href=\"#posts-listing-and-related-posts\" aria-label=\"posts listing and related posts permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Posts listing and related posts</h2>\n<p>Gatsby gives me a simple GraphQL API to get data from my Markdown files, and this can be done easily using the <a href=\"https://github.com/gatsbyjs/gatsby/tree/master/packages/gatsby-transformer-remark\" target=\"_blank\" rel=\"noreferrer\">gatsby-transformer-remark</a> plugin, so then I can query my posts with:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> pageQuery <span class=\"token operator\">=</span> graphql<span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">\r\n    query Posts($locale: String) {\r\n        allMarkdownRemark(\r\n            filter: {\r\n                fields: { locale: { eq: $locale } }\r\n                frontmatter: { show: { eq: true } }\r\n            }\r\n            sort: { fields: [frontmatter___date], order: DESC }\r\n        ) {\r\n            edges {\r\n                node {\r\n                    excerpt\r\n                    fields {\r\n                        slug\r\n                        path\r\n                        locale\r\n                    }\r\n                    frontmatter {\r\n                        date\r\n                        title\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>If you want to know more on how to create your own Gatsby blog from scratch, please follow <a href=\"https://www.gatsbyjs.com/blog/2017-07-19-creating-a-blog-with-gatsby/\" target=\"_blank\" rel=\"noreferrer\">their official tutorial</a> on it.</p>\n<p>For the related posts, I decided to get all my posts and check on each one of them which other posts had the most common tags with it, and then add the top 3 related posts to that post related posts, this might not be the most efficient way to do this, but remember that I‚Äôm only compiling the website once, so that‚Äôs ok üòä</p>\n<h2 id=\"pagination\" style=\"position:relative;\"><a href=\"#pagination\" aria-label=\"pagination permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Pagination</h2>\n<p>Material UI already has a <a href=\"https://material-ui.com/components/pagination/\" target=\"_blank\" rel=\"noreferrer\">pagination component</a>, so I created an <code class=\"language-text\">Archive.jsx</code> template that takes a list of posts, a total pages number and the number of the current page, and then during the <a href=\"https://www.gatsbyjs.com/docs/reference/config-files/gatsby-node/\" target=\"_blank\" rel=\"noreferrer\">Gatsby compilation process</a> I create a bunch of archive pages using my template and that‚Äôs it, easy!</p>\n<h2 id=\"search\" style=\"position:relative;\"><a href=\"#search\" aria-label=\"search permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Search</h2>\n<p>Since Gatsby uses super modern JavaScript technologies, creating a local search should be pretty easy, right? YES! There is even <a href=\"https://github.com/angeloashmore/gatsby-plugin-local-search\" target=\"_blank\" rel=\"noreferrer\">a plugin</a> for it already! Noice!</p>\n<p>Just follow <a href=\"https://labs.walltowall.com/easy-client-side-search-for-gatsby-sites/\" target=\"_blank\" rel=\"noreferrer\">this tutorial</a> and combine the code with the <a href=\"https://material-ui.com/components/autocomplete/\" target=\"_blank\" rel=\"noreferrer\">Material UI autocomplete component</a> to create a <code class=\"language-text\">SearchBar</code> component like the one in this blog.</p>\n<h2 id=\"google-photos-integration\" style=\"position:relative;\"><a href=\"#google-photos-integration\" aria-label=\"google photos integration permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Google Photos integration</h2>\n<p>The bad part about JAMStack is that my git repo will contain not only all my codebase, but also all my content data, including photos, etc, and this can get real big real fast.</p>\n<p>Of course, I could consume my data from an external API instead of from Markdown files and this will already help a bit, but being able to not store photos in the repo will save a lot of space.</p>\n<p>Thanks to <a href=\"https://medium.com/@ValentinHervieu/how-i-used-google-photos-to-host-my-website-pictures-gallery-d49f037c8e3c\" target=\"_blank\" rel=\"noreferrer\">this nice post</a> by <a href=\"https://medium.com/@ValentinHervieu\" target=\"_blank\" rel=\"noreferrer\">@ValentinHervieu</a> we can get an idea on how to get the images URL from a Google Photos album URL, I can simply follow that post and add the code to my Gatsby building process.</p>\n<h2 id=\"multi-languages\" style=\"position:relative;\"><a href=\"#multi-languages\" aria-label=\"multi languages permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Multi-languages</h2>\n<p>As Portuguese is my native language, and I live outside Brazil, it is useful to be able to write posts in multiple languages, to be able to share them with my friends here and in Brazil, and for that, I need to add functionality to be able to create posts in different languages, and obviously <a href=\"https://github.com/wiziple/gatsby-plugin-intl\" target=\"_blank\" rel=\"noreferrer\">there is a Gatsby plugin for that</a>.</p>\n<p>This plugin is based on the famous <a href=\"https://formatjs.io/docs/react-intl/\" target=\"_blank\" rel=\"noreferrer\">React Intl</a>, and is very simple to use, just add a new object in the Gatsby plugin settings to pass an array with the codes of the languages you want to add and a path to where the translations for those languages will be. See below how this object looks like for this blog:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\">module<span class=\"token punctuation\">.</span>exports <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token operator\">...</span>config<span class=\"token punctuation\">,</span>\r\n    <span class=\"token literal-property property\">plugins</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">{</span>\r\n        <span class=\"token literal-property property\">resolve</span><span class=\"token operator\">:</span> <span class=\"token string\">'gatsby-plugin-intl'</span><span class=\"token punctuation\">,</span>\r\n        <span class=\"token literal-property property\">options</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\r\n            <span class=\"token literal-property property\">path</span><span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>__dirname<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">/src/intl</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\r\n            <span class=\"token literal-property property\">languages</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'en'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'pt-br'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\r\n            <span class=\"token literal-property property\">defaultLanguage</span><span class=\"token operator\">:</span> <span class=\"token string\">'en'</span><span class=\"token punctuation\">,</span>\r\n            <span class=\"token literal-property property\">redirect</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\r\n            <span class=\"token literal-property property\">redirectComponent</span><span class=\"token operator\">:</span> require<span class=\"token punctuation\">.</span><span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span><span class=\"token string\">'./src/utils/redirect.js'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\r\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\r\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\r\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>What this will do is whenever you create a page like <code class=\"language-text\">/contact/</code>, it will create a new page for each of the languages that you configured it for, like <code class=\"language-text\">/en/contact/</code> and <code class=\"language-text\">/pt-br/contact/</code>. Awesome. But what about blog posts? I don‚Äôt want to have paths like <code class=\"language-text\">/en/hello-world/</code> and <code class=\"language-text\">/pt-br/hello-world/</code>, I want <code class=\"language-text\">/en/hello-world/</code> and <code class=\"language-text\">/pt-br/ola-mundo/</code>.</p>\n<p>To have the same blog post in different languages, I create markdown files like <code class=\"language-text\">hello-world.en.md</code> and <code class=\"language-text\">hello-world.pt-br.md</code> and then I link them by the post title and post date, this way I can switch the language in the blog post page, and then see that same post in another language.</p>\n<p><img src=\"/2105ea55eebac25b4267be0420fbb6e5/language-switcher.gif\" alt=\"Language switcher\"></p>\n<h2 id=\"contact-page-and-comments-section\" style=\"position:relative;\"><a href=\"#contact-page-and-comments-section\" aria-label=\"contact page and comments section permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Contact page and comments section</h2>\n<p>There are a couple of services that offer commenting systems to your website, like <a href=\"https://disqus.com/\" target=\"_blank\" rel=\"noreferrer\">disqus.com</a> and <a href=\"https://developers.facebook.com/docs/plugins/comments/\" target=\"_blank\" rel=\"noreferrer\">Facebook Comments</a>, but Disqus‚Äô free plan will add ads to your site, and Facebook will require users to have a Facebook account to use it.</p>\n<p>After some research, I found out that it‚Äôs possible to use <a href=\"https://blog.webjeda.com/google-form-customize/\" target=\"_blank\" rel=\"noreferrer\">Google Forms as a commenting system</a> for my JAMStack blog.</p>\n<p>The comment data is stored in a Google Spreadsheet on your Google Drive, which can then be accessed in the Gatsby build process to pass all the comments to the appropriate blog posts.</p>\n<p>One caveat of using this system is that if I want the new comments to show up in my blog, I need to rebuild everything again, but let‚Äôs think of that as a process to approve/disapprove comments üòÑ, but also <a href=\"https://www.gatsbyjs.com/docs/reference/release-notes/v3.0/#incremental-builds-in-oss\" target=\"_blank\" rel=\"noreferrer\">if you configure everything properly, Gatsby rebuilds can be quite smart and cheap</a>.</p>\n<h2 id=\"github-actions\" style=\"position:relative;\"><a href=\"#github-actions\" aria-label=\"github actions permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>GitHub Actions</h2>\n<p>After all the coding and hacking, all that is left is to use GitHub Actions to build and deploy my website, and for that I simply create a <code class=\"language-text\">.github/workflows/deploy.yml</code> file in my GitHub repo with the following settings:</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Deploy to GitHub Pages\r\n<span class=\"token key atrule\">on</span><span class=\"token punctuation\">:</span>\r\n  <span class=\"token key atrule\">workflow_dispatch</span><span class=\"token punctuation\">:</span>\r\n  <span class=\"token key atrule\">push</span><span class=\"token punctuation\">:</span>\r\n    <span class=\"token key atrule\">branches</span><span class=\"token punctuation\">:</span>\r\n      <span class=\"token punctuation\">-</span> main\r\n\r\n<span class=\"token key atrule\">jobs</span><span class=\"token punctuation\">:</span>\r\n  <span class=\"token key atrule\">build-and-deploy</span><span class=\"token punctuation\">:</span>\r\n    <span class=\"token key atrule\">runs-on</span><span class=\"token punctuation\">:</span> ubuntu<span class=\"token punctuation\">-</span>latest\r\n    <span class=\"token key atrule\">steps</span><span class=\"token punctuation\">:</span>\r\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Checkout\r\n        <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> actions/checkout@v2.3.4\r\n        <span class=\"token key atrule\">with</span><span class=\"token punctuation\">:</span>\r\n          <span class=\"token key atrule\">persist-credentials</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">false</span>\r\n\r\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Install and Build üöß\r\n        <span class=\"token key atrule\">run</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">|</span><span class=\"token scalar string\">\r\n          npm cache clean --force\r\n          npm install\r\n          npm run clean\r\n          npm run build</span>\r\n\r\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Deploy üöÄ\r\n        <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> JamesIves/github<span class=\"token punctuation\">-</span>pages<span class=\"token punctuation\">-</span>deploy<span class=\"token punctuation\">-</span>action@4.1.1\r\n        <span class=\"token key atrule\">with</span><span class=\"token punctuation\">:</span>\r\n          <span class=\"token key atrule\">token</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> secrets.ACCESS_TOKEN <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\r\n          <span class=\"token key atrule\">repository-name</span><span class=\"token punctuation\">:</span> blopa/pablo.gg\r\n          <span class=\"token key atrule\">branch</span><span class=\"token punctuation\">:</span> gh<span class=\"token punctuation\">-</span>pages\r\n          <span class=\"token key atrule\">folder</span><span class=\"token punctuation\">:</span> public\r\n          <span class=\"token key atrule\">clean</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">true</span>\r\n          <span class=\"token key atrule\">single-commit</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">true</span></code></pre></div>\n<p>This will build the website every time I push to the <code class=\"language-text\">main</code> branch and then deploy it to <a href=\"https://github.com/blopa/pablo.gg\" target=\"_blank\" rel=\"noreferrer\">github.com/blopa/pablo.gg</a> so it can be accessed via <a href=\"https://pablo.gg/\" target=\"_blank\" rel=\"noreferrer\">https://pablo.gg/</a>.</p>\n<h2 id=\"why\" style=\"position:relative;\"><a href=\"#why\" aria-label=\"why permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Why</h2>\n<p>You might be wonder ‚Äúwhy don‚Äôt you simply spin a $1.00 server and run WordPress?‚Äù, and I tell you why, it‚Äôs not only a case of saving money, but it‚Äôs also one thing less to care about, and if I die or get into a coma I don‚Äôt know, my website will still be only - as long as GitHub Pages is available and free. And by using JAMStack you will automatically decrease de processing power used to serve your website, which then will also decrease CO2 emission and save the planet (or at least help a bit).</p>\n<h2 id=\"conclusion\" style=\"position:relative;\"><a href=\"#conclusion\" aria-label=\"conclusion permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Conclusion</h2>\n<p>Not only I learned a new React framework, but I also have a nice and light personal blog with $0.00 cost of hosting, and even if one day GitHub Actions and GitHub Pages go offline, I can still build my blog locally and deploy to any static hosting that would cost very little per year, so yay!</p>\n<p>Of course, I end up paying for the <a href=\"https://godaddy.com/tlds/gg-domain\" target=\"_blank\" rel=\"noreferrer\">.gg domain</a>, but if you want to go <em>full frugal</em> you can simply host your website using free domains like <a href=\"https://pages.github.com/\" target=\"_blank\" rel=\"noreferrer\">github.io</a> or <a href=\"https://freenom.com\" target=\"_blank\" rel=\"noreferrer\">freenom.com</a>.</p>","fields":{"postHashId":"Y29kaW5ndHJ1ZW51bGwyMDIxLTA0LTE3VDAwOjAwOjAwLjAwMFo=","slug":"/2021/2021-04-17-i-pay-0-in-hosting-for-this-website.en/","path":"/blog/coding/i-pay-0-in-hosting-for-this-website/","locale":"en"},"rawMarkdownBody":"When I was in college, web development wasn't a major part of programming as it is these days, I didn't have a single class on the web, and now I work with it every day. Pretty crazy.\r\n\r\nI remember learning some basic HTML back in school, around 1999, and making awesome looking websites like:\r\n\r\n![My website](../../uploads/blog/2021/04/my-website.gif)\r\n\r\n## The old ways\r\nBack in the old (Dreamweaver) days if I wanted to make a website, I would have something like this:\r\n\r\n```shell\r\n- website\r\n  - index.html\r\n  - about.html\r\n  - contact.html\r\n```\r\n\r\nThen for each of those files, I would have to write the full HTML for that page, even if all of them had the same header or logo, etc. In this example, there is no database, no dynamic data, no compilation, the website is 100% static, I can simply open these files in my browser locally and everything will work without the need of servers because HTML is pretty much just a plain text with steroids.\r\n\r\nOf course, this is far from ideal, so other solutions like PHP came in to allow us to make things a bit more dynamic.\r\n\r\n## Not that old ways\r\nWith PHP, I can split my HTML template into re-usable chunks, so I could easily boot up a WordPress website and set up the whole header layout, and then focus only on creating the content for the website.\r\n\r\nThe problem is that my browser doesn't understand PHP, so I need a server to convert all the PHP logic into static HTML, so every time someone requested to see a page on my website, the request would go to my server, which will process the PHP code and serve an HTML page and of course, this costs way more than simply serving static HTML files.\r\n\r\nA PHP website file structure would have something like this:\r\n\r\n```shell\r\n- website\r\n      - index.php\r\n      - header.php\r\n      - footer.php\r\n  - content\r\n      - home.php\r\n      - about.php\r\n      - contact.php\r\n```\r\n\r\nThis is where most of the websites are now, and with a good reason, Web 2.0 is complex and dynamics is needed... for most cases at least, but what about sites that barely change like blogs or portfolios?\r\n\r\n## The new way - JAMStack\r\nJAMStack stands for `JavaScript, API & Markup - Stack` and it's here to bring the best of the old ways into our lives. With JAMStack I can create my website the same way I'd do it using PHP, but instead of having the data processed on every request, I can code my whole website, pre-compile it once, and then serve it as static HTML + JavaScript files. This is super useful for websites like this one, and this technique is nothing new, all our desktop apps are pre-compiled and served \"statically\" - let's forget about SaaS for a second ok?\r\n\r\nFor example on this website, I have a template for a blog post page, and then I fill this template with data from a Markdown file. This file structure is something like this:\r\n\r\n```shell\r\n- website\r\n      - index.html\r\n  - pages\r\n      - home.html\r\n      - contact.html\r\n  - templates\r\n      - blog-posts.html\r\n  - content\r\n      - my-first-post.md\r\n      - my-second-post.md\r\n```\r\n\r\nI'm using Gatsby to make [this](https://pablo.gg/) website, so I can write everything using React components, and the Gatsby framework compiles everything into a bunch of HTML files that are served to the browser.\r\n\r\n## Where to start?\r\nBefore trying Gatsby, I started with [Jekyll](https://jekyllrb.com/), which was a way to create a [JAMStack blog and deploy it for free on GitHub Pages](https://jekyllrb.com/docs/github-pages/), that's all I needed, but first I had to convert all my posts from my 12 years old WordPress blog into Markdown files with [frontmatter](https://hexo.io/docs/front-matter.html) variables.\r\n\r\nWordPress posts are (generally) stored in a database, so I need a way to pull these data and save it as a Markdown file, and the easiest way is to simply use a WordPress plugin, like [wordpress-to-jekyll-exporter](https://github.com/benbalter/wordpress-to-jekyll-exporter). If you don't have access to your blog anymore, but still have your `database.sql` file (like me üòÖ) just [boot up a local version of WordPress](https://wordpress.org/support/article/installing-wordpress-on-your-own-computer/) to exports your posts.\r\n\r\nI also created a [Python script](https://gist.github.com/blopa/a6e49c798cf0fd5c875025c6ae282064) to change some data from the generated Markdown files to fit some of my needs.\r\n\r\nI had over 100 posts in my old blog, so it was a big surprise to me to know that there was [no way to use a Jekyll pagination plugin v2](https://pages.github.com/versions/) and automatically deploy it to GitHub Pages, so I decided to look for other solutions.\r\n\r\n## The Great Gatsby\r\nSince I already know React, going with Gatsby was a no-brainer, and they have excellent documentation and lots of plugins and tutorials and with the release of [GitHub Actions](https://github.com/features/actions), it was possible to build and deploy Gatsby within the GitHub environment without having to use an external service like [travis-ci.org](https://travis-ci.org/). Not only that, but I could even have my source-code in a private repo and deploy it to a public repo, this way I can have draft posts without them being public in the codebase.\r\n\r\nFirst I made [this](https://github.com/blopa/gatsby-material-ui-starter) repo based on the instructions from [this](https://github.com/mui-org/material-ui/tree/master/examples/gatsby) MUI repo. All it does is link together the Material UI React library into Gatsby.\r\n\r\nThe next step was getting the [gatsby-material-ui-starter](https://github.com/blopa/gatsby-material-ui-starter) as a template to add all my blog logic, but first I needed a list of all the features I wanted in my blog, and those were:\r\n\r\n- Home page with posts listing\r\n- Blog page with posts listing\r\n- Blog post page with related posts\r\n- Archive page with pagination\r\n- Comments section\r\n- Contact page\r\n- Albums page with photos from Google Photos\r\n- Search\r\n- NO SERVERS\r\n\r\nEverything sounds pretty reasonable until you remember this all needs to be done with JAMStack and no servers. Is this even possible? Yes, it is. Gatsby and React are really powerful tools.\r\n\r\n## Posts listing and related posts\r\nGatsby gives me a simple GraphQL API to get data from my Markdown files, and this can be done easily using the [gatsby-transformer-remark](https://github.com/gatsbyjs/gatsby/tree/master/packages/gatsby-transformer-remark) plugin, so then I can query my posts with:\r\n\r\n```javascript\r\nexport const pageQuery = graphql`\r\n    query Posts($locale: String) {\r\n        allMarkdownRemark(\r\n            filter: {\r\n                fields: { locale: { eq: $locale } }\r\n                frontmatter: { show: { eq: true } }\r\n            }\r\n            sort: { fields: [frontmatter___date], order: DESC }\r\n        ) {\r\n            edges {\r\n                node {\r\n                    excerpt\r\n                    fields {\r\n                        slug\r\n                        path\r\n                        locale\r\n                    }\r\n                    frontmatter {\r\n                        date\r\n                        title\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n`;\r\n```\r\n\r\nIf you want to know more on how to create your own Gatsby blog from scratch, please follow [their official tutorial](https://www.gatsbyjs.com/blog/2017-07-19-creating-a-blog-with-gatsby/) on it.\r\n\r\nFor the related posts, I decided to get all my posts and check on each one of them which other posts had the most common tags with it, and then add the top 3 related posts to that post related posts, this might not be the most efficient way to do this, but remember that I'm only compiling the website once, so that's ok üòä\r\n\r\n## Pagination\r\nMaterial UI already has a [pagination component](https://material-ui.com/components/pagination/), so I created an `Archive.jsx` template that takes a list of posts, a total pages number and the number of the current page, and then during the [Gatsby compilation process](https://www.gatsbyjs.com/docs/reference/config-files/gatsby-node/) I create a bunch of archive pages using my template and that's it, easy!\r\n\r\n## Search\r\nSince Gatsby uses super modern JavaScript technologies, creating a local search should be pretty easy, right? YES! There is even [a plugin](https://github.com/angeloashmore/gatsby-plugin-local-search) for it already! Noice!\r\n\r\nJust follow [this tutorial](https://labs.walltowall.com/easy-client-side-search-for-gatsby-sites/) and combine the code with the [Material UI autocomplete component](https://material-ui.com/components/autocomplete/) to create a `SearchBar` component like the one in this blog.\r\n\r\n## Google Photos integration\r\nThe bad part about JAMStack is that my git repo will contain not only all my codebase, but also all my content data, including photos, etc, and this can get real big real fast.\r\n\r\nOf course, I could consume my data from an external API instead of from Markdown files and this will already help a bit, but being able to not store photos in the repo will save a lot of space.\r\n\r\nThanks to [this nice post](https://medium.com/@ValentinHervieu/how-i-used-google-photos-to-host-my-website-pictures-gallery-d49f037c8e3c) by [@ValentinHervieu](https://medium.com/@ValentinHervieu) we can get an idea on how to get the images URL from a Google Photos album URL, I can simply follow that post and add the code to my Gatsby building process.\r\n\r\n## Multi-languages\r\nAs Portuguese is my native language, and I live outside Brazil, it is useful to be able to write posts in multiple languages, to be able to share them with my friends here and in Brazil, and for that, I need to add functionality to be able to create posts in different languages, and obviously [there is a Gatsby plugin for that](https://github.com/wiziple/gatsby-plugin-intl).\r\n\r\nThis plugin is based on the famous [React Intl](https://formatjs.io/docs/react-intl/), and is very simple to use, just add a new object in the Gatsby plugin settings to pass an array with the codes of the languages you want to add and a path to where the translations for those languages will be. See below how this object looks like for this blog:\r\n\r\n```javascript\r\nmodule.exports = {\r\n    ...config,\r\n    plugins: [{\r\n        resolve: 'gatsby-plugin-intl',\r\n        options: {\r\n            path: `${__dirname}/src/intl`,\r\n            languages: ['en', 'pt-br'],\r\n            defaultLanguage: 'en',\r\n            redirect: true,\r\n            redirectComponent: require.resolve('./src/utils/redirect.js'),\r\n        },\r\n    }],\r\n};\r\n```\r\n\r\nWhat this will do is whenever you create a page like `/contact/`, it will create a new page for each of the languages that you configured it for, like `/en/contact/` and `/pt-br/contact/`. Awesome. But what about blog posts? I don't want to have paths like `/en/hello-world/` and `/pt-br/hello-world/`, I want `/en/hello-world/` and `/pt-br/ola-mundo/`.\r\n\r\nTo have the same blog post in different languages, I create markdown files like `hello-world.en.md` and `hello-world.pt-br.md` and then I link them by the post title and post date, this way I can switch the language in the blog post page, and then see that same post in another language.\r\n\r\n![Language switcher](../../uploads/blog/2021/04/language-switcher.gif)\r\n\r\n## Contact page and comments section\r\nThere are a couple of services that offer commenting systems to your website, like [disqus.com](https://disqus.com/) and [Facebook Comments](https://developers.facebook.com/docs/plugins/comments/), but Disqus' free plan will add ads to your site, and Facebook will require users to have a Facebook account to use it.\r\n\r\nAfter some research, I found out that it's possible to use [Google Forms as a commenting system](https://blog.webjeda.com/google-form-customize/) for my JAMStack blog.\r\n\r\nThe comment data is stored in a Google Spreadsheet on your Google Drive, which can then be accessed in the Gatsby build process to pass all the comments to the appropriate blog posts.\r\n\r\nOne caveat of using this system is that if I want the new comments to show up in my blog, I need to rebuild everything again, but let's think of that as a process to approve/disapprove comments üòÑ, but also [if you configure everything properly, Gatsby rebuilds can be quite smart and cheap](https://www.gatsbyjs.com/docs/reference/release-notes/v3.0/#incremental-builds-in-oss).\r\n\r\n## GitHub Actions\r\nAfter all the coding and hacking, all that is left is to use GitHub Actions to build and deploy my website, and for that I simply create a `.github/workflows/deploy.yml` file in my GitHub repo with the following settings:\r\n\r\n```yaml\r\nname: Deploy to GitHub Pages\r\non:\r\n  workflow_dispatch:\r\n  push:\r\n    branches:\r\n      - main\r\n\r\njobs:\r\n  build-and-deploy:\r\n    runs-on: ubuntu-latest\r\n    steps:\r\n      - name: Checkout\r\n        uses: actions/checkout@v2.3.4\r\n        with:\r\n          persist-credentials: false\r\n\r\n      - name: Install and Build üöß\r\n        run: |\r\n          npm cache clean --force\r\n          npm install\r\n          npm run clean\r\n          npm run build\r\n\r\n      - name: Deploy üöÄ\r\n        uses: JamesIves/github-pages-deploy-action@4.1.1\r\n        with:\r\n          token: ${{ secrets.ACCESS_TOKEN }}\r\n          repository-name: blopa/pablo.gg\r\n          branch: gh-pages\r\n          folder: public\r\n          clean: true\r\n          single-commit: true\r\n```\r\n\r\nThis will build the website every time I push to the `main` branch and then deploy it to [github.com/blopa/pablo.gg](https://github.com/blopa/pablo.gg) so it can be accessed via [https://pablo.gg/](https://pablo.gg/).\r\n\r\n## Why\r\nYou might be wonder \"why don't you simply spin a $1.00 server and run WordPress?\", and I tell you why, it's not only a case of saving money, but it's also one thing less to care about, and if I die or get into a coma I don't know, my website will still be only - as long as GitHub Pages is available and free. And by using JAMStack you will automatically decrease de processing power used to serve your website, which then will also decrease CO2 emission and save the planet (or at least help a bit).\r\n\r\n## Conclusion\r\nNot only I learned a new React framework, but I also have a nice and light personal blog with $0.00 cost of hosting, and even if one day GitHub Actions and GitHub Pages go offline, I can still build my blog locally and deploy to any static hosting that would cost very little per year, so yay!\r\n\r\nOf course, I end up paying for the [.gg domain](https://godaddy.com/tlds/gg-domain), but if you want to go *full frugal* you can simply host your website using free domains like [github.io](https://pages.github.com/) or [freenom.com](https://freenom.com).\r\n","frontmatter":{"tags":["jamstack","javascript","gatsby","reactjs","github","github pages","github actions","frugal","multi-languages","flexsearch","google photos","markdown"],"categories":["coding"],"allowComments":true,"publishOnMedium":false,"cover":null,"date":"2021-04-17T00:00:00.000Z","id":null,"path":"i-pay-0-in-hosting-for-this-website","show":true,"title":"I pay $0.00 in hosting for this website","hideExcerpt":false,"subtitle":""}}},{"node":{"excerpt":"Happy #quarantineversary! Oh yeah, it‚Äôs been one year, one‚Ä¶","html":"<p>Happy <a href=\"https://twitter.com/hashtag/quarantineversary?f=live\" target=\"_blank\" rel=\"noreferrer\">#quarantineversary</a>! Oh yeah, it‚Äôs been one year, one year since I was told to work from home for the next two weeks, and apparently, this includes give or take ~50 extra weeks - and counting.</p>\n<p>Fortunately, I had the privilege of keeping my job and gained the free time to invest in some personal projects, like <a href=\"/en/blog/tags/skate-platformer\">working on the Skate Platformer game</a>, learning React Hooks, playing lots and lots of videogames - something that I was struggling to find time to do in the past.</p>\n<p>I actually don‚Äôt have anything to add in this blog post, it just felt like I needed to write something about 2020, so why not? So here is a picture of my last day in the office vs a picture of my lunch today (free pizza sponsored by the hackathon at work):</p>\n<p><figure class=\"gatsby-resp-image-figure\" style=\"\">\n    <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1024px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 75%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAPABQDASIAAhEBAxEB/8QAGAAAAwEBAAAAAAAAAAAAAAAAAAEEAwX/xAAVAQEBAAAAAAAAAAAAAAAAAAABAv/aAAwDAQACEAMQAAAB0XMY3kZL/8QAGhABAAMAAwAAAAAAAAAAAAAAAQIDEgAiI//aAAgBAQABBQKxwyQejyEZW2L5wa8//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAGxAAAgMAAwAAAAAAAAAAAAAAAAECESESMTL/2gAIAQEABj8CSwxnslykX27Nxn//xAAbEAEAAwEAAwAAAAAAAAAAAAABABEhMVFxkf/aAAgBAQABPyEO2dd5OxB8NZMhB9mDCO0TS6gcfcqf/9oADAMBAAIAAwAAABBzH//EABURAQEAAAAAAAAAAAAAAAAAAAEA/9oACAEDAQE/ECAv/8QAFhEBAQEAAAAAAAAAAAAAAAAAAQAR/9oACAECAQE/EJXb/8QAHBABAAICAwEAAAAAAAAAAAAAAREhADFBUWGR/9oACAEBAAE/EJoPa3E6ru7cLDoEI0vXecxBZwvWMby9iWYr5j74YU2WWZRk6AYfaM//2Q=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Last day in the office\"\n        title=\"Last day in the office\"\n        src=\"/static/841023e8bc81cea51096b4b07fa0ff89/63217/IMG_20200312.jpg\"\n        srcset=\"/static/841023e8bc81cea51096b4b07fa0ff89/db830/IMG_20200312.jpg 256w,\n/static/841023e8bc81cea51096b4b07fa0ff89/8102f/IMG_20200312.jpg 512w,\n/static/841023e8bc81cea51096b4b07fa0ff89/63217/IMG_20200312.jpg 1024w,\n/static/841023e8bc81cea51096b4b07fa0ff89/d58d1/IMG_20200312.jpg 1536w,\n/static/841023e8bc81cea51096b4b07fa0ff89/09658/IMG_20200312.jpg 2048w,\n/static/841023e8bc81cea51096b4b07fa0ff89/08826/IMG_20200312.jpg 3264w\"\n        sizes=\"(max-width: 1024px) 100vw, 1024px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\">Last day in the office</figcaption>\n  </figure>\r\n<figure class=\"gatsby-resp-image-figure\" style=\"\">\n    <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1024px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 133.203125%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAbABQDASIAAhEBAxEB/8QAGQAAAgMBAAAAAAAAAAAAAAAAAAMBAgQF/8QAFwEAAwEAAAAAAAAAAAAAAAAAAQIDBP/aAAwDAQACEAMQAAAB1xy9ILyRWSxtYtJQ0S//xAAcEAEAAgIDAQAAAAAAAAAAAAABAAIDERASISL/2gAIAQEAAQUCrZW5NsvnstL/AD3lgcgaiaeD2f/EABkRAQACAwAAAAAAAAAAAAAAAAABEQISIf/aAAgBAwEBPwGutGaof//EABgRAAMBAQAAAAAAAAAAAAAAAAABEQMS/9oACAECAQE/ATsxdZWf/8QAHRAAAgICAwEAAAAAAAAAAAAAABEBIUFRECAzcf/aAAgBAQAGPwKGrwPR5itmZ+8JXsURXSz/xAAcEAEAAgMBAQEAAAAAAAAAAAABABEhMUFRYYH/2gAIAQEAAT8hWKjwyfsKwJeh7LQuz9ZRKBijVTfHLUCeRiKot9SvSByFU77UN32G2YLVz//aAAwDAQACAAMAAAAQ3xk9/8QAFxEBAQEBAAAAAAAAAAAAAAAAAQAQIf/aAAgBAwEBPxACAzyRH//EABkRAQACAwAAAAAAAAAAAAAAAAEAEBEhUf/aAAgBAgEBPxBUMtNFwjD/xAAeEAEAAgMAAgMAAAAAAAAAAAABABEhMUFRYYGR8f/aAAgBAQABPxBsSDF5Ne31KlIKpm/CXAaM0SzszuDa9uHoyy11Xvx8S1zKa1B/mUNH8nJkFN+5UJQHgGA0GFX2oBB0xrIQpa8J/9k='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Healthy lunch... not\"\n        title=\"Healthy lunch... not\"\n        src=\"/static/29060b3b6d7ca48c75fec59ae15c07f7/63217/IMG_20210312.jpg\"\n        srcset=\"/static/29060b3b6d7ca48c75fec59ae15c07f7/db830/IMG_20210312.jpg 256w,\n/static/29060b3b6d7ca48c75fec59ae15c07f7/8102f/IMG_20210312.jpg 512w,\n/static/29060b3b6d7ca48c75fec59ae15c07f7/63217/IMG_20210312.jpg 1024w,\n/static/29060b3b6d7ca48c75fec59ae15c07f7/5bcb7/IMG_20210312.jpg 1471w\"\n        sizes=\"(max-width: 1024px) 100vw, 1024px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\">Healthy lunch... not</figcaption>\n  </figure></p>\n<p>My beard got bigger üëÄ</p>","fields":{"postHashId":"Z2VuZXJhbHRydWVudWxsMjAyMS0wMy0xMlQwMDowMDowMC4wMDBa","slug":"/2021/2021-03-12-one-year-of-working-from-home.en/","path":"/blog/general/one-year-of-working-from-home/","locale":"en"},"rawMarkdownBody":"Happy [#quarantineversary](https://twitter.com/hashtag/quarantineversary?f=live)! Oh yeah, it's been one year, one year since I was told to work from home for the next two weeks, and apparently, this includes give or take ~50 extra weeks - and counting.\r\n\r\nFortunately, I had the privilege of keeping my job and gained the free time to invest in some personal projects, like [working on the Skate Platformer game](/en/blog/tags/skate-platformer), learning React Hooks, playing lots and lots of videogames - something that I was struggling to find time to do in the past.\r\n\r\nI actually don't have anything to add in this blog post, it just felt like I needed to write something about 2020, so why not? So here is a picture of my last day in the office vs a picture of my lunch today (free pizza sponsored by the hackathon at work):\r\n\r\n![Last day in the office](../../uploads/blog/2021/03/IMG_20200312.jpg)\r\n![Healthy lunch... not](../../uploads/blog/2021/03/IMG_20210312.jpg)\r\n\r\nMy beard got bigger üëÄ\r\n","frontmatter":{"tags":["quarantineversary","working from home","wfh"],"categories":["general"],"allowComments":true,"publishOnMedium":false,"cover":null,"date":"2021-03-12T00:00:00.000Z","id":null,"path":"one-year-of-working-from-home","show":true,"title":"One year of working from home","hideExcerpt":false,"subtitle":""}}},{"node":{"excerpt":"Feliz #quarantineversary! Oh yeah, j√° faz um ano, um ano‚Ä¶","html":"<p>Feliz <a href=\"https://twitter.com/hashtag/quarantineversary?f=live\" target=\"_blank\" rel=\"noreferrer\">#quarantineversary</a>! Oh yeah, j√° faz um ano, um ano desde que me pediram para trabalhar de casa por duas semanas e, aparentemente, isso inclui mais ou menos umas ~50 semanas extras - e contando.</p>\n<p>Felizmente tive o privil√©gio de manter o meu emprego e ainda ganhar um monte de tempo livre para investir em alguns projetos pessoais, como <a href=\"/pt-br/blog/tags/skate-platformer\">trabalhar no jogo Skate Platformer</a>, aprender React Hooks, jogar muito videogame - algo que eu estava lutando para encontrar tempo para fazer no passado.</p>\n<p>Na verdade, n√£o tenho nada a acrescentar nesse post, apenas senti que precisava escrever algo sobre 2020, ent√£o why not? Para encerrar, aqui est√° uma foto do meu √∫ltimo dia no escrit√≥rio versus uma foto do meu almo√ßo hoje (pizza gr√°tis patrocinada pelo hackathon no trabalho):</p>\n<p><figure class=\"gatsby-resp-image-figure\" style=\"\">\n    <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1024px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 75%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAPABQDASIAAhEBAxEB/8QAGAAAAwEBAAAAAAAAAAAAAAAAAAEEAwX/xAAVAQEBAAAAAAAAAAAAAAAAAAABAv/aAAwDAQACEAMQAAAB0XMY3kZL/8QAGhABAAMAAwAAAAAAAAAAAAAAAQIDEgAiI//aAAgBAQABBQKxwyQejyEZW2L5wa8//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAGxAAAgMAAwAAAAAAAAAAAAAAAAECESESMTL/2gAIAQEABj8CSwxnslykX27Nxn//xAAbEAEAAwEAAwAAAAAAAAAAAAABABEhMVFxkf/aAAgBAQABPyEO2dd5OxB8NZMhB9mDCO0TS6gcfcqf/9oADAMBAAIAAwAAABBzH//EABURAQEAAAAAAAAAAAAAAAAAAAEA/9oACAEDAQE/ECAv/8QAFhEBAQEAAAAAAAAAAAAAAAAAAQAR/9oACAECAQE/EJXb/8QAHBABAAICAwEAAAAAAAAAAAAAAREhADFBUWGR/9oACAEBAAE/EJoPa3E6ru7cLDoEI0vXecxBZwvWMby9iWYr5j74YU2WWZRk6AYfaM//2Q=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"√öltimo dia no escrit√≥rio\"\n        title=\"√öltimo dia no escrit√≥rio\"\n        src=\"/static/841023e8bc81cea51096b4b07fa0ff89/63217/IMG_20200312.jpg\"\n        srcset=\"/static/841023e8bc81cea51096b4b07fa0ff89/db830/IMG_20200312.jpg 256w,\n/static/841023e8bc81cea51096b4b07fa0ff89/8102f/IMG_20200312.jpg 512w,\n/static/841023e8bc81cea51096b4b07fa0ff89/63217/IMG_20200312.jpg 1024w,\n/static/841023e8bc81cea51096b4b07fa0ff89/d58d1/IMG_20200312.jpg 1536w,\n/static/841023e8bc81cea51096b4b07fa0ff89/09658/IMG_20200312.jpg 2048w,\n/static/841023e8bc81cea51096b4b07fa0ff89/08826/IMG_20200312.jpg 3264w\"\n        sizes=\"(max-width: 1024px) 100vw, 1024px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\">√öltimo dia no escrit√≥rio</figcaption>\n  </figure>\r\n<figure class=\"gatsby-resp-image-figure\" style=\"\">\n    <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1024px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 133.203125%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAbABQDASIAAhEBAxEB/8QAGQAAAgMBAAAAAAAAAAAAAAAAAAMBAgQF/8QAFwEAAwEAAAAAAAAAAAAAAAAAAQIDBP/aAAwDAQACEAMQAAAB1xy9ILyRWSxtYtJQ0S//xAAcEAEAAgIDAQAAAAAAAAAAAAABAAIDERASISL/2gAIAQEAAQUCrZW5NsvnstL/AD3lgcgaiaeD2f/EABkRAQACAwAAAAAAAAAAAAAAAAABEQISIf/aAAgBAwEBPwGutGaof//EABgRAAMBAQAAAAAAAAAAAAAAAAABEQMS/9oACAECAQE/ATsxdZWf/8QAHRAAAgICAwEAAAAAAAAAAAAAABEBIUFRECAzcf/aAAgBAQAGPwKGrwPR5itmZ+8JXsURXSz/xAAcEAEAAgMBAQEAAAAAAAAAAAABABEhMUFRYYH/2gAIAQEAAT8hWKjwyfsKwJeh7LQuz9ZRKBijVTfHLUCeRiKot9SvSByFU77UN32G2YLVz//aAAwDAQACAAMAAAAQ3xk9/8QAFxEBAQEBAAAAAAAAAAAAAAAAAQAQIf/aAAgBAwEBPxACAzyRH//EABkRAQACAwAAAAAAAAAAAAAAAAEAEBEhUf/aAAgBAgEBPxBUMtNFwjD/xAAeEAEAAgMAAgMAAAAAAAAAAAABABEhMUFRYYGR8f/aAAgBAQABPxBsSDF5Ne31KlIKpm/CXAaM0SzszuDa9uHoyy11Xvx8S1zKa1B/mUNH8nJkFN+5UJQHgGA0GFX2oBB0xrIQpa8J/9k='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Almo√ßo saud√°vel sqn\"\n        title=\"Almo√ßo saud√°vel sqn\"\n        src=\"/static/29060b3b6d7ca48c75fec59ae15c07f7/63217/IMG_20210312.jpg\"\n        srcset=\"/static/29060b3b6d7ca48c75fec59ae15c07f7/db830/IMG_20210312.jpg 256w,\n/static/29060b3b6d7ca48c75fec59ae15c07f7/8102f/IMG_20210312.jpg 512w,\n/static/29060b3b6d7ca48c75fec59ae15c07f7/63217/IMG_20210312.jpg 1024w,\n/static/29060b3b6d7ca48c75fec59ae15c07f7/5bcb7/IMG_20210312.jpg 1471w\"\n        sizes=\"(max-width: 1024px) 100vw, 1024px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\">Almo√ßo saud√°vel sqn</figcaption>\n  </figure></p>\n<p>Minha barba cresceu bastante üëÄ</p>","fields":{"postHashId":"Z2VuZXJhbHRydWVudWxsMjAyMS0wMy0xMlQwMDowMDowMC4wMDBa","slug":"/2021/2021-03-12-um-ano-de-home-office.pt-br/","path":"/blog/general/um-ano-de-home-office/","locale":"pt-br"},"rawMarkdownBody":"Feliz [#quarantineversary](https://twitter.com/hashtag/quarantineversary?f=live)! Oh yeah, j√° faz um ano, um ano desde que me pediram para trabalhar de casa por duas semanas e, aparentemente, isso inclui mais ou menos umas ~50 semanas extras - e contando.\r\n\r\nFelizmente tive o privil√©gio de manter o meu emprego e ainda ganhar um monte de tempo livre para investir em alguns projetos pessoais, como [trabalhar no jogo Skate Platformer](/pt-br/blog/tags/skate-platformer), aprender React Hooks, jogar muito videogame - algo que eu estava lutando para encontrar tempo para fazer no passado.\r\n\r\nNa verdade, n√£o tenho nada a acrescentar nesse post, apenas senti que precisava escrever algo sobre 2020, ent√£o why not? Para encerrar, aqui est√° uma foto do meu √∫ltimo dia no escrit√≥rio versus uma foto do meu almo√ßo hoje (pizza gr√°tis patrocinada pelo hackathon no trabalho):\r\n\r\n![√öltimo dia no escrit√≥rio](../../uploads/blog/2021/03/IMG_20200312.jpg)\r\n![Almo√ßo saud√°vel sqn](../../uploads/blog/2021/03/IMG_20210312.jpg)\r\n\r\nMinha barba cresceu bastante üëÄ\r\n","frontmatter":{"tags":["quarantineversary","trabalhando de casa","home office","wfh"],"categories":["general"],"allowComments":true,"publishOnMedium":false,"cover":null,"date":"2021-03-12T00:00:00.000Z","id":null,"path":"um-ano-de-home-office","show":true,"title":"Um ano de home office","hideExcerpt":false,"subtitle":""}}},{"node":{"excerpt":"Well isn‚Äôt that something? Less than 7 days after failing to‚Ä¶","html":"<p>Well isn‚Äôt that something? Less than 7 days after <a href=\"/en/blog/general/godammit-whatsapp/\">failing to restore my messages backup on Whatsapp</a>, Telegram announced that you can now <a href=\"https://telegram.org/blog/move-history/\" target=\"_blank\" rel=\"noreferrer\">import messages from other chat apps</a>. Like, godammit Telegram, how can it be so awesome? Since this last update, you can import your message history from WhatsApp, Line, and KakaoTalk, to do that you need to export your chat from, let‚Äôs say Whatsapp, and share it to your equivalent contact on Telegram.</p>\n<p><img src=\"/a1e04df6ad4fb7475359d1ae76aacc63/importing-to-telegram.gif\" alt=\"Importing to Telegram\"></p>\n<p>Telegram said they will eventually make an API available, so you can build your own scripts and import messages from any chat app. Awesome. But do we really need to wait? Uhmn not really. Let‚Äôs take a look at how the exported <code class=\"language-text\">.txt</code> file from Whatsapp looks like:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">8/13/10, 12:11 - Scott Pilgrim: What is the website for Amazon.ca?\r\n8/13/10, 12:12 - Wallace Wells: Amazon.ca...</code></pre></div>\n<p>So let‚Äôs say that like me, you only have access to your Whatsapp <code class=\"language-text\">msgstore.db</code> file, then you can‚Äôt export your messages from the Whatsapp app, right? In this case, you can use the <a href=\"https://github.com/andreas-mausch/whatsapp-viewer\" target=\"_blank\" rel=\"noreferrer\">Whatsapp Viewer</a> tool to export your chat message as a <code class=\"language-text\">JSON</code> file that looks like this:</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\r\n    <span class=\"token property\">\"key\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"0000000000000@s.whatsapp.net\"</span><span class=\"token punctuation\">,</span>\r\n    <span class=\"token property\">\"contactName\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Wallace Wells\"</span><span class=\"token punctuation\">,</span>\r\n    <span class=\"token property\">\"messages\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\r\n        <span class=\"token punctuation\">{</span>\r\n            <span class=\"token property\">\"timestamp\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"2010-08-13T12:11:00Z\"</span><span class=\"token punctuation\">,</span>\r\n            <span class=\"token property\">\"fromMe\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\r\n            <span class=\"token property\">\"type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"text\"</span><span class=\"token punctuation\">,</span>\r\n            <span class=\"token property\">\"text\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"What is the website for Amazon.ca?\"</span>\r\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\r\n        <span class=\"token punctuation\">{</span>\r\n            <span class=\"token property\">\"timestamp\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"2010-08-13T12:12:00Z\"</span><span class=\"token punctuation\">,</span>\r\n            <span class=\"token property\">\"fromMe\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\r\n            <span class=\"token property\">\"type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"text\"</span><span class=\"token punctuation\">,</span>\r\n            <span class=\"token property\">\"text\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Amazon.ca..\"</span>\r\n        <span class=\"token punctuation\">}</span>\r\n    <span class=\"token punctuation\">]</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Now all you have to do is load this <code class=\"language-text\">JSON</code> file with a simple <code class=\"language-text\">Node.js</code> (for example) script and save it as a <code class=\"language-text\">.txt</code> file using that pattern above.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span>\r\n    readFileSync<span class=\"token punctuation\">,</span>\r\n    writeFileSync<span class=\"token punctuation\">,</span>\r\n<span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'fs'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token keyword\">const</span> yourName <span class=\"token operator\">=</span> <span class=\"token string\">'Scott Pilgrim'</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// TODO put your name here</span>\r\n\r\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">convertMessageObjToTxt</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">messageObj<span class=\"token punctuation\">,</span> sender</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token comment\">// format \"2010-08-13T12:11:00Z\"</span>\r\n    <span class=\"token keyword\">const</span> dateObj <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Date</span><span class=\"token punctuation\">(</span>messageObj<span class=\"token punctuation\">.</span>timestamp<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">const</span> date <span class=\"token operator\">=</span> dateObj<span class=\"token punctuation\">.</span><span class=\"token function\">toLocaleDateString</span><span class=\"token punctuation\">(</span><span class=\"token string\">'en-US'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">const</span> time <span class=\"token operator\">=</span> dateObj<span class=\"token punctuation\">.</span><span class=\"token function\">toLocaleTimeString</span><span class=\"token punctuation\">(</span><span class=\"token string\">'en-US'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">hour12</span><span class=\"token operator\">:</span> <span class=\"token boolean\">false</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">slice</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n    <span class=\"token comment\">// format is \"M/DD/YY, HH:MM - Sender's Name: Message\"</span>\r\n    <span class=\"token keyword\">return</span> date <span class=\"token operator\">+</span> <span class=\"token string\">', '</span> <span class=\"token operator\">+</span> time <span class=\"token operator\">+</span> <span class=\"token string\">' - '</span> <span class=\"token operator\">+</span> sender <span class=\"token operator\">+</span> <span class=\"token string\">': '</span> <span class=\"token operator\">+</span> messageObj<span class=\"token punctuation\">.</span>text <span class=\"token operator\">+</span> <span class=\"token string\">'\\n'</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span>\r\n\r\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>process<span class=\"token punctuation\">.</span>argv<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token comment\">// read the JSON file</span>\r\n    <span class=\"token keyword\">const</span> chatJson <span class=\"token operator\">=</span> <span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">parse</span><span class=\"token punctuation\">(</span><span class=\"token function\">readFileSync</span><span class=\"token punctuation\">(</span>process<span class=\"token punctuation\">.</span>argv<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'utf8'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">let</span> txtContent <span class=\"token operator\">=</span> <span class=\"token string\">''</span><span class=\"token punctuation\">;</span>\r\n\r\n    chatJson<span class=\"token punctuation\">.</span>messages<span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">message</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n        txtContent <span class=\"token operator\">+=</span> <span class=\"token function\">convertMessageObjToTxt</span><span class=\"token punctuation\">(</span>\r\n            message<span class=\"token punctuation\">,</span>\r\n            message<span class=\"token punctuation\">.</span>fromMe <span class=\"token operator\">?</span> yourName <span class=\"token operator\">:</span> chatJson<span class=\"token punctuation\">.</span>contactName\r\n        <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n    <span class=\"token comment\">// save is as a .txt</span>\r\n    <span class=\"token function\">writeFileSync</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>process<span class=\"token punctuation\">.</span>argv<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">.txt</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span> txtContent<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>You can run the script with <code class=\"language-text\">node script.js your-json-file.json</code> and the result will be a <code class=\"language-text\">.txt</code> file that you can import into Telegram. Awesome, right? The only caveat is that you need to import this <code class=\"language-text\">.txt</code> via the Telegram mobile app only.</p>\n<p>So that‚Äôs it! While WhatsApp asks you to give away your privacy for a super shitty app, Telegram continues to be free, open-source (the app, not their servers), and with an awesome API that lets, you do almost anything. Pretty crazy.</p>","fields":{"postHashId":"Z2VuZXJhbHRydWVudWxsMjAyMS0wMS0zMVQwMDowMDowMC4wMDBa","slug":"/2021/2021-01-31-godammit-telegram.en/","path":"/blog/general/godammit-telegram/","locale":"en"},"rawMarkdownBody":"Well isn't that something? Less than 7 days after [failing to restore my messages backup on Whatsapp](/en/blog/general/godammit-whatsapp/), Telegram announced that you can now [import messages from other chat apps](https://telegram.org/blog/move-history/). Like, godammit Telegram, how can it be so awesome? Since this last update, you can import your message history from WhatsApp, Line, and KakaoTalk, to do that you need to export your chat from, let's say Whatsapp, and share it to your equivalent contact on Telegram.\r\n\r\n![Importing to Telegram](../../uploads/blog/2021/01/importing-to-telegram.gif)\r\n\r\nTelegram said they will eventually make an API available, so you can build your own scripts and import messages from any chat app. Awesome. But do we really need to wait? Uhmn not really. Let's take a look at how the exported `.txt` file from Whatsapp looks like:\r\n\r\n```\r\n8/13/10, 12:11 - Scott Pilgrim: What is the website for Amazon.ca?\r\n8/13/10, 12:12 - Wallace Wells: Amazon.ca...\r\n```\r\n\r\nSo let's say that like me, you only have access to your Whatsapp `msgstore.db` file, then you can't export your messages from the Whatsapp app, right? In this case, you can use the [Whatsapp Viewer](https://github.com/andreas-mausch/whatsapp-viewer) tool to export your chat message as a `JSON` file that looks like this:\r\n\r\n```json\r\n{\r\n    \"key\": \"0000000000000@s.whatsapp.net\",\r\n    \"contactName\": \"Wallace Wells\",\r\n    \"messages\": [\r\n        {\r\n            \"timestamp\": \"2010-08-13T12:11:00Z\",\r\n            \"fromMe\": true,\r\n            \"type\": \"text\",\r\n            \"text\": \"What is the website for Amazon.ca?\"\r\n        },\r\n        {\r\n            \"timestamp\": \"2010-08-13T12:12:00Z\",\r\n            \"fromMe\": false,\r\n            \"type\": \"text\",\r\n            \"text\": \"Amazon.ca..\"\r\n        }\r\n    ]\r\n}\r\n```\r\n\r\nNow all you have to do is load this `JSON` file with a simple `Node.js` (for example) script and save it as a `.txt` file using that pattern above.\r\n\r\n```javascript\r\nconst {\r\n    readFileSync,\r\n    writeFileSync,\r\n} = require('fs');\r\n\r\nconst yourName = 'Scott Pilgrim'; // TODO put your name here\r\n\r\nconst convertMessageObjToTxt = (messageObj, sender) => {\r\n    // format \"2010-08-13T12:11:00Z\"\r\n    const dateObj = new Date(messageObj.timestamp);\r\n    const date = dateObj.toLocaleDateString('en-US');\r\n    const time = dateObj.toLocaleTimeString('en-US', { hour12: false }).slice(0, 5);\r\n\r\n    // format is \"M/DD/YY, HH:MM - Sender's Name: Message\"\r\n    return date + ', ' + time + ' - ' + sender + ': ' + messageObj.text + '\\n';\r\n}\r\n\r\nif (process.argv[2]) {\r\n    // read the JSON file\r\n    const chatJson = JSON.parse(readFileSync(process.argv[2], 'utf8'));\r\n    let txtContent = '';\r\n\r\n    chatJson.messages.forEach((message) => {\r\n        txtContent += convertMessageObjToTxt(\r\n            message,\r\n            message.fromMe ? yourName : chatJson.contactName\r\n        );\r\n    });\r\n\r\n    // save is as a .txt\r\n    writeFileSync(`${process.argv[2]}.txt`, txtContent);\r\n}\r\n```\r\n\r\nYou can run the script with `node script.js your-json-file.json` and the result will be a `.txt` file that you can import into Telegram. Awesome, right? The only caveat is that you need to import this `.txt` via the Telegram mobile app only.\r\n\r\nSo that's it! While WhatsApp asks you to give away your privacy for a super shitty app, Telegram continues to be free, open-source (the app, not their servers), and with an awesome API that lets, you do almost anything. Pretty crazy.\r\n","frontmatter":{"tags":["whatsapp","sqlite","coding","backup","javascript","telegram","signal","nodejs","node"],"categories":["general"],"allowComments":true,"publishOnMedium":false,"cover":null,"date":"2021-01-31T00:00:00.000Z","id":null,"path":"godammit-telegram","show":true,"title":"Godammit Telegram!","hideExcerpt":false,"subtitle":""}}},{"node":{"excerpt":"Ora ora ora, esse Telegram t√° que t√°, eim? Menos de 7 dias‚Ä¶","html":"<p>Ora ora ora, esse Telegram t√° que t√°, eim? Menos de 7 dias depois de <a href=\"/pt-br/blog/general/tinha-que-ser-o-whatsapp-de-novo/\">n√£o conseguir restaurar o backup das minhas mensagens no Whatsapp</a>, o Telegram anunciou que agora voc√™ pode <a href=\"https://telegram.org/blog/move-history/pt-br\" target=\"_blank\" rel=\"noreferrer\">importar mensagens de outros aplicativos de chat</a>. Tinha que ser o Telegram denovo, n√£o √© mesmo? Como o Telegram consegue ser t√£o foda? Desde a √∫ltima atualiza√ß√£o voc√™ pode importar seu hist√≥rico de mensagens do WhatsApp, Line e KakaoTalk, para isso voc√™ precisa exportar seu chat do Whatsapp (por exemplo) e compartilh√°-lo com o contato equivalente no Telegram.</p>\n<p><img src=\"/a1e04df6ad4fb7475359d1ae76aacc63/importing-to-telegram.gif\" alt=\"Importando para o Telegram\"></p>\n<p>O Telegram disse que eventualmente disponibilizar√° uma API para que voc√™ possa construir seus pr√≥prios scripts e importar mensagens de qualquer aplicativo de chat, next level foda! Mas‚Ä¶ temos mesmo que esperar essa atualiza√ß√£o? Uhmn acho que n√£o eim. Vamos dar uma olhada como √© esse arquivo <code class=\"language-text\">.txt</code> exportado do Whatsapp:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">8/13/10, 12:11 - Scott Pilgrim: Qual √© o site da Amazon.ca?\r\n8/13/10, 12:12 - Wallace Wells: Amazon.ca..</code></pre></div>\n<p>Ent√£o digamos que, como eu, voc√™ s√≥ tenha acesso ao seu arquivo <code class=\"language-text\">msgstore.db</code> do Whatsapp, n√£o √© poss√≠vel exportar o chat do Whatsapp, certo? Neste caso voc√™ pode usar a ferramenta <a href=\"https://github.com/andreas-mausch/whatsapp-viewer\" target=\"_blank\" rel=\"noreferrer\">Whatsapp Viewer</a> para exportar suas mensagens para um arquivo <code class=\"language-text\">JSON</code>, que fica nesse formato:</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\r\n    <span class=\"token property\">\"key\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"0000000000000@s.whatsapp.net\"</span><span class=\"token punctuation\">,</span>\r\n    <span class=\"token property\">\"contactName\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Wallace Wells\"</span><span class=\"token punctuation\">,</span>\r\n    <span class=\"token property\">\"messages\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\r\n        <span class=\"token punctuation\">{</span>\r\n            <span class=\"token property\">\"timestamp\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"2010-08-13T12:11:00Z\"</span><span class=\"token punctuation\">,</span>\r\n            <span class=\"token property\">\"fromMe\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\r\n            <span class=\"token property\">\"type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"text\"</span><span class=\"token punctuation\">,</span>\r\n            <span class=\"token property\">\"text\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Qual √© o site da Amazon.ca?\"</span>\r\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\r\n        <span class=\"token punctuation\">{</span>\r\n            <span class=\"token property\">\"timestamp\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"2010-08-13T12:12:00Z\"</span><span class=\"token punctuation\">,</span>\r\n            <span class=\"token property\">\"fromMe\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\r\n            <span class=\"token property\">\"type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"text\"</span><span class=\"token punctuation\">,</span>\r\n            <span class=\"token property\">\"text\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Amazon.ca..\"</span>\r\n        <span class=\"token punctuation\">}</span>\r\n    <span class=\"token punctuation\">]</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Agora tudo que voc√™ precisa fazer √© carregar este arquivo <code class=\"language-text\">JSON</code> com um script qualquer e converte-lo para um <code class=\"language-text\">.txt</code> naquele formato. Vamos tentar fazer isso usando <code class=\"language-text\">Node.js</code>:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span>\r\n    readFileSync<span class=\"token punctuation\">,</span>\r\n    writeFileSync<span class=\"token punctuation\">,</span>\r\n<span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'fs'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token keyword\">const</span> yourName <span class=\"token operator\">=</span> <span class=\"token string\">'Scott Pilgrim'</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// TODO put your name here</span>\r\n\r\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">convertMessageObjToTxt</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">messageObj<span class=\"token punctuation\">,</span> sender</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token comment\">// format \"2010-08-13T12:11:00Z\"</span>\r\n    <span class=\"token keyword\">const</span> dateObj <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Date</span><span class=\"token punctuation\">(</span>messageObj<span class=\"token punctuation\">.</span>timestamp<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">const</span> date <span class=\"token operator\">=</span> dateObj<span class=\"token punctuation\">.</span><span class=\"token function\">toLocaleDateString</span><span class=\"token punctuation\">(</span><span class=\"token string\">'en-US'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">const</span> time <span class=\"token operator\">=</span> dateObj<span class=\"token punctuation\">.</span><span class=\"token function\">toLocaleTimeString</span><span class=\"token punctuation\">(</span><span class=\"token string\">'en-US'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">hour12</span><span class=\"token operator\">:</span> <span class=\"token boolean\">false</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">slice</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n    <span class=\"token comment\">// format is \"M/DD/YY, HH:MM - Sender's Name: Message\"</span>\r\n    <span class=\"token keyword\">return</span> date <span class=\"token operator\">+</span> <span class=\"token string\">', '</span> <span class=\"token operator\">+</span> time <span class=\"token operator\">+</span> <span class=\"token string\">' - '</span> <span class=\"token operator\">+</span> sender <span class=\"token operator\">+</span> <span class=\"token string\">': '</span> <span class=\"token operator\">+</span> messageObj<span class=\"token punctuation\">.</span>text <span class=\"token operator\">+</span> <span class=\"token string\">'\\n'</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span>\r\n\r\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>process<span class=\"token punctuation\">.</span>argv<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token comment\">// read the JSON file</span>\r\n    <span class=\"token keyword\">const</span> chatJson <span class=\"token operator\">=</span> <span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">parse</span><span class=\"token punctuation\">(</span><span class=\"token function\">readFileSync</span><span class=\"token punctuation\">(</span>process<span class=\"token punctuation\">.</span>argv<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'utf8'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">let</span> txtContent <span class=\"token operator\">=</span> <span class=\"token string\">''</span><span class=\"token punctuation\">;</span>\r\n\r\n    chatJson<span class=\"token punctuation\">.</span>messages<span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">message</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n        txtContent <span class=\"token operator\">+=</span> <span class=\"token function\">convertMessageObjToTxt</span><span class=\"token punctuation\">(</span>\r\n            message<span class=\"token punctuation\">,</span>\r\n            message<span class=\"token punctuation\">.</span>fromMe <span class=\"token operator\">?</span> yourName <span class=\"token operator\">:</span> chatJson<span class=\"token punctuation\">.</span>contactName\r\n        <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n    <span class=\"token comment\">// save is as a .txt</span>\r\n    <span class=\"token function\">writeFileSync</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>process<span class=\"token punctuation\">.</span>argv<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">.txt</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span> txtContent<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Execute esse script com o comando <code class=\"language-text\">node script.js seu-arquivo-json.json</code> e o resultado ser√° um arquivo <code class=\"language-text\">.txt</code> que voc√™ pode importar para o Telegram. Facinho, n√©? O √∫nico problema √© que voc√™ precisa importar este <code class=\"language-text\">.txt</code> pelo app de celular do Telegram.</p>\n<p>Ent√£o √© isso! Enquanto o WhatsApp pede que voc√™ ceda sua privacidade por um aplicativo super merda, o Telegram continua a ser gratuito, com c√≥digo aberto (o aplicativo, n√£o seus servidores) e com uma API incr√≠vel que permite fazer quase tudo. Muito foda!</p>","fields":{"postHashId":"Z2VuZXJhbHRydWVudWxsMjAyMS0wMS0zMVQwMDowMDowMC4wMDBa","slug":"/2021/2021-01-31-tinha-que-ser-o-telegram-de-novo.pt-br/","path":"/blog/general/tinha-que-ser-o-telegram-de-novo/","locale":"pt-br"},"rawMarkdownBody":"Ora ora ora, esse Telegram t√° que t√°, eim? Menos de 7 dias depois de [n√£o conseguir restaurar o backup das minhas mensagens no Whatsapp](/pt-br/blog/general/tinha-que-ser-o-whatsapp-de-novo/), o Telegram anunciou que agora voc√™ pode [importar mensagens de outros aplicativos de chat](https://telegram.org/blog/move-history/pt-br). Tinha que ser o Telegram denovo, n√£o √© mesmo? Como o Telegram consegue ser t√£o foda? Desde a √∫ltima atualiza√ß√£o voc√™ pode importar seu hist√≥rico de mensagens do WhatsApp, Line e KakaoTalk, para isso voc√™ precisa exportar seu chat do Whatsapp (por exemplo) e compartilh√°-lo com o contato equivalente no Telegram.\r\n\r\n![Importando para o Telegram](../../uploads/blog/2021/01/importing-to-telegram.gif)\r\n\r\nO Telegram disse que eventualmente disponibilizar√° uma API para que voc√™ possa construir seus pr√≥prios scripts e importar mensagens de qualquer aplicativo de chat, next level foda! Mas... temos mesmo que esperar essa atualiza√ß√£o? Uhmn acho que n√£o eim. Vamos dar uma olhada como √© esse arquivo `.txt` exportado do Whatsapp:\r\n\r\n```\r\n8/13/10, 12:11 - Scott Pilgrim: Qual √© o site da Amazon.ca?\r\n8/13/10, 12:12 - Wallace Wells: Amazon.ca..\r\n```\r\n\r\nEnt√£o digamos que, como eu, voc√™ s√≥ tenha acesso ao seu arquivo `msgstore.db` do Whatsapp, n√£o √© poss√≠vel exportar o chat do Whatsapp, certo? Neste caso voc√™ pode usar a ferramenta [Whatsapp Viewer](https://github.com/andreas-mausch/whatsapp-viewer) para exportar suas mensagens para um arquivo `JSON`, que fica nesse formato:\r\n\r\n```json\r\n{\r\n    \"key\": \"0000000000000@s.whatsapp.net\",\r\n    \"contactName\": \"Wallace Wells\",\r\n    \"messages\": [\r\n        {\r\n            \"timestamp\": \"2010-08-13T12:11:00Z\",\r\n            \"fromMe\": true,\r\n            \"type\": \"text\",\r\n            \"text\": \"Qual √© o site da Amazon.ca?\"\r\n        },\r\n        {\r\n            \"timestamp\": \"2010-08-13T12:12:00Z\",\r\n            \"fromMe\": false,\r\n            \"type\": \"text\",\r\n            \"text\": \"Amazon.ca..\"\r\n        }\r\n    ]\r\n}\r\n```\r\n\r\nAgora tudo que voc√™ precisa fazer √© carregar este arquivo `JSON` com um script qualquer e converte-lo para um `.txt` naquele formato. Vamos tentar fazer isso usando `Node.js`:\r\n\r\n```javascript\r\nconst {\r\n    readFileSync,\r\n    writeFileSync,\r\n} = require('fs');\r\n\r\nconst yourName = 'Scott Pilgrim'; // TODO put your name here\r\n\r\nconst convertMessageObjToTxt = (messageObj, sender) => {\r\n    // format \"2010-08-13T12:11:00Z\"\r\n    const dateObj = new Date(messageObj.timestamp);\r\n    const date = dateObj.toLocaleDateString('en-US');\r\n    const time = dateObj.toLocaleTimeString('en-US', { hour12: false }).slice(0, 5);\r\n\r\n    // format is \"M/DD/YY, HH:MM - Sender's Name: Message\"\r\n    return date + ', ' + time + ' - ' + sender + ': ' + messageObj.text + '\\n';\r\n}\r\n\r\nif (process.argv[2]) {\r\n    // read the JSON file\r\n    const chatJson = JSON.parse(readFileSync(process.argv[2], 'utf8'));\r\n    let txtContent = '';\r\n\r\n    chatJson.messages.forEach((message) => {\r\n        txtContent += convertMessageObjToTxt(\r\n            message,\r\n            message.fromMe ? yourName : chatJson.contactName\r\n        );\r\n    });\r\n\r\n    // save is as a .txt\r\n    writeFileSync(`${process.argv[2]}.txt`, txtContent);\r\n}\r\n```\r\n\r\nExecute esse script com o comando `node script.js seu-arquivo-json.json` e o resultado ser√° um arquivo `.txt` que voc√™ pode importar para o Telegram. Facinho, n√©? O √∫nico problema √© que voc√™ precisa importar este `.txt` pelo app de celular do Telegram.\r\n\r\nEnt√£o √© isso! Enquanto o WhatsApp pede que voc√™ ceda sua privacidade por um aplicativo super merda, o Telegram continua a ser gratuito, com c√≥digo aberto (o aplicativo, n√£o seus servidores) e com uma API incr√≠vel que permite fazer quase tudo. Muito foda!\r\n","frontmatter":{"tags":["whatsapp","sqlite","programa√ß√£o","backup","javascript","telegram","signal","nodejs","node"],"categories":["general"],"allowComments":true,"publishOnMedium":false,"cover":null,"date":"2021-01-31T00:00:00.000Z","id":null,"path":"tinha-que-ser-o-telegram-de-novo","show":true,"title":"Tinha que ser o Telegram de novo!","hideExcerpt":false,"subtitle":""}}},{"node":{"excerpt":"Whatsapp was in all news outlets recently due to its new‚Ä¶","html":"<p>Whatsapp was in all news outlets recently due to its new privacy policies, but this post is not about that. Oh no no, this post is about my 28 hours battle to restore my Whatsapp messages backup that led to nothing, well, kind of.</p>\n<p>Whatsapp isn‚Äôt really a good app, I think we all kind of know that? Like really, I need to have my phone connected to the internet to use the web version of it? WTF! But fine, we all use it because it‚Äôs the app that everyone uses, right? I mean what can you do? I feel you.</p>\n<p>I‚Äôm an early adopter of Whatsapp, back when they had a Symbian version of the app I was using it in my Nokia phone, so I‚Äôm using it for many and many years, and I always backup my chat history, first with <a href=\"https://play.google.com/store/apps/details?id=com.keramidas.TitaniumBackup\" target=\"_blank\" rel=\"noreferrer\">Titanium Backup</a> and then with the Google Drive integration, which was convenient because I didn‚Äôt have to root my phone and void the warranty.</p>\n<h2 id=\"so-what-happened\" style=\"position:relative;\"><a href=\"#so-what-happened\" aria-label=\"so what happened permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>So what happened?</h2>\n<p>I got a new phone, a <a href=\"https://www.gsmarena.com/oneplus_nord_n10_5g-10556.php\" target=\"_blank\" rel=\"noreferrer\">OnePlus Nord N10</a>, I know it‚Äôs not top-notch but it‚Äôs a good upgrade from a <a href=\"https://www.gsmarena.com/motorola_moto_z3_play-9003.php\" target=\"_blank\" rel=\"noreferrer\">Motorola Moto Z3 Play</a> and it has 5G, so I‚Äôm happy to help Bill Gates bring the New World Order for us via coronavirus.</p>\n<p>The truth is Whatsapp pisses me off, it‚Äôs a super simple yet super buggy and slow messaging app, that I only use to be able to talk to some friends that still don‚Äôt use Telegram (noobs). So before moving everything to my new phone, I made a new Whatsapp backup and straight away uninstalled the app from my phone, after all, why would I keep it? I hate it. Silly me‚Ä¶</p>\n<p>I started the process of restoring my Whatsapp backup via Google Drive on my new phone, and then when it hit 24% I got an error: <strong>Couldn‚Äôt restore messages</strong>. It‚Äôs 10GB of backup data, so I didn‚Äôt worry too much and decided to try again, well the thing is that to try again, you need to uninstall Whatsapp and install it again‚Ä¶ ok‚Ä¶</p>\n<p>So I did that, and to my surprise, same error, and there is no option to retry or change to restoring from the local storage no no no, if you want to retry, then uninstall and install it again. So I kept trying, different backup sources (local, cloud), different backup files, and then I wasn‚Äôt able to ask for an SMS for 2 hours?? lol ok. I waited, tried again, it didn‚Äôt work of course, and then I had to wait 7 hours. Awesome.</p>\n<p><figure class=\"gatsby-resp-image-figure\" style=\"\">\n    <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 576px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 222.265625%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAsABQDASIAAhEBAxEB/8QAGQAAAwEBAQAAAAAAAAAAAAAAAAECBAMF/8QAFQEBAQAAAAAAAAAAAAAAAAAAAAH/2gAMAwEAAhADEAAAAfCqAYhNDzsZIUc2tEB//8QAGxAAAQUBAQAAAAAAAAAAAAAAAQACESAhEBP/2gAIAQEAAQUCWVDAR5hOEHVJrPf/xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAEDAQE/AV//xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAECAQE/AV//xAAXEAADAQAAAAAAAAAAAAAAAAAAIDEw/9oACAEBAAY/Ampc/wD/xAAdEAACAQQDAAAAAAAAAAAAAAAAAREQIVFhIDGB/9oACAEBAAE/IRYWex+cFltjaLUicmbGXfdZJZJZLP/aAAwDAQACAAMAAAAQe/KDIw//xAAWEQEBAQAAAAAAAAAAAAAAAAABESD/2gAIAQMBAT8QGa//xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAECAQE/EF//xAAiEAEAAgEDAwUAAAAAAAAAAAABABExIVFhEIGhQXGx0fH/2gAIAQEAAT8QMVZUpzaMsT4ibyuQmkXoEQpdVEPX7Qb5Sr1gRQB7s/TYqXZeZ9Tv5iN/MNXVicziO9P/2Q=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Now let&#39;s wait 24h\"\n        title=\"Now let&#39;s wait 24h\"\n        src=\"/static/ac157d47debff09e795b787faedeee4d/17d4d/whatsapp-waiting-time.jpg\"\n        srcset=\"/static/ac157d47debff09e795b787faedeee4d/db830/whatsapp-waiting-time.jpg 256w,\n/static/ac157d47debff09e795b787faedeee4d/8102f/whatsapp-waiting-time.jpg 512w,\n/static/ac157d47debff09e795b787faedeee4d/17d4d/whatsapp-waiting-time.jpg 576w\"\n        sizes=\"(max-width: 576px) 100vw, 576px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\">Now let&#39;s wait 24h</figcaption>\n  </figure></p>\n<p>Then I started researching, <a href=\"https://www.google.com/search?q=whatsapp+restore+stuck+at+24&#x26;oq=whatsapp+restore+stuck+at+24%25\" target=\"_blank\" rel=\"noreferrer\">and many other people have the same problem</a>. I don‚Äôt understand how an app, from a billionaire company, can be so bad. I tried reaching out to customer support, and they said they couldn‚Äôt help me. It took me less than 5 minutes to restore my Signal backup to my new phone, and I was already 20 hours in trying to restore my Whatsapp backup.</p>\n<h2 id=\"ok-what-now\" style=\"position:relative;\"><a href=\"#ok-what-now\" aria-label=\"ok what now permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Ok what now?</h2>\n<p>I gave up. Yeah, seriously, I gave up. All I want to do now is to be able to access my chat history in any form possible like I have the backup files, so it must have a way, right?</p>\n<h2 id=\"1---root-your-phone\" style=\"position:relative;\"><a href=\"#1---root-your-phone\" aria-label=\"1   root your phone permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1 - Root your phone</h2>\n<p>That‚Äôs not super nice, but I had to do it, if you want to decrypt the <code class=\"language-text\">msgstore.db.crypt12</code> file from the Whatsapp backup, you‚Äôre going to need your Whatsapp encryption key, that is located on <code class=\"language-text\">/data/data/com.whatsapp/files/key</code>, and to be able to copy this file, you‚Äôre going to need root permissions.</p>\n<h2 id=\"2---decrypt-your-database-file\" style=\"position:relative;\"><a href=\"#2---decrypt-your-database-file\" aria-label=\"2   decrypt your database file permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2 - Decrypt your database file</h2>\n<p>Once you have the key, you can decrypt it via a <a href=\"https://github.com/CanciuCostin/crypt12-decrypt\" target=\"_blank\" rel=\"noreferrer\">Go script (or .exe)</a> or using the awesome <a href=\"https://github.com/andreas-mausch/whatsapp-viewer\" target=\"_blank\" rel=\"noreferrer\">Whatsapp Viewer</a> tool, that not only decrypts your backup file (which is an SQLite file) but also loads all your chats and allow you to export them to <code class=\"language-text\">HTML</code> or <code class=\"language-text\">JSON</code> one by one.</p>\n<h2 id=\"3---access-your-data\" style=\"position:relative;\"><a href=\"#3---access-your-data\" aria-label=\"3   access your data permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3 - Access your data</h2>\n<p>As I mentioned before, you can use the Whatsapp Viewer to view all your conversations, or you can even use an SQLite browser app and dive into the database yourself. I‚Äôve found a <a href=\"https://github.com/KnugiHK/Whatsapp-Chat-Exporter\" target=\"_blank\" rel=\"noreferrer\">really nice Python script on GitHub</a> (that is only 6 days old - lucky me) that allowed me to export all my chats at once to a single <code class=\"language-text\">JSON</code> file, and with this <code class=\"language-text\">JSON</code> file I can do whatever I want with my Whatsapp history, I might even use <a href=\"https://github.com/detaysoft/react-chat-elements#readme\" target=\"_blank\" rel=\"noreferrer\">react-chat-elements</a> to create a small <a href=\"https://www.gatsbyjs.com/\" target=\"_blank\" rel=\"noreferrer\">Gatsby</a> project to load all my messages, who knows.</p>\n<h2 id=\"the-lesson\" style=\"position:relative;\"><a href=\"#the-lesson\" aria-label=\"the lesson permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>The lesson</h2>\n<p>Whatsapp is bad, and you shouldn‚Äôt use it. Really. And I‚Äôm not even talking about the privacy thing, it‚Äôs just an awful app that lacks basic features that any messaging app nowadays should have, just use Telegram.</p>\n<p>With that said, I‚Äôm sadly still going to use it because I need to keep in touch with other people that only use Whatsapp, and even worse, I‚Äôm going to use it without my backup üò≠. At least now I know I can‚Äôt trust it and that there are other (unofficial) solutions to the backup restoration problem.</p>","fields":{"postHashId":"Z2VuZXJhbHRydWVudWxsMjAyMS0wMS0yNFQwMDowMDowMC4wMDBa","slug":"/2021/2021-01-24-godammit-whatsapp.en/","path":"/blog/general/godammit-whatsapp/","locale":"en"},"rawMarkdownBody":"Whatsapp was in all news outlets recently due to its new privacy policies, but this post is not about that. Oh no no, this post is about my 28 hours battle to restore my Whatsapp messages backup that led to nothing, well, kind of.\r\n\r\nWhatsapp isn't really a good app, I think we all kind of know that? Like really, I need to have my phone connected to the internet to use the web version of it? WTF! But fine, we all use it because it's the app that everyone uses, right? I mean what can you do? I feel you.\r\n\r\nI'm an early adopter of Whatsapp, back when they had a Symbian version of the app I was using it in my Nokia phone, so I'm using it for many and many years, and I always backup my chat history, first with [Titanium Backup](https://play.google.com/store/apps/details?id=com.keramidas.TitaniumBackup) and then with the Google Drive integration, which was convenient because I didn't have to root my phone and void the warranty.\r\n\r\n## So what happened?\r\n\r\nI got a new phone, a [OnePlus Nord N10](https://www.gsmarena.com/oneplus_nord_n10_5g-10556.php), I know it's not top-notch but it's a good upgrade from a [Motorola Moto Z3 Play](https://www.gsmarena.com/motorola_moto_z3_play-9003.php) and it has 5G, so I'm happy to help Bill Gates bring the New World Order for us via coronavirus.\r\n\r\nThe truth is Whatsapp pisses me off, it's a super simple yet super buggy and slow messaging app, that I only use to be able to talk to some friends that still don't use Telegram (noobs). So before moving everything to my new phone, I made a new Whatsapp backup and straight away uninstalled the app from my phone, after all, why would I keep it? I hate it. Silly me...\r\n\r\nI started the process of restoring my Whatsapp backup via Google Drive on my new phone, and then when it hit 24% I got an error: __Couldn't restore messages__. It's 10GB of backup data, so I didn't worry too much and decided to try again, well the thing is that to try again, you need to uninstall Whatsapp and install it again... ok...\r\n\r\nSo I did that, and to my surprise, same error, and there is no option to retry or change to restoring from the local storage no no no, if you want to retry, then uninstall and install it again. So I kept trying, different backup sources (local, cloud), different backup files, and then I wasn't able to ask for an SMS for 2 hours?? lol ok. I waited, tried again, it didn't work of course, and then I had to wait 7 hours. Awesome.\r\n\r\n![Now let's wait 24h](../../uploads/blog/2021/01/whatsapp-waiting-time.jpg)\r\n\r\nThen I started researching, [and many other people have the same problem](https://www.google.com/search?q=whatsapp+restore+stuck+at+24&oq=whatsapp+restore+stuck+at+24%25). I don't understand how an app, from a billionaire company, can be so bad. I tried reaching out to customer support, and they said they couldn't help me. It took me less than 5 minutes to restore my Signal backup to my new phone, and I was already 20 hours in trying to restore my Whatsapp backup.\r\n\r\n## Ok what now?\r\n\r\nI gave up. Yeah, seriously, I gave up. All I want to do now is to be able to access my chat history in any form possible like I have the backup files, so it must have a way, right?\r\n\r\n## 1 - Root your phone\r\n\r\nThat's not super nice, but I had to do it, if you want to decrypt the `msgstore.db.crypt12` file from the Whatsapp backup, you're going to need your Whatsapp encryption key, that is located on `/data/data/com.whatsapp/files/key`, and to be able to copy this file, you're going to need root permissions.\r\n\r\n## 2 - Decrypt your database file\r\n\r\nOnce you have the key, you can decrypt it via a [Go script (or .exe)](https://github.com/CanciuCostin/crypt12-decrypt) or using the awesome [Whatsapp Viewer](https://github.com/andreas-mausch/whatsapp-viewer) tool, that not only decrypts your backup file (which is an SQLite file) but also loads all your chats and allow you to export them to `HTML` or `JSON` one by one.\r\n\r\n## 3 - Access your data\r\n\r\nAs I mentioned before, you can use the Whatsapp Viewer to view all your conversations, or you can even use an SQLite browser app and dive into the database yourself. I've found a [really nice Python script on GitHub](https://github.com/KnugiHK/Whatsapp-Chat-Exporter) (that is only 6 days old - lucky me) that allowed me to export all my chats at once to a single `JSON` file, and with this `JSON` file I can do whatever I want with my Whatsapp history, I might even use [react-chat-elements](https://github.com/detaysoft/react-chat-elements#readme) to create a small [Gatsby](https://www.gatsbyjs.com/) project to load all my messages, who knows.\r\n\r\n## The lesson\r\n\r\nWhatsapp is bad, and you shouldn't use it. Really. And I'm not even talking about the privacy thing, it's just an awful app that lacks basic features that any messaging app nowadays should have, just use Telegram.\r\n\r\nWith that said, I'm sadly still going to use it because I need to keep in touch with other people that only use Whatsapp, and even worse, I'm going to use it without my backup üò≠. At least now I know I can't trust it and that there are other (unofficial) solutions to the backup restoration problem.\r\n","frontmatter":{"tags":["whatsapp","sqlite","coding","backup","python","telegram","signal"],"categories":["general"],"allowComments":true,"publishOnMedium":false,"cover":null,"date":"2021-01-24T00:00:00.000Z","id":null,"path":"godammit-whatsapp","show":true,"title":"Godammit Whatsapp!","hideExcerpt":false,"subtitle":""}}},{"node":{"excerpt":"O Whatsapp estava em todos os sites de not√≠cias recentemente‚Ä¶","html":"<p>O Whatsapp estava em todos os sites de not√≠cias recentemente devido √†s suas novas pol√≠ticas de privacidade, mas este post n√£o √© sobre isso. Ah n√£o n√£o, este post √© sobre minha batalha de 28 horas para restaurar meu backup de mensagens do Whatsapp que n√£o deu em nada, quer dizer, mais ou menos em nada.</p>\n<p>Whatsapp n√£o √© um aplicativo bom, acho que todos n√≥s sabemos disso, n√©? Tipo √© s√©rio que eu preciso ter o meu celular conectado √† internet para usar a vers√£o web? Como assim?! Mas tudo bem, todos n√≥s usamos porque √© o aplicativo de mensagem que todos usam, certo? Fazer o que?</p>\n<p>Eu sou da galera que come√ßou a usar o Whatsapp assim que ele saiu, quando ainda tinha uma vers√£o Symbian que eu usava no meu Nokia, ent√£o assim, eu j√° estou usando o Whatsapp por muitos e muitos anos, e sempre fa√ßo backup do meu hist√≥rico de mensagens, primeiro com <a href=\"https://play.google.com/store/apps/details?id=com.keramidas.TitaniumBackup\" target=\"_blank\" rel=\"noreferrer\">Titanium Backup</a> e depois com a integra√ß√£o do Google Drive, que foi bem conveniente porque n√£o precisava mais fazer o root no meu celular e ter problemas com a garantia.</p>\n<h2 id=\"e-o-que-aconteceu\" style=\"position:relative;\"><a href=\"#e-o-que-aconteceu\" aria-label=\"e o que aconteceu permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>E o que aconteceu?</h2>\n<p>Eu comprei um celular novo, um <a href=\"https://www.gsmarena.com/oneplus_nord_n10_5g-10556.php\" target=\"_blank\" rel=\"noreferrer\">OnePlus Nord N10</a>, eu sei que n√£o √© um celular üëåTOPüëå‚Ñ¢, mas √© uma boa atualiza√ß√£o para quem est√° usando o <a href=\"https://www.gsmarena.com/motorola_moto_z3_play-9003.php\" target=\"_blank\" rel=\"noreferrer\">Motorola Moto Z3 Play</a> e ainda por cima tem 5G, ent√£o eu estou feliz que estou ajudando o Bill Gates a trazer a Nova Ordem Mundial para n√≥s via o coronav√≠rus.</p>\n<p>A verdade √© que eu me irrito muito com o Whatsapp, √© um aplicativo com poucas features, mas super lento e com muitos bugs, que eu s√≥ uso para falar com alguns amigos que ainda n√£o usam o Telegram (noobs). Antes de mover tudo para o meu celular novo, eu fiz um novo backup do Whatsapp e logo em seguida j√° desinstalei ele do meu celular, de tanto √≥dio que eu tenho. Isso foi um erro.</p>\n<p>Eu iniciei o processo de restaura√ß√£o do backup do Whatsapp atrav√©s do Google Drive no meu celular novo e, quando atingiu 24%, apareceu um erro: <strong>N√£o foi poss√≠vel restaurar o backup</strong>. S√£o 10GB de backup, ent√£o n√£o me preocupei muito e resolvi tentar de novo, bom acontece que para tentar de novo, voc√™ precisa desinstalar o Whatsapp e instalar novamente‚Ä¶ ok‚Ä¶</p>\n<p>Ent√£o eu fui la instalei e desinstalei, tentei denovo, e para minha surpresa aconteceu o mesmo erro. E n√£o existe op√ß√£o de tentar novamente ou mudar para restaura√ß√£o de arquivos no armazenamento local, n√£o n√£o n√£o, se voc√™ quiser tentar novamente, desinstale e instale novamente esse incr√≠vel aplicativo. Continuei tentando mais algumas vezes, com tipos de backup diferentes (local, nuvem), com arquivos de backup diferentes, e depois de tanto tentar, eu passei a ter que esperar 2 horas para pedir um SMS para ativar a minha conta. T√° n√©‚Ä¶ Esperei, tentei de novo, e claro que n√£o funcionou, a√≠ tive que esperar 7 horas. Impressionante.</p>\n<p><figure class=\"gatsby-resp-image-figure\" style=\"\">\n    <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 576px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 222.265625%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAsABQDASIAAhEBAxEB/8QAGQAAAwEBAQAAAAAAAAAAAAAAAAECBAMF/8QAFQEBAQAAAAAAAAAAAAAAAAAAAAH/2gAMAwEAAhADEAAAAfCqAYhNDzsZIUc2tEB//8QAGxAAAQUBAQAAAAAAAAAAAAAAAQACESAhEBP/2gAIAQEAAQUCWVDAR5hOEHVJrPf/xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAEDAQE/AV//xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAECAQE/AV//xAAXEAADAQAAAAAAAAAAAAAAAAAAIDEw/9oACAEBAAY/Ampc/wD/xAAdEAACAQQDAAAAAAAAAAAAAAAAAREQIVFhIDGB/9oACAEBAAE/IRYWex+cFltjaLUicmbGXfdZJZJZLP/aAAwDAQACAAMAAAAQe/KDIw//xAAWEQEBAQAAAAAAAAAAAAAAAAABESD/2gAIAQMBAT8QGa//xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAECAQE/EF//xAAiEAEAAgEDAwUAAAAAAAAAAAABABExIVFhEIGhQXGx0fH/2gAIAQEAAT8QMVZUpzaMsT4ibyuQmkXoEQpdVEPX7Qb5Sr1gRQB7s/TYqXZeZ9Tv5iN/MNXVicziO9P/2Q=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Bora esperar 24h\"\n        title=\"Bora esperar 24h\"\n        src=\"/static/ac157d47debff09e795b787faedeee4d/17d4d/whatsapp-waiting-time.jpg\"\n        srcset=\"/static/ac157d47debff09e795b787faedeee4d/db830/whatsapp-waiting-time.jpg 256w,\n/static/ac157d47debff09e795b787faedeee4d/8102f/whatsapp-waiting-time.jpg 512w,\n/static/ac157d47debff09e795b787faedeee4d/17d4d/whatsapp-waiting-time.jpg 576w\"\n        sizes=\"(max-width: 576px) 100vw, 576px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\">Bora esperar 24h</figcaption>\n  </figure></p>\n<p>Ent√£o comecei a pesquisar <a href=\"https://www.google.com.br/search?q=whatsapp+backup+travou+em+24%25&#x26;oq=whatsapp+backup+travou+em+24%25\" target=\"_blank\" rel=\"noreferrer\">e muitas outras pessoas t√™m o mesmo problema</a>. Eu n√£o entendo como um aplicativo de uma empresa bilion√°ria pode ser t√£o ruim. Tentei entrar em contato com o suporte ao cliente, mas eles falaram que n√£o podiam me ajudar. Levei menos de 5 minutos para restaurar meu backup do Signal para meu celular novo e j√° estava h√° 20 horas tentando restaurar meu backup do Whatsapp.</p>\n<h2 id=\"ta-e-agora\" style=\"position:relative;\"><a href=\"#ta-e-agora\" aria-label=\"ta e agora permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>T√° e agora?</h2>\n<p>Eu desisti. Pois √©, s√©rio, eu desisti. Tudo o que quero fazer agora √© acessar meu hist√≥rico de mensagens de qualquer maneira poss√≠vel, tipo uma planilha ou sei l√°. Eu tenho os arquivos de backup, ent√£o isso tem que ser poss√≠vel de algum jeito, n√©?</p>\n<h2 id=\"1---faca-o-root-no-seu-celular\" style=\"position:relative;\"><a href=\"#1---faca-o-root-no-seu-celular\" aria-label=\"1   faca o root no seu celular permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1 - Fa√ßa o root no seu celular</h2>\n<p>Isso n√£o √© muito legal, mas n√£o tem outro jeito, se voc√™ quiser descriptografar o arquivo <code class=\"language-text\">msgstore.db.crypt12</code> do backup do Whatsapp, voc√™ vai precisar da sua chave de criptografia do Whatsapp, que est√° localizada em <code class=\"language-text\">/data/data/com.whatsapp/files/key</code>, e para conseguir copiar esse arquivo √© necessario o root.</p>\n<h2 id=\"2---descriptografe-o-seu-arquivo-de-banco-de-dados\" style=\"position:relative;\"><a href=\"#2---descriptografe-o-seu-arquivo-de-banco-de-dados\" aria-label=\"2   descriptografe o seu arquivo de banco de dados permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2 - Descriptografe o seu arquivo de banco de dados</h2>\n<p>Depois de obter a chave, voc√™ pode descriptografar o seu arquivo de backup por meio de um <a href=\"https://github.com/CanciuCostin/crypt12-decrypt\" target=\"_blank\" rel=\"noreferrer\">script Go (ou .exe)</a> ou usando o incr√≠vel <a href=\"https://github.com/andreas-mausch/whatsapp-viewer\" target=\"_blank\" rel=\"noreferrer\">Whatsapp Viewer</a>, que n√£o s√≥ descriptografa o seu arquivo de backup (que √© um arquivo SQLite), mas tamb√©m carrega todos os seus chats e permite export√°-los para <code class=\"language-text\">HTML</code> ou <code class=\"language-text\">JSON</code> um por um.</p>\n<h2 id=\"3---acesse-seus-dados\" style=\"position:relative;\"><a href=\"#3---acesse-seus-dados\" aria-label=\"3   acesse seus dados permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3 - Acesse seus dados</h2>\n<p>Como mencionado antes, voc√™ pode usar o Whatsapp Viewer para visualizar todas as suas conversas ou pode at√© usar um aplicativo de navegador SQLite e ver os dados direto por l√°. Eu encontrei um <a href=\"https://github.com/KnugiHK/Whatsapp-Chat-Exporter\" target=\"_blank\" rel=\"noreferrer\">script em Python muito bom no GitHub</a> (que tem apenas 6 dias de vida - sorte minha) que me permitiu exportar todos os meus chats em uma vez s√≥ para um √∫nico arquivo <code class=\"language-text\">JSON</code>, e com este arquivo <code class=\"language-text\">JSON</code> posso fazer o que quiser com meu hist√≥rico do Whatsapp, posso at√© usar <a href=\"https://github.com/detaysoft/react-chat-elements#readme\" target=\"_blank\" rel=\"noreferrer\">react-chat-elements</a> para criar um pequeno projeto com <a href=\"https://www.gatsbyjs.com/\" target=\"_blank\" rel=\"noreferrer\">Gatsby</a> para carregar todas as minhas mensagens, quem sabe.</p>\n<h2 id=\"moral-da-historia\" style=\"position:relative;\"><a href=\"#moral-da-historia\" aria-label=\"moral da historia permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Moral da hist√≥ria</h2>\n<p>O Whatsapp √© muito ruim e voc√™ n√£o deveria us√°-lo. De verdade. E nem estou falando da quest√£o da privacidade, √© apenas um aplicativo horr√≠vel que n√£o tem features b√°sicas que qualquer aplicativo de mensagens hoje em dia deveria ter. Esquece o Whatsapp e use o Telegram.</p>\n<p>Infelizmente eu ainda vou continuar usando o Whatsapp, porque preciso manter contato com outras pessoas que s√≥ usam ele e, pior ainda, vou us√°-lo sem o meu backup üò≠. Pelo menos agora sei que n√£o posso confiar nele para isso e que existem outras solu√ß√µes (n√£o oficiais) para resolver esse problema.</p>","fields":{"postHashId":"Z2VuZXJhbHRydWVudWxsMjAyMS0wMS0yNFQwMDowMDowMC4wMDBa","slug":"/2021/2021-01-24-tinha-que-ser-o-whatsapp-de-novo.pt-br/","path":"/blog/general/tinha-que-ser-o-whatsapp-de-novo/","locale":"pt-br"},"rawMarkdownBody":"O Whatsapp estava em todos os sites de not√≠cias recentemente devido √†s suas novas pol√≠ticas de privacidade, mas este post n√£o √© sobre isso. Ah n√£o n√£o, este post √© sobre minha batalha de 28 horas para restaurar meu backup de mensagens do Whatsapp que n√£o deu em nada, quer dizer, mais ou menos em nada.\r\n\r\nWhatsapp n√£o √© um aplicativo bom, acho que todos n√≥s sabemos disso, n√©? Tipo √© s√©rio que eu preciso ter o meu celular conectado √† internet para usar a vers√£o web? Como assim?! Mas tudo bem, todos n√≥s usamos porque √© o aplicativo de mensagem que todos usam, certo? Fazer o que?\r\n\r\nEu sou da galera que come√ßou a usar o Whatsapp assim que ele saiu, quando ainda tinha uma vers√£o Symbian que eu usava no meu Nokia, ent√£o assim, eu j√° estou usando o Whatsapp por muitos e muitos anos, e sempre fa√ßo backup do meu hist√≥rico de mensagens, primeiro com [Titanium Backup](https://play.google.com/store/apps/details?id=com.keramidas.TitaniumBackup) e depois com a integra√ß√£o do Google Drive, que foi bem conveniente porque n√£o precisava mais fazer o root no meu celular e ter problemas com a garantia.\r\n\r\n## E o que aconteceu?\r\n\r\nEu comprei um celular novo, um [OnePlus Nord N10](https://www.gsmarena.com/oneplus_nord_n10_5g-10556.php), eu sei que n√£o √© um celular üëåTOPüëå‚Ñ¢, mas √© uma boa atualiza√ß√£o para quem est√° usando o [Motorola Moto Z3 Play](https://www.gsmarena.com/motorola_moto_z3_play-9003.php) e ainda por cima tem 5G, ent√£o eu estou feliz que estou ajudando o Bill Gates a trazer a Nova Ordem Mundial para n√≥s via o coronav√≠rus.\r\n\r\nA verdade √© que eu me irrito muito com o Whatsapp, √© um aplicativo com poucas features, mas super lento e com muitos bugs, que eu s√≥ uso para falar com alguns amigos que ainda n√£o usam o Telegram (noobs). Antes de mover tudo para o meu celular novo, eu fiz um novo backup do Whatsapp e logo em seguida j√° desinstalei ele do meu celular, de tanto √≥dio que eu tenho. Isso foi um erro.\r\n\r\nEu iniciei o processo de restaura√ß√£o do backup do Whatsapp atrav√©s do Google Drive no meu celular novo e, quando atingiu 24%, apareceu um erro: __N√£o foi poss√≠vel restaurar o backup__. S√£o 10GB de backup, ent√£o n√£o me preocupei muito e resolvi tentar de novo, bom acontece que para tentar de novo, voc√™ precisa desinstalar o Whatsapp e instalar novamente... ok...\r\n\r\nEnt√£o eu fui la instalei e desinstalei, tentei denovo, e para minha surpresa aconteceu o mesmo erro. E n√£o existe op√ß√£o de tentar novamente ou mudar para restaura√ß√£o de arquivos no armazenamento local, n√£o n√£o n√£o, se voc√™ quiser tentar novamente, desinstale e instale novamente esse incr√≠vel aplicativo. Continuei tentando mais algumas vezes, com tipos de backup diferentes (local, nuvem), com arquivos de backup diferentes, e depois de tanto tentar, eu passei a ter que esperar 2 horas para pedir um SMS para ativar a minha conta. T√° n√©... Esperei, tentei de novo, e claro que n√£o funcionou, a√≠ tive que esperar 7 horas. Impressionante.\r\n\r\n![Bora esperar 24h](../../uploads/blog/2021/01/whatsapp-waiting-time.jpg)\r\n\r\nEnt√£o comecei a pesquisar [e muitas outras pessoas t√™m o mesmo problema](https://www.google.com.br/search?q=whatsapp+backup+travou+em+24%25&oq=whatsapp+backup+travou+em+24%25). Eu n√£o entendo como um aplicativo de uma empresa bilion√°ria pode ser t√£o ruim. Tentei entrar em contato com o suporte ao cliente, mas eles falaram que n√£o podiam me ajudar. Levei menos de 5 minutos para restaurar meu backup do Signal para meu celular novo e j√° estava h√° 20 horas tentando restaurar meu backup do Whatsapp.\r\n\r\n## T√° e agora?\r\n\r\nEu desisti. Pois √©, s√©rio, eu desisti. Tudo o que quero fazer agora √© acessar meu hist√≥rico de mensagens de qualquer maneira poss√≠vel, tipo uma planilha ou sei l√°. Eu tenho os arquivos de backup, ent√£o isso tem que ser poss√≠vel de algum jeito, n√©?\r\n\r\n## 1 - Fa√ßa o root no seu celular\r\n\r\nIsso n√£o √© muito legal, mas n√£o tem outro jeito, se voc√™ quiser descriptografar o arquivo `msgstore.db.crypt12` do backup do Whatsapp, voc√™ vai precisar da sua chave de criptografia do Whatsapp, que est√° localizada em `/data/data/com.whatsapp/files/key`, e para conseguir copiar esse arquivo √© necessario o root.\r\n\r\n## 2 - Descriptografe o seu arquivo de banco de dados\r\n\r\nDepois de obter a chave, voc√™ pode descriptografar o seu arquivo de backup por meio de um [script Go (ou .exe)](https://github.com/CanciuCostin/crypt12-decrypt) ou usando o incr√≠vel [Whatsapp Viewer](https://github.com/andreas-mausch/whatsapp-viewer), que n√£o s√≥ descriptografa o seu arquivo de backup (que √© um arquivo SQLite), mas tamb√©m carrega todos os seus chats e permite export√°-los para `HTML` ou `JSON` um por um.\r\n\r\n## 3 - Acesse seus dados\r\n\r\nComo mencionado antes, voc√™ pode usar o Whatsapp Viewer para visualizar todas as suas conversas ou pode at√© usar um aplicativo de navegador SQLite e ver os dados direto por l√°. Eu encontrei um [script em Python muito bom no GitHub](https://github.com/KnugiHK/Whatsapp-Chat-Exporter) (que tem apenas 6 dias de vida - sorte minha) que me permitiu exportar todos os meus chats em uma vez s√≥ para um √∫nico arquivo `JSON`, e com este arquivo `JSON` posso fazer o que quiser com meu hist√≥rico do Whatsapp, posso at√© usar [react-chat-elements](https://github.com/detaysoft/react-chat-elements#readme) para criar um pequeno projeto com [Gatsby](https://www.gatsbyjs.com/) para carregar todas as minhas mensagens, quem sabe.\r\n\r\n## Moral da hist√≥ria\r\n\r\nO Whatsapp √© muito ruim e voc√™ n√£o deveria us√°-lo. De verdade. E nem estou falando da quest√£o da privacidade, √© apenas um aplicativo horr√≠vel que n√£o tem features b√°sicas que qualquer aplicativo de mensagens hoje em dia deveria ter. Esquece o Whatsapp e use o Telegram.\r\n\r\nInfelizmente eu ainda vou continuar usando o Whatsapp, porque preciso manter contato com outras pessoas que s√≥ usam ele e, pior ainda, vou us√°-lo sem o meu backup üò≠. Pelo menos agora sei que n√£o posso confiar nele para isso e que existem outras solu√ß√µes (n√£o oficiais) para resolver esse problema.\r\n","frontmatter":{"tags":["whatsapp","sqlite","programa√ß√£o","backup","python","telegram","signal"],"categories":["general"],"allowComments":true,"publishOnMedium":false,"cover":null,"date":"2021-01-24T00:00:00.000Z","id":null,"path":"tinha-que-ser-o-whatsapp-de-novo","show":true,"title":"Tinha que ser o Whatsapp de novo!","hideExcerpt":false,"subtitle":""}}},{"node":{"excerpt":"Wassup everyone, I‚Äôm once again late with my ‚Äúweekly‚Äù devlog‚Ä¶","html":"<p>Wassup everyone, I‚Äôm once again late with my ‚Äúweekly‚Äù devlog, due to the holidays and stuff. But let‚Äôs drop the small talk and cut to the chase.</p>\n<p><div class=\"gatsby-resp-iframe-wrapper\" style=\"padding-bottom: 56.42857142857143%; position: relative; height: 0; overflow: hidden; margin-bottom: 1.0725rem\" > <div class=\"embedVideo-container\"> <iframe title=\"\" src=\"https://www.youtube.com/embed/WKK5jc3rl1w?rel=0\" class=\"embedVideo-iframe\" style=\"border:0; position: absolute; top: 0; left: 0; width: 100%; height: 100%; \" loading=\"eager\" allowfullscreen=\"\" sandbox=\"allow-same-origin allow-scripts allow-popups\"></iframe> </div> </div></p>\n<p>This is very simple to do, but it adds a nice polishing level to the game. First I created a new scene called <code class=\"language-text\">StagePresentationScene</code>. In it, I get the variable <code class=\"language-text\">stageName</code> and show it in the middle of the screen for 1.5 seconds.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> Scene <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'phaser'</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> handleSceneEnd <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'../utils/scenes'</span><span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">StagePresentationScene</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">Scene</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token keyword\">super</span><span class=\"token punctuation\">(</span><span class=\"token string\">'StagePresentationScene'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span>\r\n\r\n    <span class=\"token function\">init</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">data</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>initData <span class=\"token operator\">=</span> data<span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span>\r\n\r\n    <span class=\"token function\">create</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">.</span><span class=\"token function\">text</span><span class=\"token punctuation\">(</span>\r\n            <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>cameras<span class=\"token punctuation\">.</span>main<span class=\"token punctuation\">.</span>width <span class=\"token operator\">/</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span>\r\n            <span class=\"token number\">80</span><span class=\"token punctuation\">,</span>\r\n            <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>initData<span class=\"token punctuation\">.</span>stageName\r\n        <span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">setDepth</span><span class=\"token punctuation\">(</span><span class=\"token number\">50</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">setOrigin</span><span class=\"token punctuation\">(</span><span class=\"token number\">0.5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0.5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>time<span class=\"token punctuation\">.</span><span class=\"token function\">delayedCall</span><span class=\"token punctuation\">(</span>\r\n            <span class=\"token number\">1500</span><span class=\"token punctuation\">,</span>\r\n            <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">handleSceneEnd</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'GameScene'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>initData<span class=\"token punctuation\">)</span>\r\n        <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span>\r\n<span class=\"token punctuation\">}</span>\r\n\r\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> StagePresentationScene<span class=\"token punctuation\">;</span></code></pre></div>\n<p>I can access the <code class=\"language-text\">stageName</code> attribute from Tiled with a simple <code class=\"language-text\">filter</code> function.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">// stageNameProperty will be an object with a property value in it</span>\r\n<span class=\"token keyword\">const</span> stageNameProperty <span class=\"token operator\">=</span> stageJson<span class=\"token operator\">?.</span>properties<span class=\"token operator\">?.</span><span class=\"token function\">find</span><span class=\"token punctuation\">(</span>\r\n    <span class=\"token punctuation\">(</span><span class=\"token parameter\">property</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> property<span class=\"token punctuation\">.</span>name <span class=\"token operator\">===</span> <span class=\"token constant\">STAGE_NAME</span>\r\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>This is very simple to do but makes the game way better looking.</p>\n<p><img src=\"/286f7df54e54aa88ad4967a1424de1c5/stage-presentation.gif\" alt=\"Stage transition\"></p>\n<p>And that‚Äôs it. Don‚Äôt forget to add the <code class=\"language-text\">stageName</code> property to your Tiled map properties. See you next week.</p>","fields":{"postHashId":"Z2FtZXN0cnVlbnVsbDIwMjAtMTItMjlUMDA6MDA6MDAuMDAwWg==","slug":"/2020/2020-29-12-adding-transition-when-entering-a-stage-on-phaser-js-skate-platformer-game-devlog-16.en/","path":"/blog/games/adding-transition-when-entering-a-stage-on-phaser-js-skate-platformer-game-devlog-16/","locale":"en"},"rawMarkdownBody":"Wassup everyone, I'm once again late with my \"weekly\" devlog, due to the holidays and stuff. But let's drop the small talk and cut to the chase.\r\n\r\n`youtube: https://www.youtube.com/watch?v=WKK5jc3rl1w`\r\n\r\nThis is very simple to do, but it adds a nice polishing level to the game. First I created a new scene called `StagePresentationScene`. In it, I get the variable `stageName` and show it in the middle of the screen for 1.5 seconds.\r\n\r\n```javascript\r\nimport { Scene } from 'phaser';\r\nimport { handleSceneEnd } from '../utils/scenes';\r\n\r\nclass StagePresentationScene extends Scene {\r\n    constructor() {\r\n        super('StagePresentationScene');\r\n    }\r\n\r\n    init(data) {\r\n        this.initData = data;\r\n    }\r\n\r\n    create() {\r\n        this.add.text(\r\n            this.cameras.main.width / 2,\r\n            80,\r\n            this.initData.stageName\r\n        ).setDepth(50).setOrigin(0.5, 0.5);\r\n\r\n        this.time.delayedCall(\r\n            1500,\r\n            () => handleSceneEnd(this, 'GameScene', this.initData)\r\n        );\r\n    }\r\n}\r\n\r\nexport default StagePresentationScene;\r\n```\r\n\r\nI can access the `stageName` attribute from Tiled with a simple `filter` function.\r\n\r\n```javascript\r\n// stageNameProperty will be an object with a property value in it\r\nconst stageNameProperty = stageJson?.properties?.find(\r\n    (property) => property.name === STAGE_NAME\r\n);\r\n```\r\n\r\nThis is very simple to do but makes the game way better looking.\r\n\r\n![Stage transition](../../uploads/blog/2020/12/stage-presentation.gif)\r\n\r\nAnd that's it. Don't forget to add the `stageName` property to your Tiled map properties. See you next week.\r\n","frontmatter":{"tags":["coding","games","javascript","phaser","phaser 3","game devlog","gamedev","skate platformer","super ollie vs pebble corp","webpack","tiled"],"categories":["games"],"allowComments":true,"publishOnMedium":false,"cover":null,"date":"2020-12-29T00:00:00.000Z","id":null,"path":"adding-transition-when-entering-a-stage-on-phaser-js-skate-platformer-game-devlog-16","show":true,"title":"Adding transition when entering a stage on Phaser JS - Game Devlog #16","hideExcerpt":false,"subtitle":""}}},{"node":{"excerpt":"Fala galera, estou aqui mais uma vez humildemente atrasado‚Ä¶","html":"<p>Fala galera, estou aqui mais uma vez humildemente atrasado com um devlog devido ao natal e etc. Mas bom, deixa isso pra la e vamos ver logo o video de hoje.</p>\n<p><div class=\"gatsby-resp-iframe-wrapper\" style=\"padding-bottom: 56.42857142857143%; position: relative; height: 0; overflow: hidden; margin-bottom: 1.0725rem\" > <div class=\"embedVideo-container\"> <iframe title=\"\" src=\"https://www.youtube.com/embed/WKK5jc3rl1w?rel=0\" class=\"embedVideo-iframe\" style=\"border:0; position: absolute; top: 0; left: 0; width: 100%; height: 100%; \" loading=\"eager\" allowfullscreen=\"\" sandbox=\"allow-same-origin allow-scripts allow-popups\"></iframe> </div> </div></p>\n<p>Bom isso √© bem simples de fazer, por√©m adiciona uma nivel de polimento bem legal no jogo. Primeiro eu criei uma game scene nova chamada <code class=\"language-text\">StagePresentationScene</code>, e nela, eu pego a vari√°vel <code class=\"language-text\">stageName</code> e a mostro no meio da tela por 1,5 segundo.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> Scene <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'phaser'</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> handleSceneEnd <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'../utils/scenes'</span><span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">StagePresentationScene</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">Scene</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token keyword\">super</span><span class=\"token punctuation\">(</span><span class=\"token string\">'StagePresentationScene'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span>\r\n\r\n    <span class=\"token function\">init</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">data</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>initData <span class=\"token operator\">=</span> data<span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span>\r\n\r\n    <span class=\"token function\">create</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">.</span><span class=\"token function\">text</span><span class=\"token punctuation\">(</span>\r\n            <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>cameras<span class=\"token punctuation\">.</span>main<span class=\"token punctuation\">.</span>width <span class=\"token operator\">/</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span>\r\n            <span class=\"token number\">80</span><span class=\"token punctuation\">,</span>\r\n            <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>initData<span class=\"token punctuation\">.</span>stageName\r\n        <span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">setDepth</span><span class=\"token punctuation\">(</span><span class=\"token number\">50</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">setOrigin</span><span class=\"token punctuation\">(</span><span class=\"token number\">0.5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0.5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>time<span class=\"token punctuation\">.</span><span class=\"token function\">delayedCall</span><span class=\"token punctuation\">(</span>\r\n            <span class=\"token number\">1500</span><span class=\"token punctuation\">,</span>\r\n            <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">handleSceneEnd</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'GameScene'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>initData<span class=\"token punctuation\">)</span>\r\n        <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span>\r\n<span class=\"token punctuation\">}</span>\r\n\r\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> StagePresentationScene<span class=\"token punctuation\">;</span></code></pre></div>\n<p>Eu consigo acessar o atributo <code class=\"language-text\">stageName</code> do Tiled com uma simples fun√ß√£o de <code class=\"language-text\">filter</code>.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">// stageNameProperty will be an object with a property value in it</span>\r\n<span class=\"token keyword\">const</span> stageNameProperty <span class=\"token operator\">=</span> stageJson<span class=\"token operator\">?.</span>properties<span class=\"token operator\">?.</span><span class=\"token function\">find</span><span class=\"token punctuation\">(</span>\r\n    <span class=\"token punctuation\">(</span><span class=\"token parameter\">property</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> property<span class=\"token punctuation\">.</span>name <span class=\"token operator\">===</span> <span class=\"token constant\">STAGE_NAME</span>\r\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>E apesar de ser bem simples de fazer, isso deixa o jogo bem mais bonitinho.</p>\n<p><img src=\"/286f7df54e54aa88ad4967a1424de1c5/stage-presentation.gif\" alt=\"Transi√ß√£o para fase\"></p>\n<p>E por hoje √© isso. N√£o esque√ßa de adicionar a propriedade <code class=\"language-text\">stageName</code> nas propriedades de mapa no Tiled. Vejo voc√™s semana que vem!</p>","fields":{"postHashId":"Z2FtZXN0cnVlbnVsbDIwMjAtMTItMjlUMDA6MDA6MDAuMDAwWg==","slug":"/2020/2020-29-12-adicionando-transicao-ao-carregar-uma-fase-no-phaser-js-skate-platformer-game-devlog-16.pt-br/","path":"/blog/games/adicionando-transicao-ao-carregar-uma-fase-no-phaser-js-skate-platformer-game-devlog-16/","locale":"pt-br"},"rawMarkdownBody":"Fala galera, estou aqui mais uma vez humildemente atrasado com um devlog devido ao natal e etc. Mas bom, deixa isso pra la e vamos ver logo o video de hoje.\r\n\r\n`youtube: https://www.youtube.com/watch?v=WKK5jc3rl1w`\r\n\r\nBom isso √© bem simples de fazer, por√©m adiciona uma nivel de polimento bem legal no jogo. Primeiro eu criei uma game scene nova chamada `StagePresentationScene`, e nela, eu pego a vari√°vel `stageName` e a mostro no meio da tela por 1,5 segundo.\r\n\r\n```javascript\r\nimport { Scene } from 'phaser';\r\nimport { handleSceneEnd } from '../utils/scenes';\r\n\r\nclass StagePresentationScene extends Scene {\r\n    constructor() {\r\n        super('StagePresentationScene');\r\n    }\r\n\r\n    init(data) {\r\n        this.initData = data;\r\n    }\r\n\r\n    create() {\r\n        this.add.text(\r\n            this.cameras.main.width / 2,\r\n            80,\r\n            this.initData.stageName\r\n        ).setDepth(50).setOrigin(0.5, 0.5);\r\n\r\n        this.time.delayedCall(\r\n            1500,\r\n            () => handleSceneEnd(this, 'GameScene', this.initData)\r\n        );\r\n    }\r\n}\r\n\r\nexport default StagePresentationScene;\r\n```\r\n\r\nEu consigo acessar o atributo `stageName` do Tiled com uma simples fun√ß√£o de `filter`.\r\n\r\n```javascript\r\n// stageNameProperty will be an object with a property value in it\r\nconst stageNameProperty = stageJson?.properties?.find(\r\n    (property) => property.name === STAGE_NAME\r\n);\r\n```\r\n\r\nE apesar de ser bem simples de fazer, isso deixa o jogo bem mais bonitinho.\r\n\r\n![Transi√ß√£o para fase](../../uploads/blog/2020/12/stage-presentation.gif)\r\n\r\nE por hoje √© isso. N√£o esque√ßa de adicionar a propriedade `stageName` nas propriedades de mapa no Tiled. Vejo voc√™s semana que vem!\r\n","frontmatter":{"tags":["programa√ß√£o","jogos","javascript","phaser","phaser 3","game devlog","gamedev","skate platformer","super ollie vs pebble corp","webpack","tiled"],"categories":["games"],"allowComments":true,"publishOnMedium":false,"cover":null,"date":"2020-12-29T00:00:00.000Z","id":null,"path":"adicionando-transicao-ao-carregar-uma-fase-no-phaser-js-skate-platformer-game-devlog-16","show":true,"title":"Adicionando transi√ß√£o ao carregar uma fase no Phaser JS - Game Devlog #16","hideExcerpt":false,"subtitle":""}}},{"node":{"excerpt":"Alright, get comfortable because today‚Äôs devlog is long, but‚Ä¶","html":"<p>Alright, get comfortable because today‚Äôs devlog is long, but it‚Äôs worth it. I‚Äôm really happy I managed to do this devlog, after all Cyberpunk 2077 was released this week, and I‚Äôm playing it on Stadia! Today‚Äôs devlog is long mostly because I want to explain the reason why I am doing things a certain way.</p>\n<p>Today I‚Äôm going to show you how I improved my enemy AI and why I handle so many edge cases in my code. Let‚Äôs dive into it.</p>\n<p><div class=\"gatsby-resp-iframe-wrapper\" style=\"padding-bottom: 56.42857142857143%; position: relative; height: 0; overflow: hidden; margin-bottom: 1.0725rem\" > <div class=\"embedVideo-container\"> <iframe title=\"\" src=\"https://www.youtube.com/embed/KoCubm17q8s?rel=0\" class=\"embedVideo-iframe\" style=\"border:0; position: absolute; top: 0; left: 0; width: 100%; height: 100%; \" loading=\"eager\" allowfullscreen=\"\" sandbox=\"allow-same-origin allow-scripts allow-popups\"></iframe> </div> </div></p>\n<p>My first take on the AI algorithm was to calculate it on the go, so wherever I place an enemy, it would move around and calculate if it should turn or not on every frame, this was very costly, especially when I had many enemies on screen.</p>\n<p>There were two ways to approach this problem, one would be manually creating a static path on Tiled and make the enemy follow that path, but whenever I add a new enemy, I would have to add a path for it too, and this can get really annoying to do really fast.</p>\n<p>The second option is instead of calculating the enemy‚Äôs behavior on every frame, I could pre-calculate all of them as soon as the stage is loaded and then set that path statically, this way I would have the freedom to add enemies wherever I want on Tiled, without having to add extra paths for them to follow and also keep the framerate stable by not processing the enemy‚Äôs logic on every frame.</p>\n<p>So how did I do that? First, there are some edge cases that I needed to handle, like what if the enemy is not on a platform? Or what if the platform doesn‚Äôt have edges? I know I will be making the stages on Tiled, but it‚Äôs good to handle those anyway because we never know.</p>\n<p>Since I can‚Äôt know if the enemy is already on a platform or not, I need to wait for the game‚Äôs physics to kick in and calculate the enemy‚Äôs position, such as gravity and stuff, so instead of calculating the static AI in the <code class=\"language-text\">constructor</code>, I‚Äôm doing it in the <code class=\"language-text\">update</code> function, and after it‚Äôs calculated, I simply ‚Äúremove‚Äù the <code class=\"language-text\">update</code> function by replacing it with a <code class=\"language-text\">no-op</code> function.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">Enemy</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">GameObjects<span class=\"token punctuation\">.</span>Sprite</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span> scene<span class=\"token punctuation\">,</span> x<span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">,</span> asset <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token keyword\">super</span><span class=\"token punctuation\">(</span>scene<span class=\"token punctuation\">,</span> x<span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">,</span> asset<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>staticAi <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token constant\">PLATFORM_WALKING</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>aiColliders <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span>\r\n\r\n    <span class=\"token function\">update</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">time<span class=\"token punctuation\">,</span> delta</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>aiColliders<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n            <span class=\"token comment\">// we don't need the update function anymore</span>\r\n            <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function-variable function\">update</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\r\n            <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token punctuation\">}</span>\r\n\r\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>staticAi<span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">aiStrategy</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>aiStrategy <span class=\"token operator\">===</span> <span class=\"token constant\">PLATFORM_WALKING</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n                <span class=\"token comment\">// first check if the enemy is on a platform</span>\r\n                <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>touchingDownObject<span class=\"token operator\">?.</span>layer<span class=\"token operator\">?.</span>tilemapLayer<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n                    <span class=\"token comment\">// then calculate the colliders that will make the enemy change direction</span>\r\n                    <span class=\"token keyword\">const</span> colliders <span class=\"token operator\">=</span> <span class=\"token function\">staticPlatformWalkingBehavior</span><span class=\"token punctuation\">(</span>\r\n                        <span class=\"token keyword\">this</span><span class=\"token punctuation\">,</span>\r\n                        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>touchingDownObject<span class=\"token punctuation\">.</span>layer<span class=\"token punctuation\">.</span>tilemapLayer\r\n                    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n                    <span class=\"token comment\">// TODO concat array</span>\r\n                    colliders<span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">collider</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>aiColliders<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span>collider<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                <span class=\"token punctuation\">}</span>\r\n            <span class=\"token punctuation\">}</span>\r\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span>\r\n<span class=\"token punctuation\">}</span>\r\n\r\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> Enemy<span class=\"token punctuation\">;</span></code></pre></div>\n<p>And then all the magic happens inside the <code class=\"language-text\">staticPlatformWalkingBehavior</code>, which honestly is super straightforward, I just need to get the collision layer from the enemy and check for an edge in the platform in both directions. The only catch in this function is that I don‚Äôt want it to run forever until it finds an edge because maybe the platform doesn‚Äôt have an edge, who knows? So instead I will run the loop for every tile in the map‚Äôs width.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">function</span> <span class=\"token function\">staticPlatformWalkingBehavior</span><span class=\"token punctuation\">(</span>\r\n    <span class=\"token parameter\">gameObject<span class=\"token punctuation\">,</span>\r\n    dynamicLayer</span>\r\n<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> scene <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> gameObject<span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">const</span> divider <span class=\"token operator\">=</span> <span class=\"token constant\">TILE_WIDTH</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">const</span> loopSize <span class=\"token operator\">=</span> scene<span class=\"token punctuation\">.</span>mapData<span class=\"token punctuation\">.</span>tileSize<span class=\"token punctuation\">.</span>width <span class=\"token operator\">*</span> divider<span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">const</span> result <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">const</span> layers <span class=\"token operator\">=</span> dynamicLayer<span class=\"token operator\">?.</span>getChildren<span class=\"token operator\">?.</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">||</span> <span class=\"token punctuation\">[</span>dynamicLayer<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\r\n\r\n    <span class=\"token comment\">// for each collision layer</span>\r\n    layers<span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">layer</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token comment\">// for each direction</span>\r\n        <span class=\"token punctuation\">[</span><span class=\"token constant\">FACING_RIGHT</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">FACING_LEFT</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">direction</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n            <span class=\"token comment\">// for each tile of the map * divider</span>\r\n            <span class=\"token keyword\">let</span> lastGroundTile<span class=\"token punctuation\">;</span>\r\n            <span class=\"token keyword\">new</span> <span class=\"token class-name\">Array</span><span class=\"token punctuation\">(</span>loopSize<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">fill</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">some</span><span class=\"token punctuation\">(</span>\r\n                <span class=\"token punctuation\">(</span><span class=\"token parameter\">num<span class=\"token punctuation\">,</span> index</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n                    <span class=\"token keyword\">const</span> multiplier <span class=\"token operator\">=</span> direction <span class=\"token operator\">===</span> <span class=\"token constant\">FACING_RIGHT</span> <span class=\"token operator\">?</span> <span class=\"token number\">1</span> <span class=\"token operator\">:</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\r\n                    <span class=\"token keyword\">const</span> posX <span class=\"token operator\">=</span> gameObject<span class=\"token punctuation\">.</span>x <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>index <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span> <span class=\"token number\">0.5</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> multiplier<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                    <span class=\"token keyword\">const</span> groundTile <span class=\"token operator\">=</span> layer<span class=\"token punctuation\">.</span><span class=\"token function\">getTileAtWorldXY</span><span class=\"token punctuation\">(</span>\r\n                        posX<span class=\"token punctuation\">,</span>\r\n                        gameObject<span class=\"token punctuation\">.</span>y <span class=\"token operator\">+</span> <span class=\"token number\">0.5</span>\r\n                    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n                    <span class=\"token keyword\">const</span> tile <span class=\"token operator\">=</span> layer<span class=\"token punctuation\">.</span><span class=\"token function\">getTileAtWorldXY</span><span class=\"token punctuation\">(</span>\r\n                        posX<span class=\"token punctuation\">,</span>\r\n                        gameObject<span class=\"token punctuation\">.</span>y <span class=\"token operator\">-</span> <span class=\"token number\">0.5</span>\r\n                    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n                    <span class=\"token comment\">// check for collisions</span>\r\n                    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>\r\n                        <span class=\"token operator\">!</span>groundTile<span class=\"token operator\">?.</span>properties<span class=\"token operator\">?.</span>collideUp\r\n                        <span class=\"token operator\">||</span> <span class=\"token punctuation\">(</span>direction <span class=\"token operator\">===</span> <span class=\"token constant\">FACING_RIGHT</span> <span class=\"token operator\">&amp;&amp;</span> tile<span class=\"token operator\">?.</span>properties<span class=\"token operator\">?.</span>collideLeft<span class=\"token punctuation\">)</span>\r\n                        <span class=\"token operator\">||</span> <span class=\"token punctuation\">(</span>direction <span class=\"token operator\">===</span> <span class=\"token constant\">FACING_LEFT</span> <span class=\"token operator\">&amp;&amp;</span> tile<span class=\"token operator\">?.</span>properties<span class=\"token operator\">?.</span>collideRight<span class=\"token punctuation\">)</span>\r\n                    <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n                        <span class=\"token keyword\">let</span> newPosX <span class=\"token operator\">=</span>\r\n                            lastGroundTile<span class=\"token operator\">?.</span>pixelX\r\n                            <span class=\"token operator\">||</span> tile<span class=\"token operator\">?.</span>pixelX\r\n                            <span class=\"token operator\">||</span> Math<span class=\"token punctuation\">.</span><span class=\"token function\">round</span><span class=\"token punctuation\">(</span>posX <span class=\"token operator\">/</span> <span class=\"token constant\">TILE_WIDTH</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token constant\">TILE_WIDTH</span><span class=\"token punctuation\">;</span>\r\n                        newPosX <span class=\"token operator\">+=</span> <span class=\"token punctuation\">(</span><span class=\"token constant\">TILE_WIDTH</span> <span class=\"token operator\">*</span> multiplier<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n                        <span class=\"token comment\">// create a custom collider object</span>\r\n                        <span class=\"token keyword\">const</span> platformLimitCollider <span class=\"token operator\">=</span> <span class=\"token function\">createInteractiveGameObject</span><span class=\"token punctuation\">(</span>\r\n                            gameObject<span class=\"token punctuation\">.</span>scene<span class=\"token punctuation\">,</span>\r\n                            newPosX<span class=\"token punctuation\">,</span>\r\n                            gameObject<span class=\"token punctuation\">.</span>y <span class=\"token operator\">-</span> <span class=\"token constant\">TILE_HEIGHT</span><span class=\"token punctuation\">,</span>\r\n                            <span class=\"token constant\">TILE_WIDTH</span><span class=\"token punctuation\">,</span>\r\n                            <span class=\"token constant\">TILE_HEIGHT</span><span class=\"token punctuation\">,</span>\r\n                            <span class=\"token string\">'something'</span>\r\n                        <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n                        <span class=\"token comment\">// create a collision between the gameobject and the custom collider</span>\r\n                        scene<span class=\"token punctuation\">.</span>physics<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">.</span><span class=\"token function\">collider</span><span class=\"token punctuation\">(</span>gameObject<span class=\"token punctuation\">,</span> platformLimitCollider<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n                            gameObject<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span><span class=\"token function\">setVelocityX</span><span class=\"token punctuation\">(</span>\r\n                                <span class=\"token operator\">-</span>gameObject<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span>velocity<span class=\"token punctuation\">.</span>x\r\n                            <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                            gameObject<span class=\"token punctuation\">.</span><span class=\"token function\">setFlipX</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>gameObject<span class=\"token punctuation\">.</span>flipX<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                        result<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span>platformLimitCollider<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n                        <span class=\"token comment\">// return true so the 'some' doesn't run anymore</span>\r\n                        <span class=\"token keyword\">return</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span>\r\n                    <span class=\"token punctuation\">}</span>\r\n\r\n                    lastGroundTile <span class=\"token operator\">=</span> groundTile<span class=\"token punctuation\">;</span>\r\n                    <span class=\"token keyword\">return</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span>\r\n                <span class=\"token punctuation\">}</span>\r\n            <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n    <span class=\"token keyword\">return</span> result<span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>And with that code, we have the result below.</p>\n<p><img src=\"/c44e9c39ebda2dbd1987240257d76317/static-ai-calculation.gif\" alt=\"Static AI calculation\"></p>\n<p>My main goal is to create all the rules of the game based on elements and interactions so that afterward I can simply create a stage on Tiled and everything works without having to mess around with it, creating colliders and other things manually, just like how Breath of The Wild was made. I much rather that the game calculate it all for me, so I can focus on creating levels. In the end, I‚Äôll have something like a Mario Maker üòÉ.</p>\n<p>And that was all for today, thanks for reading and watching the video, and don‚Äôt forget to leave your comment about what you are thinking about this series of posts/videos. Until next week!</p>","fields":{"postHashId":"Z2FtZXN0cnVlbnVsbDIwMjAtMTItMTVUMDA6MDA6MDAuMDAwWg==","slug":"/2020/2020-15-12-creating-a-smarter-and-more-performing-ai-on-phaser-js-skate-platformer-game-devlog-15.en/","path":"/blog/games/creating-a-smarter-and-more-performing-ai-on-phaser-js-skate-platformer-game-devlog-15/","locale":"en"},"rawMarkdownBody":"Alright, get comfortable because today's devlog is long, but it's worth it. I'm really happy I managed to do this devlog, after all Cyberpunk 2077 was released this week, and I'm playing it on Stadia! Today's devlog is long mostly because I want to explain the reason why I am doing things a certain way.\r\n\r\nToday I'm going to show you how I improved my enemy AI and why I handle so many edge cases in my code. Let's dive into it.\r\n\r\n`youtube: https://www.youtube.com/watch?v=KoCubm17q8s`\r\n\r\nMy first take on the AI algorithm was to calculate it on the go, so wherever I place an enemy, it would move around and calculate if it should turn or not on every frame, this was very costly, especially when I had many enemies on screen.\r\n\r\nThere were two ways to approach this problem, one would be manually creating a static path on Tiled and make the enemy follow that path, but whenever I add a new enemy, I would have to add a path for it too, and this can get really annoying to do really fast.\r\n\r\nThe second option is instead of calculating the enemy's behavior on every frame, I could pre-calculate all of them as soon as the stage is loaded and then set that path statically, this way I would have the freedom to add enemies wherever I want on Tiled, without having to add extra paths for them to follow and also keep the framerate stable by not processing the enemy's logic on every frame.\r\n\r\nSo how did I do that? First, there are some edge cases that I needed to handle, like what if the enemy is not on a platform? Or what if the platform doesn't have edges? I know I will be making the stages on Tiled, but it's good to handle those anyway because we never know.\r\n\r\nSince I can't know if the enemy is already on a platform or not, I need to wait for the game's physics to kick in and calculate the enemy's position, such as gravity and stuff, so instead of calculating the static AI in the `constructor`, I'm doing it in the `update` function, and after it's calculated, I simply \"remove\" the `update` function by replacing it with a `no-op` function.\r\n\r\n```javascript\r\nclass Enemy extends GameObjects.Sprite {\r\n    constructor({ scene, x, y, asset }) {\r\n        super(scene, x, y, asset);\r\n        this.staticAi = [PLATFORM_WALKING];\r\n        this.aiColliders = [];\r\n    }\r\n\r\n    update(time, delta) {\r\n        if (this.aiColliders.length) {\r\n            // we don't need the update function anymore\r\n            this.update = () => {};\r\n            return;\r\n        }\r\n\r\n        this.staticAi.forEach((aiStrategy) => {\r\n            if (aiStrategy === PLATFORM_WALKING) {\r\n                // first check if the enemy is on a platform\r\n                if (this.touchingDownObject?.layer?.tilemapLayer) {\r\n                    // then calculate the colliders that will make the enemy change direction\r\n                    const colliders = staticPlatformWalkingBehavior(\r\n                        this,\r\n                        this.touchingDownObject.layer.tilemapLayer\r\n                    );\r\n\r\n                    // TODO concat array\r\n                    colliders.forEach((collider) => this.aiColliders.push(collider));\r\n                }\r\n            }\r\n        });\r\n    }\r\n}\r\n\r\nexport default Enemy;\r\n```\r\n\r\nAnd then all the magic happens inside the `staticPlatformWalkingBehavior`, which honestly is super straightforward, I just need to get the collision layer from the enemy and check for an edge in the platform in both directions. The only catch in this function is that I don't want it to run forever until it finds an edge because maybe the platform doesn't have an edge, who knows? So instead I will run the loop for every tile in the map's width.\r\n\r\n```javascript\r\nexport function staticPlatformWalkingBehavior(\r\n    gameObject,\r\n    dynamicLayer\r\n) {\r\n    const { scene } = gameObject;\r\n    const divider = TILE_WIDTH;\r\n    const loopSize = scene.mapData.tileSize.width * divider;\r\n    const result = [];\r\n    const layers = dynamicLayer?.getChildren?.() || [dynamicLayer];\r\n\r\n    // for each collision layer\r\n    layers.forEach((layer) => {\r\n        // for each direction\r\n        [FACING_RIGHT, FACING_LEFT].forEach((direction) => {\r\n            // for each tile of the map * divider\r\n            let lastGroundTile;\r\n            new Array(loopSize).fill(null).some(\r\n                (num, index) => {\r\n                    const multiplier = direction === FACING_RIGHT ? 1 : -1;\r\n                    const posX = gameObject.x + (((index + 1) - 0.5) * multiplier);\r\n                    const groundTile = layer.getTileAtWorldXY(\r\n                        posX,\r\n                        gameObject.y + 0.5\r\n                    );\r\n\r\n                    const tile = layer.getTileAtWorldXY(\r\n                        posX,\r\n                        gameObject.y - 0.5\r\n                    );\r\n\r\n                    // check for collisions\r\n                    if (\r\n                        !groundTile?.properties?.collideUp\r\n                        || (direction === FACING_RIGHT && tile?.properties?.collideLeft)\r\n                        || (direction === FACING_LEFT && tile?.properties?.collideRight)\r\n                    ) {\r\n                        let newPosX =\r\n                            lastGroundTile?.pixelX\r\n                            || tile?.pixelX\r\n                            || Math.round(posX / TILE_WIDTH) * TILE_WIDTH;\r\n                        newPosX += (TILE_WIDTH * multiplier);\r\n\r\n                        // create a custom collider object\r\n                        const platformLimitCollider = createInteractiveGameObject(\r\n                            gameObject.scene,\r\n                            newPosX,\r\n                            gameObject.y - TILE_HEIGHT,\r\n                            TILE_WIDTH,\r\n                            TILE_HEIGHT,\r\n                            'something'\r\n                        );\r\n\r\n                        // create a collision between the gameobject and the custom collider\r\n                        scene.physics.add.collider(gameObject, platformLimitCollider, () => {\r\n                            gameObject.body.setVelocityX(\r\n                                -gameObject.body.velocity.x\r\n                            );\r\n                            gameObject.setFlipX(!gameObject.flipX);\r\n                        });\r\n                        result.push(platformLimitCollider);\r\n\r\n                        // return true so the 'some' doesn't run anymore\r\n                        return true;\r\n                    }\r\n\r\n                    lastGroundTile = groundTile;\r\n                    return false;\r\n                }\r\n            );\r\n        });\r\n    });\r\n\r\n    return result;\r\n}\r\n```\r\n\r\nAnd with that code, we have the result below.\r\n\r\n![Static AI calculation](../../uploads/blog/2020/12/static-ai-calculation.gif)\r\n\r\nMy main goal is to create all the rules of the game based on elements and interactions so that afterward I can simply create a stage on Tiled and everything works without having to mess around with it, creating colliders and other things manually, just like how Breath of The Wild was made. I much rather that the game calculate it all for me, so I can focus on creating levels. In the end, I'll have something like a Mario Maker üòÉ.\r\n\r\nAnd that was all for today, thanks for reading and watching the video, and don't forget to leave your comment about what you are thinking about this series of posts/videos. Until next week!\r\n","frontmatter":{"tags":["coding","games","javascript","phaser","phaser 3","game devlog","gamedev","skate platformer","super ollie vs pebble corp","webpack","tiled","cyberpunk 2077","stadia","ai"],"categories":["games"],"allowComments":true,"publishOnMedium":false,"cover":null,"date":"2020-12-15T00:00:00.000Z","id":null,"path":"creating-a-smarter-and-more-performing-ai-on-phaser-js-skate-platformer-game-devlog-15","show":true,"title":"Creating a smarter and more performing AI on Phaser JS - Game Devlog #15","hideExcerpt":false,"subtitle":""}}},{"node":{"excerpt":"Vamos l√°, se prepare pois o devlog de hoje √© longo, mas vale‚Ä¶","html":"<p>Vamos l√°, se prepare pois o devlog de hoje √© longo, mas vale a pena. Eu estou muito feliz que eu consegui fazer esse devlog, afinal Cyberpunk 2077 saiu essa semana e eu comecei a jogar no Stadia! O devlog de hoje est√° longo porque quero explicar o motivo pelo qual estou fazendo certas coisas.</p>\n<p>Hoje vou mostrar como melhorei a AI dos inimigos do jogo e por que lido com tantos edge cases no meu c√≥digo. Bora l√°!</p>\n<p><div class=\"gatsby-resp-iframe-wrapper\" style=\"padding-bottom: 56.42857142857143%; position: relative; height: 0; overflow: hidden; margin-bottom: 1.0725rem\" > <div class=\"embedVideo-container\"> <iframe title=\"\" src=\"https://www.youtube.com/embed/KoCubm17q8s?rel=0\" class=\"embedVideo-iframe\" style=\"border:0; position: absolute; top: 0; left: 0; width: 100%; height: 100%; \" loading=\"eager\" allowfullscreen=\"\" sandbox=\"allow-same-origin allow-scripts allow-popups\"></iframe> </div> </div></p>\n<p>Minha primeira tentativa no algoritmo de AI foi calcul√°-lo em tempo de execu√ß√£o, ent√£o onde quer que eu colocasse um inimigo, ele se moveria e calcularia se deveria girar ou n√£o em cada frame, isso era muito pesado para o processador, especialmente quando eu tinha muitos inimigos na tela ao mesmo tempo.</p>\n<p>Havia duas maneiras de abordar esse problema, uma seria criar manualmente um path est√°tico no Tiled e fazer o inimigo seguir esse path, mas sempre que adicionar um novo inimigo, eu teria que adicionar um path para ele tamb√©m, e isso pode acaba sendo um trabalho super tedioso, sem contar √†s vezes que eu com certeza esqueceria de adicionar o path. Complicado.</p>\n<p>A segunda op√ß√£o √© ao inv√©s de calcular o comportamento do inimigo em cada frame, eu poderia pr√©-calcular todos eles assim que a fase fosse carregada, e ent√£o definir esse path estaticamente, desta forma eu teria a liberdade de adicionar inimigos onde eu quisesse no Tiled, sem ter que adicionar paths extras para eles seguirem e tamb√©m manter a taxa de frames est√°vel por n√£o processar a l√≥gica do inimigo em cada frame.</p>\n<p>Ent√£o, como eu fiz isso? Primeiro, h√° alguns edge cases que eu preciso lidar, tipo e se o inimigo n√£o estiver em uma plataforma ou ch√£o? Ou e se a plataforma n√£o tiver bordas? Eu sei que eu mesmo estarei fazendo as fases no Tiled, mas √© bom lidar com esses problemas de qualquer forma, porque nunca sabemos quais bugs o futuro nos reserva.</p>\n<p>J√° que eu n√£o tenho como saber se o inimigo j√° est√° em uma plataforma ou n√£o, eu preciso esperar a f√≠sica do jogo entrar em a√ß√£o e calcular a posi√ß√£o do inimigo, como √† gravidade e outras coisas, ent√£o ao inv√©s de calcular a AI est√°tica no <code class=\"language-text\">construtor</code>, estou fazendo isso na fun√ß√£o <code class=\"language-text\">update</code> e, depois de calculado, simplesmente ‚Äúremovo‚Äù a fun√ß√£o <code class=\"language-text\">update</code> substituindo-a por uma fun√ß√£o <code class=\"language-text\">no-op</code> (no operation).</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">Enemy</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">GameObjects<span class=\"token punctuation\">.</span>Sprite</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span> scene<span class=\"token punctuation\">,</span> x<span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">,</span> asset <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token keyword\">super</span><span class=\"token punctuation\">(</span>scene<span class=\"token punctuation\">,</span> x<span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">,</span> asset<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>staticAi <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token constant\">PLATFORM_WALKING</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>aiColliders <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span>\r\n\r\n    <span class=\"token function\">update</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">time<span class=\"token punctuation\">,</span> delta</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>aiColliders<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n            <span class=\"token comment\">// we don't need the update function anymore</span>\r\n            <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function-variable function\">update</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\r\n            <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token punctuation\">}</span>\r\n\r\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>staticAi<span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">aiStrategy</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>aiStrategy <span class=\"token operator\">===</span> <span class=\"token constant\">PLATFORM_WALKING</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n                <span class=\"token comment\">// first check if the enemy is on a platform</span>\r\n                <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>touchingDownObject<span class=\"token operator\">?.</span>layer<span class=\"token operator\">?.</span>tilemapLayer<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n                    <span class=\"token comment\">// then calculate the colliders that will make the enemy change direction</span>\r\n                    <span class=\"token keyword\">const</span> colliders <span class=\"token operator\">=</span> <span class=\"token function\">staticPlatformWalkingBehavior</span><span class=\"token punctuation\">(</span>\r\n                        <span class=\"token keyword\">this</span><span class=\"token punctuation\">,</span>\r\n                        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>touchingDownObject<span class=\"token punctuation\">.</span>layer<span class=\"token punctuation\">.</span>tilemapLayer\r\n                    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n                    <span class=\"token comment\">// TODO concat array</span>\r\n                    colliders<span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">collider</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>aiColliders<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span>collider<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                <span class=\"token punctuation\">}</span>\r\n            <span class=\"token punctuation\">}</span>\r\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span>\r\n<span class=\"token punctuation\">}</span>\r\n\r\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> Enemy<span class=\"token punctuation\">;</span></code></pre></div>\n<p>E ent√£o toda a m√°gica acontece dentro do <code class=\"language-text\">staticPlatformWalkingBehavior</code>, que honestamente √© super simples e zero m√°gica, eu s√≥ preciso pegar a layer de colis√£o do inimigo e verificar se h√° uma borda na plataforma em ambas as dire√ß√µes. O √∫nico problema dessa fun√ß√£o √© que n√£o quero que ela rode para sempre at√© encontrar uma borda, porque talvez a plataforma n√£o tenha uma borda, quem sabe? Ent√£o, em vez disso, executarei esse loop para cada tile que eu tenho dentro da largura do mapa.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">function</span> <span class=\"token function\">staticPlatformWalkingBehavior</span><span class=\"token punctuation\">(</span>\r\n    <span class=\"token parameter\">gameObject<span class=\"token punctuation\">,</span>\r\n    dynamicLayer</span>\r\n<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> scene <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> gameObject<span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">const</span> divider <span class=\"token operator\">=</span> <span class=\"token constant\">TILE_WIDTH</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">const</span> loopSize <span class=\"token operator\">=</span> scene<span class=\"token punctuation\">.</span>mapData<span class=\"token punctuation\">.</span>tileSize<span class=\"token punctuation\">.</span>width <span class=\"token operator\">*</span> divider<span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">const</span> result <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">const</span> layers <span class=\"token operator\">=</span> dynamicLayer<span class=\"token operator\">?.</span>getChildren<span class=\"token operator\">?.</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">||</span> <span class=\"token punctuation\">[</span>dynamicLayer<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\r\n\r\n    <span class=\"token comment\">// for each collision layer</span>\r\n    layers<span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">layer</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token comment\">// for each direction</span>\r\n        <span class=\"token punctuation\">[</span><span class=\"token constant\">FACING_RIGHT</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">FACING_LEFT</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">direction</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n            <span class=\"token comment\">// for each tile of the map * divider</span>\r\n            <span class=\"token keyword\">let</span> lastGroundTile<span class=\"token punctuation\">;</span>\r\n            <span class=\"token keyword\">new</span> <span class=\"token class-name\">Array</span><span class=\"token punctuation\">(</span>loopSize<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">fill</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">some</span><span class=\"token punctuation\">(</span>\r\n                <span class=\"token punctuation\">(</span><span class=\"token parameter\">num<span class=\"token punctuation\">,</span> index</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n                    <span class=\"token keyword\">const</span> multiplier <span class=\"token operator\">=</span> direction <span class=\"token operator\">===</span> <span class=\"token constant\">FACING_RIGHT</span> <span class=\"token operator\">?</span> <span class=\"token number\">1</span> <span class=\"token operator\">:</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\r\n                    <span class=\"token keyword\">const</span> posX <span class=\"token operator\">=</span> gameObject<span class=\"token punctuation\">.</span>x <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>index <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span> <span class=\"token number\">0.5</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> multiplier<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                    <span class=\"token keyword\">const</span> groundTile <span class=\"token operator\">=</span> layer<span class=\"token punctuation\">.</span><span class=\"token function\">getTileAtWorldXY</span><span class=\"token punctuation\">(</span>\r\n                        posX<span class=\"token punctuation\">,</span>\r\n                        gameObject<span class=\"token punctuation\">.</span>y <span class=\"token operator\">+</span> <span class=\"token number\">0.5</span>\r\n                    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n                    <span class=\"token keyword\">const</span> tile <span class=\"token operator\">=</span> layer<span class=\"token punctuation\">.</span><span class=\"token function\">getTileAtWorldXY</span><span class=\"token punctuation\">(</span>\r\n                        posX<span class=\"token punctuation\">,</span>\r\n                        gameObject<span class=\"token punctuation\">.</span>y <span class=\"token operator\">-</span> <span class=\"token number\">0.5</span>\r\n                    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n                    <span class=\"token comment\">// check for collisions</span>\r\n                    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>\r\n                        <span class=\"token operator\">!</span>groundTile<span class=\"token operator\">?.</span>properties<span class=\"token operator\">?.</span>collideUp\r\n                        <span class=\"token operator\">||</span> <span class=\"token punctuation\">(</span>direction <span class=\"token operator\">===</span> <span class=\"token constant\">FACING_RIGHT</span> <span class=\"token operator\">&amp;&amp;</span> tile<span class=\"token operator\">?.</span>properties<span class=\"token operator\">?.</span>collideLeft<span class=\"token punctuation\">)</span>\r\n                        <span class=\"token operator\">||</span> <span class=\"token punctuation\">(</span>direction <span class=\"token operator\">===</span> <span class=\"token constant\">FACING_LEFT</span> <span class=\"token operator\">&amp;&amp;</span> tile<span class=\"token operator\">?.</span>properties<span class=\"token operator\">?.</span>collideRight<span class=\"token punctuation\">)</span>\r\n                    <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n                        <span class=\"token keyword\">let</span> newPosX <span class=\"token operator\">=</span>\r\n                            lastGroundTile<span class=\"token operator\">?.</span>pixelX\r\n                            <span class=\"token operator\">||</span> tile<span class=\"token operator\">?.</span>pixelX\r\n                            <span class=\"token operator\">||</span> Math<span class=\"token punctuation\">.</span><span class=\"token function\">round</span><span class=\"token punctuation\">(</span>posX <span class=\"token operator\">/</span> <span class=\"token constant\">TILE_WIDTH</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token constant\">TILE_WIDTH</span><span class=\"token punctuation\">;</span>\r\n                        newPosX <span class=\"token operator\">+=</span> <span class=\"token punctuation\">(</span><span class=\"token constant\">TILE_WIDTH</span> <span class=\"token operator\">*</span> multiplier<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n                        <span class=\"token comment\">// create a custom collider object</span>\r\n                        <span class=\"token keyword\">const</span> platformLimitCollider <span class=\"token operator\">=</span> <span class=\"token function\">createInteractiveGameObject</span><span class=\"token punctuation\">(</span>\r\n                            gameObject<span class=\"token punctuation\">.</span>scene<span class=\"token punctuation\">,</span>\r\n                            newPosX<span class=\"token punctuation\">,</span>\r\n                            gameObject<span class=\"token punctuation\">.</span>y <span class=\"token operator\">-</span> <span class=\"token constant\">TILE_HEIGHT</span><span class=\"token punctuation\">,</span>\r\n                            <span class=\"token constant\">TILE_WIDTH</span><span class=\"token punctuation\">,</span>\r\n                            <span class=\"token constant\">TILE_HEIGHT</span><span class=\"token punctuation\">,</span>\r\n                            <span class=\"token string\">'something'</span>\r\n                        <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n                        <span class=\"token comment\">// create a collision between the gameobject and the custom collider</span>\r\n                        scene<span class=\"token punctuation\">.</span>physics<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">.</span><span class=\"token function\">collider</span><span class=\"token punctuation\">(</span>gameObject<span class=\"token punctuation\">,</span> platformLimitCollider<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n                            gameObject<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span><span class=\"token function\">setVelocityX</span><span class=\"token punctuation\">(</span>\r\n                                <span class=\"token operator\">-</span>gameObject<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span>velocity<span class=\"token punctuation\">.</span>x\r\n                            <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                            gameObject<span class=\"token punctuation\">.</span><span class=\"token function\">setFlipX</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>gameObject<span class=\"token punctuation\">.</span>flipX<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                        result<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span>platformLimitCollider<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n                        <span class=\"token comment\">// return true so the 'some' doesn't run anymore</span>\r\n                        <span class=\"token keyword\">return</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span>\r\n                    <span class=\"token punctuation\">}</span>\r\n\r\n                    lastGroundTile <span class=\"token operator\">=</span> groundTile<span class=\"token punctuation\">;</span>\r\n                    <span class=\"token keyword\">return</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span>\r\n                <span class=\"token punctuation\">}</span>\r\n            <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n    <span class=\"token keyword\">return</span> result<span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>E com esse c√≥digo, temos o resultado abaixo.</p>\n<p><img src=\"/c44e9c39ebda2dbd1987240257d76317/static-ai-calculation.gif\" alt=\"C√°lculo est√°tico da AI\"></p>\n<p>O meu principal objetivo √© criar todas as regras de jogo baseadas em elementos e intera√ß√µes para que depois eu possa simplesmente criar uma fase no Tiled e tudo funcionar sem eu precisar ficar mexendo muito nela, criando colliders e outras coisas manualmente, assim como fizeram no Breath of The Wild. Eu prefiro que o jogo calcule tudo isso pra mim para que eu possa focar em criar novas fases sem dificuldade. E no final eu vou ter tipo um Mario Maker üòÉ.</p>\n<p>E por hoje ficamos por aqui, obrigado por ler e assistir o v√≠deo e n√£o se esque√ßa de deixar o seu coment√°rio sobre o que voc√™ est√° achando dessa s√©rie de posts / v√≠deos. At√© semana que vem!</p>","fields":{"postHashId":"Z2FtZXN0cnVlbnVsbDIwMjAtMTItMTVUMDA6MDA6MDAuMDAwWg==","slug":"/2020/2020-15-12-criando-uma-ai-mais-inteligente-e-performatica-no-phaser-js-skate-platformer-game-devlog-15.pt-br/","path":"/blog/games/criando-uma-ai-mais-inteligente-e-performatica-no-phaser-js-skate-platformer-game-devlog-15/","locale":"pt-br"},"rawMarkdownBody":"Vamos l√°, se prepare pois o devlog de hoje √© longo, mas vale a pena. Eu estou muito feliz que eu consegui fazer esse devlog, afinal Cyberpunk 2077 saiu essa semana e eu comecei a jogar no Stadia! O devlog de hoje est√° longo porque quero explicar o motivo pelo qual estou fazendo certas coisas.\r\n\r\nHoje vou mostrar como melhorei a AI dos inimigos do jogo e por que lido com tantos edge cases no meu c√≥digo. Bora l√°!\r\n\r\n`youtube: https://www.youtube.com/watch?v=KoCubm17q8s`\r\n\r\nMinha primeira tentativa no algoritmo de AI foi calcul√°-lo em tempo de execu√ß√£o, ent√£o onde quer que eu colocasse um inimigo, ele se moveria e calcularia se deveria girar ou n√£o em cada frame, isso era muito pesado para o processador, especialmente quando eu tinha muitos inimigos na tela ao mesmo tempo.\r\n\r\nHavia duas maneiras de abordar esse problema, uma seria criar manualmente um path est√°tico no Tiled e fazer o inimigo seguir esse path, mas sempre que adicionar um novo inimigo, eu teria que adicionar um path para ele tamb√©m, e isso pode acaba sendo um trabalho super tedioso, sem contar √†s vezes que eu com certeza esqueceria de adicionar o path. Complicado.\r\n\r\nA segunda op√ß√£o √© ao inv√©s de calcular o comportamento do inimigo em cada frame, eu poderia pr√©-calcular todos eles assim que a fase fosse carregada, e ent√£o definir esse path estaticamente, desta forma eu teria a liberdade de adicionar inimigos onde eu quisesse no Tiled, sem ter que adicionar paths extras para eles seguirem e tamb√©m manter a taxa de frames est√°vel por n√£o processar a l√≥gica do inimigo em cada frame.\r\n\r\nEnt√£o, como eu fiz isso? Primeiro, h√° alguns edge cases que eu preciso lidar, tipo e se o inimigo n√£o estiver em uma plataforma ou ch√£o? Ou e se a plataforma n√£o tiver bordas? Eu sei que eu mesmo estarei fazendo as fases no Tiled, mas √© bom lidar com esses problemas de qualquer forma, porque nunca sabemos quais bugs o futuro nos reserva.\r\n\r\nJ√° que eu n√£o tenho como saber se o inimigo j√° est√° em uma plataforma ou n√£o, eu preciso esperar a f√≠sica do jogo entrar em a√ß√£o e calcular a posi√ß√£o do inimigo, como √† gravidade e outras coisas, ent√£o ao inv√©s de calcular a AI est√°tica no `construtor`, estou fazendo isso na fun√ß√£o `update` e, depois de calculado, simplesmente \"removo\" a fun√ß√£o `update` substituindo-a por uma fun√ß√£o `no-op` (no operation).\r\n\r\n```javascript\r\nclass Enemy extends GameObjects.Sprite {\r\n    constructor({ scene, x, y, asset }) {\r\n        super(scene, x, y, asset);\r\n        this.staticAi = [PLATFORM_WALKING];\r\n        this.aiColliders = [];\r\n    }\r\n\r\n    update(time, delta) {\r\n        if (this.aiColliders.length) {\r\n            // we don't need the update function anymore\r\n            this.update = () => {};\r\n            return;\r\n        }\r\n\r\n        this.staticAi.forEach((aiStrategy) => {\r\n            if (aiStrategy === PLATFORM_WALKING) {\r\n                // first check if the enemy is on a platform\r\n                if (this.touchingDownObject?.layer?.tilemapLayer) {\r\n                    // then calculate the colliders that will make the enemy change direction\r\n                    const colliders = staticPlatformWalkingBehavior(\r\n                        this,\r\n                        this.touchingDownObject.layer.tilemapLayer\r\n                    );\r\n\r\n                    // TODO concat array\r\n                    colliders.forEach((collider) => this.aiColliders.push(collider));\r\n                }\r\n            }\r\n        });\r\n    }\r\n}\r\n\r\nexport default Enemy;\r\n```\r\n\r\nE ent√£o toda a m√°gica acontece dentro do `staticPlatformWalkingBehavior`, que honestamente √© super simples e zero m√°gica, eu s√≥ preciso pegar a layer de colis√£o do inimigo e verificar se h√° uma borda na plataforma em ambas as dire√ß√µes. O √∫nico problema dessa fun√ß√£o √© que n√£o quero que ela rode para sempre at√© encontrar uma borda, porque talvez a plataforma n√£o tenha uma borda, quem sabe? Ent√£o, em vez disso, executarei esse loop para cada tile que eu tenho dentro da largura do mapa.\r\n\r\n```javascript\r\nexport function staticPlatformWalkingBehavior(\r\n    gameObject,\r\n    dynamicLayer\r\n) {\r\n    const { scene } = gameObject;\r\n    const divider = TILE_WIDTH;\r\n    const loopSize = scene.mapData.tileSize.width * divider;\r\n    const result = [];\r\n    const layers = dynamicLayer?.getChildren?.() || [dynamicLayer];\r\n\r\n    // for each collision layer\r\n    layers.forEach((layer) => {\r\n        // for each direction\r\n        [FACING_RIGHT, FACING_LEFT].forEach((direction) => {\r\n            // for each tile of the map * divider\r\n            let lastGroundTile;\r\n            new Array(loopSize).fill(null).some(\r\n                (num, index) => {\r\n                    const multiplier = direction === FACING_RIGHT ? 1 : -1;\r\n                    const posX = gameObject.x + (((index + 1) - 0.5) * multiplier);\r\n                    const groundTile = layer.getTileAtWorldXY(\r\n                        posX,\r\n                        gameObject.y + 0.5\r\n                    );\r\n\r\n                    const tile = layer.getTileAtWorldXY(\r\n                        posX,\r\n                        gameObject.y - 0.5\r\n                    );\r\n\r\n                    // check for collisions\r\n                    if (\r\n                        !groundTile?.properties?.collideUp\r\n                        || (direction === FACING_RIGHT && tile?.properties?.collideLeft)\r\n                        || (direction === FACING_LEFT && tile?.properties?.collideRight)\r\n                    ) {\r\n                        let newPosX =\r\n                            lastGroundTile?.pixelX\r\n                            || tile?.pixelX\r\n                            || Math.round(posX / TILE_WIDTH) * TILE_WIDTH;\r\n                        newPosX += (TILE_WIDTH * multiplier);\r\n\r\n                        // create a custom collider object\r\n                        const platformLimitCollider = createInteractiveGameObject(\r\n                            gameObject.scene,\r\n                            newPosX,\r\n                            gameObject.y - TILE_HEIGHT,\r\n                            TILE_WIDTH,\r\n                            TILE_HEIGHT,\r\n                            'something'\r\n                        );\r\n\r\n                        // create a collision between the gameobject and the custom collider\r\n                        scene.physics.add.collider(gameObject, platformLimitCollider, () => {\r\n                            gameObject.body.setVelocityX(\r\n                                -gameObject.body.velocity.x\r\n                            );\r\n                            gameObject.setFlipX(!gameObject.flipX);\r\n                        });\r\n                        result.push(platformLimitCollider);\r\n\r\n                        // return true so the 'some' doesn't run anymore\r\n                        return true;\r\n                    }\r\n\r\n                    lastGroundTile = groundTile;\r\n                    return false;\r\n                }\r\n            );\r\n        });\r\n    });\r\n\r\n    return result;\r\n}\r\n```\r\n\r\nE com esse c√≥digo, temos o resultado abaixo.\r\n\r\n![C√°lculo est√°tico da AI](../../uploads/blog/2020/12/static-ai-calculation.gif)\r\n\r\nO meu principal objetivo √© criar todas as regras de jogo baseadas em elementos e intera√ß√µes para que depois eu possa simplesmente criar uma fase no Tiled e tudo funcionar sem eu precisar ficar mexendo muito nela, criando colliders e outras coisas manualmente, assim como fizeram no Breath of The Wild. Eu prefiro que o jogo calcule tudo isso pra mim para que eu possa focar em criar novas fases sem dificuldade. E no final eu vou ter tipo um Mario Maker üòÉ.\r\n\r\nE por hoje ficamos por aqui, obrigado por ler e assistir o v√≠deo e n√£o se esque√ßa de deixar o seu coment√°rio sobre o que voc√™ est√° achando dessa s√©rie de posts / v√≠deos. At√© semana que vem!\r\n","frontmatter":{"tags":["programa√ß√£o","jogos","javascript","phaser","phaser 3","game devlog","gamedev","skate platformer","super ollie vs pebble corp","webpack","tiled","cyberpunk 2077","stadia","ai"],"categories":["games"],"allowComments":true,"publishOnMedium":false,"cover":null,"date":"2020-12-15T00:00:00.000Z","id":null,"path":"criando-uma-ai-mais-inteligente-e-performatica-no-phaser-js-skate-platformer-game-devlog-15","show":true,"title":"Criando uma AI mais inteligente e perform√°tica no Phaser JS - Game Devlog #15","hideExcerpt":false,"subtitle":""}}},{"node":{"excerpt":"Hey, y‚Äôall. This week I bring another tiny devlog due to‚Ä¶","html":"<p>Hey, y‚Äôall. This week I bring another tiny devlog due to being way too hooked in Hyrule Warriors‚Ä¶ yeah yeah I know, but I finally beat the game on difficulty <code class=\"language-text\">Very Hard</code> so now I‚Äôm free. Today I‚Äôm going to show you how to create a rainy weather based on variables set on Tiled.</p>\n<p><div class=\"gatsby-resp-iframe-wrapper\" style=\"padding-bottom: 56.42857142857143%; position: relative; height: 0; overflow: hidden; margin-bottom: 1.0725rem\" > <div class=\"embedVideo-container\"> <iframe title=\"\" src=\"https://www.youtube.com/embed/z6b3F9SwxN0?rel=0\" class=\"embedVideo-iframe\" style=\"border:0; position: absolute; top: 0; left: 0; width: 100%; height: 100%; \" loading=\"eager\" allowfullscreen=\"\" sandbox=\"allow-same-origin allow-scripts allow-popups\"></iframe> </div> </div></p>\n<p>This is really easy to do, the only part that takes some time is tweaking the particle settings until you find something that you like, you can use <a href=\"https://www.particlebarn.com/\" target=\"_blank\" rel=\"noreferrer\">particlebarn.com</a> to help you with that. After finding the configuration that you like, just port it into the game, in my case I‚Äôm using the configuration below.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>rain <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">.</span><span class=\"token function\">particles</span><span class=\"token punctuation\">(</span><span class=\"token string\">'rain_drop'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>rain<span class=\"token punctuation\">.</span><span class=\"token function\">createEmitter</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\r\n    <span class=\"token literal-property property\">x</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">min</span><span class=\"token operator\">:</span> <span class=\"token operator\">-</span><span class=\"token number\">50</span><span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">max</span><span class=\"token operator\">:</span> mapWidth <span class=\"token operator\">+</span> <span class=\"token number\">50</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\r\n    <span class=\"token literal-property property\">y</span><span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span>\r\n    <span class=\"token literal-property property\">lifespan</span><span class=\"token operator\">:</span> <span class=\"token number\">1200</span><span class=\"token punctuation\">,</span>\r\n    <span class=\"token literal-property property\">speedY</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">min</span><span class=\"token operator\">:</span> <span class=\"token number\">200</span><span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">max</span><span class=\"token operator\">:</span> <span class=\"token number\">400</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\r\n    <span class=\"token literal-property property\">gravityY</span><span class=\"token operator\">:</span> <span class=\"token number\">100</span><span class=\"token punctuation\">,</span>\r\n    <span class=\"token literal-property property\">gravityX</span><span class=\"token operator\">:</span> PhaserMath<span class=\"token punctuation\">.</span><span class=\"token function\">Between</span><span class=\"token punctuation\">(</span><span class=\"token number\">100</span><span class=\"token punctuation\">,</span> <span class=\"token number\">200</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\r\n    <span class=\"token literal-property property\">scale</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">start</span><span class=\"token operator\">:</span> <span class=\"token number\">0.5</span><span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">end</span><span class=\"token operator\">:</span> <span class=\"token number\">0.8</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\r\n    <span class=\"token literal-property property\">quantity</span><span class=\"token operator\">:</span> <span class=\"token number\">30</span><span class=\"token punctuation\">,</span>\r\n    <span class=\"token literal-property property\">blendMode</span><span class=\"token operator\">:</span> <span class=\"token string\">'ADD'</span><span class=\"token punctuation\">,</span>\r\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>rain<span class=\"token punctuation\">.</span><span class=\"token function\">setDepth</span><span class=\"token punctuation\">(</span><span class=\"token constant\">WEATHER_DEPTH</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p><img src=\"/d5995b4f2529cb05217c237b43bad353/rainy-weather.gif\" alt=\"Rainy weather\" title=\"The gif compression is not living up to the real effect\"></p>\n<p>Then I wrap this code into an <code class=\"language-text\">if</code> statement and run it whenever I have the property <code class=\"language-text\">weather</code> set to <code class=\"language-text\">rainy</code> on Tiled. And that was it for today, short but awesome I hope.</p>\n<p>Until next week!</p>","fields":{"postHashId":"Z2FtZXN0cnVlbnVsbDIwMjAtMTItMDlUMDA6MDA6MDAuMDAwWg==","slug":"/2020/2020-09-12-creating-custom-weather-on-phaser-js-skate-platformer-game-devlog-14.en/","path":"/blog/games/creating-custom-weather-on-phaser-js-skate-platformer-game-devlog-14/","locale":"en"},"rawMarkdownBody":"Hey, y'all. This week I bring another tiny devlog due to being way too hooked in Hyrule Warriors... yeah yeah I know, but I finally beat the game on difficulty `Very Hard` so now I'm free. Today I'm going to show you how to create a rainy weather based on variables set on Tiled.\r\n\r\n`youtube: https://www.youtube.com/watch?v=z6b3F9SwxN0`\r\n\r\nThis is really easy to do, the only part that takes some time is tweaking the particle settings until you find something that you like, you can use [particlebarn.com](https://www.particlebarn.com/) to help you with that. After finding the configuration that you like, just port it into the game, in my case I'm using the configuration below.\r\n\r\n```javascript\r\nthis.rain = this.add.particles('rain_drop');\r\nthis.rain.createEmitter({\r\n    x: { min: -50, max: mapWidth + 50 },\r\n    y: 0,\r\n    lifespan: 1200,\r\n    speedY: { min: 200, max: 400 },\r\n    gravityY: 100,\r\n    gravityX: PhaserMath.Between(100, 200),\r\n    scale: { start: 0.5, end: 0.8 },\r\n    quantity: 30,\r\n    blendMode: 'ADD',\r\n});\r\nthis.rain.setDepth(WEATHER_DEPTH);\r\n```\r\n\r\n![Rainy weather](../../uploads/blog/2020/12/rainy-weather.gif \"The gif compression is not living up to the real effect\")\r\n\r\nThen I wrap this code into an `if` statement and run it whenever I have the property `weather` set to `rainy` on Tiled. And that was it for today, short but awesome I hope.\r\n\r\nUntil next week!\r\n","frontmatter":{"tags":["coding","games","javascript","phaser","phaser 3","game devlog","gamedev","skate platformer","super ollie vs pebble corp","webpack","tiled","hyrule warriors","weather","rain"],"categories":["games"],"allowComments":true,"publishOnMedium":false,"cover":null,"date":"2020-12-09T00:00:00.000Z","id":null,"path":"creating-custom-weather-on-phaser-js-skate-platformer-game-devlog-14","show":true,"title":"Creating custom weather on Phaser JS - Skate Platformer Game Devlog #14","hideExcerpt":false,"subtitle":""}}},{"node":{"excerpt":"Fala galera. Esta semana eu trago outro devlog pequenininho‚Ä¶","html":"<p>Fala galera. Esta semana eu trago outro devlog pequenininho por causa do Hyrule Warriors‚Ä¶ √â eu sei, mas agora eu fechei o jogo no modo <code class=\"language-text\">Very Hard</code> e estou ‚Äúlivre‚Äù. Hoje vou mostrar como criar um clima chuvoso com base em vari√°veis definidas no Tiled.</p>\n<p><div class=\"gatsby-resp-iframe-wrapper\" style=\"padding-bottom: 56.42857142857143%; position: relative; height: 0; overflow: hidden; margin-bottom: 1.0725rem\" > <div class=\"embedVideo-container\"> <iframe title=\"\" src=\"https://www.youtube.com/embed/z6b3F9SwxN0?rel=0\" class=\"embedVideo-iframe\" style=\"border:0; position: absolute; top: 0; left: 0; width: 100%; height: 100%; \" loading=\"eager\" allowfullscreen=\"\" sandbox=\"allow-same-origin allow-scripts allow-popups\"></iframe> </div> </div></p>\n<p>Isso √© muito f√°cil de fazer, a √∫nica parte que leva algum tempo √© ajustar as configura√ß√µes de part√≠culas at√© encontrar algo que voc√™ goste, voc√™ pode usar <a href=\"https://www.particlebarn.com/\" target=\"_blank\" rel=\"noreferrer\">particlebarn.com</a> para ajudar. Depois de encontrar a configura√ß√£o desejada, basta copia-la para o jogo, no meu caso estou usando a configura√ß√£o abaixo.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>rain <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">.</span><span class=\"token function\">particles</span><span class=\"token punctuation\">(</span><span class=\"token string\">'rain_drop'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>rain<span class=\"token punctuation\">.</span><span class=\"token function\">createEmitter</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\r\n    <span class=\"token literal-property property\">x</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">min</span><span class=\"token operator\">:</span> <span class=\"token operator\">-</span><span class=\"token number\">50</span><span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">max</span><span class=\"token operator\">:</span> mapWidth <span class=\"token operator\">+</span> <span class=\"token number\">50</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\r\n    <span class=\"token literal-property property\">y</span><span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span>\r\n    <span class=\"token literal-property property\">lifespan</span><span class=\"token operator\">:</span> <span class=\"token number\">1200</span><span class=\"token punctuation\">,</span>\r\n    <span class=\"token literal-property property\">speedY</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">min</span><span class=\"token operator\">:</span> <span class=\"token number\">200</span><span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">max</span><span class=\"token operator\">:</span> <span class=\"token number\">400</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\r\n    <span class=\"token literal-property property\">gravityY</span><span class=\"token operator\">:</span> <span class=\"token number\">100</span><span class=\"token punctuation\">,</span>\r\n    <span class=\"token literal-property property\">gravityX</span><span class=\"token operator\">:</span> PhaserMath<span class=\"token punctuation\">.</span><span class=\"token function\">Between</span><span class=\"token punctuation\">(</span><span class=\"token number\">100</span><span class=\"token punctuation\">,</span> <span class=\"token number\">200</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\r\n    <span class=\"token literal-property property\">scale</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">start</span><span class=\"token operator\">:</span> <span class=\"token number\">0.5</span><span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">end</span><span class=\"token operator\">:</span> <span class=\"token number\">0.8</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\r\n    <span class=\"token literal-property property\">quantity</span><span class=\"token operator\">:</span> <span class=\"token number\">30</span><span class=\"token punctuation\">,</span>\r\n    <span class=\"token literal-property property\">blendMode</span><span class=\"token operator\">:</span> <span class=\"token string\">'ADD'</span><span class=\"token punctuation\">,</span>\r\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>rain<span class=\"token punctuation\">.</span><span class=\"token function\">setDepth</span><span class=\"token punctuation\">(</span><span class=\"token constant\">WEATHER_DEPTH</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p><img src=\"/d5995b4f2529cb05217c237b43bad353/rainy-weather.gif\" alt=\"Tempo chuvoso\" title=\"A compress√£o do gif n√£o est√° fazendo jus ao efeito\"></p>\n<p>Depois √© s√≥ colocar esse c√≥digo dentro de um <code class=\"language-text\">if</code> e executa-lo sempre que tiver a propriedade <code class=\"language-text\">weather</code> definida como <code class=\"language-text\">rainy</code> no mapa do Tiled. E foi isso por hoje, curto, mas incr√≠vel haha.</p>\n<p>At√© semana que vem!</p>","fields":{"postHashId":"Z2FtZXN0cnVlbnVsbDIwMjAtMTItMDlUMDA6MDA6MDAuMDAwWg==","slug":"/2020/2020-09-12-criando-clima-chuvoso-no-phaser-js-skate-platformer-game-devlog-14.pt-br/","path":"/blog/games/criando-clima-chuvoso-no-phaser-js-skate-platformer-game-devlog-14/","locale":"pt-br"},"rawMarkdownBody":"Fala galera. Esta semana eu trago outro devlog pequenininho por causa do Hyrule Warriors... √â eu sei, mas agora eu fechei o jogo no modo `Very Hard` e estou \"livre\". Hoje vou mostrar como criar um clima chuvoso com base em vari√°veis definidas no Tiled.\r\n\r\n`youtube: https://www.youtube.com/watch?v=z6b3F9SwxN0`\r\n\r\nIsso √© muito f√°cil de fazer, a √∫nica parte que leva algum tempo √© ajustar as configura√ß√µes de part√≠culas at√© encontrar algo que voc√™ goste, voc√™ pode usar [particlebarn.com](https://www.particlebarn.com/) para ajudar. Depois de encontrar a configura√ß√£o desejada, basta copia-la para o jogo, no meu caso estou usando a configura√ß√£o abaixo.\r\n\r\n```javascript\r\nthis.rain = this.add.particles('rain_drop');\r\nthis.rain.createEmitter({\r\n    x: { min: -50, max: mapWidth + 50 },\r\n    y: 0,\r\n    lifespan: 1200,\r\n    speedY: { min: 200, max: 400 },\r\n    gravityY: 100,\r\n    gravityX: PhaserMath.Between(100, 200),\r\n    scale: { start: 0.5, end: 0.8 },\r\n    quantity: 30,\r\n    blendMode: 'ADD',\r\n});\r\nthis.rain.setDepth(WEATHER_DEPTH);\r\n```\r\n\r\n![Tempo chuvoso](../../uploads/blog/2020/12/rainy-weather.gif \"A compress√£o do gif n√£o est√° fazendo jus ao efeito\")\r\n\r\nDepois √© s√≥ colocar esse c√≥digo dentro de um `if` e executa-lo sempre que tiver a propriedade `weather` definida como `rainy` no mapa do Tiled. E foi isso por hoje, curto, mas incr√≠vel haha.\r\n\r\nAt√© semana que vem!\r\n\r\n","frontmatter":{"tags":["programa√ß√£o","jogos","javascript","phaser","phaser 3","game devlog","gamedev","skate platformer","super ollie vs pebble corp","webpack","tiled","hyrule warriors","clima","chuva"],"categories":["games"],"allowComments":true,"publishOnMedium":false,"cover":null,"date":"2020-12-09T00:00:00.000Z","id":null,"path":"criando-clima-chuvoso-no-phaser-js-skate-platformer-game-devlog-14","show":true,"title":"Criando clima chuvoso no Phaser JS - Skate Platformer Game Devlog #14","hideExcerpt":false,"subtitle":""}}},{"node":{"excerpt":"Hey guys, in today‚Äôs game devlog I‚Äôll add a loading screen‚Ä¶","html":"<p>Hey guys, in today‚Äôs game devlog I‚Äôll add a loading screen showing the assets being loaded and also add the option to use translations in the game‚Äôs texts.</p>\n<p><div class=\"gatsby-resp-iframe-wrapper\" style=\"padding-bottom: 56.42857142857143%; position: relative; height: 0; overflow: hidden; margin-bottom: 1.0725rem\" > <div class=\"embedVideo-container\"> <iframe title=\"\" src=\"https://www.youtube.com/embed/IlOlv-9hKZc?rel=0\" class=\"embedVideo-iframe\" style=\"border:0; position: absolute; top: 0; left: 0; width: 100%; height: 100%; \" loading=\"eager\" allowfullscreen=\"\" sandbox=\"allow-same-origin allow-scripts allow-popups\"></iframe> </div> </div></p>\n<p>To create the loading screen, I followed the <a href=\"https://gamedevacademy.org/creating-a-preloading-screen-in-phaser-3/\" target=\"_blank\" rel=\"noreferrer\">tutorial made by the Zenva folks</a>, which basically comes down to using 3 events that are dispatched by Phaser during the load process of assets in the <code class=\"language-text\">preload</code> function.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>load<span class=\"token punctuation\">.</span><span class=\"token function\">on</span><span class=\"token punctuation\">(</span><span class=\"token string\">'progress'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">value</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>load<span class=\"token punctuation\">.</span><span class=\"token function\">on</span><span class=\"token punctuation\">(</span><span class=\"token string\">'fileprogress'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">file</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>file<span class=\"token punctuation\">.</span>key<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>load<span class=\"token punctuation\">.</span><span class=\"token function\">on</span><span class=\"token punctuation\">(</span><span class=\"token string\">'complete'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'complete'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>And the end result will look something like the following code block. Please follow up <a href=\"https://gamedevacademy.org/creating-a-preloading-screen-in-phaser-3/\" target=\"_blank\" rel=\"noreferrer\">Zenva‚Äôs blog post</a> for a more detailed tutorial.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> progressBox <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">.</span><span class=\"token function\">graphics</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">const</span> progressBar <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">.</span><span class=\"token function\">graphics</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\nprogressBox<span class=\"token punctuation\">.</span><span class=\"token function\">fillStyle</span><span class=\"token punctuation\">(</span><span class=\"token number\">0x222222</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0.8</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\nprogressBox<span class=\"token punctuation\">.</span><span class=\"token function\">fillRect</span><span class=\"token punctuation\">(</span><span class=\"token number\">240</span><span class=\"token punctuation\">,</span> <span class=\"token number\">270</span><span class=\"token punctuation\">,</span> <span class=\"token number\">320</span><span class=\"token punctuation\">,</span> <span class=\"token number\">50</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>load<span class=\"token punctuation\">.</span><span class=\"token function\">on</span><span class=\"token punctuation\">(</span><span class=\"token string\">'progress'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">value</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n    progressBar<span class=\"token punctuation\">.</span><span class=\"token function\">clear</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    progressBar<span class=\"token punctuation\">.</span><span class=\"token function\">fillStyle</span><span class=\"token punctuation\">(</span><span class=\"token number\">0xffffff</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    progressBar<span class=\"token punctuation\">.</span><span class=\"token function\">fillRect</span><span class=\"token punctuation\">(</span><span class=\"token number\">250</span><span class=\"token punctuation\">,</span> <span class=\"token number\">280</span><span class=\"token punctuation\">,</span> <span class=\"token number\">300</span> <span class=\"token operator\">*</span> value<span class=\"token punctuation\">,</span> <span class=\"token number\">30</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>For the translation, I need to initialize the <code class=\"language-text\">i18next</code> plugin with the languages that I want my game to support. This needs to be initialized in your game entry point, probably <code class=\"language-text\">index.js</code> or <code class=\"language-text\">main.js</code>.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> i18next <span class=\"token keyword\">from</span> <span class=\"token string\">'i18next'</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">import</span> LanguageDetector <span class=\"token keyword\">from</span> <span class=\"token string\">'i18next-browser-languagedetector'</span><span class=\"token punctuation\">;</span>\r\n\r\ni18next<span class=\"token punctuation\">.</span><span class=\"token function\">use</span><span class=\"token punctuation\">(</span>LanguageDetector<span class=\"token punctuation\">)</span>\r\n  <span class=\"token punctuation\">.</span><span class=\"token function\">init</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\r\n    <span class=\"token literal-property property\">resources</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\r\n      <span class=\"token literal-property property\">en</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token literal-property property\">translation</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\r\n          <span class=\"token string-property property\">\"loading_ellipsis\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Loading...\"</span><span class=\"token punctuation\">,</span>\r\n          <span class=\"token string-property property\">\"loading_asset_colon\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Loading asset:\"</span><span class=\"token punctuation\">,</span>\r\n          <span class=\"token string-property property\">\"select_your_stage\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Select Your Stage\"</span>\r\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\r\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\r\n      <span class=\"token string-property property\">'pt-BR'</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token literal-property property\">translation</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\r\n          <span class=\"token string-property property\">\"loading_ellipsis\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Carregando...\"</span><span class=\"token punctuation\">,</span>\r\n          <span class=\"token string-property property\">\"loading_asset_colon\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Carregando arquivo: \"</span><span class=\"token punctuation\">,</span>\r\n          <span class=\"token string-property property\">\"select_your_stage\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Selecione sua fase\"</span>\r\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\r\n      <span class=\"token punctuation\">}</span>\r\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\r\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>After that, you can use <code class=\"language-text\">i18next.t('translation_key')</code> anywhere in your game to get that key translation for the current language. You can also change languages manually by calling <code class=\"language-text\">i18next.changeLanguage('language_key')</code>.</p>\n<p>That‚Äôs it for today, I‚Äôm still playing the new Hyrule Warriors but at least I managed to make some progress in the game and the devlog. See you next week!</p>","fields":{"postHashId":"Z2FtZXN0cnVlbnVsbDIwMjAtMTEtMjlUMDA6MDA6MDAuMDAwWg==","slug":"/2020/2020-29-11-creating-a-loading-screen-and-adding-translation-on-phaser-js-skate-platformer-game-devlog-13.en/","path":"/blog/games/creating-a-loading-screen-and-adding-translation-on-phaser-js-skate-platformer-game-devlog-13/","locale":"en"},"rawMarkdownBody":"Hey guys, in today's game devlog I'll add a loading screen showing the assets being loaded and also add the option to use translations in the game's texts.\r\n\r\n`youtube: https://www.youtube.com/watch?v=IlOlv-9hKZc`\r\n\r\nTo create the loading screen, I followed the [tutorial made by the Zenva folks](https://gamedevacademy.org/creating-a-preloading-screen-in-phaser-3/), which basically comes down to using 3 events that are dispatched by Phaser during the load process of assets in the `preload` function.\r\n\r\n```javascript\r\nthis.load.on('progress', (value) => {\r\n    console.log(value);\r\n});\r\n\r\nthis.load.on('fileprogress', (file) => {\r\n    console.log(file.key);\r\n});\r\n\r\nthis.load.on('complete', () => {\r\n    console.log('complete');\r\n});\r\n```\r\n\r\nAnd the end result will look something like the following code block. Please follow up [Zenva's blog post](https://gamedevacademy.org/creating-a-preloading-screen-in-phaser-3/) for a more detailed tutorial.\r\n\r\n```javascript\r\nconst progressBox = this.add.graphics();\r\nconst progressBar = this.add.graphics();\r\nprogressBox.fillStyle(0x222222, 0.8);\r\nprogressBox.fillRect(240, 270, 320, 50);\r\n\r\nthis.load.on('progress', (value) => {\r\n    progressBar.clear();\r\n    progressBar.fillStyle(0xffffff, 1);\r\n    progressBar.fillRect(250, 280, 300 * value, 30);\r\n});\r\n```\r\n\r\nFor the translation, I need to initialize the `i18next` plugin with the languages that I want my game to support. This needs to be initialized in your game entry point, probably `index.js` or `main.js`.\r\n\r\n```javascript\r\nimport i18next from 'i18next';\r\nimport LanguageDetector from 'i18next-browser-languagedetector';\r\n\r\ni18next.use(LanguageDetector)\r\n  .init({\r\n    resources: {\r\n      en: {\r\n        translation: {\r\n          \"loading_ellipsis\": \"Loading...\",\r\n          \"loading_asset_colon\": \"Loading asset:\",\r\n          \"select_your_stage\": \"Select Your Stage\"\r\n        },\r\n      },\r\n      'pt-BR': {\r\n        translation: {\r\n          \"loading_ellipsis\": \"Carregando...\",\r\n          \"loading_asset_colon\": \"Carregando arquivo: \",\r\n          \"select_your_stage\": \"Selecione sua fase\"\r\n        },\r\n      }\r\n    },\r\n  });\r\n```\r\n\r\nAfter that, you can use `i18next.t('translation_key')` anywhere in your game to get that key translation for the current language. You can also change languages manually by calling `i18next.changeLanguage('language_key')`.\r\n\r\nThat's it for today, I'm still playing the new Hyrule Warriors but at least I managed to make some progress in the game and the devlog. See you next week!\r\n","frontmatter":{"tags":["coding","games","javascript","phaser","phaser 3","game devlog","gamedev","skate platformer","super ollie vs pebble corp","webpack","tiled","i18next","translation","hyrule warriors"],"categories":["games"],"allowComments":true,"publishOnMedium":false,"cover":null,"date":"2020-11-29T00:00:00.000Z","id":null,"path":"creating-a-loading-screen-and-adding-translation-on-phaser-js-skate-platformer-game-devlog-13","show":true,"title":"Creating a loading screen and adding translation on Phaser JS - Skate Platformer Game Devlog #13","hideExcerpt":false,"subtitle":""}}},{"node":{"excerpt":"Fala pessoal, no game devlog de hoje eu vou adicionar uma‚Ä¶","html":"<p>Fala pessoal, no game devlog de hoje eu vou adicionar uma loading screen mostrando os assets que est√£o sendo carregados e tamb√©m adicionar a op√ß√£o de usar tradu√ß√µes nos textos do jogo.</p>\n<p><div class=\"gatsby-resp-iframe-wrapper\" style=\"padding-bottom: 56.42857142857143%; position: relative; height: 0; overflow: hidden; margin-bottom: 1.0725rem\" > <div class=\"embedVideo-container\"> <iframe title=\"\" src=\"https://www.youtube.com/embed/IlOlv-9hKZc?rel=0\" class=\"embedVideo-iframe\" style=\"border:0; position: absolute; top: 0; left: 0; width: 100%; height: 100%; \" loading=\"eager\" allowfullscreen=\"\" sandbox=\"allow-same-origin allow-scripts allow-popups\"></iframe> </div> </div></p>\n<p>Para fazer a loading screen, eu segui o <a href=\"https://gamedevacademy.org/creating-a-preloading-screen-in-phaser-3/\" target=\"_blank\" rel=\"noreferrer\">tutorial feito pelo site Zenva</a>, que basicamente se resume em utilizar 3 eventos que s√£o disparados pelo Phaser durante o processo de load dos assets na fun√ß√£o <code class=\"language-text\">preload</code>.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>load<span class=\"token punctuation\">.</span><span class=\"token function\">on</span><span class=\"token punctuation\">(</span><span class=\"token string\">'progress'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">value</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n            \r\n<span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>load<span class=\"token punctuation\">.</span><span class=\"token function\">on</span><span class=\"token punctuation\">(</span><span class=\"token string\">'fileprogress'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">file</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>file<span class=\"token punctuation\">.</span>key<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n \r\n<span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>load<span class=\"token punctuation\">.</span><span class=\"token function\">on</span><span class=\"token punctuation\">(</span><span class=\"token string\">'complete'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'complete'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>E o resultado final ficar√° tipo o c√≥digo abaixo. Veja <a href=\"https://gamedevacademy.org/creating-a-preloading-screen-in-phaser-3/\" target=\"_blank\" rel=\"noreferrer\">o post no blog do Zenva</a> para um tutorial mais detalhado.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> progressBox <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">.</span><span class=\"token function\">graphics</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">const</span> progressBar <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">.</span><span class=\"token function\">graphics</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\nprogressBox<span class=\"token punctuation\">.</span><span class=\"token function\">fillStyle</span><span class=\"token punctuation\">(</span><span class=\"token number\">0x222222</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0.8</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\nprogressBox<span class=\"token punctuation\">.</span><span class=\"token function\">fillRect</span><span class=\"token punctuation\">(</span><span class=\"token number\">240</span><span class=\"token punctuation\">,</span> <span class=\"token number\">270</span><span class=\"token punctuation\">,</span> <span class=\"token number\">320</span><span class=\"token punctuation\">,</span> <span class=\"token number\">50</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>load<span class=\"token punctuation\">.</span><span class=\"token function\">on</span><span class=\"token punctuation\">(</span><span class=\"token string\">'progress'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">value</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n    progressBar<span class=\"token punctuation\">.</span><span class=\"token function\">clear</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    progressBar<span class=\"token punctuation\">.</span><span class=\"token function\">fillStyle</span><span class=\"token punctuation\">(</span><span class=\"token number\">0xffffff</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    progressBar<span class=\"token punctuation\">.</span><span class=\"token function\">fillRect</span><span class=\"token punctuation\">(</span><span class=\"token number\">250</span><span class=\"token punctuation\">,</span> <span class=\"token number\">280</span><span class=\"token punctuation\">,</span> <span class=\"token number\">300</span> <span class=\"token operator\">*</span> value<span class=\"token punctuation\">,</span> <span class=\"token number\">30</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Para a tradu√ß√£o, tenho que inicializar o plugin <code class=\"language-text\">i18next</code> com os idiomas que desejo que meu jogo suporte. Isso precisa ser inicializado no entry point do jogo, provavelmente o arquivo <code class=\"language-text\">index.js</code> ou <code class=\"language-text\">main.js</code>.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> i18next <span class=\"token keyword\">from</span> <span class=\"token string\">'i18next'</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">import</span> LanguageDetector <span class=\"token keyword\">from</span> <span class=\"token string\">'i18next-browser-languagedetector'</span><span class=\"token punctuation\">;</span>\r\n\r\ni18next<span class=\"token punctuation\">.</span><span class=\"token function\">use</span><span class=\"token punctuation\">(</span>LanguageDetector<span class=\"token punctuation\">)</span>\r\n  <span class=\"token punctuation\">.</span><span class=\"token function\">init</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\r\n    <span class=\"token literal-property property\">resources</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\r\n      <span class=\"token literal-property property\">en</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token literal-property property\">translation</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\r\n          <span class=\"token string-property property\">\"loading_ellipsis\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Loading...\"</span><span class=\"token punctuation\">,</span>\r\n          <span class=\"token string-property property\">\"loading_asset_colon\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Loading asset:\"</span><span class=\"token punctuation\">,</span>\r\n          <span class=\"token string-property property\">\"select_your_stage\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Select Your Stage\"</span>\r\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\r\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\r\n      <span class=\"token string-property property\">'pt-BR'</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token literal-property property\">translation</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\r\n          <span class=\"token string-property property\">\"loading_ellipsis\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Carregando...\"</span><span class=\"token punctuation\">,</span>\r\n          <span class=\"token string-property property\">\"loading_asset_colon\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Carregando arquivo: \"</span><span class=\"token punctuation\">,</span>\r\n          <span class=\"token string-property property\">\"select_your_stage\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Selecione sua fase\"</span>\r\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\r\n      <span class=\"token punctuation\">}</span>\r\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\r\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Depois disso, voc√™ pode usar <code class=\"language-text\">i18next.t('translation_key')</code> em qualquer lugar do jogo para obter a tradu√ß√£o de uma key para o idioma atual. Voc√™ tamb√©m pode alterar o idioma manualmente chamando <code class=\"language-text\">i18next.changeLanguage('language_key')</code>.</p>\n<p>E por hoje √© isso, eu ainda estou jogando o novo Hyrule Warriors mas pelo menos consegui fazer um pouco de progresso no jogo e no devlog. Vejo voc√™s semana que vem, at√©!</p>","fields":{"postHashId":"Z2FtZXN0cnVlbnVsbDIwMjAtMTEtMjlUMDA6MDA6MDAuMDAwWg==","slug":"/2020/2020-29-11-criando-uma-loading-screen-e-traduzindo-o-meu-jogo-no-phaser-js-skate-platformer-game-devlog-13.pt-br/","path":"/blog/games/criando-uma-loading-screen-e-traduzindo-o-meu-jogo-no-phaser-js-skate-platformer-game-devlog-13/","locale":"pt-br"},"rawMarkdownBody":"Fala pessoal, no game devlog de hoje eu vou adicionar uma loading screen mostrando os assets que est√£o sendo carregados e tamb√©m adicionar a op√ß√£o de usar tradu√ß√µes nos textos do jogo.\r\n\r\n`youtube: https://www.youtube.com/watch?v=IlOlv-9hKZc`\r\n\r\nPara fazer a loading screen, eu segui o [tutorial feito pelo site Zenva](https://gamedevacademy.org/creating-a-preloading-screen-in-phaser-3/), que basicamente se resume em utilizar 3 eventos que s√£o disparados pelo Phaser durante o processo de load dos assets na fun√ß√£o `preload`.\r\n\r\n```javascript\r\nthis.load.on('progress', (value) => {\r\n    console.log(value);\r\n});\r\n            \r\nthis.load.on('fileprogress', (file) => {\r\n    console.log(file.key);\r\n});\r\n \r\nthis.load.on('complete', () => {\r\n    console.log('complete');\r\n});\r\n```\r\n\r\nE o resultado final ficar√° tipo o c√≥digo abaixo. Veja [o post no blog do Zenva](https://gamedevacademy.org/creating-a-preloading-screen-in-phaser-3/) para um tutorial mais detalhado.\r\n\r\n```javascript\r\nconst progressBox = this.add.graphics();\r\nconst progressBar = this.add.graphics();\r\nprogressBox.fillStyle(0x222222, 0.8);\r\nprogressBox.fillRect(240, 270, 320, 50);\r\n\r\nthis.load.on('progress', (value) => {\r\n    progressBar.clear();\r\n    progressBar.fillStyle(0xffffff, 1);\r\n    progressBar.fillRect(250, 280, 300 * value, 30);\r\n});\r\n```\r\n\r\nPara a tradu√ß√£o, tenho que inicializar o plugin `i18next` com os idiomas que desejo que meu jogo suporte. Isso precisa ser inicializado no entry point do jogo, provavelmente o arquivo `index.js` ou `main.js`.\r\n\r\n```javascript\r\nimport i18next from 'i18next';\r\nimport LanguageDetector from 'i18next-browser-languagedetector';\r\n\r\ni18next.use(LanguageDetector)\r\n  .init({\r\n    resources: {\r\n      en: {\r\n        translation: {\r\n          \"loading_ellipsis\": \"Loading...\",\r\n          \"loading_asset_colon\": \"Loading asset:\",\r\n          \"select_your_stage\": \"Select Your Stage\"\r\n        },\r\n      },\r\n      'pt-BR': {\r\n        translation: {\r\n          \"loading_ellipsis\": \"Carregando...\",\r\n          \"loading_asset_colon\": \"Carregando arquivo: \",\r\n          \"select_your_stage\": \"Selecione sua fase\"\r\n        },\r\n      }\r\n    },\r\n  });\r\n```\r\n\r\nDepois disso, voc√™ pode usar `i18next.t('translation_key')` em qualquer lugar do jogo para obter a tradu√ß√£o de uma key para o idioma atual. Voc√™ tamb√©m pode alterar o idioma manualmente chamando `i18next.changeLanguage('language_key')`.\r\n\r\nE por hoje √© isso, eu ainda estou jogando o novo Hyrule Warriors mas pelo menos consegui fazer um pouco de progresso no jogo e no devlog. Vejo voc√™s semana que vem, at√©!\r\n","frontmatter":{"tags":["programa√ß√£o","jogos","javascript","phaser","phaser 3","game devlog","gamedev","skate platformer","super ollie vs pebble corp","webpack","tiled","i18next","tradu√ß√£o","hyrule warriors"],"categories":["games"],"allowComments":true,"publishOnMedium":false,"cover":null,"date":"2020-11-29T00:00:00.000Z","id":null,"path":"criando-uma-loading-screen-e-traduzindo-o-meu-jogo-no-phaser-js-skate-platformer-game-devlog-13","show":true,"title":"Criando uma loading screen e traduzindo o meu jogo no Phaser JS - Skate Platformer Game Devlog #13","hideExcerpt":false,"subtitle":""}}},{"node":{"excerpt":"Fala pessoal! No v√≠deo de hoje vou mostrar como eu fiz para‚Ä¶","html":"<p>Fala pessoal! No v√≠deo de hoje vou mostrar como eu fiz para criar um checkpoint para o her√≥i no meu jogo de uma maneira bem f√°cil.</p>\n<p><div class=\"gatsby-resp-iframe-wrapper\" style=\"padding-bottom: 56.42857142857143%; position: relative; height: 0; overflow: hidden; margin-bottom: 1.0725rem\" > <div class=\"embedVideo-container\"> <iframe title=\"\" src=\"https://www.youtube.com/embed/KKsg96FD2qI?rel=0\" class=\"embedVideo-iframe\" style=\"border:0; position: absolute; top: 0; left: 0; width: 100%; height: 100%; \" loading=\"eager\" allowfullscreen=\"\" sandbox=\"allow-same-origin allow-scripts allow-popups\"></iframe> </div> </div></p>\n<p>Bom, eu basicamente fiz tudo em duas etapas. Primeiro, defino um overlap entre o her√≥i e meu objeto de checkpoint e, dentro da fun√ß√£o de callback, salvo a posi√ß√£o atual do her√≥i para ser usada posteriormente.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> checkpoint <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Checkpoint</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">const</span> overlap <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>physics<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">.</span><span class=\"token function\">overlap</span><span class=\"token punctuation\">(</span>\r\n  <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>player<span class=\"token punctuation\">,</span>\r\n  checkpoint<span class=\"token punctuation\">,</span>\r\n  <span class=\"token punctuation\">(</span><span class=\"token parameter\">objectA<span class=\"token punctuation\">,</span> objectB</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n    checkpoint<span class=\"token punctuation\">.</span><span class=\"token function\">setAnimation</span><span class=\"token punctuation\">(</span><span class=\"token string\">'save'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    overlap<span class=\"token operator\">?.</span><span class=\"token function\">destroy</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n    <span class=\"token comment\">// save it to the browser local storage</span>\r\n    localStorage<span class=\"token punctuation\">.</span><span class=\"token function\">setItem</span><span class=\"token punctuation\">(</span><span class=\"token string\">'hero_checkpoint'</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">stringify</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\r\n      <span class=\"token literal-property property\">x</span><span class=\"token operator\">:</span> hero<span class=\"token punctuation\">.</span>x<span class=\"token punctuation\">,</span>\r\n      <span class=\"token literal-property property\">y</span><span class=\"token operator\">:</span> hero<span class=\"token punctuation\">.</span>y<span class=\"token punctuation\">,</span>\r\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>E no final da minha fun√ß√£o <code class=\"language-text\">create</code> da minha scene, eu coloco o her√≥i na nova posi√ß√£o salva de antes.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> heroCheckpoint <span class=\"token operator\">=</span> localStorage<span class=\"token punctuation\">.</span><span class=\"token function\">getItem</span><span class=\"token punctuation\">(</span><span class=\"token string\">'hero_checkpoint'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>heroCheckpoint<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">const</span> position <span class=\"token operator\">=</span> <span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">parse</span><span class=\"token punctuation\">(</span>heroCheckpoint<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>player<span class=\"token punctuation\">.</span><span class=\"token function\">setX</span><span class=\"token punctuation\">(</span>position<span class=\"token punctuation\">.</span>x<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>player<span class=\"token punctuation\">.</span><span class=\"token function\">setY</span><span class=\"token punctuation\">(</span>position<span class=\"token punctuation\">.</span>y<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span>\r\n\r\n<span class=\"token comment\">// always remove the key just in case</span>\r\nlocalStorage<span class=\"token punctuation\">.</span><span class=\"token function\">removeItem</span><span class=\"token punctuation\">(</span><span class=\"token string\">'hero_checkpoint'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>E √© isso. Super simples, certo? Desculpe pelo devlog curto esta semana, mas eu tive um pequeno acidente na minha m√£o, como falei no v√≠deo, e me impossibilitou de programar por uns dias.</p>\n<p>Essa semana, o novo Hyrule Warriors ser√° lan√ßado, ent√£o n√£o posso prometer que farei novos devlogs tamb√©m üò¨ mas vou tentar!</p>","fields":{"postHashId":"Z2FtZXN0cnVlbnVsbDIwMjAtMTEtMTlUMDA6MDA6MDAuMDAwWg==","slug":"/2020/2020-19-11-salvando-progresso-do-jogador-com-checkpoints-no-phaser-js-skate-platformer-game-devlog-12.pt-br/","path":"/blog/games/salvando-progresso-do-jogador-com-checkpoints-no-phaser-js-skate-platformer-game-devlog-12/","locale":"pt-br"},"rawMarkdownBody":"Fala pessoal! No v√≠deo de hoje vou mostrar como eu fiz para criar um checkpoint para o her√≥i no meu jogo de uma maneira bem f√°cil.\r\n\r\n`youtube: https://www.youtube.com/watch?v=KKsg96FD2qI`\r\n\r\nBom, eu basicamente fiz tudo em duas etapas. Primeiro, defino um overlap entre o her√≥i e meu objeto de checkpoint e, dentro da fun√ß√£o de callback, salvo a posi√ß√£o atual do her√≥i para ser usada posteriormente.\r\n\r\n```javascript\r\nconst checkpoint = new Checkpoint();\r\nconst overlap = this.physics.add.overlap(\r\n  this.player,\r\n  checkpoint,\r\n  (objectA, objectB) => {\r\n    checkpoint.setAnimation('save');\r\n    overlap?.destroy();\r\n\r\n    // save it to the browser local storage\r\n    localStorage.setItem('hero_checkpoint', JSON.stringify({\r\n      x: hero.x,\r\n      y: hero.y,\r\n    }));\r\n});\r\n```\r\n\r\nE no final da minha fun√ß√£o `create` da minha scene, eu coloco o her√≥i na nova posi√ß√£o salva de antes.\r\n\r\n```javascript\r\nconst heroCheckpoint = localStorage.getItem('hero_checkpoint');\r\nif (heroCheckpoint) {\r\n    const position = JSON.parse(heroCheckpoint);\r\n    this.player.setX(position.x);\r\n    this.player.setY(position.y);\r\n}\r\n\r\n// always remove the key just in case\r\nlocalStorage.removeItem('hero_checkpoint');\r\n```\r\n\r\nE √© isso. Super simples, certo? Desculpe pelo devlog curto esta semana, mas eu tive um pequeno acidente na minha m√£o, como falei no v√≠deo, e me impossibilitou de programar por uns dias.\r\n\r\nEssa semana, o novo Hyrule Warriors ser√° lan√ßado, ent√£o n√£o posso prometer que farei novos devlogs tamb√©m üò¨ mas vou tentar!\r\n","frontmatter":{"tags":["programa√ß√£o","jogos","javascript","phaser","phaser 3","game devlog","gamedev","skate platformer","super ollie vs pebble corp","webpack","tiled","hyrule warriors"],"categories":["games"],"allowComments":true,"publishOnMedium":false,"cover":null,"date":"2020-11-19T00:00:00.000Z","id":null,"path":"salvando-progresso-do-jogador-com-checkpoints-no-phaser-js-skate-platformer-game-devlog-12","show":true,"title":"Salvando progresso do jogador com checkpoints no Phaser JS - Skate Platformer Game Devlog #12","hideExcerpt":false,"subtitle":""}}},{"node":{"excerpt":"Hey guys! In today‚Äôs video, I will show you how I created a‚Ä¶","html":"<p>Hey guys! In today‚Äôs video, I will show you how I created a checkpoint for the hero in my game in a very easy way.</p>\n<p><div class=\"gatsby-resp-iframe-wrapper\" style=\"padding-bottom: 56.42857142857143%; position: relative; height: 0; overflow: hidden; margin-bottom: 1.0725rem\" > <div class=\"embedVideo-container\"> <iframe title=\"\" src=\"https://www.youtube.com/embed/KKsg96FD2qI?rel=0\" class=\"embedVideo-iframe\" style=\"border:0; position: absolute; top: 0; left: 0; width: 100%; height: 100%; \" loading=\"eager\" allowfullscreen=\"\" sandbox=\"allow-same-origin allow-scripts allow-popups\"></iframe> </div> </div></p>\n<p>So this is done pretty much in two easy steps, first I set overlap between the hero and my checkpoint object, and inside the callback function, I save the current hero position to be used later on.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> checkpoint <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Checkpoint</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">const</span> overlap <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>physics<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">.</span><span class=\"token function\">overlap</span><span class=\"token punctuation\">(</span>\r\n  <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>player<span class=\"token punctuation\">,</span>\r\n  checkpoint<span class=\"token punctuation\">,</span>\r\n  <span class=\"token punctuation\">(</span><span class=\"token parameter\">objectA<span class=\"token punctuation\">,</span> objectB</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n    checkpoint<span class=\"token punctuation\">.</span><span class=\"token function\">setAnimation</span><span class=\"token punctuation\">(</span><span class=\"token string\">'save'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    overlap<span class=\"token operator\">?.</span><span class=\"token function\">destroy</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n    <span class=\"token comment\">// save it to the browser local storage</span>\r\n    localStorage<span class=\"token punctuation\">.</span><span class=\"token function\">setItem</span><span class=\"token punctuation\">(</span><span class=\"token string\">'hero_checkpoint'</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">stringify</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\r\n      <span class=\"token literal-property property\">x</span><span class=\"token operator\">:</span> hero<span class=\"token punctuation\">.</span>x<span class=\"token punctuation\">,</span>\r\n      <span class=\"token literal-property property\">y</span><span class=\"token operator\">:</span> hero<span class=\"token punctuation\">.</span>y<span class=\"token punctuation\">,</span>\r\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>And at the end of my <code class=\"language-text\">create</code> function from my scene, I set the hero to the new saved position from before.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> heroCheckpoint <span class=\"token operator\">=</span> localStorage<span class=\"token punctuation\">.</span><span class=\"token function\">getItem</span><span class=\"token punctuation\">(</span><span class=\"token string\">'hero_checkpoint'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>heroCheckpoint<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">const</span> position <span class=\"token operator\">=</span> <span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">parse</span><span class=\"token punctuation\">(</span>heroCheckpoint<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>player<span class=\"token punctuation\">.</span><span class=\"token function\">setX</span><span class=\"token punctuation\">(</span>position<span class=\"token punctuation\">.</span>x<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>player<span class=\"token punctuation\">.</span><span class=\"token function\">setY</span><span class=\"token punctuation\">(</span>position<span class=\"token punctuation\">.</span>y<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span>\r\n\r\n<span class=\"token comment\">// always remove the key just in case</span>\r\nlocalStorage<span class=\"token punctuation\">.</span><span class=\"token function\">removeItem</span><span class=\"token punctuation\">(</span><span class=\"token string\">'hero_checkpoint'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>And that‚Äôs it. Super simple, right? Sorry for the short devlog this week, but I had a tiny hand injure as mentioned in the video, which made it impossible for me to code for a few days.</p>\n<p>This week the new Hyrule Warriors is out, so I can‚Äôt promise I will be making any new devlogs too üò¨ but I will try!</p>","fields":{"postHashId":"Z2FtZXN0cnVlbnVsbDIwMjAtMTEtMTlUMDA6MDA6MDAuMDAwWg==","slug":"/2020/2020-19-11-saving-player-progress-with-checkpoints-with-phaser-js-skate-platformer-game-devlog-12.en/","path":"/blog/games/saving-player-progress-with-checkpoints-with-phaser-js-skate-platformer-game-devlog-12/","locale":"en"},"rawMarkdownBody":"Hey guys! In today's video, I will show you how I created a checkpoint for the hero in my game in a very easy way.\r\n\r\n`youtube: https://www.youtube.com/watch?v=KKsg96FD2qI`\r\n\r\nSo this is done pretty much in two easy steps, first I set overlap between the hero and my checkpoint object, and inside the callback function, I save the current hero position to be used later on.\r\n\r\n```javascript\r\nconst checkpoint = new Checkpoint();\r\nconst overlap = this.physics.add.overlap(\r\n  this.player,\r\n  checkpoint,\r\n  (objectA, objectB) => {\r\n    checkpoint.setAnimation('save');\r\n    overlap?.destroy();\r\n\r\n    // save it to the browser local storage\r\n    localStorage.setItem('hero_checkpoint', JSON.stringify({\r\n      x: hero.x,\r\n      y: hero.y,\r\n    }));\r\n});\r\n```\r\n\r\nAnd at the end of my `create` function from my scene, I set the hero to the new saved position from before.\r\n\r\n```javascript\r\nconst heroCheckpoint = localStorage.getItem('hero_checkpoint');\r\nif (heroCheckpoint) {\r\n    const position = JSON.parse(heroCheckpoint);\r\n    this.player.setX(position.x);\r\n    this.player.setY(position.y);\r\n}\r\n\r\n// always remove the key just in case\r\nlocalStorage.removeItem('hero_checkpoint');\r\n```\r\n\r\nAnd that's it. Super simple, right? Sorry for the short devlog this week, but I had a tiny hand injure as mentioned in the video, which made it impossible for me to code for a few days.\r\n\r\nThis week the new Hyrule Warriors is out, so I can't promise I will be making any new devlogs too üò¨ but I will try!\r\n","frontmatter":{"tags":["coding","games","javascript","phaser","phaser 3","game devlog","gamedev","skate platformer","super ollie vs pebble corp","webpack","tiled","hyrule warriors"],"categories":["games"],"allowComments":true,"publishOnMedium":false,"cover":null,"date":"2020-11-19T00:00:00.000Z","id":null,"path":"saving-player-progress-with-checkpoints-with-phaser-js-skate-platformer-game-devlog-12","show":true,"title":"Saving player progress with checkpoints with Phaser JS - Skate Platformer Game Devlog #12","hideExcerpt":false,"subtitle":""}}},{"node":{"excerpt":"Fala pessoal, no devlog de hoje vou fazer uma parada muito‚Ä¶","html":"<p>Fala pessoal, no devlog de hoje vou fazer uma parada muito legal - carregar dinamicamente arquivos externos de mapa do Tiled criado pelo usu√°rio.</p>\n<p><div class=\"gatsby-resp-iframe-wrapper\" style=\"padding-bottom: 56.42857142857143%; position: relative; height: 0; overflow: hidden; margin-bottom: 1.0725rem\" > <div class=\"embedVideo-container\"> <iframe title=\"\" src=\"https://www.youtube.com/embed/RiC4T97s8eI?rel=0\" class=\"embedVideo-iframe\" style=\"border:0; position: absolute; top: 0; left: 0; width: 100%; height: 100%; \" loading=\"eager\" allowfullscreen=\"\" sandbox=\"allow-same-origin allow-scripts allow-popups\"></iframe> </div> </div></p>\n<p>Primeiro, temos que entender como o Phaser funciona. O Phaser √© executado dentro de um elemento de canvas do HTML que √© anexado a qualquer ID de elemento HTML que voc√™ colocar na op√ß√£o <code class=\"language-text\">parent</code> de configura√ß√µes do Phaser, ent√£o, se eu quiser usar uma a√ß√£o relacionada ao browser, como enviar um arquivo usando o elemento HTML de file input, eu tenho que cria-lo manualmente e para depois poder usa-lo quando necess√°rio.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> fileInput <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">HtmlFileInput</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\r\n    <span class=\"token literal-property property\">scene</span><span class=\"token operator\">:</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">,</span>\r\n    <span class=\"token literal-property property\">spriteKey</span><span class=\"token operator\">:</span> <span class=\"token string\">'file-input'</span><span class=\"token punctuation\">,</span>\r\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">callBackFunction</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token comment\">// trigget the HTML file input click</span>\r\n    fileInput<span class=\"token punctuation\">.</span>fileInput<span class=\"token punctuation\">.</span><span class=\"token function\">click</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Mas que diabos √© esse <code class=\"language-text\">HtmlFileInput</code>? √â basicamente uma classe que em seu construtor eu crio dinamicamente um elemento HTML de input a anexo ele ao DOM da p√°gina. A parte de estilo existe para garantir que o elemento n√£o seja vis√≠vel para o usu√°rio.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">HtmlFileInput</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span>\r\n        scene<span class=\"token punctuation\">,</span>\r\n        spriteKey<span class=\"token punctuation\">,</span>\r\n    <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token comment\">// Phaser's parent HTML element</span>\r\n        <span class=\"token keyword\">const</span> mainElement <span class=\"token operator\">=</span> scene<span class=\"token punctuation\">.</span>sys<span class=\"token punctuation\">.</span>game<span class=\"token punctuation\">.</span>canvas<span class=\"token punctuation\">.</span>parentElement<span class=\"token punctuation\">;</span>\r\n\r\n        <span class=\"token comment\">// create html input type</span>\r\n        <span class=\"token keyword\">const</span> fileInput <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">createElement</span><span class=\"token punctuation\">(</span><span class=\"token string\">'input'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        fileInput<span class=\"token punctuation\">.</span><span class=\"token function\">setAttribute</span><span class=\"token punctuation\">(</span><span class=\"token string\">'type'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'file'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        fileInput<span class=\"token punctuation\">.</span><span class=\"token function\">setAttribute</span><span class=\"token punctuation\">(</span><span class=\"token string\">'accept'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'.json'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        fileInput<span class=\"token punctuation\">.</span><span class=\"token function\">setAttribute</span><span class=\"token punctuation\">(</span><span class=\"token string\">'id'</span><span class=\"token punctuation\">,</span> spriteKey<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n        <span class=\"token comment\">// TODO this stylings</span>\r\n        fileInput<span class=\"token punctuation\">.</span>style<span class=\"token punctuation\">.</span>position <span class=\"token operator\">=</span> <span class=\"token string\">'absolute'</span><span class=\"token punctuation\">;</span>\r\n        fileInput<span class=\"token punctuation\">.</span>style<span class=\"token punctuation\">.</span>top <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\r\n        fileInput<span class=\"token punctuation\">.</span>style<span class=\"token punctuation\">.</span>display <span class=\"token operator\">=</span> <span class=\"token string\">'block'</span><span class=\"token punctuation\">;</span>\r\n        fileInput<span class=\"token punctuation\">.</span>style<span class=\"token punctuation\">.</span>marginTop <span class=\"token operator\">=</span> <span class=\"token string\">'-400px'</span><span class=\"token punctuation\">;</span>\r\n\r\n        mainElement<span class=\"token punctuation\">.</span><span class=\"token function\">appendChild</span><span class=\"token punctuation\">(</span>fileInput<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setFileInput</span><span class=\"token punctuation\">(</span>fileInput<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setScene</span><span class=\"token punctuation\">(</span>scene<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span>\r\n\r\n    <span class=\"token function-variable function\">setFileInput</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">fileInput</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>fileInput <span class=\"token operator\">=</span> fileInput<span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span>\r\n\r\n    <span class=\"token function-variable function\">setScene</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">scene</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>scene <span class=\"token operator\">=</span> scene<span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span>\r\n<span class=\"token punctuation\">}</span>\r\n\r\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> HtmlFileInput<span class=\"token punctuation\">;</span></code></pre></div>\n<p>Eu sei que parece uma gambiarra, mas esta √© a maneira correta de fazer isso na Phaser 3, apenas n√£o se esque√ßa de remover o elemento do DOM quando terminar de us√°-lo, chamando <code class=\"language-text\">fileInput.fileInput.remove()</code>.</p>\n<p>Agora preciso fazer o parse do arquivo <code class=\"language-text\">.json</code> enviado pelo usu√°rio e deixa-lo dispon√≠vel no ‚Äúgerenciador de arquivos em cache‚Äù do Phaser, e a melhor maneira de fazer isso √© usando a fun√ß√£o <code class=\"language-text\">preload</code> do Phaser. Primeiro, vamos dar uma olhada em como a fun√ß√£o de callback realmente funciona.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">callBackFunction</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">data</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n    fileInput<span class=\"token punctuation\">.</span>textfield<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">onchange</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">e</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token keyword\">const</span> reader <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">FileReader</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        reader<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'load'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">event</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n            <span class=\"token keyword\">const</span> result <span class=\"token operator\">=</span> <span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">parse</span><span class=\"token punctuation\">(</span>reader<span class=\"token punctuation\">.</span>result<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n            <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>scene<span class=\"token punctuation\">.</span><span class=\"token function\">start</span><span class=\"token punctuation\">(</span><span class=\"token string\">'CustomStageLoadingScene'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\r\n                <span class=\"token literal-property property\">stageKey</span><span class=\"token operator\">:</span> <span class=\"token string\">'custom_stage'</span><span class=\"token punctuation\">,</span>\r\n                <span class=\"token literal-property property\">stageData</span><span class=\"token operator\">:</span> result<span class=\"token punctuation\">,</span>\r\n                <span class=\"token literal-property property\">nextScene</span><span class=\"token operator\">:</span> <span class=\"token string\">'GameScene'</span><span class=\"token punctuation\">,</span>\r\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        reader<span class=\"token punctuation\">.</span><span class=\"token function\">readAsText</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">.</span>target<span class=\"token punctuation\">.</span>files<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\r\n\r\n    fileInput<span class=\"token punctuation\">.</span>textfield<span class=\"token punctuation\">.</span><span class=\"token function\">click</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Como voc√™ pode ver, eu estou usando o <code class=\"language-text\">FileReader</code> para carregar o arquivo e passando ele como par√¢metro para uma scene nova chamada <code class=\"language-text\">CustomStageLoadingScene</code> que s√≥ existe como uma game scene auxiliar para carregar dinamicamente a fase enviada pelo usu√°rio.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">CustomStageLoadingScene</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">Scene</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token keyword\">super</span><span class=\"token punctuation\">(</span><span class=\"token string\">'CustomStageLoadingScene'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span>\r\n\r\n    <span class=\"token function\">init</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">data</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token comment\">// data sent as a second parameter when calling the scene</span>\r\n        <span class=\"token comment\">// will be available here</span>\r\n        <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> stageKey<span class=\"token punctuation\">,</span> stageData<span class=\"token punctuation\">,</span> nextScene <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> data<span class=\"token punctuation\">;</span>\r\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>stageKey <span class=\"token operator\">=</span> stageKey<span class=\"token punctuation\">;</span>\r\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>stageData <span class=\"token operator\">=</span> stageData<span class=\"token punctuation\">;</span>\r\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>nextScene <span class=\"token operator\">=</span> nextScene<span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span>\r\n\r\n    <span class=\"token function\">preload</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> stageKey<span class=\"token punctuation\">,</span> stageData <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token comment\">// make the JSON data available to Phaser's internal cache</span>\r\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>load<span class=\"token punctuation\">.</span><span class=\"token function\">tilemapTiledJSON</span><span class=\"token punctuation\">(</span>stageKey<span class=\"token punctuation\">,</span> stageData<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span>\r\n\r\n    <span class=\"token function\">create</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> stageKey<span class=\"token punctuation\">,</span> nextScene <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token comment\">// start the next scene</span>\r\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>scene<span class=\"token punctuation\">.</span><span class=\"token function\">start</span><span class=\"token punctuation\">(</span>nextScene<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> stageKey<span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">stageName</span><span class=\"token operator\">:</span> <span class=\"token string\">'custom'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Agora que eu tenho os dados setados com o <code class=\"language-text\">this.load.tilemapTiledJSON()</code>, eu posso criar o novo est√°gio com <code class=\"language-text\">scene.make.tilemap ({key: stageKey})</code>. Show de bola!</p>\n<p>E isso √© tudo por hoje, por favor, n√£o esque√ßa de curtir o v√≠deo e se inscrever no meu canal, e se esses devlogs forem de alguma utilidade para voc√™, me avise nos coment√°rios abaixo. Obrigado e at√© a pr√≥xima.</p>","fields":{"postHashId":"Z2FtZXN0cnVlbnVsbDIwMjAtMTEtMTFUMDA6MDA6MDAuMDAwWg==","slug":"/2020/2020-11-11-carregando-fases-criadas-pelo-usuario-no-tiled-no-phaser-js-skate-platformer-game-devlog-11.pt-br/","path":"/blog/games/carregando-fases-criadas-pelo-usuario-no-tiled-no-phaser-js-skate-platformer-game-devlog-11/","locale":"pt-br"},"rawMarkdownBody":"Fala pessoal, no devlog de hoje vou fazer uma parada muito legal - carregar dinamicamente arquivos externos de mapa do Tiled criado pelo usu√°rio.\r\n\r\n`youtube: https://www.youtube.com/watch?v=RiC4T97s8eI`\r\n\r\nPrimeiro, temos que entender como o Phaser funciona. O Phaser √© executado dentro de um elemento de canvas do HTML que √© anexado a qualquer ID de elemento HTML que voc√™ colocar na op√ß√£o `parent` de configura√ß√µes do Phaser, ent√£o, se eu quiser usar uma a√ß√£o relacionada ao browser, como enviar um arquivo usando o elemento HTML de file input, eu tenho que cria-lo manualmente e para depois poder usa-lo quando necess√°rio.\r\n\r\n```javascript\r\nconst fileInput = new HtmlFileInput({\r\n    scene: this,\r\n    spriteKey: 'file-input',\r\n});\r\n\r\nconst callBackFunction = () => {\r\n    // trigget the HTML file input click\r\n    fileInput.fileInput.click();\r\n}\r\n```\r\n\r\nMas que diabos √© esse `HtmlFileInput`? √â basicamente uma classe que em seu construtor eu crio dinamicamente um elemento HTML de input a anexo ele ao DOM da p√°gina. A parte de estilo existe para garantir que o elemento n√£o seja vis√≠vel para o usu√°rio.\r\n\r\n```javascript\r\nclass HtmlFileInput {\r\n    constructor({\r\n        scene,\r\n        spriteKey,\r\n    }) {\r\n        // Phaser's parent HTML element\r\n        const mainElement = scene.sys.game.canvas.parentElement;\r\n\r\n        // create html input type\r\n        const fileInput = document.createElement('input');\r\n        fileInput.setAttribute('type', 'file');\r\n        fileInput.setAttribute('accept', '.json');\r\n        fileInput.setAttribute('id', spriteKey);\r\n\r\n        // TODO this stylings\r\n        fileInput.style.position = 'absolute';\r\n        fileInput.style.top = 0;\r\n        fileInput.style.display = 'block';\r\n        fileInput.style.marginTop = '-400px';\r\n\r\n        mainElement.appendChild(fileInput);\r\n        this.setFileInput(fileInput);\r\n        this.setScene(scene);\r\n    }\r\n\r\n    setFileInput = (fileInput) => {\r\n        this.fileInput = fileInput;\r\n    }\r\n\r\n    setScene = (scene) => {\r\n        this.scene = scene;\r\n    }\r\n}\r\n\r\nexport default HtmlFileInput;\r\n```\r\n\r\nEu sei que parece uma gambiarra, mas esta √© a maneira correta de fazer isso na Phaser 3, apenas n√£o se esque√ßa de remover o elemento do DOM quando terminar de us√°-lo, chamando `fileInput.fileInput.remove()`.\r\n\r\nAgora preciso fazer o parse do arquivo `.json` enviado pelo usu√°rio e deixa-lo dispon√≠vel no \"gerenciador de arquivos em cache\" do Phaser, e a melhor maneira de fazer isso √© usando a fun√ß√£o `preload` do Phaser. Primeiro, vamos dar uma olhada em como a fun√ß√£o de callback realmente funciona.\r\n\r\n```javascript\r\nconst callBackFunction = (data) => {\r\n    fileInput.textfield.onchange = (e) => {\r\n        const reader = new FileReader();\r\n        reader.addEventListener('load', (event) => {\r\n            const result = JSON.parse(reader.result);\r\n            this.scene.start('CustomStageLoadingScene', {\r\n                stageKey: 'custom_stage',\r\n                stageData: result,\r\n                nextScene: 'GameScene',\r\n            });\r\n        });\r\n        reader.readAsText(e.target.files[0]);\r\n    };\r\n\r\n    fileInput.textfield.click();\r\n}\r\n```\r\n\r\nComo voc√™ pode ver, eu estou usando o `FileReader` para carregar o arquivo e passando ele como par√¢metro para uma scene nova chamada `CustomStageLoadingScene` que s√≥ existe como uma game scene auxiliar para carregar dinamicamente a fase enviada pelo usu√°rio.\r\n\r\n```javascript\r\nclass CustomStageLoadingScene extends Scene {\r\n    constructor() {\r\n        super('CustomStageLoadingScene');\r\n    }\r\n\r\n    init(data) {\r\n        // data sent as a second parameter when calling the scene\r\n        // will be available here\r\n        const { stageKey, stageData, nextScene } = data;\r\n        this.stageKey = stageKey;\r\n        this.stageData = stageData;\r\n        this.nextScene = nextScene;\r\n    }\r\n\r\n    preload() {\r\n        const { stageKey, stageData } = this;\r\n        // make the JSON data available to Phaser's internal cache\r\n        this.load.tilemapTiledJSON(stageKey, stageData);\r\n    }\r\n\r\n    create() {\r\n        const { stageKey, nextScene } = this;\r\n        // start the next scene\r\n        this.scene.start(nextScene, { stageKey, stageName: 'custom' });\r\n    }\r\n}\r\n```\r\n\r\nAgora que eu tenho os dados setados com o `this.load.tilemapTiledJSON()`, eu posso criar o novo est√°gio com `scene.make.tilemap ({key: stageKey})`. Show de bola!\r\n\r\nE isso √© tudo por hoje, por favor, n√£o esque√ßa de curtir o v√≠deo e se inscrever no meu canal, e se esses devlogs forem de alguma utilidade para voc√™, me avise nos coment√°rios abaixo. Obrigado e at√© a pr√≥xima.\r\n","frontmatter":{"tags":["programa√ß√£o","jogos","javascript","phaser","phaser 3","game devlog","gamedev","skate platformer","super ollie vs pebble corp","webpack","tiled"],"categories":["games"],"allowComments":true,"publishOnMedium":false,"cover":null,"date":"2020-11-11T00:00:00.000Z","id":null,"path":"carregando-fases-criadas-pelo-usuario-no-tiled-no-phaser-js-skate-platformer-game-devlog-11","show":true,"title":"Carregando fases criadas pelo usu√°rio no Tiled no Phaser JS - Skate Platformer Game Devlog #11","hideExcerpt":false,"subtitle":""}}},{"node":{"excerpt":"Hey guys, in today‚Äôs devlog I‚Äôm going to make something‚Ä¶","html":"<p>Hey guys, in today‚Äôs devlog I‚Äôm going to make something really cool - dynamically upload external Tiled map files created by the user.</p>\n<p><div class=\"gatsby-resp-iframe-wrapper\" style=\"padding-bottom: 56.42857142857143%; position: relative; height: 0; overflow: hidden; margin-bottom: 1.0725rem\" > <div class=\"embedVideo-container\"> <iframe title=\"\" src=\"https://www.youtube.com/embed/RiC4T97s8eI?rel=0\" class=\"embedVideo-iframe\" style=\"border:0; position: absolute; top: 0; left: 0; width: 100%; height: 100%; \" loading=\"eager\" allowfullscreen=\"\" sandbox=\"allow-same-origin allow-scripts allow-popups\"></iframe> </div> </div></p>\n<p>First, let‚Äôs all get on the same page on how Phaser works. Phaser runs in an HTML canvas element that is attached to whichever HTML element ID you put on Phaser‚Äôs <code class=\"language-text\">parent</code> settings option, so if I want a browser-related action like uploading a file using the HTML file-input element, I have to manually create that element and trigger it when needed.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> fileInput <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">HtmlFileInput</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\r\n    <span class=\"token literal-property property\">scene</span><span class=\"token operator\">:</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">,</span>\r\n    <span class=\"token literal-property property\">spriteKey</span><span class=\"token operator\">:</span> <span class=\"token string\">'file-input'</span><span class=\"token punctuation\">,</span>\r\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">callBackFunction</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token comment\">// trigget the HTML file input click</span>\r\n    fileInput<span class=\"token punctuation\">.</span>fileInput<span class=\"token punctuation\">.</span><span class=\"token function\">click</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>But what the hell is this <code class=\"language-text\">HtmlFileInput</code>? It is basically a class that in its constructor I dynamically create an HTML input element and attach it to the page‚Äôs DOM. The styling part is there to make sure the element is not visible to the user.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">HtmlFileInput</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span>\r\n        scene<span class=\"token punctuation\">,</span>\r\n        spriteKey<span class=\"token punctuation\">,</span>\r\n    <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token comment\">// Phaser's parent HTML element</span>\r\n        <span class=\"token keyword\">const</span> mainElement <span class=\"token operator\">=</span> scene<span class=\"token punctuation\">.</span>sys<span class=\"token punctuation\">.</span>game<span class=\"token punctuation\">.</span>canvas<span class=\"token punctuation\">.</span>parentElement<span class=\"token punctuation\">;</span>\r\n\r\n        <span class=\"token comment\">// create html input type</span>\r\n        <span class=\"token keyword\">const</span> fileInput <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">createElement</span><span class=\"token punctuation\">(</span><span class=\"token string\">'input'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        fileInput<span class=\"token punctuation\">.</span><span class=\"token function\">setAttribute</span><span class=\"token punctuation\">(</span><span class=\"token string\">'type'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'file'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        fileInput<span class=\"token punctuation\">.</span><span class=\"token function\">setAttribute</span><span class=\"token punctuation\">(</span><span class=\"token string\">'accept'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'.json'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        fileInput<span class=\"token punctuation\">.</span><span class=\"token function\">setAttribute</span><span class=\"token punctuation\">(</span><span class=\"token string\">'id'</span><span class=\"token punctuation\">,</span> spriteKey<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n        <span class=\"token comment\">// TODO this stylings</span>\r\n        fileInput<span class=\"token punctuation\">.</span>style<span class=\"token punctuation\">.</span>position <span class=\"token operator\">=</span> <span class=\"token string\">'absolute'</span><span class=\"token punctuation\">;</span>\r\n        fileInput<span class=\"token punctuation\">.</span>style<span class=\"token punctuation\">.</span>top <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\r\n        fileInput<span class=\"token punctuation\">.</span>style<span class=\"token punctuation\">.</span>display <span class=\"token operator\">=</span> <span class=\"token string\">'block'</span><span class=\"token punctuation\">;</span>\r\n        fileInput<span class=\"token punctuation\">.</span>style<span class=\"token punctuation\">.</span>marginTop <span class=\"token operator\">=</span> <span class=\"token string\">'-400px'</span><span class=\"token punctuation\">;</span>\r\n\r\n        mainElement<span class=\"token punctuation\">.</span><span class=\"token function\">appendChild</span><span class=\"token punctuation\">(</span>fileInput<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setFileInput</span><span class=\"token punctuation\">(</span>fileInput<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setScene</span><span class=\"token punctuation\">(</span>scene<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span>\r\n\r\n    <span class=\"token function-variable function\">setFileInput</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">fileInput</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>fileInput <span class=\"token operator\">=</span> fileInput<span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span>\r\n\r\n    <span class=\"token function-variable function\">setScene</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">scene</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>scene <span class=\"token operator\">=</span> scene<span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span>\r\n<span class=\"token punctuation\">}</span>\r\n\r\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> HtmlFileInput<span class=\"token punctuation\">;</span></code></pre></div>\n<p>I know this feels like a hack, but this is the proper way of doing it on Phaser 3, just don forget to remove the element from the DOM when you‚Äôre done with it by calling <code class=\"language-text\">fileInput.fileInput.remove()</code>.</p>\n<p>Now I need a way to parse the <code class=\"language-text\">.json</code> file uploaded by the user and make it available on Phaser‚Äôs ‚Äúcached file manager‚Äù, and the best way to do that is by using Phaser‚Äôs <code class=\"language-text\">preload</code> function. First, let‚Äôs take a look at how the actual callback function works.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">callBackFunction</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">data</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n    fileInput<span class=\"token punctuation\">.</span>textfield<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">onchange</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">e</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token keyword\">const</span> reader <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">FileReader</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        reader<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'load'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">event</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n            <span class=\"token keyword\">const</span> result <span class=\"token operator\">=</span> <span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">parse</span><span class=\"token punctuation\">(</span>reader<span class=\"token punctuation\">.</span>result<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n            <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>scene<span class=\"token punctuation\">.</span><span class=\"token function\">start</span><span class=\"token punctuation\">(</span><span class=\"token string\">'CustomStageLoadingScene'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\r\n                <span class=\"token literal-property property\">stageKey</span><span class=\"token operator\">:</span> <span class=\"token string\">'custom_stage'</span><span class=\"token punctuation\">,</span>\r\n                <span class=\"token literal-property property\">stageData</span><span class=\"token operator\">:</span> result<span class=\"token punctuation\">,</span>\r\n                <span class=\"token literal-property property\">nextScene</span><span class=\"token operator\">:</span> <span class=\"token string\">'GameScene'</span><span class=\"token punctuation\">,</span>\r\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        reader<span class=\"token punctuation\">.</span><span class=\"token function\">readAsText</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">.</span>target<span class=\"token punctuation\">.</span>files<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\r\n\r\n    fileInput<span class=\"token punctuation\">.</span>textfield<span class=\"token punctuation\">.</span><span class=\"token function\">click</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>As you can see, I am using <code class=\"language-text\">FileReader</code> to load the file and passing it as a parameter to a new scene called <code class=\"language-text\">CustomStageLoadingScene</code> that only exists as an aux scene to dynamically load the phase sent by the user.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">CustomStageLoadingScene</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">Scene</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token keyword\">super</span><span class=\"token punctuation\">(</span><span class=\"token string\">'CustomStageLoadingScene'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span>\r\n\r\n    <span class=\"token function\">init</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">data</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token comment\">// data sent as a second parameter when calling the scene</span>\r\n        <span class=\"token comment\">// will be available here</span>\r\n        <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> stageKey<span class=\"token punctuation\">,</span> stageData<span class=\"token punctuation\">,</span> nextScene <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> data<span class=\"token punctuation\">;</span>\r\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>stageKey <span class=\"token operator\">=</span> stageKey<span class=\"token punctuation\">;</span>\r\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>stageData <span class=\"token operator\">=</span> stageData<span class=\"token punctuation\">;</span>\r\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>nextScene <span class=\"token operator\">=</span> nextScene<span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span>\r\n\r\n    <span class=\"token function\">preload</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> stageKey<span class=\"token punctuation\">,</span> stageData <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token comment\">// make the JSON data available to Phaser's internal cache</span>\r\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>load<span class=\"token punctuation\">.</span><span class=\"token function\">tilemapTiledJSON</span><span class=\"token punctuation\">(</span>stageKey<span class=\"token punctuation\">,</span> stageData<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span>\r\n\r\n    <span class=\"token function\">create</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> stageKey<span class=\"token punctuation\">,</span> nextScene <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token comment\">// start the next scene</span>\r\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>scene<span class=\"token punctuation\">.</span><span class=\"token function\">start</span><span class=\"token punctuation\">(</span>nextScene<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> stageKey<span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">stageName</span><span class=\"token operator\">:</span> <span class=\"token string\">'custom'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Now that I have the data set with <code class=\"language-text\">this.load.tilemapTiledJSON()</code>, I can create the new stage with <code class=\"language-text\">scene.make.tilemap({ key: stageKey })</code>. Pretty neat, right?</p>\n<p>And that‚Äôs all for today, please don‚Äôt forget to like and subscribe to my channel, and if these devlogs are of any use to you, let me know in the comments below. Thanks and until next time.</p>","fields":{"postHashId":"Z2FtZXN0cnVlbnVsbDIwMjAtMTEtMTFUMDA6MDA6MDAuMDAwWg==","slug":"/2020/2020-11-11-loading-user-created-tiled-stages-on-phaser-js-skate-platformer-game-devlog-11.en/","path":"/blog/games/loading-user-created-tiled-stages-on-phaser-js-skate-platformer-game-devlog-11/","locale":"en"},"rawMarkdownBody":"Hey guys, in today's devlog I'm going to make something really cool - dynamically upload external Tiled map files created by the user.\r\n\r\n`youtube: https://www.youtube.com/watch?v=RiC4T97s8eI`\r\n\r\nFirst, let's all get on the same page on how Phaser works. Phaser runs in an HTML canvas element that is attached to whichever HTML element ID you put on Phaser's `parent` settings option, so if I want a browser-related action like uploading a file using the HTML file-input element, I have to manually create that element and trigger it when needed.\r\n\r\n```javascript\r\nconst fileInput = new HtmlFileInput({\r\n    scene: this,\r\n    spriteKey: 'file-input',\r\n});\r\n\r\nconst callBackFunction = () => {\r\n    // trigget the HTML file input click\r\n    fileInput.fileInput.click();\r\n}\r\n```\r\n\r\nBut what the hell is this `HtmlFileInput`? It is basically a class that in its constructor I dynamically create an HTML input element and attach it to the page's DOM. The styling part is there to make sure the element is not visible to the user.\r\n\r\n```javascript\r\nclass HtmlFileInput {\r\n    constructor({\r\n        scene,\r\n        spriteKey,\r\n    }) {\r\n        // Phaser's parent HTML element\r\n        const mainElement = scene.sys.game.canvas.parentElement;\r\n\r\n        // create html input type\r\n        const fileInput = document.createElement('input');\r\n        fileInput.setAttribute('type', 'file');\r\n        fileInput.setAttribute('accept', '.json');\r\n        fileInput.setAttribute('id', spriteKey);\r\n\r\n        // TODO this stylings\r\n        fileInput.style.position = 'absolute';\r\n        fileInput.style.top = 0;\r\n        fileInput.style.display = 'block';\r\n        fileInput.style.marginTop = '-400px';\r\n\r\n        mainElement.appendChild(fileInput);\r\n        this.setFileInput(fileInput);\r\n        this.setScene(scene);\r\n    }\r\n\r\n    setFileInput = (fileInput) => {\r\n        this.fileInput = fileInput;\r\n    }\r\n\r\n    setScene = (scene) => {\r\n        this.scene = scene;\r\n    }\r\n}\r\n\r\nexport default HtmlFileInput;\r\n```\r\n\r\nI know this feels like a hack, but this is the proper way of doing it on Phaser 3, just don forget to remove the element from the DOM when you're done with it by calling `fileInput.fileInput.remove()`.\r\n\r\nNow I need a way to parse the `.json` file uploaded by the user and make it available on Phaser's \"cached file manager\", and the best way to do that is by using Phaser's `preload` function. First, let's take a look at how the actual callback function works.\r\n\r\n```javascript\r\nconst callBackFunction = (data) => {\r\n    fileInput.textfield.onchange = (e) => {\r\n        const reader = new FileReader();\r\n        reader.addEventListener('load', (event) => {\r\n            const result = JSON.parse(reader.result);\r\n            this.scene.start('CustomStageLoadingScene', {\r\n                stageKey: 'custom_stage',\r\n                stageData: result,\r\n                nextScene: 'GameScene',\r\n            });\r\n        });\r\n        reader.readAsText(e.target.files[0]);\r\n    };\r\n\r\n    fileInput.textfield.click();\r\n}\r\n```\r\n\r\nAs you can see, I am using `FileReader` to load the file and passing it as a parameter to a new scene called `CustomStageLoadingScene` that only exists as an aux scene to dynamically load the phase sent by the user.\r\n\r\n```javascript\r\nclass CustomStageLoadingScene extends Scene {\r\n    constructor() {\r\n        super('CustomStageLoadingScene');\r\n    }\r\n\r\n    init(data) {\r\n        // data sent as a second parameter when calling the scene\r\n        // will be available here\r\n        const { stageKey, stageData, nextScene } = data;\r\n        this.stageKey = stageKey;\r\n        this.stageData = stageData;\r\n        this.nextScene = nextScene;\r\n    }\r\n\r\n    preload() {\r\n        const { stageKey, stageData } = this;\r\n        // make the JSON data available to Phaser's internal cache\r\n        this.load.tilemapTiledJSON(stageKey, stageData);\r\n    }\r\n\r\n    create() {\r\n        const { stageKey, nextScene } = this;\r\n        // start the next scene\r\n        this.scene.start(nextScene, { stageKey, stageName: 'custom' });\r\n    }\r\n}\r\n```\r\n\r\nNow that I have the data set with `this.load.tilemapTiledJSON()`, I can create the new stage with `scene.make.tilemap({ key: stageKey })`. Pretty neat, right?\r\n\r\nAnd that's all for today, please don't forget to like and subscribe to my channel, and if these devlogs are of any use to you, let me know in the comments below. Thanks and until next time.\r\n","frontmatter":{"tags":["coding","games","javascript","phaser","phaser 3","game devlog","gamedev","skate platformer","super ollie vs pebble corp","webpack","tiled"],"categories":["games"],"allowComments":true,"publishOnMedium":false,"cover":null,"date":"2020-11-11T00:00:00.000Z","id":null,"path":"loading-user-created-tiled-stages-on-phaser-js-skate-platformer-game-devlog-11","show":true,"title":"Loading user-created Tiled stages on Phaser JS - Skate Platformer Game Devlog #11","hideExcerpt":false,"subtitle":""}}},{"node":{"excerpt":"Fala pessoal, no game devlog de hoje vou mostrar como eu fiz‚Ä¶","html":"<p>Fala pessoal, no game devlog de hoje vou mostrar como eu fiz para criar o HUD com os status do her√≥i.</p>\n<p><div class=\"gatsby-resp-iframe-wrapper\" style=\"padding-bottom: 56.42857142857143%; position: relative; height: 0; overflow: hidden; margin-bottom: 1.0725rem\" > <div class=\"embedVideo-container\"> <iframe title=\"\" src=\"https://www.youtube.com/embed/JVeRYsaXxpg?rel=0\" class=\"embedVideo-iframe\" style=\"border:0; position: absolute; top: 0; left: 0; width: 100%; height: 100%; \" loading=\"eager\" allowfullscreen=\"\" sandbox=\"allow-same-origin allow-scripts allow-popups\"></iframe> </div> </div></p>\n<p>A primeira coisa que fiz foi cortar o design do HUD que o √çtalo fez em pequenas partes reutiliz√°veis para que eu pudesse aumentar/diminuir as barras de vida √† vontade. O PNG do atlas ficou assim:</p>\n<p><figure class=\"gatsby-resp-image-figure\" style=\"\">\n    <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 330px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 142.578125%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAdABQDASIAAhEBAxEB/8QAGAAAAwEBAAAAAAAAAAAAAAAAAAMFAgT/xAAXAQADAQAAAAAAAAAAAAAAAAAAAQID/9oADAMBAAIQAxAAAAF+ubkVWhYLbpao0pCRH//EABwQAAEEAwEAAAAAAAAAAAAAAAEAAgMSESIxBP/aAAgBAQABBQJ5qBKwjq9MbnnSkeKB1DaPCkCHWDX/xAAZEQADAAMAAAAAAAAAAAAAAAAAASESMUH/2gAIAQMBAT8BSXR7HaZH/8QAGxEAAQQDAAAAAAAAAAAAAAAAAAECAxEQE0H/2gAIAQIBAT8BvCR100tP/8QAIRAAAQMBCQAAAAAAAAAAAAAAAAECETEQEiAhMkFhcYH/2gAIAQEABj8Cly+mqxsZolS9DooJBwbdYKn/xAAcEAADAQADAQEAAAAAAAAAAAAAAREhMUFRYXH/2gAIAQEAAT8hpQblcCY1+hNJU6hiq6sGpwPsiXWl05Seh5U3+Bbptb2LVXpjH//aAAwDAQACAAMAAAAQHCNP/8QAGBEAAwEBAAAAAAAAAAAAAAAAAAERMaH/2gAIAQMBAT8QuKRkiAb3eH//xAAYEQEBAQEBAAAAAAAAAAAAAAABABExUf/aAAgBAgEBPxDLyHYA5PW//8QAHBABAAMAAwEBAAAAAAAAAAAAAQARITFBUXGB/9oACAEBAAE/EAPCm7H4grm+w5DIk4RlyWRrZ3fnAxWg0ZgNWdQa0R9NjaknC8TAQtlGvyBKKpVxyIWpoFe87KaasF+RmlGVk//Z'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"HUD do her√≥i\"\n        title=\"HUD do her√≥i\"\n        src=\"/static/e238085b17b34974e3945879aea90722/4f5c6/hero_hud.jpg\"\n        srcset=\"/static/e238085b17b34974e3945879aea90722/db830/hero_hud.jpg 256w,\n/static/e238085b17b34974e3945879aea90722/4f5c6/hero_hud.jpg 330w\"\n        sizes=\"(max-width: 330px) 100vw, 330px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\">HUD do her√≥i</figcaption>\n  </figure></p>\n<p>Depois de ter todas as partes do HUD separadas, eu criei um <code class=\"language-text\">GameGroup</code> com todas as imagens, e sempre que eu precisar aumentar ou diminuir a vida do her√≥i eu chamo as fun√ß√µes <code class=\"language-text\">increasePlayerLife</code> e <code class=\"language-text\">decreasePlayerLife</code>.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">PlayerHud</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">GameGroup</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">scene</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token keyword\">const</span> children <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token comment\">// create all the game object images</span>\r\n        <span class=\"token punctuation\">[</span>\r\n            <span class=\"token string\">'hud_meter_border'</span><span class=\"token punctuation\">,</span>\r\n            <span class=\"token string\">'hud_meter_point_border'</span><span class=\"token punctuation\">,</span>\r\n            <span class=\"token string\">'player_face_hud'</span><span class=\"token punctuation\">,</span>\r\n            <span class=\"token string\">'player_life_hud'</span><span class=\"token punctuation\">,</span>\r\n            <span class=\"token string\">'skate_hud'</span><span class=\"token punctuation\">,</span>\r\n            <span class=\"token string\">'skate_life_hud'</span><span class=\"token punctuation\">,</span>\r\n            <span class=\"token string\">'collectable_times'</span><span class=\"token punctuation\">,</span>\r\n            <span class=\"token string\">'coin'</span><span class=\"token punctuation\">,</span>\r\n        <span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">asset</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>\r\n              <span class=\"token punctuation\">[</span><span class=\"token string\">'hud_meter_border'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'hud_meter_point_border'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">includes</span><span class=\"token punctuation\">(</span>asset<span class=\"token punctuation\">)</span>\r\n            <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n                <span class=\"token punctuation\">[</span><span class=\"token string\">'skate'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'player'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">hudType</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n                    <span class=\"token keyword\">const</span> assetName <span class=\"token operator\">=</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>hudType<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">_</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>asset<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span>\r\n                    <span class=\"token keyword\">const</span> child <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">GameObjects<span class=\"token punctuation\">.</span>Image</span><span class=\"token punctuation\">(</span>\r\n                        scene<span class=\"token punctuation\">,</span>\r\n                        x<span class=\"token punctuation\">,</span>\r\n                        y<span class=\"token punctuation\">,</span>\r\n                        asset\r\n                    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n                    child<span class=\"token punctuation\">.</span><span class=\"token function\">setOrigin</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                    child<span class=\"token punctuation\">.</span><span class=\"token function\">setName</span><span class=\"token punctuation\">(</span>assetName<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                    child<span class=\"token punctuation\">.</span><span class=\"token function\">setScrollFactor</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                    children<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span>child<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span>\r\n            <span class=\"token punctuation\">}</span>\r\n\r\n            <span class=\"token keyword\">const</span> child <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">GameObjects<span class=\"token punctuation\">.</span>Image</span><span class=\"token punctuation\">(</span>\r\n                scene<span class=\"token punctuation\">,</span>\r\n                x<span class=\"token punctuation\">,</span>\r\n                y<span class=\"token punctuation\">,</span>\r\n                asset\r\n            <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n            child<span class=\"token punctuation\">.</span><span class=\"token function\">setOrigin</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n            child<span class=\"token punctuation\">.</span><span class=\"token function\">setName</span><span class=\"token punctuation\">(</span>asset<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n            child<span class=\"token punctuation\">.</span><span class=\"token function\">setScrollFactor</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n            children<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span>child<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n        <span class=\"token keyword\">super</span><span class=\"token punctuation\">(</span>scene<span class=\"token punctuation\">,</span> children<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n        <span class=\"token comment\">// create a dummy game object to store the data manager</span>\r\n        <span class=\"token keyword\">const</span> dataGameobject <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">GameObjects<span class=\"token punctuation\">.</span>Rectangle</span><span class=\"token punctuation\">(</span>scene<span class=\"token punctuation\">,</span> x<span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>data <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Data<span class=\"token punctuation\">.</span>DataManager</span><span class=\"token punctuation\">(</span>dataGameobject<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n        <span class=\"token comment\">// set data manager listeners</span>\r\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">.</span><span class=\"token function\">set</span><span class=\"token punctuation\">(</span><span class=\"token constant\">PLAYER_LIFE_DATA</span><span class=\"token punctuation\">,</span> initialPlayerLife<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">.</span><span class=\"token function\">set</span><span class=\"token punctuation\">(</span><span class=\"token constant\">SKATE_LIFE_DATA</span><span class=\"token punctuation\">,</span> initialSkateLife<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">.</span><span class=\"token function\">set</span><span class=\"token punctuation\">(</span><span class=\"token constant\">COLLECTED_NUTS_DATA</span><span class=\"token punctuation\">,</span> initialCollectedNuts<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">.</span>events<span class=\"token punctuation\">.</span><span class=\"token function\">on</span><span class=\"token punctuation\">(</span>\r\n          <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">changedata-</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token constant\">SKATE_LIFE_DATA</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\r\n          <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>onSkateLifeChanged\r\n        <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">.</span>events<span class=\"token punctuation\">.</span><span class=\"token function\">on</span><span class=\"token punctuation\">(</span>\r\n          <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">changedata-</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token constant\">PLAYER_LIFE_DATA</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\r\n          <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>onPlayerLifeChanged\r\n        <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">.</span>events<span class=\"token punctuation\">.</span><span class=\"token function\">on</span><span class=\"token punctuation\">(</span>\r\n          <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">changedata-</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token constant\">COLLECTED_NUTS_DATA</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\r\n          <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>onCollectedNutsChanged\r\n        <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n        <span class=\"token comment\">// After everythibg is set</span>\r\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setHudPositions</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span>\r\n\r\n    <span class=\"token function-variable function\">setHudPositions</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token comment\">// TODO</span>\r\n    <span class=\"token punctuation\">}</span>\r\n\r\n    <span class=\"token function-variable function\">increasePlayerLife</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token comment\">// TODO</span>\r\n    <span class=\"token punctuation\">}</span>\r\n\r\n    <span class=\"token function-variable function\">decreasePlayerLife</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token comment\">// TODO</span>\r\n    <span class=\"token punctuation\">}</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Como eu n√£o queria deixar a fun√ß√£o <code class=\"language-text\">construct</code> grande demais, criei a fun√ß√£o <code class=\"language-text\">setHudPositions</code> que seta todas as poci√ß√µes das imagens do HUD.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token function-variable function\">setHudPositions</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> width<span class=\"token punctuation\">,</span> height <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>scene<span class=\"token punctuation\">.</span>cameras<span class=\"token punctuation\">.</span>main<span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">const</span> paddingX <span class=\"token operator\">=</span> <span class=\"token number\">10</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">const</span> paddingY <span class=\"token operator\">=</span> <span class=\"token number\">10</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">const</span> skateLife <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token constant\">SKATE_LIFE_DATA</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">const</span> playerLife <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token constant\">PLAYER_LIFE_DATA</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">getChildren</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">child</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> name <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> child<span class=\"token punctuation\">;</span>\r\n        child<span class=\"token punctuation\">.</span><span class=\"token function\">setX</span><span class=\"token punctuation\">(</span>paddingX<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        child<span class=\"token punctuation\">.</span><span class=\"token function\">setY</span><span class=\"token punctuation\">(</span>paddingY<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n        <span class=\"token keyword\">switch</span> <span class=\"token punctuation\">(</span>name<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n            <span class=\"token keyword\">case</span> <span class=\"token string\">'player_face_hud'</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\r\n                <span class=\"token comment\">// TODO</span>\r\n                <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\r\n            <span class=\"token punctuation\">}</span>\r\n            <span class=\"token keyword\">case</span> <span class=\"token string\">'player_hud_meter_border'</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\r\n                child<span class=\"token punctuation\">.</span><span class=\"token function\">setX</span><span class=\"token punctuation\">(</span>child<span class=\"token punctuation\">.</span>x <span class=\"token operator\">+</span> <span class=\"token number\">32</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                child<span class=\"token punctuation\">.</span><span class=\"token function\">setY</span><span class=\"token punctuation\">(</span>child<span class=\"token punctuation\">.</span>y <span class=\"token operator\">+</span> <span class=\"token number\">15</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                child<span class=\"token punctuation\">.</span><span class=\"token function\">setScale</span><span class=\"token punctuation\">(</span>playerLife <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                child<span class=\"token punctuation\">.</span><span class=\"token function\">setDepth</span><span class=\"token punctuation\">(</span>child<span class=\"token punctuation\">.</span>depth <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\r\n            <span class=\"token punctuation\">}</span>\r\n            <span class=\"token keyword\">case</span> <span class=\"token string\">'player_hud_meter_point_border'</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\r\n                child<span class=\"token punctuation\">.</span><span class=\"token function\">setX</span><span class=\"token punctuation\">(</span>child<span class=\"token punctuation\">.</span>x <span class=\"token operator\">+</span> playerLife <span class=\"token operator\">+</span> <span class=\"token number\">31</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                child<span class=\"token punctuation\">.</span><span class=\"token function\">setY</span><span class=\"token punctuation\">(</span>child<span class=\"token punctuation\">.</span>y <span class=\"token operator\">+</span> <span class=\"token number\">16</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                child<span class=\"token punctuation\">.</span><span class=\"token function\">setDepth</span><span class=\"token punctuation\">(</span>child<span class=\"token punctuation\">.</span>depth <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\r\n            <span class=\"token punctuation\">}</span>\r\n            <span class=\"token keyword\">case</span> <span class=\"token string\">'player_life_hud'</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\r\n                child<span class=\"token punctuation\">.</span><span class=\"token function\">setX</span><span class=\"token punctuation\">(</span>child<span class=\"token punctuation\">.</span>x <span class=\"token operator\">+</span> <span class=\"token number\">32</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                child<span class=\"token punctuation\">.</span><span class=\"token function\">setY</span><span class=\"token punctuation\">(</span>child<span class=\"token punctuation\">.</span>y <span class=\"token operator\">+</span> <span class=\"token number\">16</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                child<span class=\"token punctuation\">.</span><span class=\"token function\">setScale</span><span class=\"token punctuation\">(</span>playerLife<span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                child<span class=\"token punctuation\">.</span><span class=\"token function\">setDepth</span><span class=\"token punctuation\">(</span>child<span class=\"token punctuation\">.</span>depth <span class=\"token operator\">-</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\r\n            <span class=\"token punctuation\">}</span>\r\n            <span class=\"token keyword\">case</span> <span class=\"token string\">'skate_hud'</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\r\n                child<span class=\"token punctuation\">.</span><span class=\"token function\">setY</span><span class=\"token punctuation\">(</span>child<span class=\"token punctuation\">.</span>y <span class=\"token operator\">+</span> <span class=\"token number\">32</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\r\n            <span class=\"token punctuation\">}</span>\r\n            <span class=\"token keyword\">case</span> <span class=\"token string\">'skate_hud_meter_border'</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\r\n                child<span class=\"token punctuation\">.</span><span class=\"token function\">setX</span><span class=\"token punctuation\">(</span>child<span class=\"token punctuation\">.</span>x <span class=\"token operator\">+</span> <span class=\"token number\">32</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                child<span class=\"token punctuation\">.</span><span class=\"token function\">setY</span><span class=\"token punctuation\">(</span>child<span class=\"token punctuation\">.</span>y <span class=\"token operator\">+</span> <span class=\"token number\">34</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                child<span class=\"token punctuation\">.</span><span class=\"token function\">setScale</span><span class=\"token punctuation\">(</span>skateLife <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                child<span class=\"token punctuation\">.</span><span class=\"token function\">setDepth</span><span class=\"token punctuation\">(</span>child<span class=\"token punctuation\">.</span>depth <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\r\n            <span class=\"token punctuation\">}</span>\r\n            <span class=\"token keyword\">case</span> <span class=\"token string\">'skate_hud_meter_point_border'</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\r\n                child<span class=\"token punctuation\">.</span><span class=\"token function\">setX</span><span class=\"token punctuation\">(</span>child<span class=\"token punctuation\">.</span>x <span class=\"token operator\">+</span> skateLife <span class=\"token operator\">+</span> <span class=\"token number\">31</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                child<span class=\"token punctuation\">.</span><span class=\"token function\">setY</span><span class=\"token punctuation\">(</span>child<span class=\"token punctuation\">.</span>y <span class=\"token operator\">+</span> <span class=\"token number\">35</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                child<span class=\"token punctuation\">.</span><span class=\"token function\">setDepth</span><span class=\"token punctuation\">(</span>child<span class=\"token punctuation\">.</span>depth <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\r\n            <span class=\"token punctuation\">}</span>\r\n            <span class=\"token keyword\">case</span> <span class=\"token string\">'skate_life_hud'</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\r\n                child<span class=\"token punctuation\">.</span><span class=\"token function\">setX</span><span class=\"token punctuation\">(</span>child<span class=\"token punctuation\">.</span>x <span class=\"token operator\">+</span> <span class=\"token number\">32</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                child<span class=\"token punctuation\">.</span><span class=\"token function\">setY</span><span class=\"token punctuation\">(</span>child<span class=\"token punctuation\">.</span>y <span class=\"token operator\">+</span> <span class=\"token number\">35</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                child<span class=\"token punctuation\">.</span><span class=\"token function\">setScale</span><span class=\"token punctuation\">(</span>skateLife<span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                child<span class=\"token punctuation\">.</span><span class=\"token function\">setDepth</span><span class=\"token punctuation\">(</span>child<span class=\"token punctuation\">.</span>depth <span class=\"token operator\">-</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\r\n            <span class=\"token punctuation\">}</span>\r\n            <span class=\"token keyword\">case</span> <span class=\"token string\">'coin'</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\r\n                child<span class=\"token punctuation\">.</span><span class=\"token function\">setY</span><span class=\"token punctuation\">(</span>child<span class=\"token punctuation\">.</span>y <span class=\"token operator\">+</span> <span class=\"token number\">48</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\r\n            <span class=\"token punctuation\">}</span>\r\n            <span class=\"token keyword\">case</span> <span class=\"token string\">'nut_text'</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\r\n                child<span class=\"token punctuation\">.</span><span class=\"token function\">setY</span><span class=\"token punctuation\">(</span>child<span class=\"token punctuation\">.</span>y <span class=\"token operator\">+</span> <span class=\"token number\">42</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                child<span class=\"token punctuation\">.</span><span class=\"token function\">setX</span><span class=\"token punctuation\">(</span>child<span class=\"token punctuation\">.</span>x <span class=\"token operator\">+</span> <span class=\"token number\">25</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\r\n            <span class=\"token punctuation\">}</span>\r\n            <span class=\"token keyword\">case</span> <span class=\"token string\">'collectable_times'</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\r\n                child<span class=\"token punctuation\">.</span><span class=\"token function\">setY</span><span class=\"token punctuation\">(</span>child<span class=\"token punctuation\">.</span>y <span class=\"token operator\">+</span> <span class=\"token number\">52</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                child<span class=\"token punctuation\">.</span><span class=\"token function\">setX</span><span class=\"token punctuation\">(</span>child<span class=\"token punctuation\">.</span>x <span class=\"token operator\">+</span> <span class=\"token number\">17</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\r\n            <span class=\"token punctuation\">}</span>\r\n            <span class=\"token keyword\">default</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\r\n                <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\r\n            <span class=\"token punctuation\">}</span>\r\n        <span class=\"token punctuation\">}</span>\r\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>E por √∫ltimo as fun√ß√µes <code class=\"language-text\">increasePlayerLife</code> e <code class=\"language-text\">decreasePlayerLife</code>:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token function-variable function\">decreasePlayerLife</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">value</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">const</span> playerLife <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token constant\">PLAYER_LIFE_DATA</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">.</span><span class=\"token function\">set</span><span class=\"token punctuation\">(</span><span class=\"token constant\">PLAYER_LIFE_DATA</span><span class=\"token punctuation\">,</span> playerLife <span class=\"token operator\">-</span> value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span>\r\n\r\n<span class=\"token function-variable function\">increasePlayerLife</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">value</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">const</span> playerLife <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token constant\">PLAYER_LIFE_DATA</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">.</span><span class=\"token function\">set</span><span class=\"token punctuation\">(</span><span class=\"token constant\">PLAYER_LIFE_DATA</span><span class=\"token punctuation\">,</span> playerLife <span class=\"token operator\">+</span> value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Agora bastou eu adicionar <code class=\"language-text\">gameHud.decreasePlayerLife(5)</code> na fun√ß√£o de colis√£o entre o her√≥i e os inimigos e pronto üòÑ</p>\n<p>E isso conclui o game devlog dessa semana, n√£o esque√ßa de deixar o seu coment√°rio tanto aqui quanto no v√≠deo sobre o que tem achado desses posts e v√≠deos.</p>","fields":{"postHashId":"Z2FtZXN0cnVlbnVsbDIwMjAtMTEtMDVUMDA6MDA6MDAuMDAwWg==","slug":"/2020/2020-05-11-criando-status-do-heroi-hud-no-phaser-js-skate-platformer-game-devlog-10.pt-br/","path":"/blog/games/criando-status-do-heroi-hud-no-phaser-js-skate-platformer-game-devlog-10/","locale":"pt-br"},"rawMarkdownBody":"Fala pessoal, no game devlog de hoje vou mostrar como eu fiz para criar o HUD com os status do her√≥i.\r\n\r\n`youtube: https://www.youtube.com/watch?v=JVeRYsaXxpg`\r\n\r\nA primeira coisa que fiz foi cortar o design do HUD que o √çtalo fez em pequenas partes reutiliz√°veis para que eu pudesse aumentar/diminuir as barras de vida √† vontade. O PNG do atlas ficou assim:\r\n\r\n![HUD do her√≥i](../../uploads/blog/2020/11/hero_hud.jpg)\r\n\r\nDepois de ter todas as partes do HUD separadas, eu criei um `GameGroup` com todas as imagens, e sempre que eu precisar aumentar ou diminuir a vida do her√≥i eu chamo as fun√ß√µes `increasePlayerLife` e `decreasePlayerLife`.\r\n\r\n```javascript\r\nclass PlayerHud extends GameGroup {\r\n    constructor(scene) {\r\n        const children = [];\r\n        // create all the game object images\r\n        [\r\n            'hud_meter_border',\r\n            'hud_meter_point_border',\r\n            'player_face_hud',\r\n            'player_life_hud',\r\n            'skate_hud',\r\n            'skate_life_hud',\r\n            'collectable_times',\r\n            'coin',\r\n        ].forEach((asset) => {\r\n            if (\r\n              ['hud_meter_border', 'hud_meter_point_border'].includes(asset)\r\n            ) {\r\n                ['skate', 'player'].forEach((hudType) => {\r\n                    const assetName = `${hudType}_${asset}`;\r\n                    const child = new GameObjects.Image(\r\n                        scene,\r\n                        x,\r\n                        y,\r\n                        asset\r\n                    );\r\n\r\n                    child.setOrigin(0, 0);\r\n                    child.setName(assetName);\r\n                    child.setScrollFactor(0);\r\n                    children.push(child);\r\n                });\r\n                return;\r\n            }\r\n\r\n            const child = new GameObjects.Image(\r\n                scene,\r\n                x,\r\n                y,\r\n                asset\r\n            );\r\n\r\n            child.setOrigin(0, 0);\r\n            child.setName(asset);\r\n            child.setScrollFactor(0);\r\n            children.push(child);\r\n        });\r\n\r\n        super(scene, children);\r\n\r\n        // create a dummy game object to store the data manager\r\n        const dataGameobject = new GameObjects.Rectangle(scene, x, y);\r\n        this.data = new Data.DataManager(dataGameobject);\r\n\r\n        // set data manager listeners\r\n        this.data.set(PLAYER_LIFE_DATA, initialPlayerLife);\r\n        this.data.set(SKATE_LIFE_DATA, initialSkateLife);\r\n        this.data.set(COLLECTED_NUTS_DATA, initialCollectedNuts);\r\n        this.data.events.on(\r\n          `changedata-${SKATE_LIFE_DATA}`,\r\n          this.onSkateLifeChanged\r\n        );\r\n        this.data.events.on(\r\n          `changedata-${PLAYER_LIFE_DATA}`,\r\n          this.onPlayerLifeChanged\r\n        );\r\n        this.data.events.on(\r\n          `changedata-${COLLECTED_NUTS_DATA}`,\r\n          this.onCollectedNutsChanged\r\n        );\r\n\r\n        // After everythibg is set\r\n        this.setHudPositions();\r\n    }\r\n\r\n    setHudPositions = () => {\r\n        // TODO\r\n    }\r\n\r\n    increasePlayerLife = () => {\r\n        // TODO\r\n    }\r\n\r\n    decreasePlayerLife = () => {\r\n        // TODO\r\n    }\r\n}\r\n```\r\n\r\nComo eu n√£o queria deixar a fun√ß√£o `construct` grande demais, criei a fun√ß√£o `setHudPositions` que seta todas as poci√ß√µes das imagens do HUD.\r\n\r\n```javascript\r\nsetHudPositions = () => {\r\n    const { width, height } = this.scene.cameras.main;\r\n    const paddingX = 10;\r\n    const paddingY = 10;\r\n    const skateLife = this.data.get(SKATE_LIFE_DATA);\r\n    const playerLife = this.data.get(PLAYER_LIFE_DATA);\r\n    this.getChildren().forEach((child) => {\r\n        const { name } = child;\r\n        child.setX(paddingX);\r\n        child.setY(paddingY);\r\n\r\n        switch (name) {\r\n            case 'player_face_hud': {\r\n                // TODO\r\n                break;\r\n            }\r\n            case 'player_hud_meter_border': {\r\n                child.setX(child.x + 32);\r\n                child.setY(child.y + 15);\r\n                child.setScale(playerLife - 1, 1);\r\n                child.setDepth(child.depth - 1);\r\n                break;\r\n            }\r\n            case 'player_hud_meter_point_border': {\r\n                child.setX(child.x + playerLife + 31);\r\n                child.setY(child.y + 16);\r\n                child.setDepth(child.depth - 1);\r\n                break;\r\n            }\r\n            case 'player_life_hud': {\r\n                child.setX(child.x + 32);\r\n                child.setY(child.y + 16);\r\n                child.setScale(playerLife, 1);\r\n                child.setDepth(child.depth - 2);\r\n                break;\r\n            }\r\n            case 'skate_hud': {\r\n                child.setY(child.y + 32);\r\n                break;\r\n            }\r\n            case 'skate_hud_meter_border': {\r\n                child.setX(child.x + 32);\r\n                child.setY(child.y + 34);\r\n                child.setScale(skateLife - 1, 1);\r\n                child.setDepth(child.depth - 1);\r\n                break;\r\n            }\r\n            case 'skate_hud_meter_point_border': {\r\n                child.setX(child.x + skateLife + 31);\r\n                child.setY(child.y + 35);\r\n                child.setDepth(child.depth - 1);\r\n                break;\r\n            }\r\n            case 'skate_life_hud': {\r\n                child.setX(child.x + 32);\r\n                child.setY(child.y + 35);\r\n                child.setScale(skateLife, 1);\r\n                child.setDepth(child.depth - 2);\r\n                break;\r\n            }\r\n            case 'coin': {\r\n                child.setY(child.y + 48);\r\n                break;\r\n            }\r\n            case 'nut_text': {\r\n                child.setY(child.y + 42);\r\n                child.setX(child.x + 25);\r\n                break;\r\n            }\r\n            case 'collectable_times': {\r\n                child.setY(child.y + 52);\r\n                child.setX(child.x + 17);\r\n                break;\r\n            }\r\n            default: {\r\n                break;\r\n            }\r\n        }\r\n    });\r\n}\r\n```\r\n\r\nE por √∫ltimo as fun√ß√µes `increasePlayerLife` e `decreasePlayerLife`:\r\n\r\n```javascript\r\ndecreasePlayerLife = (value) => {\r\n    const playerLife = this.data.get(PLAYER_LIFE_DATA);\r\n    this.data.set(PLAYER_LIFE_DATA, playerLife - value);\r\n}\r\n\r\nincreasePlayerLife = (value) => {\r\n    const playerLife = this.data.get(PLAYER_LIFE_DATA);\r\n    this.data.set(PLAYER_LIFE_DATA, playerLife + value);\r\n}\r\n```\r\n\r\nAgora bastou eu adicionar `gameHud.decreasePlayerLife(5)` na fun√ß√£o de colis√£o entre o her√≥i e os inimigos e pronto üòÑ\r\n\r\nE isso conclui o game devlog dessa semana, n√£o esque√ßa de deixar o seu coment√°rio tanto aqui quanto no v√≠deo sobre o que tem achado desses posts e v√≠deos.\r\n","frontmatter":{"tags":["programa√ß√£o","jogos","javascript","phaser","phaser 3","game devlog","gamedev","skate platformer","super ollie vs pebble corp","webpack","tiled","hud","status do jogador","health"],"categories":["games"],"allowComments":true,"publishOnMedium":false,"cover":null,"date":"2020-11-05T00:00:00.000Z","id":null,"path":"criando-status-do-heroi-hud-no-phaser-js-skate-platformer-game-devlog-10","show":true,"title":"Criando status do her√≥i (HUD) no Phaser JS - Skate Platformer Game Devlog #10","hideExcerpt":false,"subtitle":""}}},{"node":{"excerpt":"Hey guys, in today‚Äôs game devlog I‚Äôll show you how I did to‚Ä¶","html":"<p>Hey guys, in today‚Äôs game devlog I‚Äôll show you how I did to create the HUD with the hero‚Äôs status.</p>\n<p><div class=\"gatsby-resp-iframe-wrapper\" style=\"padding-bottom: 56.42857142857143%; position: relative; height: 0; overflow: hidden; margin-bottom: 1.0725rem\" > <div class=\"embedVideo-container\"> <iframe title=\"\" src=\"https://www.youtube.com/embed/JVeRYsaXxpg?rel=0\" class=\"embedVideo-iframe\" style=\"border:0; position: absolute; top: 0; left: 0; width: 100%; height: 100%; \" loading=\"eager\" allowfullscreen=\"\" sandbox=\"allow-same-origin allow-scripts allow-popups\"></iframe> </div> </div></p>\n<p>The first thing I did was to cut the HUD design from √çtalo into small reusable parts so I could increase/decrease the meter bars at will. My final atlas PNG looks like this:</p>\n<p><figure class=\"gatsby-resp-image-figure\" style=\"\">\n    <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 330px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 142.578125%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAdABQDASIAAhEBAxEB/8QAGAAAAwEBAAAAAAAAAAAAAAAAAAMFAgT/xAAXAQADAQAAAAAAAAAAAAAAAAAAAQID/9oADAMBAAIQAxAAAAF+ubkVWhYLbpao0pCRH//EABwQAAEEAwEAAAAAAAAAAAAAAAEAAgMSESIxBP/aAAgBAQABBQJ5qBKwjq9MbnnSkeKB1DaPCkCHWDX/xAAZEQADAAMAAAAAAAAAAAAAAAAAASESMUH/2gAIAQMBAT8BSXR7HaZH/8QAGxEAAQQDAAAAAAAAAAAAAAAAAAECAxEQE0H/2gAIAQIBAT8BvCR100tP/8QAIRAAAQMBCQAAAAAAAAAAAAAAAAECETEQEiAhMkFhcYH/2gAIAQEABj8Cly+mqxsZolS9DooJBwbdYKn/xAAcEAADAQADAQEAAAAAAAAAAAAAAREhMUFRYXH/2gAIAQEAAT8hpQblcCY1+hNJU6hiq6sGpwPsiXWl05Seh5U3+Bbptb2LVXpjH//aAAwDAQACAAMAAAAQHCNP/8QAGBEAAwEBAAAAAAAAAAAAAAAAAAERMaH/2gAIAQMBAT8QuKRkiAb3eH//xAAYEQEBAQEBAAAAAAAAAAAAAAABABExUf/aAAgBAgEBPxDLyHYA5PW//8QAHBABAAMAAwEBAAAAAAAAAAAAAQARITFBUXGB/9oACAEBAAE/EAPCm7H4grm+w5DIk4RlyWRrZ3fnAxWg0ZgNWdQa0R9NjaknC8TAQtlGvyBKKpVxyIWpoFe87KaasF+RmlGVk//Z'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Hero HUD\"\n        title=\"Hero HUD\"\n        src=\"/static/e238085b17b34974e3945879aea90722/4f5c6/hero_hud.jpg\"\n        srcset=\"/static/e238085b17b34974e3945879aea90722/db830/hero_hud.jpg 256w,\n/static/e238085b17b34974e3945879aea90722/4f5c6/hero_hud.jpg 330w\"\n        sizes=\"(max-width: 330px) 100vw, 330px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\">Hero HUD</figcaption>\n  </figure></p>\n<p>After having all the HUD parts separated, I created a <code class=\"language-text\">GameGroup</code> with all the images, and whenever I need to increase or decrease the life of the hero I call the functions <code class=\"language-text\">increasePlayerLife</code> and <code class=\"language-text\">decreasePlayerLife</code>.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">PlayerHud</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">GameGroup</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">scene</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token keyword\">const</span> children <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token comment\">// create all the game object images</span>\r\n        <span class=\"token punctuation\">[</span>\r\n            <span class=\"token string\">'hud_meter_border'</span><span class=\"token punctuation\">,</span>\r\n            <span class=\"token string\">'hud_meter_point_border'</span><span class=\"token punctuation\">,</span>\r\n            <span class=\"token string\">'player_face_hud'</span><span class=\"token punctuation\">,</span>\r\n            <span class=\"token string\">'player_life_hud'</span><span class=\"token punctuation\">,</span>\r\n            <span class=\"token string\">'skate_hud'</span><span class=\"token punctuation\">,</span>\r\n            <span class=\"token string\">'skate_life_hud'</span><span class=\"token punctuation\">,</span>\r\n            <span class=\"token string\">'collectable_times'</span><span class=\"token punctuation\">,</span>\r\n            <span class=\"token string\">'coin'</span><span class=\"token punctuation\">,</span>\r\n        <span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">asset</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>\r\n              <span class=\"token punctuation\">[</span><span class=\"token string\">'hud_meter_border'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'hud_meter_point_border'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">includes</span><span class=\"token punctuation\">(</span>asset<span class=\"token punctuation\">)</span>\r\n            <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n                <span class=\"token punctuation\">[</span><span class=\"token string\">'skate'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'player'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">hudType</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n                    <span class=\"token keyword\">const</span> assetName <span class=\"token operator\">=</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>hudType<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">_</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>asset<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span>\r\n                    <span class=\"token keyword\">const</span> child <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">GameObjects<span class=\"token punctuation\">.</span>Image</span><span class=\"token punctuation\">(</span>\r\n                        scene<span class=\"token punctuation\">,</span>\r\n                        x<span class=\"token punctuation\">,</span>\r\n                        y<span class=\"token punctuation\">,</span>\r\n                        asset\r\n                    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n                    child<span class=\"token punctuation\">.</span><span class=\"token function\">setOrigin</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                    child<span class=\"token punctuation\">.</span><span class=\"token function\">setName</span><span class=\"token punctuation\">(</span>assetName<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                    child<span class=\"token punctuation\">.</span><span class=\"token function\">setScrollFactor</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                    children<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span>child<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span>\r\n            <span class=\"token punctuation\">}</span>\r\n\r\n            <span class=\"token keyword\">const</span> child <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">GameObjects<span class=\"token punctuation\">.</span>Image</span><span class=\"token punctuation\">(</span>\r\n                scene<span class=\"token punctuation\">,</span>\r\n                x<span class=\"token punctuation\">,</span>\r\n                y<span class=\"token punctuation\">,</span>\r\n                asset\r\n            <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n            child<span class=\"token punctuation\">.</span><span class=\"token function\">setOrigin</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n            child<span class=\"token punctuation\">.</span><span class=\"token function\">setName</span><span class=\"token punctuation\">(</span>asset<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n            child<span class=\"token punctuation\">.</span><span class=\"token function\">setScrollFactor</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n            children<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span>child<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n        <span class=\"token keyword\">super</span><span class=\"token punctuation\">(</span>scene<span class=\"token punctuation\">,</span> children<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n        <span class=\"token comment\">// create a dummy game object to store the data manager</span>\r\n        <span class=\"token keyword\">const</span> dataGameobject <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">GameObjects<span class=\"token punctuation\">.</span>Rectangle</span><span class=\"token punctuation\">(</span>scene<span class=\"token punctuation\">,</span> x<span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>data <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Data<span class=\"token punctuation\">.</span>DataManager</span><span class=\"token punctuation\">(</span>dataGameobject<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n        <span class=\"token comment\">// set data manager listeners</span>\r\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">.</span><span class=\"token function\">set</span><span class=\"token punctuation\">(</span><span class=\"token constant\">PLAYER_LIFE_DATA</span><span class=\"token punctuation\">,</span> initialPlayerLife<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">.</span><span class=\"token function\">set</span><span class=\"token punctuation\">(</span><span class=\"token constant\">SKATE_LIFE_DATA</span><span class=\"token punctuation\">,</span> initialSkateLife<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">.</span><span class=\"token function\">set</span><span class=\"token punctuation\">(</span><span class=\"token constant\">COLLECTED_NUTS_DATA</span><span class=\"token punctuation\">,</span> initialCollectedNuts<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">.</span>events<span class=\"token punctuation\">.</span><span class=\"token function\">on</span><span class=\"token punctuation\">(</span>\r\n          <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">changedata-</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token constant\">SKATE_LIFE_DATA</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\r\n          <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>onSkateLifeChanged\r\n        <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">.</span>events<span class=\"token punctuation\">.</span><span class=\"token function\">on</span><span class=\"token punctuation\">(</span>\r\n          <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">changedata-</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token constant\">PLAYER_LIFE_DATA</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\r\n          <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>onPlayerLifeChanged\r\n        <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">.</span>events<span class=\"token punctuation\">.</span><span class=\"token function\">on</span><span class=\"token punctuation\">(</span>\r\n          <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">changedata-</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token constant\">COLLECTED_NUTS_DATA</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\r\n          <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>onCollectedNutsChanged\r\n        <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n        <span class=\"token comment\">// After everythibg is set</span>\r\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setHudPositions</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span>\r\n\r\n    <span class=\"token function-variable function\">setHudPositions</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token comment\">// TODO</span>\r\n    <span class=\"token punctuation\">}</span>\r\n\r\n    <span class=\"token function-variable function\">increasePlayerLife</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token comment\">// TODO</span>\r\n    <span class=\"token punctuation\">}</span>\r\n\r\n    <span class=\"token function-variable function\">decreasePlayerLife</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token comment\">// TODO</span>\r\n    <span class=\"token punctuation\">}</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>As I didn‚Äôt want to make the <code class=\"language-text\">construct</code> function too big, I created the <code class=\"language-text\">setHudPositions</code> function that sets all the positions of the HUD images.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token function-variable function\">setHudPositions</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> width<span class=\"token punctuation\">,</span> height <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>scene<span class=\"token punctuation\">.</span>cameras<span class=\"token punctuation\">.</span>main<span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">const</span> paddingX <span class=\"token operator\">=</span> <span class=\"token number\">10</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">const</span> paddingY <span class=\"token operator\">=</span> <span class=\"token number\">10</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">const</span> skateLife <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token constant\">SKATE_LIFE_DATA</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">const</span> playerLife <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token constant\">PLAYER_LIFE_DATA</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">getChildren</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">child</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> name <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> child<span class=\"token punctuation\">;</span>\r\n        child<span class=\"token punctuation\">.</span><span class=\"token function\">setX</span><span class=\"token punctuation\">(</span>paddingX<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        child<span class=\"token punctuation\">.</span><span class=\"token function\">setY</span><span class=\"token punctuation\">(</span>paddingY<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n        <span class=\"token keyword\">switch</span> <span class=\"token punctuation\">(</span>name<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n            <span class=\"token keyword\">case</span> <span class=\"token string\">'player_face_hud'</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\r\n                <span class=\"token comment\">// TODO</span>\r\n                <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\r\n            <span class=\"token punctuation\">}</span>\r\n            <span class=\"token keyword\">case</span> <span class=\"token string\">'player_hud_meter_border'</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\r\n                child<span class=\"token punctuation\">.</span><span class=\"token function\">setX</span><span class=\"token punctuation\">(</span>child<span class=\"token punctuation\">.</span>x <span class=\"token operator\">+</span> <span class=\"token number\">32</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                child<span class=\"token punctuation\">.</span><span class=\"token function\">setY</span><span class=\"token punctuation\">(</span>child<span class=\"token punctuation\">.</span>y <span class=\"token operator\">+</span> <span class=\"token number\">15</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                child<span class=\"token punctuation\">.</span><span class=\"token function\">setScale</span><span class=\"token punctuation\">(</span>playerLife <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                child<span class=\"token punctuation\">.</span><span class=\"token function\">setDepth</span><span class=\"token punctuation\">(</span>child<span class=\"token punctuation\">.</span>depth <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\r\n            <span class=\"token punctuation\">}</span>\r\n            <span class=\"token keyword\">case</span> <span class=\"token string\">'player_hud_meter_point_border'</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\r\n                child<span class=\"token punctuation\">.</span><span class=\"token function\">setX</span><span class=\"token punctuation\">(</span>child<span class=\"token punctuation\">.</span>x <span class=\"token operator\">+</span> playerLife <span class=\"token operator\">+</span> <span class=\"token number\">31</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                child<span class=\"token punctuation\">.</span><span class=\"token function\">setY</span><span class=\"token punctuation\">(</span>child<span class=\"token punctuation\">.</span>y <span class=\"token operator\">+</span> <span class=\"token number\">16</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                child<span class=\"token punctuation\">.</span><span class=\"token function\">setDepth</span><span class=\"token punctuation\">(</span>child<span class=\"token punctuation\">.</span>depth <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\r\n            <span class=\"token punctuation\">}</span>\r\n            <span class=\"token keyword\">case</span> <span class=\"token string\">'player_life_hud'</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\r\n                child<span class=\"token punctuation\">.</span><span class=\"token function\">setX</span><span class=\"token punctuation\">(</span>child<span class=\"token punctuation\">.</span>x <span class=\"token operator\">+</span> <span class=\"token number\">32</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                child<span class=\"token punctuation\">.</span><span class=\"token function\">setY</span><span class=\"token punctuation\">(</span>child<span class=\"token punctuation\">.</span>y <span class=\"token operator\">+</span> <span class=\"token number\">16</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                child<span class=\"token punctuation\">.</span><span class=\"token function\">setScale</span><span class=\"token punctuation\">(</span>playerLife<span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                child<span class=\"token punctuation\">.</span><span class=\"token function\">setDepth</span><span class=\"token punctuation\">(</span>child<span class=\"token punctuation\">.</span>depth <span class=\"token operator\">-</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\r\n            <span class=\"token punctuation\">}</span>\r\n            <span class=\"token keyword\">case</span> <span class=\"token string\">'skate_hud'</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\r\n                child<span class=\"token punctuation\">.</span><span class=\"token function\">setY</span><span class=\"token punctuation\">(</span>child<span class=\"token punctuation\">.</span>y <span class=\"token operator\">+</span> <span class=\"token number\">32</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\r\n            <span class=\"token punctuation\">}</span>\r\n            <span class=\"token keyword\">case</span> <span class=\"token string\">'skate_hud_meter_border'</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\r\n                child<span class=\"token punctuation\">.</span><span class=\"token function\">setX</span><span class=\"token punctuation\">(</span>child<span class=\"token punctuation\">.</span>x <span class=\"token operator\">+</span> <span class=\"token number\">32</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                child<span class=\"token punctuation\">.</span><span class=\"token function\">setY</span><span class=\"token punctuation\">(</span>child<span class=\"token punctuation\">.</span>y <span class=\"token operator\">+</span> <span class=\"token number\">34</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                child<span class=\"token punctuation\">.</span><span class=\"token function\">setScale</span><span class=\"token punctuation\">(</span>skateLife <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                child<span class=\"token punctuation\">.</span><span class=\"token function\">setDepth</span><span class=\"token punctuation\">(</span>child<span class=\"token punctuation\">.</span>depth <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\r\n            <span class=\"token punctuation\">}</span>\r\n            <span class=\"token keyword\">case</span> <span class=\"token string\">'skate_hud_meter_point_border'</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\r\n                child<span class=\"token punctuation\">.</span><span class=\"token function\">setX</span><span class=\"token punctuation\">(</span>child<span class=\"token punctuation\">.</span>x <span class=\"token operator\">+</span> skateLife <span class=\"token operator\">+</span> <span class=\"token number\">31</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                child<span class=\"token punctuation\">.</span><span class=\"token function\">setY</span><span class=\"token punctuation\">(</span>child<span class=\"token punctuation\">.</span>y <span class=\"token operator\">+</span> <span class=\"token number\">35</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                child<span class=\"token punctuation\">.</span><span class=\"token function\">setDepth</span><span class=\"token punctuation\">(</span>child<span class=\"token punctuation\">.</span>depth <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\r\n            <span class=\"token punctuation\">}</span>\r\n            <span class=\"token keyword\">case</span> <span class=\"token string\">'skate_life_hud'</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\r\n                child<span class=\"token punctuation\">.</span><span class=\"token function\">setX</span><span class=\"token punctuation\">(</span>child<span class=\"token punctuation\">.</span>x <span class=\"token operator\">+</span> <span class=\"token number\">32</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                child<span class=\"token punctuation\">.</span><span class=\"token function\">setY</span><span class=\"token punctuation\">(</span>child<span class=\"token punctuation\">.</span>y <span class=\"token operator\">+</span> <span class=\"token number\">35</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                child<span class=\"token punctuation\">.</span><span class=\"token function\">setScale</span><span class=\"token punctuation\">(</span>skateLife<span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                child<span class=\"token punctuation\">.</span><span class=\"token function\">setDepth</span><span class=\"token punctuation\">(</span>child<span class=\"token punctuation\">.</span>depth <span class=\"token operator\">-</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\r\n            <span class=\"token punctuation\">}</span>\r\n            <span class=\"token keyword\">case</span> <span class=\"token string\">'coin'</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\r\n                child<span class=\"token punctuation\">.</span><span class=\"token function\">setY</span><span class=\"token punctuation\">(</span>child<span class=\"token punctuation\">.</span>y <span class=\"token operator\">+</span> <span class=\"token number\">48</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\r\n            <span class=\"token punctuation\">}</span>\r\n            <span class=\"token keyword\">case</span> <span class=\"token string\">'nut_text'</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\r\n                child<span class=\"token punctuation\">.</span><span class=\"token function\">setY</span><span class=\"token punctuation\">(</span>child<span class=\"token punctuation\">.</span>y <span class=\"token operator\">+</span> <span class=\"token number\">42</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                child<span class=\"token punctuation\">.</span><span class=\"token function\">setX</span><span class=\"token punctuation\">(</span>child<span class=\"token punctuation\">.</span>x <span class=\"token operator\">+</span> <span class=\"token number\">25</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\r\n            <span class=\"token punctuation\">}</span>\r\n            <span class=\"token keyword\">case</span> <span class=\"token string\">'collectable_times'</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\r\n                child<span class=\"token punctuation\">.</span><span class=\"token function\">setY</span><span class=\"token punctuation\">(</span>child<span class=\"token punctuation\">.</span>y <span class=\"token operator\">+</span> <span class=\"token number\">52</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                child<span class=\"token punctuation\">.</span><span class=\"token function\">setX</span><span class=\"token punctuation\">(</span>child<span class=\"token punctuation\">.</span>x <span class=\"token operator\">+</span> <span class=\"token number\">17</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\r\n            <span class=\"token punctuation\">}</span>\r\n            <span class=\"token keyword\">default</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\r\n                <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\r\n            <span class=\"token punctuation\">}</span>\r\n        <span class=\"token punctuation\">}</span>\r\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>And last but not least the functions <code class=\"language-text\">increasePlayerLife</code> and <code class=\"language-text\">decreasePlayerLife</code>:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token function-variable function\">decreasePlayerLife</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">value</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">const</span> playerLife <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token constant\">PLAYER_LIFE_DATA</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">.</span><span class=\"token function\">set</span><span class=\"token punctuation\">(</span><span class=\"token constant\">PLAYER_LIFE_DATA</span><span class=\"token punctuation\">,</span> playerLife <span class=\"token operator\">-</span> value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span>\r\n\r\n<span class=\"token function-variable function\">increasePlayerLife</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">value</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">const</span> playerLife <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token constant\">PLAYER_LIFE_DATA</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">.</span><span class=\"token function\">set</span><span class=\"token punctuation\">(</span><span class=\"token constant\">PLAYER_LIFE_DATA</span><span class=\"token punctuation\">,</span> playerLife <span class=\"token operator\">+</span> value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Now I can simply add <code class=\"language-text\">gameHud.decreasePlayerLife(5)</code> in the collision function between the hero and the enemies and that‚Äôs it üòÑ</p>\n<p>And that concludes this week‚Äôs game devlog, don‚Äôt forget to leave your comment both here and in the video about what you think of these posts and videos.</p>","fields":{"postHashId":"Z2FtZXN0cnVlbnVsbDIwMjAtMTEtMDVUMDA6MDA6MDAuMDAwWg==","slug":"/2020/2020-05-11-creating-hero-hud-on-phaser-js-skate-platformer-game-devlog-10.en/","path":"/blog/games/creating-hero-hud-on-phaser-js-skate-platformer-game-devlog-10/","locale":"en"},"rawMarkdownBody":"Hey guys, in today's game devlog I'll show you how I did to create the HUD with the hero's status.\r\n\r\n`youtube: https://www.youtube.com/watch?v=JVeRYsaXxpg`\r\n\r\nThe first thing I did was to cut the HUD design from √çtalo into small reusable parts so I could increase/decrease the meter bars at will. My final atlas PNG looks like this:\r\n\r\n![Hero HUD](../../uploads/blog/2020/11/hero_hud.jpg)\r\n\r\nAfter having all the HUD parts separated, I created a `GameGroup` with all the images, and whenever I need to increase or decrease the life of the hero I call the functions `increasePlayerLife` and `decreasePlayerLife`.\r\n\r\n```javascript\r\nclass PlayerHud extends GameGroup {\r\n    constructor(scene) {\r\n        const children = [];\r\n        // create all the game object images\r\n        [\r\n            'hud_meter_border',\r\n            'hud_meter_point_border',\r\n            'player_face_hud',\r\n            'player_life_hud',\r\n            'skate_hud',\r\n            'skate_life_hud',\r\n            'collectable_times',\r\n            'coin',\r\n        ].forEach((asset) => {\r\n            if (\r\n              ['hud_meter_border', 'hud_meter_point_border'].includes(asset)\r\n            ) {\r\n                ['skate', 'player'].forEach((hudType) => {\r\n                    const assetName = `${hudType}_${asset}`;\r\n                    const child = new GameObjects.Image(\r\n                        scene,\r\n                        x,\r\n                        y,\r\n                        asset\r\n                    );\r\n\r\n                    child.setOrigin(0, 0);\r\n                    child.setName(assetName);\r\n                    child.setScrollFactor(0);\r\n                    children.push(child);\r\n                });\r\n                return;\r\n            }\r\n\r\n            const child = new GameObjects.Image(\r\n                scene,\r\n                x,\r\n                y,\r\n                asset\r\n            );\r\n\r\n            child.setOrigin(0, 0);\r\n            child.setName(asset);\r\n            child.setScrollFactor(0);\r\n            children.push(child);\r\n        });\r\n\r\n        super(scene, children);\r\n\r\n        // create a dummy game object to store the data manager\r\n        const dataGameobject = new GameObjects.Rectangle(scene, x, y);\r\n        this.data = new Data.DataManager(dataGameobject);\r\n\r\n        // set data manager listeners\r\n        this.data.set(PLAYER_LIFE_DATA, initialPlayerLife);\r\n        this.data.set(SKATE_LIFE_DATA, initialSkateLife);\r\n        this.data.set(COLLECTED_NUTS_DATA, initialCollectedNuts);\r\n        this.data.events.on(\r\n          `changedata-${SKATE_LIFE_DATA}`,\r\n          this.onSkateLifeChanged\r\n        );\r\n        this.data.events.on(\r\n          `changedata-${PLAYER_LIFE_DATA}`,\r\n          this.onPlayerLifeChanged\r\n        );\r\n        this.data.events.on(\r\n          `changedata-${COLLECTED_NUTS_DATA}`,\r\n          this.onCollectedNutsChanged\r\n        );\r\n\r\n        // After everythibg is set\r\n        this.setHudPositions();\r\n    }\r\n\r\n    setHudPositions = () => {\r\n        // TODO\r\n    }\r\n\r\n    increasePlayerLife = () => {\r\n        // TODO\r\n    }\r\n\r\n    decreasePlayerLife = () => {\r\n        // TODO\r\n    }\r\n}\r\n```\r\n\r\nAs I didn't want to make the `construct` function too big, I created the `setHudPositions` function that sets all the positions of the HUD images.\r\n\r\n```javascript\r\nsetHudPositions = () => {\r\n    const { width, height } = this.scene.cameras.main;\r\n    const paddingX = 10;\r\n    const paddingY = 10;\r\n    const skateLife = this.data.get(SKATE_LIFE_DATA);\r\n    const playerLife = this.data.get(PLAYER_LIFE_DATA);\r\n    this.getChildren().forEach((child) => {\r\n        const { name } = child;\r\n        child.setX(paddingX);\r\n        child.setY(paddingY);\r\n\r\n        switch (name) {\r\n            case 'player_face_hud': {\r\n                // TODO\r\n                break;\r\n            }\r\n            case 'player_hud_meter_border': {\r\n                child.setX(child.x + 32);\r\n                child.setY(child.y + 15);\r\n                child.setScale(playerLife - 1, 1);\r\n                child.setDepth(child.depth - 1);\r\n                break;\r\n            }\r\n            case 'player_hud_meter_point_border': {\r\n                child.setX(child.x + playerLife + 31);\r\n                child.setY(child.y + 16);\r\n                child.setDepth(child.depth - 1);\r\n                break;\r\n            }\r\n            case 'player_life_hud': {\r\n                child.setX(child.x + 32);\r\n                child.setY(child.y + 16);\r\n                child.setScale(playerLife, 1);\r\n                child.setDepth(child.depth - 2);\r\n                break;\r\n            }\r\n            case 'skate_hud': {\r\n                child.setY(child.y + 32);\r\n                break;\r\n            }\r\n            case 'skate_hud_meter_border': {\r\n                child.setX(child.x + 32);\r\n                child.setY(child.y + 34);\r\n                child.setScale(skateLife - 1, 1);\r\n                child.setDepth(child.depth - 1);\r\n                break;\r\n            }\r\n            case 'skate_hud_meter_point_border': {\r\n                child.setX(child.x + skateLife + 31);\r\n                child.setY(child.y + 35);\r\n                child.setDepth(child.depth - 1);\r\n                break;\r\n            }\r\n            case 'skate_life_hud': {\r\n                child.setX(child.x + 32);\r\n                child.setY(child.y + 35);\r\n                child.setScale(skateLife, 1);\r\n                child.setDepth(child.depth - 2);\r\n                break;\r\n            }\r\n            case 'coin': {\r\n                child.setY(child.y + 48);\r\n                break;\r\n            }\r\n            case 'nut_text': {\r\n                child.setY(child.y + 42);\r\n                child.setX(child.x + 25);\r\n                break;\r\n            }\r\n            case 'collectable_times': {\r\n                child.setY(child.y + 52);\r\n                child.setX(child.x + 17);\r\n                break;\r\n            }\r\n            default: {\r\n                break;\r\n            }\r\n        }\r\n    });\r\n}\r\n```\r\n\r\nAnd last but not least the functions `increasePlayerLife` and `decreasePlayerLife`:\r\n\r\n```javascript\r\ndecreasePlayerLife = (value) => {\r\n    const playerLife = this.data.get(PLAYER_LIFE_DATA);\r\n    this.data.set(PLAYER_LIFE_DATA, playerLife - value);\r\n}\r\n\r\nincreasePlayerLife = (value) => {\r\n    const playerLife = this.data.get(PLAYER_LIFE_DATA);\r\n    this.data.set(PLAYER_LIFE_DATA, playerLife + value);\r\n}\r\n```\r\n\r\nNow I can simply add `gameHud.decreasePlayerLife(5)` in the collision function between the hero and the enemies and that's it üòÑ\r\n\r\nAnd that concludes this week's game devlog, don't forget to leave your comment both here and in the video about what you think of these posts and videos.\r\n","frontmatter":{"tags":["coding","games","javascript","phaser","phaser 3","game devlog","gamedev","skate platformer","super ollie vs pebble corp","webpack","tiled","hud","player status","health"],"categories":["games"],"allowComments":true,"publishOnMedium":false,"cover":null,"date":"2020-11-05T00:00:00.000Z","id":null,"path":"creating-hero-hud-on-phaser-js-skate-platformer-game-devlog-10","show":true,"title":"Creating hero HUD on Phaser JS - Skate Platformer Game Devlog #10","hideExcerpt":false,"subtitle":""}}},{"node":{"excerpt":"Hey guys! For today‚Äôs game devlog I‚Äôm going to show more‚Ä¶","html":"<p>Hey guys! For today‚Äôs game devlog I‚Äôm going to show more details of the enemies AI that I implemented.</p>\n<p><div class=\"gatsby-resp-iframe-wrapper\" style=\"padding-bottom: 56.42857142857143%; position: relative; height: 0; overflow: hidden; margin-bottom: 1.0725rem\" > <div class=\"embedVideo-container\"> <iframe title=\"\" src=\"https://www.youtube.com/embed/9vocKXNKNjk?rel=0\" class=\"embedVideo-iframe\" style=\"border:0; position: absolute; top: 0; left: 0; width: 100%; height: 100%; \" loading=\"eager\" allowfullscreen=\"\" sandbox=\"allow-same-origin allow-scripts allow-popups\"></iframe> </div> </div></p>\n<p>I decided to create some mixin functions for the artificial intelligence logic, which means I need to call the function binding it to the class that it‚Äôs calling it, and for that, I‚Äôm using the <a href=\"https://github.com/tc39/proposal-bind-operator\" target=\"_blank\" rel=\"noreferrer\">ES7 bind operator</a> so I can call the function like <code class=\"language-text\">this::someExternalFunction()</code>. Another way to do that would be by running <code class=\"language-text\">Object.assign(this, { someExternalFunction })</code> inside the constructor, and then call the function as if it was a class method, like <code class=\"language-text\">this.someExternalFunction()</code>, then you don‚Äôt need to bind it.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token function\">update</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">time<span class=\"token punctuation\">,</span> delta</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">this</span><span class=\"token operator\">:</span><span class=\"token operator\">:</span><span class=\"token function\">platformWalkingBehavior</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>For the logic inside <code class=\"language-text\">platformWalkingBehavior</code>, I did it in the simplest way possible, but I still need to improve it for efficiency when many enemies are on the screen. First I check if the enemy has a collidable ground tile in front of it, if it does, it means it can continue walking. Then I also check if there‚Äôs any collidable tile right in front of the enemy, if it does, it means the enemy must turn and walk in the other direction. Check the code below:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">platformWalkingBehavior</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token comment\">// checks if the next ground tile is collidable</span>\r\n    <span class=\"token keyword\">const</span> nextGroundTile <span class=\"token operator\">=</span> <span class=\"token function\">isNextGroundTileCollidable</span><span class=\"token punctuation\">(</span>\r\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">,</span>\r\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>touchingDownObject<span class=\"token punctuation\">.</span>layer<span class=\"token punctuation\">.</span>tilemapLayer<span class=\"token punctuation\">,</span>\r\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span>velocity<span class=\"token punctuation\">.</span>x <span class=\"token operator\">></span> <span class=\"token number\">0</span> <span class=\"token operator\">?</span> <span class=\"token string\">'right'</span> <span class=\"token operator\">:</span> <span class=\"token string\">'left'</span>\r\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n    <span class=\"token comment\">// checks if the next tile is collidable</span>\r\n    <span class=\"token keyword\">const</span> nextTile <span class=\"token operator\">=</span> <span class=\"token function\">isNextTileCollidable</span><span class=\"token punctuation\">(</span>\r\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">,</span>\r\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>touchingDownObject<span class=\"token punctuation\">.</span>layer<span class=\"token punctuation\">.</span>tilemapLayer<span class=\"token punctuation\">,</span>\r\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span>velocity<span class=\"token punctuation\">.</span>x <span class=\"token operator\">></span> <span class=\"token number\">0</span> <span class=\"token operator\">?</span> <span class=\"token string\">'right'</span> <span class=\"token operator\">:</span> <span class=\"token string\">'left'</span>\r\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>nextGroundTile <span class=\"token operator\">||</span> nextTile<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span><span class=\"token function\">setVelocityX</span><span class=\"token punctuation\">(</span>\r\n            <span class=\"token operator\">-</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span>velocity<span class=\"token punctuation\">.</span>x\r\n        <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span>\r\n<span class=\"token punctuation\">}</span>\r\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">isNextGroundTileCollidable</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>\r\n    <span class=\"token parameter\">gameObject<span class=\"token punctuation\">,</span>\r\n    dynamicLayer<span class=\"token punctuation\">,</span>\r\n    direction <span class=\"token operator\">=</span> <span class=\"token constant\">FACING_RIGHT</span></span>\r\n<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> width <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> gameObject<span class=\"token punctuation\">.</span><span class=\"token function\">getBounds</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> x<span class=\"token punctuation\">,</span> y <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> gameObject<span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">const</span> posX <span class=\"token operator\">=</span> direction <span class=\"token operator\">===</span> <span class=\"token constant\">FACING_RIGHT</span> <span class=\"token operator\">?</span> x <span class=\"token operator\">+</span> width <span class=\"token operator\">:</span> x <span class=\"token operator\">-</span> <span class=\"token number\">0.5</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">const</span> tile <span class=\"token operator\">=</span> dynamicLayer<span class=\"token punctuation\">.</span><span class=\"token function\">getTileAtWorldXY</span><span class=\"token punctuation\">(</span>posX<span class=\"token punctuation\">,</span> y <span class=\"token operator\">+</span> <span class=\"token number\">0.5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">return</span> tile<span class=\"token operator\">?.</span>properties<span class=\"token operator\">?.</span>collideUp<span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">isNextTileCollidable</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>\r\n    <span class=\"token parameter\">gameObject<span class=\"token punctuation\">,</span>\r\n    dynamicLayer<span class=\"token punctuation\">,</span>\r\n    direction <span class=\"token operator\">=</span> <span class=\"token constant\">FACING_RIGHT</span></span>\r\n<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> width<span class=\"token punctuation\">,</span> height <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> gameObject<span class=\"token punctuation\">.</span><span class=\"token function\">getBounds</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> x<span class=\"token punctuation\">,</span> y <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> gameObject<span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">const</span> posX <span class=\"token operator\">=</span> direction <span class=\"token operator\">===</span> <span class=\"token constant\">FACING_RIGHT</span> <span class=\"token operator\">?</span> x <span class=\"token operator\">+</span> width <span class=\"token operator\">:</span> x <span class=\"token operator\">-</span> <span class=\"token number\">0.5</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">const</span> tile <span class=\"token operator\">=</span> dynamicLayer<span class=\"token punctuation\">.</span><span class=\"token function\">getTileAtWorldXY</span><span class=\"token punctuation\">(</span>posX<span class=\"token punctuation\">,</span> y <span class=\"token operator\">-</span> <span class=\"token number\">0.5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>direction <span class=\"token operator\">===</span> <span class=\"token constant\">FACING_RIGHT</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token keyword\">return</span> tile<span class=\"token operator\">?.</span>properties<span class=\"token operator\">?.</span>collideLeft<span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span>\r\n\r\n    <span class=\"token keyword\">return</span> tile<span class=\"token operator\">?.</span>properties<span class=\"token operator\">?.</span>collideRight<span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>And this is what it looks like in the game:</p>\n<p><img src=\"/537f29d5bf323126defd6f9011d39ab5/enemy-walking-on-platform.gif\" alt=\"Enemy walking on the platform\"></p>\n<p>That‚Äôs all for today, don‚Äôt forget to like my video and subscribe to my channel.</p>","fields":{"postHashId":"Z2FtZXN0cnVlbnVsbDIwMjAtMTAtMzBUMDA6MDA6MDAuMDAwWg==","slug":"/2020/2020-30-10-creating-enemies-artificial-intelligence-on-phaser-js-skate-platformer-game-devlog-9.en/","path":"/blog/games/creating-enemies-artificial-intelligence-on-phaser-js-skate-platformer-game-devlog-9/","locale":"en"},"rawMarkdownBody":"Hey guys! For today's game devlog I'm going to show more details of the enemies AI that I implemented.\r\n\r\n`youtube: https://www.youtube.com/watch?v=9vocKXNKNjk`\r\n\r\nI decided to create some mixin functions for the artificial intelligence logic, which means I need to call the function binding it to the class that it's calling it, and for that, I'm using the [ES7 bind operator](https://github.com/tc39/proposal-bind-operator) so I can call the function like `this::someExternalFunction()`. Another way to do that would be by running `Object.assign(this, { someExternalFunction })` inside the constructor, and then call the function as if it was a class method, like `this.someExternalFunction()`, then you don't need to bind it.\r\n\r\n```javascript\r\nupdate(time, delta) {\r\n    this::platformWalkingBehavior();\r\n}\r\n```\r\n\r\nFor the logic inside `platformWalkingBehavior`, I did it in the simplest way possible, but I still need to improve it for efficiency when many enemies are on the screen. First I check if the enemy has a collidable ground tile in front of it, if it does, it means it can continue walking. Then I also check if there's any collidable tile right in front of the enemy, if it does, it means the enemy must turn and walk in the other direction. Check the code below:\r\n\r\n```javascript\r\nfunction platformWalkingBehavior() {\r\n    // checks if the next ground tile is collidable\r\n    const nextGroundTile = isNextGroundTileCollidable(\r\n        this,\r\n        this.touchingDownObject.layer.tilemapLayer,\r\n        this.body.velocity.x > 0 ? 'right' : 'left'\r\n    );\r\n\r\n    // checks if the next tile is collidable\r\n    const nextTile = isNextTileCollidable(\r\n        this,\r\n        this.touchingDownObject.layer.tilemapLayer,\r\n        this.body.velocity.x > 0 ? 'right' : 'left'\r\n    );\r\n\r\n    if (!nextGroundTile || nextTile) {\r\n        this.body.setVelocityX(\r\n            -this.body.velocity.x\r\n        );\r\n    }\r\n}\r\nconst isNextGroundTileCollidable = (\r\n    gameObject,\r\n    dynamicLayer,\r\n    direction = FACING_RIGHT\r\n) => {\r\n    const { width } = gameObject.getBounds();\r\n    const { x, y } = gameObject;\r\n    const posX = direction === FACING_RIGHT ? x + width : x - 0.5;\r\n    const tile = dynamicLayer.getTileAtWorldXY(posX, y + 0.5);\r\n    return tile?.properties?.collideUp;\r\n};\r\n\r\nconst isNextTileCollidable = (\r\n    gameObject,\r\n    dynamicLayer,\r\n    direction = FACING_RIGHT\r\n) => {\r\n    const { width, height } = gameObject.getBounds();\r\n    const { x, y } = gameObject;\r\n    const posX = direction === FACING_RIGHT ? x + width : x - 0.5;\r\n    const tile = dynamicLayer.getTileAtWorldXY(posX, y - 0.5);\r\n    if (direction === FACING_RIGHT) {\r\n        return tile?.properties?.collideLeft;\r\n    }\r\n\r\n    return tile?.properties?.collideRight;\r\n};\r\n```\r\n\r\nAnd this is what it looks like in the game:\r\n\r\n![Enemy walking on the platform](../../uploads/blog/2020/10/enemy-walking-on-platform.gif)\r\n\r\nThat's all for today, don't forget to like my video and subscribe to my channel.\r\n","frontmatter":{"tags":["coding","games","javascript","phaser","phaser 3","game devlog","gamedev","skate platformer","super ollie vs pebble corp","webpack","tiled","ai","artificial intelligence"],"categories":["games"],"allowComments":true,"publishOnMedium":false,"cover":null,"date":"2020-10-30T00:00:00.000Z","id":null,"path":"creating-enemies-artificial-intelligence-on-phaser-js-skate-platformer-game-devlog-9","show":true,"title":"Creating enemies artificial intelligence on Phaser JS - Skate Platformer Game Devlog #09","hideExcerpt":false,"subtitle":""}}},{"node":{"excerpt":"Fala galera! Para o game devlog de hoje, vou mostrar mais‚Ä¶","html":"<p>Fala galera! Para o game devlog de hoje, vou mostrar mais detalhes da AI dos inimigos que implementei.</p>\n<p><div class=\"gatsby-resp-iframe-wrapper\" style=\"padding-bottom: 56.42857142857143%; position: relative; height: 0; overflow: hidden; margin-bottom: 1.0725rem\" > <div class=\"embedVideo-container\"> <iframe title=\"\" src=\"https://www.youtube.com/embed/9vocKXNKNjk?rel=0\" class=\"embedVideo-iframe\" style=\"border:0; position: absolute; top: 0; left: 0; width: 100%; height: 100%; \" loading=\"eager\" allowfullscreen=\"\" sandbox=\"allow-same-origin allow-scripts allow-popups\"></iframe> </div> </div></p>\n<p>Eu decidi criar algumas mixin functions para a l√≥gica de intelig√™ncia artificial, o que significa que preciso chamar a fun√ß√£o dando bind √† classe que est√° chamando ela, para isso, estou usando o <a href=\"https://github.com/tc39/proposal-bind-operator\" target=\"_blank\" rel=\"noreferrer\">‚Äúbind operator‚Äù do ES7</a> para que eu possa chamar a fun√ß√£o tipo <code class=\"language-text\">this::someExternalFunction()</code>. Outra maneira de fazer isso seria executando <code class=\"language-text\">Object.assign(this, { someExternalFunction })</code> dentro do constructor, e ent√£o chame a fun√ß√£o como se ela fosse um m√©todo de classe, tipo <code class=\"language-text\">this.someExternalFunction()</code>, desse jeito voc√™ n√£o precisa usar o bind operator.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token function\">update</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">time<span class=\"token punctuation\">,</span> delta</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">this</span><span class=\"token operator\">:</span><span class=\"token operator\">:</span><span class=\"token function\">platformWalkingBehavior</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Para a l√≥gica de dentro do <code class=\"language-text\">platformWalkingBehavior</code>, eu fiz da maneira mais simples poss√≠vel, mas ainda preciso melhorar ela um pouco para ter uma efici√™ncia melhor quando muitos inimigos est√£o na tela. Primeiro eu verifico se o inimigo tem um tile de ch√£o colid√≠vel na frente dele, se tiver, significa que pode continuar andando. Eu tamb√©m verifico se h√° algum tile colid√≠vel bem na frente do inimigo, se houver, significa que o inimigo deve virar e andar na outra dire√ß√£o. Veja o c√≥digo abaixo:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">platformWalkingBehavior</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token comment\">// checks if the next ground tile is collidable</span>\r\n    <span class=\"token keyword\">const</span> nextGroundTile <span class=\"token operator\">=</span> <span class=\"token function\">isNextGroundTileCollidable</span><span class=\"token punctuation\">(</span>\r\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">,</span>\r\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>touchingDownObject<span class=\"token punctuation\">.</span>layer<span class=\"token punctuation\">.</span>tilemapLayer<span class=\"token punctuation\">,</span>\r\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span>velocity<span class=\"token punctuation\">.</span>x <span class=\"token operator\">></span> <span class=\"token number\">0</span> <span class=\"token operator\">?</span> <span class=\"token string\">'right'</span> <span class=\"token operator\">:</span> <span class=\"token string\">'left'</span>\r\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n    <span class=\"token comment\">// checks if the next tile is collidable</span>\r\n    <span class=\"token keyword\">const</span> nextTile <span class=\"token operator\">=</span> <span class=\"token function\">isNextTileCollidable</span><span class=\"token punctuation\">(</span>\r\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">,</span>\r\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>touchingDownObject<span class=\"token punctuation\">.</span>layer<span class=\"token punctuation\">.</span>tilemapLayer<span class=\"token punctuation\">,</span>\r\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span>velocity<span class=\"token punctuation\">.</span>x <span class=\"token operator\">></span> <span class=\"token number\">0</span> <span class=\"token operator\">?</span> <span class=\"token string\">'right'</span> <span class=\"token operator\">:</span> <span class=\"token string\">'left'</span>\r\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>nextGroundTile <span class=\"token operator\">||</span> nextTile<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span><span class=\"token function\">setVelocityX</span><span class=\"token punctuation\">(</span>\r\n            <span class=\"token operator\">-</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span>velocity<span class=\"token punctuation\">.</span>x\r\n        <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span>\r\n<span class=\"token punctuation\">}</span>\r\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">isNextGroundTileCollidable</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>\r\n    <span class=\"token parameter\">gameObject<span class=\"token punctuation\">,</span>\r\n    dynamicLayer<span class=\"token punctuation\">,</span>\r\n    direction <span class=\"token operator\">=</span> <span class=\"token constant\">FACING_RIGHT</span></span>\r\n<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> width <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> gameObject<span class=\"token punctuation\">.</span><span class=\"token function\">getBounds</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> x<span class=\"token punctuation\">,</span> y <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> gameObject<span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">const</span> posX <span class=\"token operator\">=</span> direction <span class=\"token operator\">===</span> <span class=\"token constant\">FACING_RIGHT</span> <span class=\"token operator\">?</span> x <span class=\"token operator\">+</span> width <span class=\"token operator\">:</span> x <span class=\"token operator\">-</span> <span class=\"token number\">0.5</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">const</span> tile <span class=\"token operator\">=</span> dynamicLayer<span class=\"token punctuation\">.</span><span class=\"token function\">getTileAtWorldXY</span><span class=\"token punctuation\">(</span>posX<span class=\"token punctuation\">,</span> y <span class=\"token operator\">+</span> <span class=\"token number\">0.5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">return</span> tile<span class=\"token operator\">?.</span>properties<span class=\"token operator\">?.</span>collideUp<span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">isNextTileCollidable</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>\r\n    <span class=\"token parameter\">gameObject<span class=\"token punctuation\">,</span>\r\n    dynamicLayer<span class=\"token punctuation\">,</span>\r\n    direction <span class=\"token operator\">=</span> <span class=\"token constant\">FACING_RIGHT</span></span>\r\n<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> width<span class=\"token punctuation\">,</span> height <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> gameObject<span class=\"token punctuation\">.</span><span class=\"token function\">getBounds</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> x<span class=\"token punctuation\">,</span> y <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> gameObject<span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">const</span> posX <span class=\"token operator\">=</span> direction <span class=\"token operator\">===</span> <span class=\"token constant\">FACING_RIGHT</span> <span class=\"token operator\">?</span> x <span class=\"token operator\">+</span> width <span class=\"token operator\">:</span> x <span class=\"token operator\">-</span> <span class=\"token number\">0.5</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">const</span> tile <span class=\"token operator\">=</span> dynamicLayer<span class=\"token punctuation\">.</span><span class=\"token function\">getTileAtWorldXY</span><span class=\"token punctuation\">(</span>posX<span class=\"token punctuation\">,</span> y <span class=\"token operator\">-</span> <span class=\"token number\">0.5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>direction <span class=\"token operator\">===</span> <span class=\"token constant\">FACING_RIGHT</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token keyword\">return</span> tile<span class=\"token operator\">?.</span>properties<span class=\"token operator\">?.</span>collideLeft<span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span>\r\n\r\n    <span class=\"token keyword\">return</span> tile<span class=\"token operator\">?.</span>properties<span class=\"token operator\">?.</span>collideRight<span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>E √© assim que fica no jogo:</p>\n<p><img src=\"/537f29d5bf323126defd6f9011d39ab5/enemy-walking-on-platform.gif\" alt=\"Enemy walking on platform\"></p>\n<p>Por hoje √© isso, n√£o esque√ßa de curtir meu v√≠deo e se inscrever no meu canal.</p>","fields":{"postHashId":"Z2FtZXN0cnVlbnVsbDIwMjAtMTAtMzBUMDA6MDA6MDAuMDAwWg==","slug":"/2020/2020-30-10-criando-inteligencia-artificial-ai-dos-inimigos-no-phaser-js-skate-platformer-game-devlog-9.pt-br/","path":"/blog/games/criando-inteligencia-artificial-ai-dos-inimigos-no-phaser-js-skate-platformer-game-devlog-9/","locale":"pt-br"},"rawMarkdownBody":"Fala galera! Para o game devlog de hoje, vou mostrar mais detalhes da AI dos inimigos que implementei.\r\n\r\n`youtube: https://www.youtube.com/watch?v=9vocKXNKNjk`\r\n\r\nEu decidi criar algumas mixin functions para a l√≥gica de intelig√™ncia artificial, o que significa que preciso chamar a fun√ß√£o dando bind √† classe que est√° chamando ela, para isso, estou usando o [\"bind operator\" do ES7](https://github.com/tc39/proposal-bind-operator) para que eu possa chamar a fun√ß√£o tipo `this::someExternalFunction()`. Outra maneira de fazer isso seria executando `Object.assign(this, { someExternalFunction })` dentro do constructor, e ent√£o chame a fun√ß√£o como se ela fosse um m√©todo de classe, tipo `this.someExternalFunction()`, desse jeito voc√™ n√£o precisa usar o bind operator.\r\n\r\n```javascript\r\nupdate(time, delta) {\r\n    this::platformWalkingBehavior();\r\n}\r\n```\r\n\r\nPara a l√≥gica de dentro do `platformWalkingBehavior`, eu fiz da maneira mais simples poss√≠vel, mas ainda preciso melhorar ela um pouco para ter uma efici√™ncia melhor quando muitos inimigos est√£o na tela. Primeiro eu verifico se o inimigo tem um tile de ch√£o colid√≠vel na frente dele, se tiver, significa que pode continuar andando. Eu tamb√©m verifico se h√° algum tile colid√≠vel bem na frente do inimigo, se houver, significa que o inimigo deve virar e andar na outra dire√ß√£o. Veja o c√≥digo abaixo:\r\n\r\n```javascript\r\nfunction platformWalkingBehavior() {\r\n    // checks if the next ground tile is collidable\r\n    const nextGroundTile = isNextGroundTileCollidable(\r\n        this,\r\n        this.touchingDownObject.layer.tilemapLayer,\r\n        this.body.velocity.x > 0 ? 'right' : 'left'\r\n    );\r\n\r\n    // checks if the next tile is collidable\r\n    const nextTile = isNextTileCollidable(\r\n        this,\r\n        this.touchingDownObject.layer.tilemapLayer,\r\n        this.body.velocity.x > 0 ? 'right' : 'left'\r\n    );\r\n\r\n    if (!nextGroundTile || nextTile) {\r\n        this.body.setVelocityX(\r\n            -this.body.velocity.x\r\n        );\r\n    }\r\n}\r\nconst isNextGroundTileCollidable = (\r\n    gameObject,\r\n    dynamicLayer,\r\n    direction = FACING_RIGHT\r\n) => {\r\n    const { width } = gameObject.getBounds();\r\n    const { x, y } = gameObject;\r\n    const posX = direction === FACING_RIGHT ? x + width : x - 0.5;\r\n    const tile = dynamicLayer.getTileAtWorldXY(posX, y + 0.5);\r\n    return tile?.properties?.collideUp;\r\n};\r\n\r\nconst isNextTileCollidable = (\r\n    gameObject,\r\n    dynamicLayer,\r\n    direction = FACING_RIGHT\r\n) => {\r\n    const { width, height } = gameObject.getBounds();\r\n    const { x, y } = gameObject;\r\n    const posX = direction === FACING_RIGHT ? x + width : x - 0.5;\r\n    const tile = dynamicLayer.getTileAtWorldXY(posX, y - 0.5);\r\n    if (direction === FACING_RIGHT) {\r\n        return tile?.properties?.collideLeft;\r\n    }\r\n\r\n    return tile?.properties?.collideRight;\r\n};\r\n```\r\n\r\nE √© assim que fica no jogo:\r\n\r\n![Enemy walking on platform](../../uploads/blog/2020/10/enemy-walking-on-platform.gif)\r\n\r\nPor hoje √© isso, n√£o esque√ßa de curtir meu v√≠deo e se inscrever no meu canal.\r\n","frontmatter":{"tags":["programa√ß√£o","jogos","javascript","phaser","phaser 3","game devlog","gamedev","skate platformer","super ollie vs pebble corp","webpack","tiled","ai","intelig√™ncia artificial"],"categories":["games"],"allowComments":true,"publishOnMedium":false,"cover":null,"date":"2020-10-30T00:00:00.000Z","id":null,"path":"criando-inteligencia-artificial-ai-dos-inimigos-no-phaser-js-skate-platformer-game-devlog-9","show":true,"title":"Criando intelig√™ncia artificial (AI) dos inimigos no Phaser JS - Skate Platformer Game Devlog #09","hideExcerpt":false,"subtitle":""}}},{"node":{"excerpt":"Hey guys, I‚Äôm back with another game devlog, it took me a‚Ä¶","html":"<p>Hey guys, I‚Äôm back with another game devlog, it took me a while to make this one because there were a couple of things that I didn‚Äôt know how to do (still don‚Äôt actually). Watch it below.</p>\n<p><div class=\"gatsby-resp-iframe-wrapper\" style=\"padding-bottom: 56.42857142857143%; position: relative; height: 0; overflow: hidden; margin-bottom: 1.0725rem\" > <div class=\"embedVideo-container\"> <iframe title=\"\" src=\"https://www.youtube.com/embed/I6btT6AHv78?rel=0\" class=\"embedVideo-iframe\" style=\"border:0; position: absolute; top: 0; left: 0; width: 100%; height: 100%; \" loading=\"eager\" allowfullscreen=\"\" sandbox=\"allow-same-origin allow-scripts allow-popups\"></iframe> </div> </div></p>\n<p>Now let‚Äôs dive into the code, remember my <code class=\"language-text\">dataLayer</code> loop? This is where we‚Äôre going to add our new objects.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">// in the scene create function</span>\r\n<span class=\"token keyword\">const</span> dataLayer <span class=\"token operator\">=</span> map<span class=\"token punctuation\">.</span><span class=\"token function\">getObjectLayer</span><span class=\"token punctuation\">(</span><span class=\"token string\">'data'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\ndataLayer<span class=\"token punctuation\">.</span>objects<span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">data</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> x<span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">,</span> name<span class=\"token punctuation\">,</span> height<span class=\"token punctuation\">,</span> width <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> data<span class=\"token punctuation\">;</span>\r\n\r\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>name <span class=\"token operator\">===</span> <span class=\"token string\">'coin'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token comment\">// TODO add coin logic here</span>\r\n    <span class=\"token punctuation\">}</span>\r\n\r\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token string\">'box'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'long_box'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">includes</span><span class=\"token punctuation\">(</span>name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token comment\">// TODO add box logic here</span>\r\n    <span class=\"token punctuation\">}</span>\r\n\r\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>name <span class=\"token operator\">===</span> <span class=\"token string\">'enemy2'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token comment\">// TODO add enemy logic here</span>\r\n    <span class=\"token punctuation\">}</span>\r\n\r\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>The first new thing is the collectible coins, which is really straightforward, all I needed to do is instantiate a new GameObject and destroy it when colliding with the hero.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>name <span class=\"token operator\">===</span> <span class=\"token string\">'coin'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">const</span> coin <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Coin</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\r\n        <span class=\"token literal-property property\">scene</span><span class=\"token operator\">:</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">,</span>\r\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    \r\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>physics<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">.</span><span class=\"token function\">overlap</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>player<span class=\"token punctuation\">,</span> coin<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n        coin<span class=\"token punctuation\">.</span><span class=\"token function\">destroy</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Now for the box, the way I wanted it to work was by having the box completely still unless the hero starts pushing it. Just by enabling Arcade Physics on default settings, the hero will exert a force in the box, and the box in the hero, and this is what this looks like:</p>\n<p><img src=\"/94a2464e81d64e9716fa39fd0d9a6470/bouncing-physics.gif\" alt=\"Bouncing physics\" title=\"poin poin poin\"></p>\n<p>I needed the box to not exert any force into the hero, so to accomplish that I‚Äôm using <code class=\"language-text\">this.body.setAllowGravity(false)</code> and <code class=\"language-text\">this.body.setImmovable(true)</code>, as you can see below:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span> scene<span class=\"token punctuation\">,</span> x<span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">,</span> asset<span class=\"token punctuation\">,</span> frame <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">super</span><span class=\"token punctuation\">(</span>scene<span class=\"token punctuation\">,</span> x<span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">,</span> asset<span class=\"token punctuation\">,</span> frame<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n    <span class=\"token comment\">// set physics</span>\r\n    scene<span class=\"token punctuation\">.</span>physics<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">.</span><span class=\"token function\">existing</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span><span class=\"token function\">setAllowGravity</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span><span class=\"token function\">setImmovable</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span><span class=\"token function\">setAccelerationY</span><span class=\"token punctuation\">(</span>\r\n        scene<span class=\"token punctuation\">.</span>physics<span class=\"token punctuation\">.</span>world<span class=\"token punctuation\">.</span>gravity<span class=\"token punctuation\">.</span>y\r\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span>\r\n\r\n<span class=\"token function\">update</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">time<span class=\"token punctuation\">,</span> delta</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">const</span> gravityY <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>scene<span class=\"token punctuation\">.</span>physics<span class=\"token punctuation\">.</span>world<span class=\"token punctuation\">.</span>gravity<span class=\"token punctuation\">.</span>y<span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span>velocity<span class=\"token punctuation\">.</span>x <span class=\"token operator\">!==</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span><span class=\"token function\">setAccelerationY</span><span class=\"token punctuation\">(</span>gravityY<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span>acceleration<span class=\"token punctuation\">.</span>y <span class=\"token operator\">!==</span> gravityY<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span><span class=\"token function\">stop</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>If you think that hack in the <code class=\"language-text\">update</code> function was the worst part, boy you‚Äôre mistaken. Let me present you what I call ‚Äúthe collision shenanigans‚Äù.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token string\">'box'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'long_box'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">includes</span><span class=\"token punctuation\">(</span>name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">let</span> box<span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>name <span class=\"token operator\">===</span> <span class=\"token string\">'box'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n        box <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Box</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\r\n            <span class=\"token literal-property property\">scene</span><span class=\"token operator\">:</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">,</span>\r\n            x<span class=\"token punctuation\">,</span>\r\n            y<span class=\"token punctuation\">,</span>\r\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\r\n        box <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">LongBox</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\r\n            <span class=\"token literal-property property\">scene</span><span class=\"token operator\">:</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">,</span>\r\n            x<span class=\"token punctuation\">,</span>\r\n            y<span class=\"token punctuation\">,</span>\r\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span>\r\n\r\n    <span class=\"token comment\">// Add colliders that forces the box to stop</span>\r\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>physics<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">.</span><span class=\"token function\">collider</span><span class=\"token punctuation\">(</span>dynamicLayers<span class=\"token punctuation\">.</span>ground<span class=\"token punctuation\">,</span> box<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n        box<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span><span class=\"token function\">stop</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>physics<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">.</span><span class=\"token function\">collider</span><span class=\"token punctuation\">(</span>dynamicLayers<span class=\"token punctuation\">.</span>elements<span class=\"token punctuation\">,</span> box<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n        box<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span><span class=\"token function\">stop</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>physics<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">.</span><span class=\"token function\">collider</span><span class=\"token punctuation\">(</span>mapGroundColliders<span class=\"token punctuation\">,</span> box<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n        box<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span><span class=\"token function\">stop</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>physics<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">.</span><span class=\"token function\">collider</span><span class=\"token punctuation\">(</span>mapElementsColliders<span class=\"token punctuation\">,</span> box<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n        box<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span><span class=\"token function\">stop</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n    <span class=\"token comment\">// Handles pushing the box</span>\r\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>physics<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">.</span><span class=\"token function\">collider</span><span class=\"token punctuation\">(</span>box<span class=\"token punctuation\">,</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>player<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>\r\n            <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>player<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span>touching<span class=\"token punctuation\">.</span>right\r\n            <span class=\"token operator\">&amp;&amp;</span> box<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span>touching<span class=\"token punctuation\">.</span>left\r\n        <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n            <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>player<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span>velocity<span class=\"token punctuation\">.</span>x <span class=\"token operator\">=</span> <span class=\"token number\">30</span><span class=\"token punctuation\">;</span>\r\n            box<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span><span class=\"token function\">setVelocityX</span><span class=\"token punctuation\">(</span>\r\n                <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>player<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span>velocity<span class=\"token punctuation\">.</span>x\r\n            <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token punctuation\">}</span>\r\n\r\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>\r\n            <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>player<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span>touching<span class=\"token punctuation\">.</span>left\r\n            <span class=\"token operator\">&amp;&amp;</span> box<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span>touching<span class=\"token punctuation\">.</span>right\r\n        <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n            <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>player<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span>velocity<span class=\"token punctuation\">.</span>x <span class=\"token operator\">=</span> <span class=\"token operator\">-</span><span class=\"token number\">30</span><span class=\"token punctuation\">;</span>\r\n            box<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span><span class=\"token function\">setVelocityX</span><span class=\"token punctuation\">(</span>\r\n                <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>player<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span>velocity<span class=\"token punctuation\">.</span>x\r\n            <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token punctuation\">}</span>\r\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>And last but not least, the enemy, which is pretty much the same as the <code class=\"language-text\">coin</code>, but instead of destroying the enemy on collision, I made the hero blink for a couple of seconds.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>name <span class=\"token operator\">===</span> <span class=\"token string\">'enemy2'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">const</span> enemy2 <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Enemy2</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\r\n       <span class=\"token literal-property property\">scene</span><span class=\"token operator\">:</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">,</span>\r\n   <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n    <span class=\"token comment\">// add hero blinking effect</span>\r\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>physics<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">.</span><span class=\"token function\">overlap</span><span class=\"token punctuation\">(</span>\r\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>player<span class=\"token punctuation\">,</span>\r\n        enemy2<span class=\"token punctuation\">,</span>\r\n        <span class=\"token punctuation\">(</span><span class=\"token parameter\">objectA<span class=\"token punctuation\">,</span> objectB</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n            <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>tweens<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\r\n                <span class=\"token literal-property property\">targets</span><span class=\"token operator\">:</span> player<span class=\"token punctuation\">,</span>\r\n                <span class=\"token literal-property property\">alpha</span><span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span>\r\n                <span class=\"token literal-property property\">ease</span><span class=\"token operator\">:</span> <span class=\"token string\">'Cubic.easeOut'</span><span class=\"token punctuation\">,</span>\r\n                <span class=\"token literal-property property\">duration</span><span class=\"token operator\">:</span> <span class=\"token number\">120</span><span class=\"token punctuation\">,</span>\r\n                <span class=\"token literal-property property\">repeat</span><span class=\"token operator\">:</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span>\r\n                <span class=\"token literal-property property\">yoyo</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\r\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token punctuation\">}</span>\r\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>That‚Äôs all for today! Stay tuned for next week when I‚Äôm going to show you how to build the enemy movement AI. Don‚Äôt forget to like my video and subscribe to my channel üòä.</p>","fields":{"postHashId":"Z2FtZXN0cnVlbnVsbDIwMjAtMTAtMjJUMDA6MDA6MDAuMDAwWg==","slug":"/2020/2020-22-10-creating-enemies-and-collectable-items-on-phaser-js-skate-platformer-game-devlog-8.en/","path":"/blog/games/creating-enemies-and-collectable-items-on-phaser-js-skate-platformer-game-devlog-8/","locale":"en"},"rawMarkdownBody":"Hey guys, I'm back with another game devlog, it took me a while to make this one because there were a couple of things that I didn't know how to do (still don't actually). Watch it below.\r\n\r\n`youtube: https://www.youtube.com/watch?v=I6btT6AHv78`\r\n\r\nNow let's dive into the code, remember my `dataLayer` loop? This is where we're going to add our new objects.\r\n\r\n```javascript\r\n// in the scene create function\r\nconst dataLayer = map.getObjectLayer('data');\r\ndataLayer.objects.forEach((data) => {\r\n    const { x, y, name, height, width } = data;\r\n\r\n    if (name === 'coin') {\r\n        // TODO add coin logic here\r\n    }\r\n\r\n    if (['box', 'long_box'].includes(name)) {\r\n        // TODO add box logic here\r\n    }\r\n\r\n    if (name === 'enemy2') {\r\n        // TODO add enemy logic here\r\n    }\r\n\r\n});\r\n```\r\n\r\nThe first new thing is the collectible coins, which is really straightforward, all I needed to do is instantiate a new GameObject and destroy it when colliding with the hero.\r\n\r\n```javascript\r\nif (name === 'coin') {\r\n    const coin = new Coin({\r\n        scene: this,\r\n    });\r\n    \r\n    this.physics.add.overlap(this.player, coin, () => {\r\n        coin.destroy(true);\r\n    });\r\n}\r\n```\r\n\r\nNow for the box, the way I wanted it to work was by having the box completely still unless the hero starts pushing it. Just by enabling Arcade Physics on default settings, the hero will exert a force in the box, and the box in the hero, and this is what this looks like:\r\n\r\n![Bouncing physics](../../uploads/blog/2020/10/bouncing-physics.gif \"poin poin poin\")\r\n\r\nI needed the box to not exert any force into the hero, so to accomplish that I'm using `this.body.setAllowGravity(false)` and `this.body.setImmovable(true)`, as you can see below:\r\n\r\n```javascript\r\nconstructor({ scene, x, y, asset, frame }) {\r\n    super(scene, x, y, asset, frame);\r\n\r\n    // set physics\r\n    scene.physics.add.existing(this);\r\n    this.body.setAllowGravity(false);\r\n    this.body.setImmovable(true);\r\n    this.body.setAccelerationY(\r\n        scene.physics.world.gravity.y\r\n    );\r\n}\r\n\r\nupdate(time, delta) {\r\n    const gravityY = this.scene.physics.world.gravity.y;\r\n    if (this.body.velocity.x !== 0) {\r\n        this.body.setAccelerationY(gravityY);\r\n    } else if (this.body.acceleration.y !== gravityY) {\r\n        this.body.stop();\r\n    }\r\n}\r\n```\r\n\r\nIf you think that hack in the `update` function was the worst part, boy you're mistaken. Let me present you what I call \"the collision shenanigans\".\r\n\r\n```javascript\r\nif (['box', 'long_box'].includes(name)) {\r\n    let box;\r\n    if (name === 'box') {\r\n        box = new Box({\r\n            scene: this,\r\n            x,\r\n            y,\r\n        });\r\n    } else {\r\n        box = new LongBox({\r\n            scene: this,\r\n            x,\r\n            y,\r\n        });\r\n    }\r\n\r\n    // Add colliders that forces the box to stop\r\n    this.physics.add.collider(dynamicLayers.ground, box, () => {\r\n        box.body.stop();\r\n    });\r\n    this.physics.add.collider(dynamicLayers.elements, box, () => {\r\n        box.body.stop();\r\n    });\r\n    this.physics.add.collider(mapGroundColliders, box, () => {\r\n        box.body.stop();\r\n    });\r\n    this.physics.add.collider(mapElementsColliders, box, () => {\r\n        box.body.stop();\r\n    });\r\n\r\n    // Handles pushing the box\r\n    this.physics.add.collider(box, this.player, () => {\r\n        if (\r\n            this.player.body.touching.right\r\n            && box.body.touching.left\r\n        ) {\r\n            this.player.body.velocity.x = 30;\r\n            box.body.setVelocityX(\r\n                this.player.body.velocity.x\r\n            );\r\n        }\r\n\r\n        if (\r\n            this.player.body.touching.left\r\n            && box.body.touching.right\r\n        ) {\r\n            this.player.body.velocity.x = -30;\r\n            box.body.setVelocityX(\r\n                this.player.body.velocity.x\r\n            );\r\n        }\r\n    });\r\n}\r\n```\r\n\r\nAnd last but not least, the enemy, which is pretty much the same as the `coin`, but instead of destroying the enemy on collision, I made the hero blink for a couple of seconds.\r\n\r\n```javascript\r\nif (name === 'enemy2') {\r\n    const enemy2 = new Enemy2({\r\n       scene: this,\r\n   });\r\n\r\n    // add hero blinking effect\r\n    this.physics.add.overlap(\r\n        this.player,\r\n        enemy2,\r\n        (objectA, objectB) => {\r\n            this.tweens.add({\r\n                targets: player,\r\n                alpha: 0,\r\n                ease: 'Cubic.easeOut',\r\n                duration: 120,\r\n                repeat: 5,\r\n                yoyo: true,\r\n            });\r\n        }\r\n    );\r\n}\r\n```\r\n\r\nThat's all for today! Stay tuned for next week when I'm going to show you how to build the enemy movement AI. Don't forget to like my video and subscribe to my channel üòä.\r\n","frontmatter":{"tags":["coding","games","javascript","phaser","phaser 3","game devlog","gamedev","skate platformer","super ollie vs pebble corp","webpack","tiled"],"categories":["games"],"allowComments":true,"publishOnMedium":false,"cover":null,"date":"2020-10-22T00:00:00.000Z","id":null,"path":"creating-enemies-and-collectable-items-on-phaser-js-skate-platformer-game-devlog-8","show":true,"title":"Creating enemies and collectable items on Phaser JS - Skate Platformer Game Devlog #08","hideExcerpt":false,"subtitle":""}}},{"node":{"excerpt":"Fala galera, estou de volta com outro game devlog, demorei‚Ä¶","html":"<p>Fala galera, estou de volta com outro game devlog, demorei um pouco para fazer este tiveram algumas coisas que eu realmente n√£o sabia fazer (e ainda n√£o sei). Veja o video abaixo.</p>\n<p><div class=\"gatsby-resp-iframe-wrapper\" style=\"padding-bottom: 56.42857142857143%; position: relative; height: 0; overflow: hidden; margin-bottom: 1.0725rem\" > <div class=\"embedVideo-container\"> <iframe title=\"\" src=\"https://www.youtube.com/embed/I6btT6AHv78?rel=0\" class=\"embedVideo-iframe\" style=\"border:0; position: absolute; top: 0; left: 0; width: 100%; height: 100%; \" loading=\"eager\" allowfullscreen=\"\" sandbox=\"allow-same-origin allow-scripts allow-popups\"></iframe> </div> </div></p>\n<p>Agora vamos dar uma olhada no c√≥digo, lembra do meu loop na variavel <code class=\"language-text\">dataLayer</code>? √â aqui que vamos adicionar nossos novos objetos.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">// in the scene create function</span>\r\n<span class=\"token keyword\">const</span> dataLayer <span class=\"token operator\">=</span> map<span class=\"token punctuation\">.</span><span class=\"token function\">getObjectLayer</span><span class=\"token punctuation\">(</span><span class=\"token string\">'data'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\ndataLayer<span class=\"token punctuation\">.</span>objects<span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">data</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> x<span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">,</span> name<span class=\"token punctuation\">,</span> height<span class=\"token punctuation\">,</span> width <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> data<span class=\"token punctuation\">;</span>\r\n\r\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>name <span class=\"token operator\">===</span> <span class=\"token string\">'coin'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token comment\">// TODO add coin logic here</span>\r\n    <span class=\"token punctuation\">}</span>\r\n\r\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token string\">'box'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'long_box'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">includes</span><span class=\"token punctuation\">(</span>name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token comment\">// TODO add box logic here</span>\r\n    <span class=\"token punctuation\">}</span>\r\n\r\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>name <span class=\"token operator\">===</span> <span class=\"token string\">'enemy2'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token comment\">// TODO add enemy logic here</span>\r\n    <span class=\"token punctuation\">}</span>\r\n\r\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>A primeira coisa nova s√£o os itens colecion√°veis, que √© bem simples, tudo o que eu precisei fazer foi instanciar um novo GameObject e destru√≠-lo quando ele colidir com o hero.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>name <span class=\"token operator\">===</span> <span class=\"token string\">'coin'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">const</span> coin <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Coin</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\r\n        <span class=\"token literal-property property\">scene</span><span class=\"token operator\">:</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">,</span>\r\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    \r\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>physics<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">.</span><span class=\"token function\">overlap</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>player<span class=\"token punctuation\">,</span> coin<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n        coin<span class=\"token punctuation\">.</span><span class=\"token function\">destroy</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Agora, para a caixa, eu queria que ela ficasse completamente parada, a menos que o hero come√ßasse a empurr√°-la. Se eu simplesmente habilitasse o Arcade Physics nas configura√ß√µes padr√£o, o hero iria exercer uma for√ßa na caixa, e a caixa uma for√ßa no hero, e fica algo assim:</p>\n<p><img src=\"/94a2464e81d64e9716fa39fd0d9a6470/bouncing-physics.gif\" alt=\"F√≠sica de pula-pula\" title=\"poin poin poin\"></p>\n<p>Eu precisava que a caixa n√£o exercesse nenhuma for√ßa no hero, e para fazer isso eu estou usando <code class=\"language-text\">this.body.setAllowGravity(false)</code> e <code class=\"language-text\">this.body.setImmovable(true)</code>, como voc√™ pode ver abaixo:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span> scene<span class=\"token punctuation\">,</span> x<span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">,</span> asset<span class=\"token punctuation\">,</span> frame <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">super</span><span class=\"token punctuation\">(</span>scene<span class=\"token punctuation\">,</span> x<span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">,</span> asset<span class=\"token punctuation\">,</span> frame<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n    <span class=\"token comment\">// set physics</span>\r\n    scene<span class=\"token punctuation\">.</span>physics<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">.</span><span class=\"token function\">existing</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span><span class=\"token function\">setAllowGravity</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span><span class=\"token function\">setImmovable</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span><span class=\"token function\">setAccelerationY</span><span class=\"token punctuation\">(</span>\r\n        scene<span class=\"token punctuation\">.</span>physics<span class=\"token punctuation\">.</span>world<span class=\"token punctuation\">.</span>gravity<span class=\"token punctuation\">.</span>y\r\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span>\r\n\r\n<span class=\"token function\">update</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">time<span class=\"token punctuation\">,</span> delta</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">const</span> gravityY <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>scene<span class=\"token punctuation\">.</span>physics<span class=\"token punctuation\">.</span>world<span class=\"token punctuation\">.</span>gravity<span class=\"token punctuation\">.</span>y<span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span>velocity<span class=\"token punctuation\">.</span>x <span class=\"token operator\">!==</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span><span class=\"token function\">setAccelerationY</span><span class=\"token punctuation\">(</span>gravityY<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span>acceleration<span class=\"token punctuation\">.</span>y <span class=\"token operator\">!==</span> gravityY<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span><span class=\"token function\">stop</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Agora se voc√™ acha que aquela gambiarra na fun√ß√£o <code class=\"language-text\">update</code> foi a pior parte, merm√£o, voc√™ est√° enganado. Deixe-me te mostrar o que chamo de ‚Äúa doideira da colis√£o‚Äù.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token string\">'box'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'long_box'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">includes</span><span class=\"token punctuation\">(</span>name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">let</span> box<span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>name <span class=\"token operator\">===</span> <span class=\"token string\">'box'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n        box <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Box</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\r\n            <span class=\"token literal-property property\">scene</span><span class=\"token operator\">:</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">,</span>\r\n            x<span class=\"token punctuation\">,</span>\r\n            y<span class=\"token punctuation\">,</span>\r\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\r\n        box <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">LongBox</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\r\n            <span class=\"token literal-property property\">scene</span><span class=\"token operator\">:</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">,</span>\r\n            x<span class=\"token punctuation\">,</span>\r\n            y<span class=\"token punctuation\">,</span>\r\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span>\r\n\r\n    <span class=\"token comment\">// Add colliders that forces the box to stop</span>\r\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>physics<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">.</span><span class=\"token function\">collider</span><span class=\"token punctuation\">(</span>dynamicLayers<span class=\"token punctuation\">.</span>ground<span class=\"token punctuation\">,</span> box<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n        box<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span><span class=\"token function\">stop</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>physics<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">.</span><span class=\"token function\">collider</span><span class=\"token punctuation\">(</span>dynamicLayers<span class=\"token punctuation\">.</span>elements<span class=\"token punctuation\">,</span> box<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n        box<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span><span class=\"token function\">stop</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>physics<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">.</span><span class=\"token function\">collider</span><span class=\"token punctuation\">(</span>mapGroundColliders<span class=\"token punctuation\">,</span> box<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n        box<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span><span class=\"token function\">stop</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>physics<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">.</span><span class=\"token function\">collider</span><span class=\"token punctuation\">(</span>mapElementsColliders<span class=\"token punctuation\">,</span> box<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n        box<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span><span class=\"token function\">stop</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n    <span class=\"token comment\">// Handles pushing the box</span>\r\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>physics<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">.</span><span class=\"token function\">collider</span><span class=\"token punctuation\">(</span>box<span class=\"token punctuation\">,</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>player<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>\r\n            <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>player<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span>touching<span class=\"token punctuation\">.</span>right\r\n            <span class=\"token operator\">&amp;&amp;</span> box<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span>touching<span class=\"token punctuation\">.</span>left\r\n        <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n            <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>player<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span>velocity<span class=\"token punctuation\">.</span>x <span class=\"token operator\">=</span> <span class=\"token number\">30</span><span class=\"token punctuation\">;</span>\r\n            box<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span><span class=\"token function\">setVelocityX</span><span class=\"token punctuation\">(</span>\r\n                <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>player<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span>velocity<span class=\"token punctuation\">.</span>x\r\n            <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token punctuation\">}</span>\r\n\r\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>\r\n            <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>player<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span>touching<span class=\"token punctuation\">.</span>left\r\n            <span class=\"token operator\">&amp;&amp;</span> box<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span>touching<span class=\"token punctuation\">.</span>right\r\n        <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n            <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>player<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span>velocity<span class=\"token punctuation\">.</span>x <span class=\"token operator\">=</span> <span class=\"token operator\">-</span><span class=\"token number\">30</span><span class=\"token punctuation\">;</span>\r\n            box<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span><span class=\"token function\">setVelocityX</span><span class=\"token punctuation\">(</span>\r\n                <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>player<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span>velocity<span class=\"token punctuation\">.</span>x\r\n            <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token punctuation\">}</span>\r\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>E por √∫ltimo o inimigo, que √© praticamente o mesmo que a <code class=\"language-text\">coin</code>, mas ao inv√©s de destruir o inimigo na colis√£o, eu fa√ßo o hero ficar piscando por uns segundos.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>name <span class=\"token operator\">===</span> <span class=\"token string\">'enemy2'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">const</span> enemy2 <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Enemy2</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\r\n       <span class=\"token literal-property property\">scene</span><span class=\"token operator\">:</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">,</span>\r\n   <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n    <span class=\"token comment\">// add hero blinking effect</span>\r\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>physics<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">.</span><span class=\"token function\">overlap</span><span class=\"token punctuation\">(</span>\r\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>player<span class=\"token punctuation\">,</span>\r\n        enemy2<span class=\"token punctuation\">,</span>\r\n        <span class=\"token punctuation\">(</span><span class=\"token parameter\">objectA<span class=\"token punctuation\">,</span> objectB</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n            <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>tweens<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\r\n                <span class=\"token literal-property property\">targets</span><span class=\"token operator\">:</span> player<span class=\"token punctuation\">,</span>\r\n                <span class=\"token literal-property property\">alpha</span><span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span>\r\n                <span class=\"token literal-property property\">ease</span><span class=\"token operator\">:</span> <span class=\"token string\">'Cubic.easeOut'</span><span class=\"token punctuation\">,</span>\r\n                <span class=\"token literal-property property\">duration</span><span class=\"token operator\">:</span> <span class=\"token number\">120</span><span class=\"token punctuation\">,</span>\r\n                <span class=\"token literal-property property\">repeat</span><span class=\"token operator\">:</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span>\r\n                <span class=\"token literal-property property\">yoyo</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\r\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token punctuation\">}</span>\r\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>E por hoje √© isso! Fique ligado na pr√≥xima semana, quando vou mostrar como construir a Intelig√™ncia Artificial do inimigo. N√£o esque√ßa de curtir o meu v√≠deo e se inscrever no meu canal üòä.</p>","fields":{"postHashId":"Z2FtZXN0cnVlbnVsbDIwMjAtMTAtMjJUMDA6MDA6MDAuMDAwWg==","slug":"/2020/2020-22-10-criando-inimigos-e-itens-colecionaveis-no-phaser-js-skate-platformer-game-devlog-8.pt-br/","path":"/blog/games/criando-inimigos-e-itens-colecionaveis-no-phaser-js-skate-platformer-game-devlog-8/","locale":"pt-br"},"rawMarkdownBody":"Fala galera, estou de volta com outro game devlog, demorei um pouco para fazer este tiveram algumas coisas que eu realmente n√£o sabia fazer (e ainda n√£o sei). Veja o video abaixo.\r\n\r\n`youtube: https://www.youtube.com/watch?v=I6btT6AHv78`\r\n\r\nAgora vamos dar uma olhada no c√≥digo, lembra do meu loop na variavel `dataLayer`? √â aqui que vamos adicionar nossos novos objetos.\r\n\r\n```javascript\r\n// in the scene create function\r\nconst dataLayer = map.getObjectLayer('data');\r\ndataLayer.objects.forEach((data) => {\r\n    const { x, y, name, height, width } = data;\r\n\r\n    if (name === 'coin') {\r\n        // TODO add coin logic here\r\n    }\r\n\r\n    if (['box', 'long_box'].includes(name)) {\r\n        // TODO add box logic here\r\n    }\r\n\r\n    if (name === 'enemy2') {\r\n        // TODO add enemy logic here\r\n    }\r\n\r\n});\r\n```\r\n\r\nA primeira coisa nova s√£o os itens colecion√°veis, que √© bem simples, tudo o que eu precisei fazer foi instanciar um novo GameObject e destru√≠-lo quando ele colidir com o hero.\r\n\r\n```javascript\r\nif (name === 'coin') {\r\n    const coin = new Coin({\r\n        scene: this,\r\n    });\r\n    \r\n    this.physics.add.overlap(this.player, coin, () => {\r\n        coin.destroy(true);\r\n    });\r\n}\r\n```\r\n\r\nAgora, para a caixa, eu queria que ela ficasse completamente parada, a menos que o hero come√ßasse a empurr√°-la. Se eu simplesmente habilitasse o Arcade Physics nas configura√ß√µes padr√£o, o hero iria exercer uma for√ßa na caixa, e a caixa uma for√ßa no hero, e fica algo assim:\r\n\r\n![F√≠sica de pula-pula](../../uploads/blog/2020/10/bouncing-physics.gif \"poin poin poin\")\r\n\r\nEu precisava que a caixa n√£o exercesse nenhuma for√ßa no hero, e para fazer isso eu estou usando `this.body.setAllowGravity(false)` e `this.body.setImmovable(true)`, como voc√™ pode ver abaixo:\r\n\r\n```javascript\r\nconstructor({ scene, x, y, asset, frame }) {\r\n    super(scene, x, y, asset, frame);\r\n\r\n    // set physics\r\n    scene.physics.add.existing(this);\r\n    this.body.setAllowGravity(false);\r\n    this.body.setImmovable(true);\r\n    this.body.setAccelerationY(\r\n        scene.physics.world.gravity.y\r\n    );\r\n}\r\n\r\nupdate(time, delta) {\r\n    const gravityY = this.scene.physics.world.gravity.y;\r\n    if (this.body.velocity.x !== 0) {\r\n        this.body.setAccelerationY(gravityY);\r\n    } else if (this.body.acceleration.y !== gravityY) {\r\n        this.body.stop();\r\n    }\r\n}\r\n```\r\n\r\nAgora se voc√™ acha que aquela gambiarra na fun√ß√£o `update` foi a pior parte, merm√£o, voc√™ est√° enganado. Deixe-me te mostrar o que chamo de \"a doideira da colis√£o\".\r\n\r\n```javascript\r\nif (['box', 'long_box'].includes(name)) {\r\n    let box;\r\n    if (name === 'box') {\r\n        box = new Box({\r\n            scene: this,\r\n            x,\r\n            y,\r\n        });\r\n    } else {\r\n        box = new LongBox({\r\n            scene: this,\r\n            x,\r\n            y,\r\n        });\r\n    }\r\n\r\n    // Add colliders that forces the box to stop\r\n    this.physics.add.collider(dynamicLayers.ground, box, () => {\r\n        box.body.stop();\r\n    });\r\n    this.physics.add.collider(dynamicLayers.elements, box, () => {\r\n        box.body.stop();\r\n    });\r\n    this.physics.add.collider(mapGroundColliders, box, () => {\r\n        box.body.stop();\r\n    });\r\n    this.physics.add.collider(mapElementsColliders, box, () => {\r\n        box.body.stop();\r\n    });\r\n\r\n    // Handles pushing the box\r\n    this.physics.add.collider(box, this.player, () => {\r\n        if (\r\n            this.player.body.touching.right\r\n            && box.body.touching.left\r\n        ) {\r\n            this.player.body.velocity.x = 30;\r\n            box.body.setVelocityX(\r\n                this.player.body.velocity.x\r\n            );\r\n        }\r\n\r\n        if (\r\n            this.player.body.touching.left\r\n            && box.body.touching.right\r\n        ) {\r\n            this.player.body.velocity.x = -30;\r\n            box.body.setVelocityX(\r\n                this.player.body.velocity.x\r\n            );\r\n        }\r\n    });\r\n}\r\n```\r\n\r\nE por √∫ltimo o inimigo, que √© praticamente o mesmo que a `coin`, mas ao inv√©s de destruir o inimigo na colis√£o, eu fa√ßo o hero ficar piscando por uns segundos.\r\n\r\n```javascript\r\nif (name === 'enemy2') {\r\n    const enemy2 = new Enemy2({\r\n       scene: this,\r\n   });\r\n\r\n    // add hero blinking effect\r\n    this.physics.add.overlap(\r\n        this.player,\r\n        enemy2,\r\n        (objectA, objectB) => {\r\n            this.tweens.add({\r\n                targets: player,\r\n                alpha: 0,\r\n                ease: 'Cubic.easeOut',\r\n                duration: 120,\r\n                repeat: 5,\r\n                yoyo: true,\r\n            });\r\n        }\r\n    );\r\n}\r\n```\r\n\r\nE por hoje √© isso! Fique ligado na pr√≥xima semana, quando vou mostrar como construir a Intelig√™ncia Artificial do inimigo. N√£o esque√ßa de curtir o meu v√≠deo e se inscrever no meu canal üòä.\r\n","frontmatter":{"tags":["programa√ß√£o","jogos","javascript","phaser","phaser 3","game devlog","gamedev","skate platformer","super ollie vs pebble corp","webpack","tiled"],"categories":["games"],"allowComments":true,"publishOnMedium":false,"cover":null,"date":"2020-10-22T00:00:00.000Z","id":null,"path":"criando-inimigos-e-itens-colecionaveis-no-phaser-js-skate-platformer-game-devlog-8","show":true,"title":"Criando inimigos e itens colecion√°veis no Phaser JS - Skate Platformer Game Devlog #08","hideExcerpt":false,"subtitle":""}}},{"node":{"excerpt":"Importando tilesets externos Tiled √© uma ferramenta open‚Ä¶","html":"<p><figure class=\"gatsby-resp-image-figure\" style=\"\">\n    <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1024px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 42.1875%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAAsTAAALEwEAmpwYAAAB80lEQVQY0wHoARf+ADOI3DOI3DKH3CiC3CeB2yqC2TKH3ESHzFGHv3hyh3R2j12MwMDO3dnY3cDL3EOP3DCG3DSI3DSJ3DWK3QAyiN0xiN02it1spd5xruRlqeUrkuyBcH+4X0CSa2+YbWvPbEPhzcauz+lVouYyi+Ayh9wziN0thtwmgtwAOIjXNYfXQI3XvsvY7JiG2XZomFttsFdcrkdHpFlfo1NZoURInUROk1duklJoY3mwMIveM4TVWZrcnb7iAGuQpGuQpWmPpWOMppFWYJ03QLFCQrhIRK5MTqVVXZdhaJhQV6lLSrNFQ6o/Q4xrdmyTp2eNoouiq8XEvADEo2PDomPDomPGpGO/pWm/omWtk2aMd2qFb2leTGWHcmqcg2qOe22nj2i8oGW+o2XEo2PEo2O/oGK4nWEAn4k5o4o4nIo5ooo5oIs4o4w5bFZJPzlQQztOQTtPRD5ORT1NPTpOXVFJook5oYo5oIo5oYw5oIs6pIw5ACFKViFLViBLViFLVSFHVCBLUSFcRylUTilMUylRVCdRVChQVChRVCRNVCFKVSFMVSFHVSJJUiFIVCFKVgA8M0s9NEs9NEs9MUs/WVc1gVkigU8xgFk9W1g7MEs6M0w7Mkw7Mkw8M0s9NEs9MktCUVQ7f1w+YVU+M0tQItiEJydQCgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Super Ollie vs Pebble Corp.\"\n        title=\"Super Ollie vs Pebble Corp.\"\n        src=\"/static/e75f123fcd3c27b5e43b60fe5c9b9a09/42a19/super-ollie-vs-pebble-corp-tittle-screen.png\"\n        srcset=\"/static/e75f123fcd3c27b5e43b60fe5c9b9a09/e3135/super-ollie-vs-pebble-corp-tittle-screen.png 256w,\n/static/e75f123fcd3c27b5e43b60fe5c9b9a09/06341/super-ollie-vs-pebble-corp-tittle-screen.png 512w,\n/static/e75f123fcd3c27b5e43b60fe5c9b9a09/42a19/super-ollie-vs-pebble-corp-tittle-screen.png 1024w,\n/static/e75f123fcd3c27b5e43b60fe5c9b9a09/e2f49/super-ollie-vs-pebble-corp-tittle-screen.png 1366w\"\n        sizes=\"(max-width: 1024px) 100vw, 1024px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\">Super Ollie vs Pebble Corp.</figcaption>\n  </figure></p>\n<p>No Game Devlog de hoje, vou mostrar como importar tilesets externos no Phaser JS, mas primeiro vamos tirar isso do caminho: Esque√ßa o nome \"Skate Platformer\", o nome do nosso jogo vai ser <span\n          \n          class='highlighted-text'\n        >Super Ollie vs Pebble Corp</span>. A gente n√£o planejava dar um nome ao jogo agora, mas a ideia simplesmente veio nas nossas cabe√ßas e achamos que o nome √© perfeito. Deixa eu te perguntar uma coisa, qual √© o pior inimigo do skatista? Indiscutivelmente essas pequenas pedrinhas, certo? E se no futuro houver uma empresa do mal que quer proibir o skate em todos os lugares, como essa empresa se chamaria? Pebble Corp, √© claro. Pebble √© o nome em ingl√™s daquelas pedrinhas que geralmente voc√™ encontra em praias e tal. Agora com isso fora do caminho, vamos continuar com o post.</p>\n<p><div class=\"gatsby-resp-iframe-wrapper\" style=\"padding-bottom: 56.42857142857143%; position: relative; height: 0; overflow: hidden; margin-bottom: 1.0725rem\" > <div class=\"embedVideo-container\"> <iframe title=\"\" src=\"https://www.youtube.com/embed/a4oeHCm_Tig?rel=0\" class=\"embedVideo-iframe\" style=\"border:0; position: absolute; top: 0; left: 0; width: 100%; height: 100%; \" loading=\"eager\" allowfullscreen=\"\" sandbox=\"allow-same-origin allow-scripts allow-popups\"></iframe> </div> </div></p>\n<h2 id=\"importando-tilesets-externos\" style=\"position:relative;\"><a href=\"#importando-tilesets-externos\" aria-label=\"importando tilesets externos permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Importando tilesets externos</h2>\n<p><a href=\"https://www.mapeditor.org/\" target=\"_blank\" rel=\"noreferrer\">Tiled</a> √© uma ferramenta <a href=\"https://github.com/bjorn/tiled\" target=\"_blank\" rel=\"noreferrer\">open source</a> poderosa para construir mapas 2D suportados por <a href=\"https://discourse.mapeditor.org/t/which-game-engine-s-are-you-using-with-tiled/757/8\" target=\"_blank\" rel=\"noreferrer\">muitas engines de jogos diferentes</a>, incluindo Phaser JS, que √© o framework que eu estou usando para <a href=\"/en/blog/tags/super-ollie-vs-pebble-corp\">esse jogo</a>.</p>\n<p>H√° um pequeno problema, ao carregar mapas do Tiled no Phaser JS, o tileset precisa estar ‚Äúembutido‚Äù no mapa, caso contr√°rio, o Phaser JS n√£o consegue carreg√°-lo. Isso √© muito frustrante porque sempre que eu fa√ßo altera√ß√µes em um tileset, eu tenho que ir em todos os meus arquivos de mapa e ‚Äúreembutir‚Äù o tileset, isso acaba demorando muito se o projeto tiver muitos mapas e tilesets diferentes.</p>\n<p><figure class=\"gatsby-resp-image-figure\" style=\"\">\n    <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 518px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 59.375%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAIAAADtbgqsAAAACXBIWXMAAAsTAAALEwEAmpwYAAACV0lEQVQoz3XRy1LTUBgH8Ox9CDc+gT6AOo6Wneg449ChilZALr2ALRSQS9PQc07SJg0pEQqdkgOlleKQQG6YtqFNW+oiFRe8j1NW4uhv5vt2/5nvQmCMFUWWZdmyLMM0DU3XdePcsgzDMHRdPTszTUNVNcuy6jdqtZpt247jmKZJbOd2kiRcXFhhWEYQhASXTiOQZRlxUxS3tnlBzO3s8jy/J0mlUunw8LBYLH49OjpVFFVVCSG5NjjgffbkxcCAJzwbvf/Wu7C8NDUxuRQJJj9H1hdnUGIVIRqCWyiKSqVSxBcazHmHJsfCXp/fM/bhzt17nvHRBw+fvvYO5Tf59aVPDLmAEE336xYIIZETC8vv38Wia2yS+TgfGfGN+AMB//hEKBzOCxkGMggk0b/0w3t5PDw8PujxHucPspkM4rM0l43GSAhRAsANkU0C8N+whA98I1Oh4DyJUiwDDRA4oabJNy+5lYgQC+apEMfSN1P/DQBA7ONiKrErcVyZIemZ6bNZT4MabkK/nIqmqVW4GJsbCwEqyTDMnwsjhDiO64fng+z6WjqT5Z8/eux7NVQCscrqqA4CACFIM3OTsxSZgPDWvePxeC6XIyqVb7tbhdzOsWnVEKAFNlMpSvuF/MFeHmOp/9lyCWMs3cAYFwoFjHG5XFYUhahWq67r9Ez1Z02/apx3tRNbOW12Oo7TdlpO02m1Wu1Op9Ptdi/7+r3nutfX167rEhe2XbWb7Q3+RxZeinSDjrdK5brj2PV648I2rMap9t3QtWbTabf6rn5d9Xo9TVNlWf4Nd4mgdymyqM4AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Embutir Tileset\"\n        title=\"Embutindo um tileset no Tiled\"\n        src=\"/static/51df513f0b0acbe195eb3327398273b4/2f227/tiled-embed-tileset.png\"\n        srcset=\"/static/51df513f0b0acbe195eb3327398273b4/e3135/tiled-embed-tileset.png 256w,\n/static/51df513f0b0acbe195eb3327398273b4/06341/tiled-embed-tileset.png 512w,\n/static/51df513f0b0acbe195eb3327398273b4/2f227/tiled-embed-tileset.png 518w\"\n        sizes=\"(max-width: 518px) 100vw, 518px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\">Embutindo um tileset no Tiled</figcaption>\n  </figure></p>\n<p>Para resolver este problema, decidi encontrar uma solu√ß√£o para embutir automaticamente os tilesets com o Webpack. Para fazer isso, comparei o arquivo JSON do mesmo mapa antes e depois de embutir um tileset, e ficou assim:</p>\n<p><figure class=\"gatsby-resp-image-figure\" style=\"\">\n    <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1024px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 58.984375%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAIAAADtbgqsAAAACXBIWXMAAAsTAAALEwEAmpwYAAABzUlEQVQoz22Ra2/aMBSG82s6RmP7GCexHUxz5VIQaimJk8CHdtIu0qYmDqH8/olLt3bdo1fWsXQeHR/ZSqe3k9k8mczCJI3H0ygdJ+NplEzGs0WYpDdxosJIBaEKo+GfBGGQxMu7O4tSCkAJACFATsX5yhyXBxGPY8QdL4hEENEhB987RvlYqWgxtxh1nIGDbNR/D0a2lz7w1S+2eAq0SfJnf/Vd3H/j91/F+ifPTFDUluRKyRvKgDJy/QZCMJ9qv9gJ3YbVId4e1GbnF53QndA7kbcyN5bnCs8VNkJHo/9evi2lNnz9HFb7ZPsitRF5c4oRuZF5Y9m2zRxGARC2L0H2RZ5vZG5EVkvdjspOFa3U7dl8lRGmjMOAYcAYCAKCAa4RBuaI5aPMG5HVPDdDvUs3h1HZSv12MjDipuCOwHXAcQlzQAwx48wP/YcfIqtFduke6U4Vu9PjX2Vn4DLGjuv2+6el++eaAIjl03nyuZvnJir3qmj/ygwYALU/AHTwjyyP8ktQGJnXF/nq01Wv1/v8ARthd/HIs8Zb115mvMzwzKiiG1Z7WXb89FuW53n8f/i+H62+xFUTl/XxrJpkY6KqiTdtsm2jyiwed78BOSS64qW11kUAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Tileset embutido vs n√£o embutido\"\n        title=\"Tileset embutido vs n√£o embutido\"\n        src=\"/static/fce7ff4d25c0afd53f6c31a041518dd8/42a19/embedded-vs-non-embedded.png\"\n        srcset=\"/static/fce7ff4d25c0afd53f6c31a041518dd8/e3135/embedded-vs-non-embedded.png 256w,\n/static/fce7ff4d25c0afd53f6c31a041518dd8/06341/embedded-vs-non-embedded.png 512w,\n/static/fce7ff4d25c0afd53f6c31a041518dd8/42a19/embedded-vs-non-embedded.png 1024w,\n/static/fce7ff4d25c0afd53f6c31a041518dd8/b38ab/embedded-vs-non-embedded.png 1168w\"\n        sizes=\"(max-width: 1024px) 100vw, 1024px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\">Tileset embutido vs n√£o embutido</figcaption>\n  </figure></p>\n<p>Como voc√™ pode ver, em vez de ter a propriedade <code class=\"language-text\">source</code> apontando para um arquivo externo, tipo <code class=\"language-text\">\"source\": \"../tilesets/test_tileset.json\"</code>, ele cont√©m todo o conte√∫do desse arquivo mais um atributo <code class=\"language-text\">firstgid</code>, ent√£o tudo o que eu preciso fazer √© percorrer todos os mapas do Tiled, ler a propriedade <code class=\"language-text\">tilesets</code>, carregar cada arquivo tileset e colocar o seu conte√∫do em uma nova array na propriedade <code class=\"language-text\">tilesets</code>.</p>\n<p>Foi assim que eu fiz:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> CopyWebpackPlugin <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'copy-webpack-plugin'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">promises</span><span class=\"token operator\">:</span> fs <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'fs'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">const</span> stageFiles <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> fs<span class=\"token punctuation\">.</span><span class=\"token function\">readdir</span><span class=\"token punctuation\">(</span><span class=\"token constant\">STAGES_PATH</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token comment\">// get only the JSON files</span>\r\n<span class=\"token keyword\">const</span> stageJsons <span class=\"token operator\">=</span> stageFiles\r\n    <span class=\"token punctuation\">.</span><span class=\"token function\">filter</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">stage</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> stage<span class=\"token punctuation\">.</span><span class=\"token function\">split</span><span class=\"token punctuation\">(</span><span class=\"token string\">'.'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">===</span> <span class=\"token string\">'json'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token keyword\">const</span> copyWebpackPluginPatterns <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\r\nstageJsons<span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">stage</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n    copyWebpackPluginPatterns<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\r\n        <span class=\"token literal-property property\">from</span><span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token constant\">STAGES_PATH</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">/</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>stage<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\r\n        <span class=\"token literal-property property\">to</span><span class=\"token operator\">:</span> <span class=\"token string\">'../assets/stages'</span><span class=\"token punctuation\">,</span>\r\n        <span class=\"token function-variable function\">transform</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">fileBuffer<span class=\"token punctuation\">,</span> elPath</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n            <span class=\"token keyword\">const</span> manifestString <span class=\"token operator\">=</span> fileBuffer<span class=\"token punctuation\">.</span><span class=\"token function\">toString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n            <span class=\"token keyword\">const</span> stageData <span class=\"token operator\">=</span> <span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">parse</span><span class=\"token punctuation\">(</span>manifestString<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n            <span class=\"token keyword\">const</span> newTilesets <span class=\"token operator\">=</span> stageData<span class=\"token punctuation\">.</span>tilesets<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">tileset</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n                <span class=\"token comment\">// firstgid is an important id reference for Tiled</span>\r\n                <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> firstgid <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> tileset<span class=\"token punctuation\">;</span>\r\n                <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>tileset<span class=\"token punctuation\">.</span>source<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n                    <span class=\"token comment\">// if there's no source, it means the Tileset</span>\r\n                    <span class=\"token comment\">// is already embedded</span>\r\n                    <span class=\"token keyword\">return</span> tileset<span class=\"token punctuation\">;</span>\r\n                <span class=\"token punctuation\">}</span>\r\n\r\n                <span class=\"token comment\">// on my setup, stages are in root/stages/</span>\r\n                <span class=\"token comment\">// and the tilesets are in root/tilesets/</span>\r\n                <span class=\"token comment\">// so we need to remove \"../tilesets/\" from the path</span>\r\n                <span class=\"token comment\">// and load it based on the root dir of the tilesets</span>\r\n                <span class=\"token keyword\">const</span> filePath <span class=\"token operator\">=</span> tileset<span class=\"token punctuation\">.</span>source<span class=\"token punctuation\">.</span><span class=\"token function\">replace</span><span class=\"token punctuation\">(</span><span class=\"token string\">'../tilesets/'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">''</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                <span class=\"token comment\">// eslint-disable-next-line import/no-dynamic-require</span>\r\n                <span class=\"token keyword\">const</span> tilesetData <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token constant\">TILESETS_PATH</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">/</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>filePath<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>tilesetData<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n                    console<span class=\"token punctuation\">.</span><span class=\"token function\">error</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Could not find file'</span><span class=\"token punctuation\">,</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token constant\">TILESETS_PATH</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">/</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>filePath<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                    <span class=\"token keyword\">return</span> tileset<span class=\"token punctuation\">;</span>\r\n                <span class=\"token punctuation\">}</span>\r\n\r\n                <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span>\r\n                    <span class=\"token operator\">...</span>tilesetData<span class=\"token punctuation\">,</span>\r\n                    firstgid<span class=\"token punctuation\">,</span>\r\n                <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\r\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n            stageData<span class=\"token punctuation\">.</span>tilesets <span class=\"token operator\">=</span> newTilesets<span class=\"token punctuation\">;</span>\r\n\r\n            <span class=\"token keyword\">return</span> Buffer<span class=\"token punctuation\">.</span><span class=\"token function\">from</span><span class=\"token punctuation\">(</span><span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">stringify</span><span class=\"token punctuation\">(</span>stageData<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\r\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\nmodule<span class=\"token punctuation\">.</span>exports <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token literal-property property\">plugins</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\r\n        <span class=\"token keyword\">new</span> <span class=\"token class-name\">CopyWebpackPlugin</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\r\n            <span class=\"token literal-property property\">patterns</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\r\n                <span class=\"token operator\">...</span>copyWebpackPluginPatterns<span class=\"token punctuation\">,</span>\r\n            <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\r\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\r\n    <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\r\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Como voc√™ pode ver, precisamos do plugin <code class=\"language-text\">copy-webpack-plugin</code> para faz√™-lo funcionar, copiando todos os mapas do diret√≥rio <code class=\"language-text\">assets/stages</code> para o diret√≥rio <code class=\"language-text\">dist/assets/stages</code>, e ao copi√°-lo, definimos uma fun√ß√£o <code class=\"language-text\">transform</code> que carregar√° os tilesets externos e os embutir√° nos mapas Tiled. Adicione este c√≥digo ao seu arquivo de configura√ß√£o do Webpack se quiser obter o mesmo resultado.</p>\n<h2 id=\"criando-a-tela-inicial\" style=\"position:relative;\"><a href=\"#criando-a-tela-inicial\" aria-label=\"criando a tela inicial permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Criando a tela inicial</h2>\n<p>Isso foi realmente muito f√°cil e direto, especialmente porque √© praticamente o mesmo c√≥digo do Game Devlog anterior.</p>\n<p>Primeiro eu carrego o mapa na fun√ß√£o <code class=\"language-text\">create</code>:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> map <span class=\"token operator\">=</span> scene<span class=\"token punctuation\">.</span>make<span class=\"token punctuation\">.</span><span class=\"token function\">tilemap</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">key</span><span class=\"token operator\">:</span> <span class=\"token string\">'title_screen'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">const</span> tileset <span class=\"token operator\">=</span> map<span class=\"token punctuation\">.</span><span class=\"token function\">addTilesetImage</span><span class=\"token punctuation\">(</span><span class=\"token string\">'title_screen'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'city_tileset'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> width<span class=\"token punctuation\">,</span> height <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>cameras<span class=\"token punctuation\">.</span>main<span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token keyword\">const</span> background <span class=\"token operator\">=</span> map<span class=\"token punctuation\">.</span><span class=\"token function\">createDynamicLayer</span><span class=\"token punctuation\">(</span><span class=\"token string\">'background'</span><span class=\"token punctuation\">,</span> tileset<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">const</span> ground <span class=\"token operator\">=</span> map<span class=\"token punctuation\">.</span><span class=\"token function\">createDynamicLayer</span><span class=\"token punctuation\">(</span><span class=\"token string\">'ground'</span><span class=\"token punctuation\">,</span> tileset<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">const</span> foreground <span class=\"token operator\">=</span> map<span class=\"token punctuation\">.</span><span class=\"token function\">createDynamicLayer</span><span class=\"token punctuation\">(</span><span class=\"token string\">'foreground'</span><span class=\"token punctuation\">,</span> tileset<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token punctuation\">[</span>background<span class=\"token punctuation\">,</span> ground<span class=\"token punctuation\">,</span> foreground<span class=\"token punctuation\">]</span>\r\n    <span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">dynamicLayer</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n        dynamicLayer<span class=\"token punctuation\">.</span><span class=\"token function\">setY</span><span class=\"token punctuation\">(</span>\r\n            height <span class=\"token operator\">-</span> background<span class=\"token punctuation\">.</span>height\r\n        <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n        <span class=\"token comment\">// set this property to make the the layers move in different speeds</span>\r\n        dynamicLayer<span class=\"token punctuation\">.</span><span class=\"token function\">setScrollFactor</span><span class=\"token punctuation\">(</span>dynamicLayer<span class=\"token punctuation\">.</span>parallaxSpeedX<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token comment\">// we're going to use that in the update function</span>\r\n<span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>parallaxCounter <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Agora tudo o que fiz foi mover a c√¢mera at√© a posi√ß√£o <code class=\"language-text\">y = 640</code> e, quando ela chegar l√°, mudar a posi√ß√£o de volta para<code class=\"language-text\">y = 0</code>, e repetir isso indefinidamente.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>parallaxCounter <span class=\"token operator\">+=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>parallaxCounter <span class=\"token operator\">===</span> <span class=\"token number\">640</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>parallaxCounter <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span>\r\n\r\n<span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>cameras<span class=\"token punctuation\">.</span>main<span class=\"token punctuation\">.</span>scrollX <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>parallaxCounter<span class=\"token punctuation\">;</span></code></pre></div>\n<p>E por hoje √© isso! Espero que tenha gostado, se quiser, deixe um coment√°rio e considere se inscrever no meu canal no YouTube.</p>","fields":{"postHashId":"Z2FtZXN0cnVlbnVsbDIwMjAtMTAtMDhUMDA6MDA6MDAuMDAwWg==","slug":"/2020/2020-08-10-importando-arquivo-de-tileset-externo-no-phaser-js-com-webpack-skate-platformer-game-devlog-7.pt-br/","path":"/blog/games/importando-arquivo-de-tileset-externo-no-phaser-js-com-webpack-skate-platformer-game-devlog-7/","locale":"pt-br"},"rawMarkdownBody":"![Super Ollie vs Pebble Corp.](../../uploads/blog/2020/10/super-ollie-vs-pebble-corp-tittle-screen.png)\r\n\r\nNo Game Devlog de hoje, vou mostrar como importar tilesets externos no Phaser JS, mas primeiro vamos tirar isso do caminho: Esque√ßa o nome \"Skate Platformer\", o nome do nosso jogo vai ser -#Super Ollie vs Pebble Corp#-. A gente n√£o planejava dar um nome ao jogo agora, mas a ideia simplesmente veio nas nossas cabe√ßas e achamos que o nome √© perfeito. Deixa eu te perguntar uma coisa, qual √© o pior inimigo do skatista? Indiscutivelmente essas pequenas pedrinhas, certo? E se no futuro houver uma empresa do mal que quer proibir o skate em todos os lugares, como essa empresa se chamaria? Pebble Corp, √© claro. Pebble √© o nome em ingl√™s daquelas pedrinhas que geralmente voc√™ encontra em praias e tal. Agora com isso fora do caminho, vamos continuar com o post.\r\n\r\n`youtube: https://www.youtube.com/watch?v=a4oeHCm_Tig`\r\n\r\n## Importando tilesets externos\r\n\r\n[Tiled](https://www.mapeditor.org/) √© uma ferramenta [open source](https://github.com/bjorn/tiled) poderosa para construir mapas 2D suportados por [muitas engines de jogos diferentes](https://discourse.mapeditor.org/t/which-game-engine-s-are-you-using-with-tiled/757/8), incluindo Phaser JS, que √© o framework que eu estou usando para [esse jogo](/en/blog/tags/super-ollie-vs-pebble-corp).\r\n\r\nH√° um pequeno problema, ao carregar mapas do Tiled no Phaser JS, o tileset precisa estar \"embutido\" no mapa, caso contr√°rio, o Phaser JS n√£o consegue carreg√°-lo. Isso √© muito frustrante porque sempre que eu fa√ßo altera√ß√µes em um tileset, eu tenho que ir em todos os meus arquivos de mapa e \"reembutir\" o tileset, isso acaba demorando muito se o projeto tiver muitos mapas e tilesets diferentes.\r\n\r\n![Embutir Tileset](../../uploads/blog/2020/10/tiled-embed-tileset.png \"Embutindo um tileset no Tiled\")\r\n\r\nPara resolver este problema, decidi encontrar uma solu√ß√£o para embutir automaticamente os tilesets com o Webpack. Para fazer isso, comparei o arquivo JSON do mesmo mapa antes e depois de embutir um tileset, e ficou assim:\r\n\r\n![Tileset embutido vs n√£o embutido](../../uploads/blog/2020/10/embedded-vs-non-embedded.png \"Tileset embutido vs n√£o embutido\")\r\n\r\nComo voc√™ pode ver, em vez de ter a propriedade `source` apontando para um arquivo externo, tipo `\"source\": \"../tilesets/test_tileset.json\"`, ele cont√©m todo o conte√∫do desse arquivo mais um atributo `firstgid`, ent√£o tudo o que eu preciso fazer √© percorrer todos os mapas do Tiled, ler a propriedade `tilesets`, carregar cada arquivo tileset e colocar o seu conte√∫do em uma nova array na propriedade `tilesets`.\r\n\r\nFoi assim que eu fiz:\r\n\r\n```javascript\r\nconst CopyWebpackPlugin = require('copy-webpack-plugin');\r\nconst { promises: fs } = require('fs');\r\nconst stageFiles = await fs.readdir(STAGES_PATH);\r\n// get only the JSON files\r\nconst stageJsons = stageFiles\r\n    .filter((stage) => stage.split('.')[1] === 'json');\r\n\r\nconst copyWebpackPluginPatterns = [];\r\nstageJsons.forEach((stage) => {\r\n    copyWebpackPluginPatterns.push({\r\n        from: `${STAGES_PATH}/${stage}`,\r\n        to: '../assets/stages',\r\n        transform: (fileBuffer, elPath) => {\r\n            const manifestString = fileBuffer.toString();\r\n            const stageData = JSON.parse(manifestString);\r\n            const newTilesets = stageData.tilesets.map((tileset) => {\r\n                // firstgid is an important id reference for Tiled\r\n                const { firstgid } = tileset;\r\n                if (!tileset.source) {\r\n                    // if there's no source, it means the Tileset\r\n                    // is already embedded\r\n                    return tileset;\r\n                }\r\n\r\n                // on my setup, stages are in root/stages/\r\n                // and the tilesets are in root/tilesets/\r\n                // so we need to remove \"../tilesets/\" from the path\r\n                // and load it based on the root dir of the tilesets\r\n                const filePath = tileset.source.replace('../tilesets/', '');\r\n                // eslint-disable-next-line import/no-dynamic-require\r\n                const tilesetData = require(`${TILESETS_PATH}/${filePath}`);\r\n                if (!tilesetData) {\r\n                    console.error('Could not find file', `${TILESETS_PATH}/${filePath}`);\r\n                    return tileset;\r\n                }\r\n\r\n                return {\r\n                    ...tilesetData,\r\n                    firstgid,\r\n                };\r\n            });\r\n            stageData.tilesets = newTilesets;\r\n\r\n            return Buffer.from(JSON.stringify(stageData));\r\n        },\r\n    });\r\n});\r\n\r\nmodule.exports = {\r\n    plugins: [\r\n        new CopyWebpackPlugin({\r\n            patterns: [\r\n                ...copyWebpackPluginPatterns,\r\n            ],\r\n        }),\r\n    ],\r\n};\r\n```\r\n\r\nComo voc√™ pode ver, precisamos do plugin `copy-webpack-plugin` para faz√™-lo funcionar, copiando todos os mapas do diret√≥rio `assets/stages` para o diret√≥rio `dist/assets/stages`, e ao copi√°-lo, definimos uma fun√ß√£o `transform` que carregar√° os tilesets externos e os embutir√° nos mapas Tiled. Adicione este c√≥digo ao seu arquivo de configura√ß√£o do Webpack se quiser obter o mesmo resultado.\r\n\r\n## Criando a tela inicial\r\nIsso foi realmente muito f√°cil e direto, especialmente porque √© praticamente o mesmo c√≥digo do Game Devlog anterior.\r\n\r\nPrimeiro eu carrego o mapa na fun√ß√£o `create`:\r\n\r\n```javascript\r\nconst map = scene.make.tilemap({ key: 'title_screen' });\r\nconst tileset = map.addTilesetImage('title_screen', 'city_tileset');\r\nconst { width, height } = this.cameras.main;\r\n\r\nconst background = map.createDynamicLayer('background', tileset, 0, 0);\r\nconst ground = map.createDynamicLayer('ground', tileset, 0, 0);\r\nconst foreground = map.createDynamicLayer('foreground', tileset, 0, 0);\r\n\r\n[background, ground, foreground]\r\n    .forEach((dynamicLayer) => {\r\n        dynamicLayer.setY(\r\n            height - background.height\r\n        );\r\n\r\n        // set this property to make the the layers move in different speeds\r\n        dynamicLayer.setScrollFactor(dynamicLayer.parallaxSpeedX);\r\n    });\r\n\r\n// we're going to use that in the update function\r\nthis.parallaxCounter = 0;\r\n```\r\n\r\nAgora tudo o que fiz foi mover a c√¢mera at√© a posi√ß√£o `y = 640` e, quando ela chegar l√°, mudar a posi√ß√£o de volta para`y = 0`, e repetir isso indefinidamente.\r\n\r\n```javascript\r\nthis.parallaxCounter += 1;\r\nif (this.parallaxCounter === 640) {\r\n    this.parallaxCounter = 0;\r\n}\r\n\r\nthis.cameras.main.scrollX = this.parallaxCounter;\r\n```\r\n\r\nE por hoje √© isso! Espero que tenha gostado, se quiser, deixe um coment√°rio e considere se inscrever no meu canal no YouTube.\r\n","frontmatter":{"tags":["programa√ß√£o","jogos","javascript","phaser","phaser 3","game devlog","gamedev","skate platformer","super ollie vs pebble corp","webpack","tiled"],"categories":["games"],"allowComments":true,"publishOnMedium":false,"cover":null,"date":"2020-10-08T00:00:00.000Z","id":null,"path":"carregando-arquivo-de-tileset-externo-no-phaser-js-com-webpack-skate-platformer-game-devlog-7","show":true,"title":"Importando arquivo de tileset externo no Phaser JS com Webpack - Skate Platformer Game Devlog #07","hideExcerpt":false,"subtitle":""}}},{"node":{"excerpt":"Loading external tileset files Tiled is a powerful open‚Ä¶","html":"<p><figure class=\"gatsby-resp-image-figure\" style=\"\">\n    <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1024px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 42.1875%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAAsTAAALEwEAmpwYAAAB80lEQVQY0wHoARf+ADOI3DOI3DKH3CiC3CeB2yqC2TKH3ESHzFGHv3hyh3R2j12MwMDO3dnY3cDL3EOP3DCG3DSI3DSJ3DWK3QAyiN0xiN02it1spd5xruRlqeUrkuyBcH+4X0CSa2+YbWvPbEPhzcauz+lVouYyi+Ayh9wziN0thtwmgtwAOIjXNYfXQI3XvsvY7JiG2XZomFttsFdcrkdHpFlfo1NZoURInUROk1duklJoY3mwMIveM4TVWZrcnb7iAGuQpGuQpWmPpWOMppFWYJ03QLFCQrhIRK5MTqVVXZdhaJhQV6lLSrNFQ6o/Q4xrdmyTp2eNoouiq8XEvADEo2PDomPDomPGpGO/pWm/omWtk2aMd2qFb2leTGWHcmqcg2qOe22nj2i8oGW+o2XEo2PEo2O/oGK4nWEAn4k5o4o4nIo5ooo5oIs4o4w5bFZJPzlQQztOQTtPRD5ORT1NPTpOXVFJook5oYo5oIo5oYw5oIs6pIw5ACFKViFLViBLViFLVSFHVCBLUSFcRylUTilMUylRVCdRVChQVChRVCRNVCFKVSFMVSFHVSJJUiFIVCFKVgA8M0s9NEs9NEs9MUs/WVc1gVkigU8xgFk9W1g7MEs6M0w7Mkw7Mkw8M0s9NEs9MktCUVQ7f1w+YVU+M0tQItiEJydQCgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Super Ollie vs Pebble Corp.\"\n        title=\"Super Ollie vs Pebble Corp.\"\n        src=\"/static/e75f123fcd3c27b5e43b60fe5c9b9a09/42a19/super-ollie-vs-pebble-corp-tittle-screen.png\"\n        srcset=\"/static/e75f123fcd3c27b5e43b60fe5c9b9a09/e3135/super-ollie-vs-pebble-corp-tittle-screen.png 256w,\n/static/e75f123fcd3c27b5e43b60fe5c9b9a09/06341/super-ollie-vs-pebble-corp-tittle-screen.png 512w,\n/static/e75f123fcd3c27b5e43b60fe5c9b9a09/42a19/super-ollie-vs-pebble-corp-tittle-screen.png 1024w,\n/static/e75f123fcd3c27b5e43b60fe5c9b9a09/e2f49/super-ollie-vs-pebble-corp-tittle-screen.png 1366w\"\n        sizes=\"(max-width: 1024px) 100vw, 1024px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\">Super Ollie vs Pebble Corp.</figcaption>\n  </figure></p>\n<p>In today's Game Devlog I will show you how to load external tilesets into Phaser JS, but first let's take this out of the way: Forget about \"Skate Platformer\", our game is going to be called <span\n          \n          class='highlighted-text'\n        >Super Ollie vs Pebble Corp</span>. We didn't really plan in naming the game now, but the idea simply popped into our heads and we think the name is perfect. Let me ask you this, what's the skater's worst enemy? Unarguably those small pebbles, right? What if in the future there's an evil company that wants to prohibit skateboarding everywhere, what would that company be called? Pebble Corp of course. Now with that out of the way, let's keep going with the post.</p>\n<p><div class=\"gatsby-resp-iframe-wrapper\" style=\"padding-bottom: 56.42857142857143%; position: relative; height: 0; overflow: hidden; margin-bottom: 1.0725rem\" > <div class=\"embedVideo-container\"> <iframe title=\"\" src=\"https://www.youtube.com/embed/a4oeHCm_Tig?rel=0\" class=\"embedVideo-iframe\" style=\"border:0; position: absolute; top: 0; left: 0; width: 100%; height: 100%; \" loading=\"eager\" allowfullscreen=\"\" sandbox=\"allow-same-origin allow-scripts allow-popups\"></iframe> </div> </div></p>\n<h2 id=\"loading-external-tileset-files\" style=\"position:relative;\"><a href=\"#loading-external-tileset-files\" aria-label=\"loading external tileset files permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Loading external tileset files</h2>\n<p><a href=\"https://www.mapeditor.org/\" target=\"_blank\" rel=\"noreferrer\">Tiled</a> is a powerful <a href=\"https://github.com/bjorn/tiled\" target=\"_blank\" rel=\"noreferrer\">open source</a> tool to build 2D maps supported by <a href=\"https://discourse.mapeditor.org/t/which-game-engine-s-are-you-using-with-tiled/757/8\" target=\"_blank\" rel=\"noreferrer\">many different game engines</a>, including Phaser JS, which is the framework I‚Äôm using for <a href=\"/en/blog/tags/super-ollie-vs-pebble-corp\">this game</a>.</p>\n<p>There is one small problem, when loading Tiled maps on Phaser JS, the tileset needs to be embedded into the map, otherwise Phaser JS can‚Äôt load it. This is quite frustrating because whenever you make changes to your tileset, you will have to go to all your map files and re-embed the tileset, this can be very time-consuming if you have multiple maps and tilesets.</p>\n<p><figure class=\"gatsby-resp-image-figure\" style=\"\">\n    <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 518px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 59.375%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAIAAADtbgqsAAAACXBIWXMAAAsTAAALEwEAmpwYAAACV0lEQVQoz3XRy1LTUBgH8Ox9CDc+gT6AOo6Wneg449ChilZALr2ALRSQS9PQc07SJg0pEQqdkgOlleKQQG6YtqFNW+oiFRe8j1NW4uhv5vt2/5nvQmCMFUWWZdmyLMM0DU3XdePcsgzDMHRdPTszTUNVNcuy6jdqtZpt247jmKZJbOd2kiRcXFhhWEYQhASXTiOQZRlxUxS3tnlBzO3s8jy/J0mlUunw8LBYLH49OjpVFFVVCSG5NjjgffbkxcCAJzwbvf/Wu7C8NDUxuRQJJj9H1hdnUGIVIRqCWyiKSqVSxBcazHmHJsfCXp/fM/bhzt17nvHRBw+fvvYO5Tf59aVPDLmAEE336xYIIZETC8vv38Wia2yS+TgfGfGN+AMB//hEKBzOCxkGMggk0b/0w3t5PDw8PujxHucPspkM4rM0l43GSAhRAsANkU0C8N+whA98I1Oh4DyJUiwDDRA4oabJNy+5lYgQC+apEMfSN1P/DQBA7ONiKrErcVyZIemZ6bNZT4MabkK/nIqmqVW4GJsbCwEqyTDMnwsjhDiO64fng+z6WjqT5Z8/eux7NVQCscrqqA4CACFIM3OTsxSZgPDWvePxeC6XIyqVb7tbhdzOsWnVEKAFNlMpSvuF/MFeHmOp/9lyCWMs3cAYFwoFjHG5XFYUhahWq67r9Ez1Z02/apx3tRNbOW12Oo7TdlpO02m1Wu1Op9Ptdi/7+r3nutfX167rEhe2XbWb7Q3+RxZeinSDjrdK5brj2PV648I2rMap9t3QtWbTabf6rn5d9Xo9TVNlWf4Nd4mgdymyqM4AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Embed Tileset\"\n        title=\"Embedding a tileset on Tiled\"\n        src=\"/static/51df513f0b0acbe195eb3327398273b4/2f227/tiled-embed-tileset.png\"\n        srcset=\"/static/51df513f0b0acbe195eb3327398273b4/e3135/tiled-embed-tileset.png 256w,\n/static/51df513f0b0acbe195eb3327398273b4/06341/tiled-embed-tileset.png 512w,\n/static/51df513f0b0acbe195eb3327398273b4/2f227/tiled-embed-tileset.png 518w\"\n        sizes=\"(max-width: 518px) 100vw, 518px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\">Embedding a tileset on Tiled</figcaption>\n  </figure></p>\n<p>To solve this problem I decided to come up with a solution to automatically embed tilemaps using Webpack, to do that I compared the JSON file from the same map before and after embedding a tileset, and it looked like this:</p>\n<p><figure class=\"gatsby-resp-image-figure\" style=\"\">\n    <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1024px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 58.984375%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAIAAADtbgqsAAAACXBIWXMAAAsTAAALEwEAmpwYAAABzUlEQVQoz22Ra2/aMBSG82s6RmP7GCexHUxz5VIQaimJk8CHdtIu0qYmDqH8/olLt3bdo1fWsXQeHR/ZSqe3k9k8mczCJI3H0ygdJ+NplEzGs0WYpDdxosJIBaEKo+GfBGGQxMu7O4tSCkAJACFATsX5yhyXBxGPY8QdL4hEENEhB987RvlYqWgxtxh1nIGDbNR/D0a2lz7w1S+2eAq0SfJnf/Vd3H/j91/F+ifPTFDUluRKyRvKgDJy/QZCMJ9qv9gJ3YbVId4e1GbnF53QndA7kbcyN5bnCs8VNkJHo/9evi2lNnz9HFb7ZPsitRF5c4oRuZF5Y9m2zRxGARC2L0H2RZ5vZG5EVkvdjspOFa3U7dl8lRGmjMOAYcAYCAKCAa4RBuaI5aPMG5HVPDdDvUs3h1HZSv12MjDipuCOwHXAcQlzQAwx48wP/YcfIqtFduke6U4Vu9PjX2Vn4DLGjuv2+6el++eaAIjl03nyuZvnJir3qmj/ygwYALU/AHTwjyyP8ktQGJnXF/nq01Wv1/v8ARthd/HIs8Zb115mvMzwzKiiG1Z7WXb89FuW53n8f/i+H62+xFUTl/XxrJpkY6KqiTdtsm2jyiwed78BOSS64qW11kUAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Embedded vs non-embedded\"\n        title=\"Embedded vs non-embedded\"\n        src=\"/static/fce7ff4d25c0afd53f6c31a041518dd8/42a19/embedded-vs-non-embedded.png\"\n        srcset=\"/static/fce7ff4d25c0afd53f6c31a041518dd8/e3135/embedded-vs-non-embedded.png 256w,\n/static/fce7ff4d25c0afd53f6c31a041518dd8/06341/embedded-vs-non-embedded.png 512w,\n/static/fce7ff4d25c0afd53f6c31a041518dd8/42a19/embedded-vs-non-embedded.png 1024w,\n/static/fce7ff4d25c0afd53f6c31a041518dd8/b38ab/embedded-vs-non-embedded.png 1168w\"\n        sizes=\"(max-width: 1024px) 100vw, 1024px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\">Embedded vs non-embedded</figcaption>\n  </figure></p>\n<p>As you can see, instead of having the property <code class=\"language-text\">source</code> to an external file, like <code class=\"language-text\">\"source\": \"../tilesets/test_tileset.json\"</code>, it contains the whole content of that file plus a <code class=\"language-text\">firstgid</code> attribute, so all we need to do is loop through all Tiled maps, read the <code class=\"language-text\">tilesets</code> property, load each individual tileset file and put each of it‚Äôs content in a array replacement for the <code class=\"language-text\">tilesets</code> property.</p>\n<p>This is how I did it:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> CopyWebpackPlugin <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'copy-webpack-plugin'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">promises</span><span class=\"token operator\">:</span> fs <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'fs'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">const</span> stageFiles <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> fs<span class=\"token punctuation\">.</span><span class=\"token function\">readdir</span><span class=\"token punctuation\">(</span><span class=\"token constant\">STAGES_PATH</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token comment\">// get only the JSON files</span>\r\n<span class=\"token keyword\">const</span> stageJsons <span class=\"token operator\">=</span> stageFiles\r\n    <span class=\"token punctuation\">.</span><span class=\"token function\">filter</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">stage</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> stage<span class=\"token punctuation\">.</span><span class=\"token function\">split</span><span class=\"token punctuation\">(</span><span class=\"token string\">'.'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">===</span> <span class=\"token string\">'json'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token keyword\">const</span> copyWebpackPluginPatterns <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\r\nstageJsons<span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">stage</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n    copyWebpackPluginPatterns<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\r\n        <span class=\"token literal-property property\">from</span><span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token constant\">STAGES_PATH</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">/</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>stage<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\r\n        <span class=\"token literal-property property\">to</span><span class=\"token operator\">:</span> <span class=\"token string\">'../assets/stages'</span><span class=\"token punctuation\">,</span>\r\n        <span class=\"token function-variable function\">transform</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">fileBuffer<span class=\"token punctuation\">,</span> elPath</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n            <span class=\"token keyword\">const</span> manifestString <span class=\"token operator\">=</span> fileBuffer<span class=\"token punctuation\">.</span><span class=\"token function\">toString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n            <span class=\"token keyword\">const</span> stageData <span class=\"token operator\">=</span> <span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">parse</span><span class=\"token punctuation\">(</span>manifestString<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n            <span class=\"token keyword\">const</span> newTilesets <span class=\"token operator\">=</span> stageData<span class=\"token punctuation\">.</span>tilesets<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">tileset</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n                <span class=\"token comment\">// firstgid is an important id reference for Tiled</span>\r\n                <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> firstgid <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> tileset<span class=\"token punctuation\">;</span>\r\n                <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>tileset<span class=\"token punctuation\">.</span>source<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n                    <span class=\"token comment\">// if there's no source, it means the Tileset</span>\r\n                    <span class=\"token comment\">// is already embedded</span>\r\n                    <span class=\"token keyword\">return</span> tileset<span class=\"token punctuation\">;</span>\r\n                <span class=\"token punctuation\">}</span>\r\n\r\n                <span class=\"token comment\">// on my setup, stages are in root/stages/</span>\r\n                <span class=\"token comment\">// and the tilesets are in root/tilesets/</span>\r\n                <span class=\"token comment\">// so we need to remove \"../tilesets/\" from the path</span>\r\n                <span class=\"token comment\">// and load it based on the root dir of the tilesets</span>\r\n                <span class=\"token keyword\">const</span> filePath <span class=\"token operator\">=</span> tileset<span class=\"token punctuation\">.</span>source<span class=\"token punctuation\">.</span><span class=\"token function\">replace</span><span class=\"token punctuation\">(</span><span class=\"token string\">'../tilesets/'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">''</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                <span class=\"token comment\">// eslint-disable-next-line import/no-dynamic-require</span>\r\n                <span class=\"token keyword\">const</span> tilesetData <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token constant\">TILESETS_PATH</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">/</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>filePath<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>tilesetData<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n                    console<span class=\"token punctuation\">.</span><span class=\"token function\">error</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Could not find file'</span><span class=\"token punctuation\">,</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token constant\">TILESETS_PATH</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">/</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>filePath<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                    <span class=\"token keyword\">return</span> tileset<span class=\"token punctuation\">;</span>\r\n                <span class=\"token punctuation\">}</span>\r\n\r\n                <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span>\r\n                    <span class=\"token operator\">...</span>tilesetData<span class=\"token punctuation\">,</span>\r\n                    firstgid<span class=\"token punctuation\">,</span>\r\n                <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\r\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n            stageData<span class=\"token punctuation\">.</span>tilesets <span class=\"token operator\">=</span> newTilesets<span class=\"token punctuation\">;</span>\r\n\r\n            <span class=\"token keyword\">return</span> Buffer<span class=\"token punctuation\">.</span><span class=\"token function\">from</span><span class=\"token punctuation\">(</span><span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">stringify</span><span class=\"token punctuation\">(</span>stageData<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\r\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\nmodule<span class=\"token punctuation\">.</span>exports <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token literal-property property\">plugins</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\r\n        <span class=\"token keyword\">new</span> <span class=\"token class-name\">CopyWebpackPlugin</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\r\n            <span class=\"token literal-property property\">patterns</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\r\n                <span class=\"token operator\">...</span>copyWebpackPluginPatterns<span class=\"token punctuation\">,</span>\r\n            <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\r\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\r\n    <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\r\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>As you can see we need the <code class=\"language-text\">copy-webpack-plugin</code> plugin to make it work, by copying all maps from the <code class=\"language-text\">assets/stages</code> directory into the <code class=\"language-text\">dist/assets/stages</code> directory, and while copying it, we set a <code class=\"language-text\">transform</code> function that will load the individual external tilesets and embed them into the Tiled maps. Add this code to your Webpack config file if you want to achieve the same result.</p>\n<h2 id=\"creating-the-title-screen\" style=\"position:relative;\"><a href=\"#creating-the-title-screen\" aria-label=\"creating the title screen permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Creating the title screen</h2>\n<p>This was actually quite easy and straightforward, specially because it‚Äôs pretty much the same code from previous Game Devlog.</p>\n<p>First I load the map in the <code class=\"language-text\">create</code> function:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> map <span class=\"token operator\">=</span> scene<span class=\"token punctuation\">.</span>make<span class=\"token punctuation\">.</span><span class=\"token function\">tilemap</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">key</span><span class=\"token operator\">:</span> <span class=\"token string\">'title_screen'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">const</span> tileset <span class=\"token operator\">=</span> map<span class=\"token punctuation\">.</span><span class=\"token function\">addTilesetImage</span><span class=\"token punctuation\">(</span><span class=\"token string\">'title_screen'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'city_tileset'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> width<span class=\"token punctuation\">,</span> height <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>cameras<span class=\"token punctuation\">.</span>main<span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token keyword\">const</span> background <span class=\"token operator\">=</span> map<span class=\"token punctuation\">.</span><span class=\"token function\">createDynamicLayer</span><span class=\"token punctuation\">(</span><span class=\"token string\">'background'</span><span class=\"token punctuation\">,</span> tileset<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">const</span> ground <span class=\"token operator\">=</span> map<span class=\"token punctuation\">.</span><span class=\"token function\">createDynamicLayer</span><span class=\"token punctuation\">(</span><span class=\"token string\">'ground'</span><span class=\"token punctuation\">,</span> tileset<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">const</span> foreground <span class=\"token operator\">=</span> map<span class=\"token punctuation\">.</span><span class=\"token function\">createDynamicLayer</span><span class=\"token punctuation\">(</span><span class=\"token string\">'foreground'</span><span class=\"token punctuation\">,</span> tileset<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token punctuation\">[</span>background<span class=\"token punctuation\">,</span> ground<span class=\"token punctuation\">,</span> foreground<span class=\"token punctuation\">]</span>\r\n    <span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">dynamicLayer</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n        dynamicLayer<span class=\"token punctuation\">.</span><span class=\"token function\">setY</span><span class=\"token punctuation\">(</span>\r\n            height <span class=\"token operator\">-</span> background<span class=\"token punctuation\">.</span>height\r\n        <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n        <span class=\"token comment\">// set this property to make the the layers move in different speeds</span>\r\n        dynamicLayer<span class=\"token punctuation\">.</span><span class=\"token function\">setScrollFactor</span><span class=\"token punctuation\">(</span>dynamicLayer<span class=\"token punctuation\">.</span>parallaxSpeedX<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token comment\">// we're going to use that in the update function</span>\r\n<span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>parallaxCounter <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Now all I did was move the camera till position <code class=\"language-text\">y = 640</code>, and from there reset the position back to <code class=\"language-text\">y = 0</code>, and the loop continues.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>parallaxCounter <span class=\"token operator\">+=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>parallaxCounter <span class=\"token operator\">===</span> <span class=\"token number\">640</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>parallaxCounter <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span>\r\n\r\n<span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>cameras<span class=\"token punctuation\">.</span>main<span class=\"token punctuation\">.</span>scrollX <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>parallaxCounter<span class=\"token punctuation\">;</span></code></pre></div>\n<p>That‚Äôs all for today, I hope you liked it, if you do please leave it a comment and consider subscribing to my YouTube channel.</p>","fields":{"postHashId":"Z2FtZXN0cnVlbnVsbDIwMjAtMTAtMDhUMDA6MDA6MDAuMDAwWg==","slug":"/2020/2020-08-10-loading-external-tileset-file-on-phaser-js-using-webpack-skate-platformer-game-devlog-7.en/","path":"/blog/games/loading-external-tileset-file-on-phaser-js-using-webpack-skate-platformer-game-devlog-7/","locale":"en"},"rawMarkdownBody":"![Super Ollie vs Pebble Corp.](../../uploads/blog/2020/10/super-ollie-vs-pebble-corp-tittle-screen.png)\r\n\r\nIn today's Game Devlog I will show you how to load external tilesets into Phaser JS, but first let's take this out of the way: Forget about \"Skate Platformer\", our game is going to be called -#Super Ollie vs Pebble Corp#-. We didn't really plan in naming the game now, but the idea simply popped into our heads and we think the name is perfect. Let me ask you this, what's the skater's worst enemy? Unarguably those small pebbles, right? What if in the future there's an evil company that wants to prohibit skateboarding everywhere, what would that company be called? Pebble Corp of course. Now with that out of the way, let's keep going with the post.\r\n\r\n`youtube: https://www.youtube.com/watch?v=a4oeHCm_Tig`\r\n\r\n## Loading external tileset files\r\n\r\n[Tiled](https://www.mapeditor.org/) is a powerful [open source](https://github.com/bjorn/tiled) tool to build 2D maps supported by [many different game engines](https://discourse.mapeditor.org/t/which-game-engine-s-are-you-using-with-tiled/757/8), including Phaser JS, which is the framework I'm using for [this game](/en/blog/tags/super-ollie-vs-pebble-corp).\r\n\r\nThere is one small problem, when loading Tiled maps on Phaser JS, the tileset needs to be embedded into the map, otherwise Phaser JS can't load it. This is quite frustrating because whenever you make changes to your tileset, you will have to go to all your map files and re-embed the tileset, this can be very time-consuming if you have multiple maps and tilesets.\r\n\r\n![Embed Tileset](../../uploads/blog/2020/10/tiled-embed-tileset.png \"Embedding a tileset on Tiled\")\r\n\r\nTo solve this problem I decided to come up with a solution to automatically embed tilemaps using Webpack, to do that I compared the JSON file from the same map before and after embedding a tileset, and it looked like this:\r\n\r\n![Embedded vs non-embedded](../../uploads/blog/2020/10/embedded-vs-non-embedded.png \"Embedded vs non-embedded\")\r\n\r\nAs you can see, instead of having the property `source` to an external file, like `\"source\": \"../tilesets/test_tileset.json\"`, it contains the whole content of that file plus a `firstgid` attribute, so all we need to do is loop through all Tiled maps, read the `tilesets` property, load each individual tileset file and put each of it's content in a array replacement for the `tilesets` property.\r\n\r\nThis is how I did it:\r\n\r\n```javascript\r\nconst CopyWebpackPlugin = require('copy-webpack-plugin');\r\nconst { promises: fs } = require('fs');\r\nconst stageFiles = await fs.readdir(STAGES_PATH);\r\n// get only the JSON files\r\nconst stageJsons = stageFiles\r\n    .filter((stage) => stage.split('.')[1] === 'json');\r\n\r\nconst copyWebpackPluginPatterns = [];\r\nstageJsons.forEach((stage) => {\r\n    copyWebpackPluginPatterns.push({\r\n        from: `${STAGES_PATH}/${stage}`,\r\n        to: '../assets/stages',\r\n        transform: (fileBuffer, elPath) => {\r\n            const manifestString = fileBuffer.toString();\r\n            const stageData = JSON.parse(manifestString);\r\n            const newTilesets = stageData.tilesets.map((tileset) => {\r\n                // firstgid is an important id reference for Tiled\r\n                const { firstgid } = tileset;\r\n                if (!tileset.source) {\r\n                    // if there's no source, it means the Tileset\r\n                    // is already embedded\r\n                    return tileset;\r\n                }\r\n\r\n                // on my setup, stages are in root/stages/\r\n                // and the tilesets are in root/tilesets/\r\n                // so we need to remove \"../tilesets/\" from the path\r\n                // and load it based on the root dir of the tilesets\r\n                const filePath = tileset.source.replace('../tilesets/', '');\r\n                // eslint-disable-next-line import/no-dynamic-require\r\n                const tilesetData = require(`${TILESETS_PATH}/${filePath}`);\r\n                if (!tilesetData) {\r\n                    console.error('Could not find file', `${TILESETS_PATH}/${filePath}`);\r\n                    return tileset;\r\n                }\r\n\r\n                return {\r\n                    ...tilesetData,\r\n                    firstgid,\r\n                };\r\n            });\r\n            stageData.tilesets = newTilesets;\r\n\r\n            return Buffer.from(JSON.stringify(stageData));\r\n        },\r\n    });\r\n});\r\n\r\nmodule.exports = {\r\n    plugins: [\r\n        new CopyWebpackPlugin({\r\n            patterns: [\r\n                ...copyWebpackPluginPatterns,\r\n            ],\r\n        }),\r\n    ],\r\n};\r\n```\r\n\r\nAs you can see we need the `copy-webpack-plugin` plugin to make it work, by copying all maps from the `assets/stages` directory into the `dist/assets/stages` directory, and while copying it, we set a `transform` function that will load the individual external tilesets and embed them into the Tiled maps. Add this code to your Webpack config file if you want to achieve the same result.\r\n\r\n## Creating the title screen\r\n\r\nThis was actually quite easy and straightforward, specially because it's pretty much the same code from previous Game Devlog.\r\n\r\nFirst I load the map in the `create` function:\r\n\r\n```javascript\r\nconst map = scene.make.tilemap({ key: 'title_screen' });\r\nconst tileset = map.addTilesetImage('title_screen', 'city_tileset');\r\nconst { width, height } = this.cameras.main;\r\n\r\nconst background = map.createDynamicLayer('background', tileset, 0, 0);\r\nconst ground = map.createDynamicLayer('ground', tileset, 0, 0);\r\nconst foreground = map.createDynamicLayer('foreground', tileset, 0, 0);\r\n\r\n[background, ground, foreground]\r\n    .forEach((dynamicLayer) => {\r\n        dynamicLayer.setY(\r\n            height - background.height\r\n        );\r\n\r\n        // set this property to make the the layers move in different speeds\r\n        dynamicLayer.setScrollFactor(dynamicLayer.parallaxSpeedX);\r\n    });\r\n\r\n// we're going to use that in the update function\r\nthis.parallaxCounter = 0;\r\n```\r\n\r\nNow all I did was move the camera till position `y = 640`, and from there reset the position back to `y = 0`, and the loop continues.\r\n\r\n```javascript\r\nthis.parallaxCounter += 1;\r\nif (this.parallaxCounter === 640) {\r\n    this.parallaxCounter = 0;\r\n}\r\n\r\nthis.cameras.main.scrollX = this.parallaxCounter;\r\n```\r\n\r\nThat's all for today, I hope you liked it, if you do please leave it a comment and consider subscribing to my YouTube channel.\r\n","frontmatter":{"tags":["coding","games","javascript","phaser","phaser 3","game devlog","gamedev","skate platformer","super ollie vs pebble corp","webpack","tiled"],"categories":["games"],"allowComments":true,"publishOnMedium":false,"cover":null,"date":"2020-10-08T00:00:00.000Z","id":null,"path":"loading-external-tileset-file-on-phaser-js-using-webpack-skate-platformer-game-devlog-7","show":true,"title":"Loading external tileset file on Phaser JS using Webpack - Skate Platformer Game Devlog #07","hideExcerpt":false,"subtitle":""}}},{"node":{"excerpt":"Fala pessoal! O Game Devlog dessa semana √© um pouco longo‚Ä¶","html":"<p>Fala pessoal! O Game Devlog dessa semana √© um pouco longo, 15 minutos, mas vale a pena assistir, pois, tem muitas coisas interessantes sobre o jogo.</p>\n<p><div class=\"gatsby-resp-iframe-wrapper\" style=\"padding-bottom: 56.42857142857143%; position: relative; height: 0; overflow: hidden; margin-bottom: 1.0725rem\" > <div class=\"embedVideo-container\"> <iframe title=\"\" src=\"https://www.youtube.com/embed/dUNkwPYmzb4?rel=0\" class=\"embedVideo-iframe\" style=\"border:0; position: absolute; top: 0; left: 0; width: 100%; height: 100%; \" loading=\"eager\" allowfullscreen=\"\" sandbox=\"allow-same-origin allow-scripts allow-popups\"></iframe> </div> </div></p>\n<h2 id=\"selecao-de-fases\" style=\"position:relative;\"><a href=\"#selecao-de-fases\" aria-label=\"selecao de fases permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Sele√ß√£o de Fases</h2>\n<p>Para facilitar o teste de novas fases, eu decidi adicionar uma tela de sele√ß√£o de est√°gio b√°sica, para que eu pudesse testar v√°rias fases no mesmo build ao inv√©s de ficar alterando o mesmo arquivo de fase toda a hora. Agora, sempre que adiciono um novo arquivo de est√°gio √† pasta de fases, essa fase ser√° automaticamente inclu√≠da no bundle do jogo, gra√ßas a algumas configura√ß√µes personalizadas no Webpack.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> CopyWebpackPlugin <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'copy-webpack-plugin'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">promises</span><span class=\"token operator\">:</span> fs <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'fs'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">const</span> stageFiles <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> fs<span class=\"token punctuation\">.</span><span class=\"token function\">readdir</span><span class=\"token punctuation\">(</span><span class=\"token constant\">STAGES_PATH</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token comment\">// get only the JSON files</span>\r\n<span class=\"token keyword\">const</span> stageJsons <span class=\"token operator\">=</span> stageFiles\r\n    <span class=\"token punctuation\">.</span><span class=\"token function\">filter</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">stage</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> stage<span class=\"token punctuation\">.</span><span class=\"token function\">split</span><span class=\"token punctuation\">(</span><span class=\"token string\">'.'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">===</span> <span class=\"token string\">'json'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">const</span> <span class=\"token constant\">GAME_STAGES</span> <span class=\"token operator\">=</span> <span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">stringify</span><span class=\"token punctuation\">(</span>\r\n    stageJsons<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">stage</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token comment\">// eslint-disable-next-line import/no-dynamic-require</span>\r\n        <span class=\"token keyword\">const</span> stageData <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token constant\">STAGES_PATH</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">/</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>stage<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token keyword\">const</span> stageName <span class=\"token operator\">=</span> <span class=\"token function\">getStageNameFromMap</span><span class=\"token punctuation\">(</span>stageData<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n        <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span>\r\n            stageName<span class=\"token punctuation\">,</span>\r\n            <span class=\"token literal-property property\">stageKey</span><span class=\"token operator\">:</span> stage<span class=\"token punctuation\">.</span><span class=\"token function\">split</span><span class=\"token punctuation\">(</span><span class=\"token string\">'.'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\r\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\nmodule<span class=\"token punctuation\">.</span>exports <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token literal-property property\">plugins</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\r\n        <span class=\"token keyword\">new</span> <span class=\"token class-name\">webpack<span class=\"token punctuation\">.</span>DefinePlugin</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\r\n            <span class=\"token constant\">GAME_STAGES</span><span class=\"token punctuation\">,</span>\r\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\r\n    <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\r\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Na scene de sele√ß√£o de fases, voc√™ pode acessar os dados de fases na vari√°vel <code class=\"language-text\">GAME_STAGES</code>, ent√£o eu fa√ßo um loop por esses dados das fases e crio um seletor de fases.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">let</span> posX <span class=\"token operator\">=</span> <span class=\"token number\">20</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">let</span> posY <span class=\"token operator\">=</span> <span class=\"token number\">50</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token constant\">GAME_STAGES</span><span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">stageData<span class=\"token punctuation\">,</span> index</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> stageKey<span class=\"token punctuation\">,</span> stageName <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> stageData<span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">const</span> stageSelector <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">StageSelector</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\r\n        <span class=\"token literal-property property\">scene</span><span class=\"token operator\">:</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">,</span>\r\n        <span class=\"token literal-property property\">x</span><span class=\"token operator\">:</span> posX<span class=\"token punctuation\">,</span>\r\n        <span class=\"token literal-property property\">y</span><span class=\"token operator\">:</span> posY<span class=\"token punctuation\">,</span>\r\n        stageKey<span class=\"token punctuation\">,</span>\r\n        stageName<span class=\"token punctuation\">,</span>\r\n        <span class=\"token function-variable function\">onClickCallback</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">data</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n            <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>scene<span class=\"token punctuation\">.</span><span class=\"token function\">start</span><span class=\"token punctuation\">(</span><span class=\"token string\">'GameScene'</span><span class=\"token punctuation\">,</span> data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\r\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">.</span><span class=\"token function\">text</span><span class=\"token punctuation\">(</span>\r\n        posX <span class=\"token operator\">+</span> <span class=\"token number\">8</span><span class=\"token punctuation\">,</span>\r\n        posY <span class=\"token operator\">+</span> <span class=\"token number\">8</span><span class=\"token punctuation\">,</span>\r\n        <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>index <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">.</span><span class=\"token function\">padStart</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'0'</span><span class=\"token punctuation\">)</span>\r\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">setDepth</span><span class=\"token punctuation\">(</span><span class=\"token number\">50</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">.</span><span class=\"token function\">existing</span><span class=\"token punctuation\">(</span>stageSelector<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    stageSelectors<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span>stageSelector<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n    posX <span class=\"token operator\">+=</span> <span class=\"token number\">52</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>index <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">%</span> <span class=\"token number\">7</span> <span class=\"token operator\">===</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n        posY <span class=\"token operator\">+=</span> <span class=\"token number\">52</span><span class=\"token punctuation\">;</span>\r\n        posX <span class=\"token operator\">=</span> <span class=\"token number\">20</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span>\r\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h2 id=\"parallax-effect\" style=\"position:relative;\"><a href=\"#parallax-effect\" aria-label=\"parallax effect permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Parallax Effect</h2>\n<p>O jogo n√£o estaria completo sem um bom parallax effect, e para conseguir isso eu decidi adicionar algumas propriedades personalizadas √†s layers do Tiled e acesso elas na fun√ß√£o update da game scene.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token function\">update</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">time<span class=\"token punctuation\">,</span> delta</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> dynamicLayers <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>mapData<span class=\"token punctuation\">;</span>\r\n    Object<span class=\"token punctuation\">.</span><span class=\"token function\">values</span><span class=\"token punctuation\">(</span>dynamicLayers<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">dynamicLayer</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n        dynamicLayer<span class=\"token punctuation\">.</span>layer<span class=\"token punctuation\">.</span>properties<span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">property</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n            <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> name<span class=\"token punctuation\">,</span> value <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> property<span class=\"token punctuation\">;</span>\r\n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>value <span class=\"token operator\">!==</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n                <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>name <span class=\"token operator\">===</span> <span class=\"token string\">'parallaxSpeedX'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n                    dynamicLayer<span class=\"token punctuation\">.</span><span class=\"token function\">setX</span><span class=\"token punctuation\">(</span>\r\n                        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>cameras<span class=\"token punctuation\">.</span>main<span class=\"token punctuation\">.</span>scrollX <span class=\"token operator\">*</span> value\r\n                    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>name <span class=\"token operator\">===</span> <span class=\"token string\">'parallaxSpeedY'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n                    dynamicLayer<span class=\"token punctuation\">.</span><span class=\"token function\">setY</span><span class=\"token punctuation\">(</span>\r\n                        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>cameras<span class=\"token punctuation\">.</span>main<span class=\"token punctuation\">.</span>scrollY <span class=\"token operator\">*</span> value\r\n                    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                <span class=\"token punctuation\">}</span>\r\n            <span class=\"token punctuation\">}</span>\r\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Obs: Depois de escrever esse post, eu descobri a fun√ß√£o <a href=\"https://photonstorm.github.io/phaser3-docs/Phaser.GameObjects.Components.ScrollFactor.html#setScrollFactor\" target=\"_blank\" rel=\"noreferrer\">setScrollFactor</a> e com ela √© poss√≠vel definir um atributo direto na layer ao inv√©s de fazer um loop na fun√ß√£o update.</p>\n<h2 id=\"descendo-de-plataformas\" style=\"position:relative;\"><a href=\"#descendo-de-plataformas\" aria-label=\"descendo de plataformas permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Descendo de Plataformas</h2>\n<p>Para fazer isso eu pesquisei um pouco, e acabei fazendo de um jeito que √© meio que uma gambiarra, mas funciona por enquanto, ent√£o decidi seguir em frente.</p>\n<p>Primeiro eu verifico se o hero est√° no ch√£o, se h√° um elemento encostando no hero por baixo e se o bot√£o para baixo est√° sendo pressionado. Caso positivo, desabilitamos a colis√£o do baixo do hero por 150 milissegundos.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">// Handle hero going down through element</span>\r\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>\r\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">isHeroOnGround</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\r\n    <span class=\"token operator\">&amp;&amp;</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">isDownJustDown</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\r\n    <span class=\"token operator\">&amp;&amp;</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>touchingDownObject\r\n<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span>checkCollision<span class=\"token punctuation\">.</span>down <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>scene<span class=\"token punctuation\">.</span>time<span class=\"token punctuation\">.</span><span class=\"token function\">delayedCall</span><span class=\"token punctuation\">(</span>\r\n        <span class=\"token number\">150</span><span class=\"token punctuation\">,</span>\r\n        <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n            <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span>checkCollision<span class=\"token punctuation\">.</span>down <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token punctuation\">}</span>\r\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Isso √© bastante simples, mas como podemos acessar o atributo <code class=\"language-text\">this.touchingDownObject</code>? Bom, essa √© a maior parte da gambiarra dessa solu√ß√£o. Primeiro, precisamos adicionar um collider entre o hero e a layer do mapa com uma fun√ß√£o de callback que ir√° verificar algumas coisas e definir o atributo <code class=\"language-text\">this.touchingDownObject</code> para o hero.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>physics<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">.</span><span class=\"token function\">collider</span><span class=\"token punctuation\">(</span>\r\n    dynamicLayers<span class=\"token punctuation\">.</span>ground<span class=\"token punctuation\">,</span>\r\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>hero<span class=\"token punctuation\">,</span>\r\n    <span class=\"token punctuation\">(</span><span class=\"token parameter\">objectA<span class=\"token punctuation\">,</span> objectB</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>hero<span class=\"token punctuation\">,</span> element<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">getHeroAndObject</span><span class=\"token punctuation\">(</span>objectA<span class=\"token punctuation\">,</span> objectB<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>\r\n            hero<span class=\"token punctuation\">.</span><span class=\"token function\">isHeroOnGround</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\r\n            <span class=\"token operator\">&amp;&amp;</span> element<span class=\"token punctuation\">.</span>properties<span class=\"token punctuation\">.</span>collidesUp\r\n            <span class=\"token operator\">&amp;&amp;</span> element<span class=\"token punctuation\">.</span>properties<span class=\"token punctuation\">.</span>canFallThrough\r\n        <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n            hero<span class=\"token punctuation\">.</span>touchingDownObject <span class=\"token operator\">=</span> element<span class=\"token punctuation\">;</span> <span class=\"token comment\">// TODO?</span>\r\n        <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\r\n            hero<span class=\"token punctuation\">.</span>touchingDownObject <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token punctuation\">}</span>\r\n    <span class=\"token punctuation\">}</span>\r\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>E √© isso a√≠! Espero que tenham gostado e n√£o esque√ßam de deixar um coment√°rio se acharam post √∫til.</p>","fields":{"postHashId":"Z2FtZXN0cnVlbnVsbDIwMjAtMTAtMDFUMDA6MDA6MDAuMDAwWg==","slug":"/2020/2020-01-10-descendo-de-plataformas-com-arcade-physics-do-phaser-js-skate-platformer-game-devlog-6.pt-br/","path":"/blog/games/descendo-de-plataformas-com-arcade-physics-do-phaser-js-skate-platformer-game-devlog-6/","locale":"pt-br"},"rawMarkdownBody":"Fala pessoal! O Game Devlog dessa semana √© um pouco longo, 15 minutos, mas vale a pena assistir, pois, tem muitas coisas interessantes sobre o jogo.\r\n\r\n`youtube: https://www.youtube.com/watch?v=dUNkwPYmzb4`\r\n\r\n## Sele√ß√£o de Fases\r\n\r\nPara facilitar o teste de novas fases, eu decidi adicionar uma tela de sele√ß√£o de est√°gio b√°sica, para que eu pudesse testar v√°rias fases no mesmo build ao inv√©s de ficar alterando o mesmo arquivo de fase toda a hora. Agora, sempre que adiciono um novo arquivo de est√°gio √† pasta de fases, essa fase ser√° automaticamente inclu√≠da no bundle do jogo, gra√ßas a algumas configura√ß√µes personalizadas no Webpack.\r\n\r\n```javascript\r\nconst CopyWebpackPlugin = require('copy-webpack-plugin');\r\nconst { promises: fs } = require('fs');\r\nconst stageFiles = await fs.readdir(STAGES_PATH);\r\n// get only the JSON files\r\nconst stageJsons = stageFiles\r\n    .filter((stage) => stage.split('.')[1] === 'json');\r\nconst GAME_STAGES = JSON.stringify(\r\n    stageJsons.map((stage) => {\r\n        // eslint-disable-next-line import/no-dynamic-require\r\n        const stageData = require(`${STAGES_PATH}/${stage}`);\r\n        const stageName = getStageNameFromMap(stageData);\r\n\r\n        return {\r\n            stageName,\r\n            stageKey: stage.split('.')[0],\r\n        };\r\n    })\r\n);\r\n\r\nmodule.exports = {\r\n    plugins: [\r\n        new webpack.DefinePlugin({\r\n            GAME_STAGES,\r\n        }),\r\n    ],\r\n};\r\n```\r\n\r\nNa scene de sele√ß√£o de fases, voc√™ pode acessar os dados de fases na vari√°vel `GAME_STAGES`, ent√£o eu fa√ßo um loop por esses dados das fases e crio um seletor de fases.\r\n\r\n```javascript\r\nlet posX = 20;\r\nlet posY = 50;\r\nGAME_STAGES.forEach((stageData, index) => {\r\n    const { stageKey, stageName } = stageData;\r\n    const stageSelector = new StageSelector({\r\n        scene: this,\r\n        x: posX,\r\n        y: posY,\r\n        stageKey,\r\n        stageName,\r\n        onClickCallback: (data) => {\r\n            this.scene.start('GameScene', data);\r\n        },\r\n    });\r\n\r\n    this.add.text(\r\n        posX + 8,\r\n        posY + 8,\r\n        `${index + 1}`.padStart(2, '0')\r\n    ).setDepth(50);\r\n\r\n    this.add.existing(stageSelector);\r\n    stageSelectors.add(stageSelector);\r\n\r\n    posX += 52;\r\n    if ((index + 1) % 7 === 0) {\r\n        posY += 52;\r\n        posX = 20;\r\n    }\r\n});\r\n```\r\n\r\n## Parallax Effect\r\n\r\nO jogo n√£o estaria completo sem um bom parallax effect, e para conseguir isso eu decidi adicionar algumas propriedades personalizadas √†s layers do Tiled e acesso elas na fun√ß√£o update da game scene.\r\n\r\n```javascript\r\nupdate(time, delta) {\r\n    const { dynamicLayers } = this.mapData;\r\n    Object.values(dynamicLayers).forEach((dynamicLayer) => {\r\n        dynamicLayer.layer.properties.forEach((property) => {\r\n            const { name, value } = property;\r\n            if (value !== 1) {\r\n                if (name === 'parallaxSpeedX') {\r\n                    dynamicLayer.setX(\r\n                        this.cameras.main.scrollX * value\r\n                    );\r\n                } else if (name === 'parallaxSpeedY') {\r\n                    dynamicLayer.setY(\r\n                        this.cameras.main.scrollY * value\r\n                    );\r\n                }\r\n            }\r\n        });\r\n    });\r\n}\r\n```\r\n\r\nObs: Depois de escrever esse post, eu descobri a fun√ß√£o [setScrollFactor](https://photonstorm.github.io/phaser3-docs/Phaser.GameObjects.Components.ScrollFactor.html#setScrollFactor) e com ela √© poss√≠vel definir um atributo direto na layer ao inv√©s de fazer um loop na fun√ß√£o update.\r\n\r\n## Descendo de Plataformas\r\n\r\nPara fazer isso eu pesquisei um pouco, e acabei fazendo de um jeito que √© meio que uma gambiarra, mas funciona por enquanto, ent√£o decidi seguir em frente.\r\n\r\nPrimeiro eu verifico se o hero est√° no ch√£o, se h√° um elemento encostando no hero por baixo e se o bot√£o para baixo est√° sendo pressionado. Caso positivo, desabilitamos a colis√£o do baixo do hero por 150 milissegundos.\r\n\r\n```javascript\r\n// Handle hero going down through element\r\nif (\r\n    this.isHeroOnGround()\r\n    && this.isDownJustDown()\r\n    && this.touchingDownObject\r\n) {\r\n    this.body.checkCollision.down = false;\r\n    this.scene.time.delayedCall(\r\n        150,\r\n        () => {\r\n            this.body.checkCollision.down = true;\r\n        }\r\n    );\r\n}\r\n```\r\n\r\nIsso √© bastante simples, mas como podemos acessar o atributo `this.touchingDownObject`? Bom, essa √© a maior parte da gambiarra dessa solu√ß√£o. Primeiro, precisamos adicionar um collider entre o hero e a layer do mapa com uma fun√ß√£o de callback que ir√° verificar algumas coisas e definir o atributo `this.touchingDownObject` para o hero.\r\n\r\n```javascript\r\nthis.physics.add.collider(\r\n    dynamicLayers.ground,\r\n    this.hero,\r\n    (objectA, objectB) => {\r\n        const [hero, element] = this.getHeroAndObject(objectA, objectB);\r\n\r\n        if (\r\n            hero.isHeroOnGround()\r\n            && element.properties.collidesUp\r\n            && element.properties.canFallThrough\r\n        ) {\r\n            hero.touchingDownObject = element; // TODO?\r\n        } else {\r\n            hero.touchingDownObject = null;\r\n        }\r\n    }\r\n);\r\n```\r\n\r\nE √© isso a√≠! Espero que tenham gostado e n√£o esque√ßam de deixar um coment√°rio se acharam post √∫til.\r\n","frontmatter":{"tags":["programa√ß√£o","jogos","javascript","phaser","phaser 3","game devlog","gamedev","skate platformer","super ollie vs pebble corp","webpack","tiled"],"categories":["games"],"allowComments":true,"publishOnMedium":false,"cover":null,"date":"2020-10-01T00:00:00.000Z","id":null,"path":"descendo-de-plataformas-com-arcade-physics-do-phaser-js-skate-platformer-game-devlog-6","show":true,"title":"Descendo de plataformas com Arcade Physics do Phaser JS - Skate Platformer Game Devlog #06","hideExcerpt":false,"subtitle":""}}},{"node":{"excerpt":"Hey guys! Today‚Äôs Game Devlog is a bit long, 15 minutes, but‚Ä¶","html":"<p>Hey guys! Today‚Äôs Game Devlog is a bit long, 15 minutes, but bare with me because there are a lot of interesting things going on in the game.</p>\n<p><div class=\"gatsby-resp-iframe-wrapper\" style=\"padding-bottom: 56.42857142857143%; position: relative; height: 0; overflow: hidden; margin-bottom: 1.0725rem\" > <div class=\"embedVideo-container\"> <iframe title=\"\" src=\"https://www.youtube.com/embed/dUNkwPYmzb4?rel=0\" class=\"embedVideo-iframe\" style=\"border:0; position: absolute; top: 0; left: 0; width: 100%; height: 100%; \" loading=\"eager\" allowfullscreen=\"\" sandbox=\"allow-same-origin allow-scripts allow-popups\"></iframe> </div> </div></p>\n<h2 id=\"stage-selection\" style=\"position:relative;\"><a href=\"#stage-selection\" aria-label=\"stage selection permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Stage Selection</h2>\n<p>To facilitate testing new stages, I decided to add a basic stage selection for the game, so I could test multiple stages in the same build instead of having to change a single file every time. Now whenever I add a new stage file to the stages folder, that stage will automatically be included in the game bundle, thanks to some custom Webpack settings.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> CopyWebpackPlugin <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'copy-webpack-plugin'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">promises</span><span class=\"token operator\">:</span> fs <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'fs'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">const</span> stageFiles <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> fs<span class=\"token punctuation\">.</span><span class=\"token function\">readdir</span><span class=\"token punctuation\">(</span><span class=\"token constant\">STAGES_PATH</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token comment\">// get only the JSON files</span>\r\n<span class=\"token keyword\">const</span> stageJsons <span class=\"token operator\">=</span> stageFiles\r\n    <span class=\"token punctuation\">.</span><span class=\"token function\">filter</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">stage</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> stage<span class=\"token punctuation\">.</span><span class=\"token function\">split</span><span class=\"token punctuation\">(</span><span class=\"token string\">'.'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">===</span> <span class=\"token string\">'json'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">const</span> <span class=\"token constant\">GAME_STAGES</span> <span class=\"token operator\">=</span> <span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">stringify</span><span class=\"token punctuation\">(</span>\r\n    stageJsons<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">stage</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token comment\">// eslint-disable-next-line import/no-dynamic-require</span>\r\n        <span class=\"token keyword\">const</span> stageData <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token constant\">STAGES_PATH</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">/</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>stage<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token keyword\">const</span> stageName <span class=\"token operator\">=</span> <span class=\"token function\">getStageNameFromMap</span><span class=\"token punctuation\">(</span>stageData<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n        <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span>\r\n            stageName<span class=\"token punctuation\">,</span>\r\n            <span class=\"token literal-property property\">stageKey</span><span class=\"token operator\">:</span> stage<span class=\"token punctuation\">.</span><span class=\"token function\">split</span><span class=\"token punctuation\">(</span><span class=\"token string\">'.'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\r\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\nmodule<span class=\"token punctuation\">.</span>exports <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token literal-property property\">plugins</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\r\n        <span class=\"token keyword\">new</span> <span class=\"token class-name\">webpack<span class=\"token punctuation\">.</span>DefinePlugin</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\r\n            <span class=\"token constant\">GAME_STAGES</span><span class=\"token punctuation\">,</span>\r\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\r\n    <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\r\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Then in the stage selection scene, you can access the stages via the <code class=\"language-text\">GAME_STAGES</code> constant, so I loop through the stages data and create the stage selector game object.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">let</span> posX <span class=\"token operator\">=</span> <span class=\"token number\">20</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">let</span> posY <span class=\"token operator\">=</span> <span class=\"token number\">50</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token constant\">GAME_STAGES</span><span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">stageData<span class=\"token punctuation\">,</span> index</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> stageKey<span class=\"token punctuation\">,</span> stageName <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> stageData<span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">const</span> stageSelector <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">StageSelector</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\r\n        <span class=\"token literal-property property\">scene</span><span class=\"token operator\">:</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">,</span>\r\n        <span class=\"token literal-property property\">x</span><span class=\"token operator\">:</span> posX<span class=\"token punctuation\">,</span>\r\n        <span class=\"token literal-property property\">y</span><span class=\"token operator\">:</span> posY<span class=\"token punctuation\">,</span>\r\n        stageKey<span class=\"token punctuation\">,</span>\r\n        stageName<span class=\"token punctuation\">,</span>\r\n        <span class=\"token function-variable function\">onClickCallback</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">data</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n            <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>scene<span class=\"token punctuation\">.</span><span class=\"token function\">start</span><span class=\"token punctuation\">(</span><span class=\"token string\">'GameScene'</span><span class=\"token punctuation\">,</span> data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\r\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">.</span><span class=\"token function\">text</span><span class=\"token punctuation\">(</span>\r\n        posX <span class=\"token operator\">+</span> <span class=\"token number\">8</span><span class=\"token punctuation\">,</span>\r\n        posY <span class=\"token operator\">+</span> <span class=\"token number\">8</span><span class=\"token punctuation\">,</span>\r\n        <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>index <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">.</span><span class=\"token function\">padStart</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'0'</span><span class=\"token punctuation\">)</span>\r\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">setDepth</span><span class=\"token punctuation\">(</span><span class=\"token number\">50</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">.</span><span class=\"token function\">existing</span><span class=\"token punctuation\">(</span>stageSelector<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    stageSelectors<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span>stageSelector<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n    posX <span class=\"token operator\">+=</span> <span class=\"token number\">52</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>index <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">%</span> <span class=\"token number\">7</span> <span class=\"token operator\">===</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n        posY <span class=\"token operator\">+=</span> <span class=\"token number\">52</span><span class=\"token punctuation\">;</span>\r\n        posX <span class=\"token operator\">=</span> <span class=\"token number\">20</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span>\r\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h2 id=\"parallax-effect\" style=\"position:relative;\"><a href=\"#parallax-effect\" aria-label=\"parallax effect permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Parallax Effect</h2>\n<p>The game wouldn‚Äôt be complete without a nice parallax effect, and to achieve that I decided to add some custom properties to the layers on Tiled, and read them in my scene‚Äôs update function to make the layer current position X or Y move accordingly with the camera movement.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token function\">update</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">time<span class=\"token punctuation\">,</span> delta</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> dynamicLayers <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>mapData<span class=\"token punctuation\">;</span>\r\n    Object<span class=\"token punctuation\">.</span><span class=\"token function\">values</span><span class=\"token punctuation\">(</span>dynamicLayers<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">dynamicLayer</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n        dynamicLayer<span class=\"token punctuation\">.</span>layer<span class=\"token punctuation\">.</span>properties<span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">property</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n            <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> name<span class=\"token punctuation\">,</span> value <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> property<span class=\"token punctuation\">;</span>\r\n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>value <span class=\"token operator\">!==</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n                <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>name <span class=\"token operator\">===</span> <span class=\"token string\">'parallaxSpeedX'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n                    dynamicLayer<span class=\"token punctuation\">.</span><span class=\"token function\">setX</span><span class=\"token punctuation\">(</span>\r\n                        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>cameras<span class=\"token punctuation\">.</span>main<span class=\"token punctuation\">.</span>scrollX <span class=\"token operator\">*</span> value\r\n                    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>name <span class=\"token operator\">===</span> <span class=\"token string\">'parallaxSpeedY'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n                    dynamicLayer<span class=\"token punctuation\">.</span><span class=\"token function\">setY</span><span class=\"token punctuation\">(</span>\r\n                        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>cameras<span class=\"token punctuation\">.</span>main<span class=\"token punctuation\">.</span>scrollY <span class=\"token operator\">*</span> value\r\n                    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                <span class=\"token punctuation\">}</span>\r\n            <span class=\"token punctuation\">}</span>\r\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Note: After writing this post, I found out about the <a href=\"https://photonstorm.github.io/phaser3-docs/Phaser.GameObjects.Components.ScrollFactor.html#setScrollFactor\" target=\"_blank\" rel=\"noreferrer\">setScrollFactor</a> function, so I can use that instead, which takes way less processing power than looping in the update function.</p>\n<h2 id=\"falling-off-platforms\" style=\"position:relative;\"><a href=\"#falling-off-platforms\" aria-label=\"falling off platforms permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Falling Off Platforms</h2>\n<p>To make this I did a bit of researching, and the way it‚Äôs done is a bit hacky, but it works for now, so I decided to just roll with it.</p>\n<p>First I check if the hero is in the ground, if there is an element the hero from below and if the down button is pressed. If so, then we disable the player bottom collision for 150 milliseconds.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">// Handle hero going down through element</span>\r\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>\r\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">isHeroOnGround</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\r\n    <span class=\"token operator\">&amp;&amp;</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">isDownJustDown</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\r\n    <span class=\"token operator\">&amp;&amp;</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>touchingDownObject\r\n<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span>checkCollision<span class=\"token punctuation\">.</span>down <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>scene<span class=\"token punctuation\">.</span>time<span class=\"token punctuation\">.</span><span class=\"token function\">delayedCall</span><span class=\"token punctuation\">(</span>\r\n        <span class=\"token number\">150</span><span class=\"token punctuation\">,</span>\r\n        <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n            <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span>checkCollision<span class=\"token punctuation\">.</span>down <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token punctuation\">}</span>\r\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>This is pretty straight forward, but how can we access the <code class=\"language-text\">this.touchingDownObject</code> attribute? Well that‚Äôs the biggest hacky part of this solution. First, we need to add a collider between the hero and the map layer with a callback that will check some stuff and set the <code class=\"language-text\">this.touchingDownObject</code> attribute for the hero.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>physics<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">.</span><span class=\"token function\">collider</span><span class=\"token punctuation\">(</span>\r\n    dynamicLayers<span class=\"token punctuation\">.</span>ground<span class=\"token punctuation\">,</span>\r\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>hero<span class=\"token punctuation\">,</span>\r\n    <span class=\"token punctuation\">(</span><span class=\"token parameter\">objectA<span class=\"token punctuation\">,</span> objectB</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>hero<span class=\"token punctuation\">,</span> element<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">getHeroAndObject</span><span class=\"token punctuation\">(</span>objectA<span class=\"token punctuation\">,</span> objectB<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>\r\n            hero<span class=\"token punctuation\">.</span><span class=\"token function\">isHeroOnGround</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\r\n            <span class=\"token operator\">&amp;&amp;</span> element<span class=\"token punctuation\">.</span>properties<span class=\"token punctuation\">.</span>collidesUp\r\n            <span class=\"token operator\">&amp;&amp;</span> element<span class=\"token punctuation\">.</span>properties<span class=\"token punctuation\">.</span>canFallThrough\r\n        <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n            hero<span class=\"token punctuation\">.</span>touchingDownObject <span class=\"token operator\">=</span> element<span class=\"token punctuation\">;</span> <span class=\"token comment\">// TODO?</span>\r\n        <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\r\n            hero<span class=\"token punctuation\">.</span>touchingDownObject <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token punctuation\">}</span>\r\n    <span class=\"token punctuation\">}</span>\r\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>That‚Äôs it! I hope you guys enjoyed it and don‚Äôt forget to leave your comment if you liked this post.</p>","fields":{"postHashId":"Z2FtZXN0cnVlbnVsbDIwMjAtMTAtMDFUMDA6MDA6MDAuMDAwWg==","slug":"/2020/2020-01-10-falling-off-platforms-with-arcade-physics-on-phaser-js-skate-platformer-game-devlog-6.en/","path":"/blog/games/falling-off-platforms-with-arcade-physics-on-phaser-js-skate-platformer-game-devlog-6/","locale":"en"},"rawMarkdownBody":"Hey guys! Today's Game Devlog is a bit long, 15 minutes, but bare with me because there are a lot of interesting things going on in the game.\r\n\r\n`youtube: https://www.youtube.com/watch?v=dUNkwPYmzb4`\r\n\r\n## Stage Selection\r\n\r\nTo facilitate testing new stages, I decided to add a basic stage selection for the game, so I could test multiple stages in the same build instead of having to change a single file every time. Now whenever I add a new stage file to the stages folder, that stage will automatically be included in the game bundle, thanks to some custom Webpack settings.\r\n\r\n```javascript\r\nconst CopyWebpackPlugin = require('copy-webpack-plugin');\r\nconst { promises: fs } = require('fs');\r\nconst stageFiles = await fs.readdir(STAGES_PATH);\r\n// get only the JSON files\r\nconst stageJsons = stageFiles\r\n    .filter((stage) => stage.split('.')[1] === 'json');\r\nconst GAME_STAGES = JSON.stringify(\r\n    stageJsons.map((stage) => {\r\n        // eslint-disable-next-line import/no-dynamic-require\r\n        const stageData = require(`${STAGES_PATH}/${stage}`);\r\n        const stageName = getStageNameFromMap(stageData);\r\n\r\n        return {\r\n            stageName,\r\n            stageKey: stage.split('.')[0],\r\n        };\r\n    })\r\n);\r\n\r\nmodule.exports = {\r\n    plugins: [\r\n        new webpack.DefinePlugin({\r\n            GAME_STAGES,\r\n        }),\r\n    ],\r\n};\r\n```\r\n\r\nThen in the stage selection scene, you can access the stages via the `GAME_STAGES` constant, so I loop through the stages data and create the stage selector game object.\r\n\r\n```javascript\r\nlet posX = 20;\r\nlet posY = 50;\r\nGAME_STAGES.forEach((stageData, index) => {\r\n    const { stageKey, stageName } = stageData;\r\n    const stageSelector = new StageSelector({\r\n        scene: this,\r\n        x: posX,\r\n        y: posY,\r\n        stageKey,\r\n        stageName,\r\n        onClickCallback: (data) => {\r\n            this.scene.start('GameScene', data);\r\n        },\r\n    });\r\n\r\n    this.add.text(\r\n        posX + 8,\r\n        posY + 8,\r\n        `${index + 1}`.padStart(2, '0')\r\n    ).setDepth(50);\r\n\r\n    this.add.existing(stageSelector);\r\n    stageSelectors.add(stageSelector);\r\n\r\n    posX += 52;\r\n    if ((index + 1) % 7 === 0) {\r\n        posY += 52;\r\n        posX = 20;\r\n    }\r\n});\r\n```\r\n\r\n## Parallax Effect\r\n\r\nThe game wouldn't be complete without a nice parallax effect, and to achieve that I decided to add some custom properties to the layers on Tiled, and read them in my scene's update function to make the layer current position X or Y move accordingly with the camera movement.\r\n\r\n```javascript\r\nupdate(time, delta) {\r\n    const { dynamicLayers } = this.mapData;\r\n    Object.values(dynamicLayers).forEach((dynamicLayer) => {\r\n        dynamicLayer.layer.properties.forEach((property) => {\r\n            const { name, value } = property;\r\n            if (value !== 1) {\r\n                if (name === 'parallaxSpeedX') {\r\n                    dynamicLayer.setX(\r\n                        this.cameras.main.scrollX * value\r\n                    );\r\n                } else if (name === 'parallaxSpeedY') {\r\n                    dynamicLayer.setY(\r\n                        this.cameras.main.scrollY * value\r\n                    );\r\n                }\r\n            }\r\n        });\r\n    });\r\n}\r\n```\r\n\r\nNote: After writing this post, I found out about the [setScrollFactor](https://photonstorm.github.io/phaser3-docs/Phaser.GameObjects.Components.ScrollFactor.html#setScrollFactor) function, so I can use that instead, which takes way less processing power than looping in the update function.\r\n\r\n## Falling Off Platforms\r\n\r\nTo make this I did a bit of researching, and the way it's done is a bit hacky, but it works for now, so I decided to just roll with it.\r\n\r\nFirst I check if the hero is in the ground, if there is an element the hero from below and if the down button is pressed. If so, then we disable the player bottom collision for 150 milliseconds.\r\n\r\n```javascript\r\n// Handle hero going down through element\r\nif (\r\n    this.isHeroOnGround()\r\n    && this.isDownJustDown()\r\n    && this.touchingDownObject\r\n) {\r\n    this.body.checkCollision.down = false;\r\n    this.scene.time.delayedCall(\r\n        150,\r\n        () => {\r\n            this.body.checkCollision.down = true;\r\n        }\r\n    );\r\n}\r\n```\r\n\r\nThis is pretty straight forward, but how can we access the `this.touchingDownObject` attribute? Well that's the biggest hacky part of this solution. First, we need to add a collider between the hero and the map layer with a callback that will check some stuff and set the `this.touchingDownObject` attribute for the hero.\r\n\r\n```javascript\r\nthis.physics.add.collider(\r\n    dynamicLayers.ground,\r\n    this.hero,\r\n    (objectA, objectB) => {\r\n        const [hero, element] = this.getHeroAndObject(objectA, objectB);\r\n\r\n        if (\r\n            hero.isHeroOnGround()\r\n            && element.properties.collidesUp\r\n            && element.properties.canFallThrough\r\n        ) {\r\n            hero.touchingDownObject = element; // TODO?\r\n        } else {\r\n            hero.touchingDownObject = null;\r\n        }\r\n    }\r\n);\r\n```\r\n\r\nThat's it! I hope you guys enjoyed it and don't forget to leave your comment if you liked this post.\r\n","frontmatter":{"tags":["coding","games","javascript","phaser","phaser 3","game devlog","gamedev","skate platformer","super ollie vs pebble corp","webpack","tiled"],"categories":["games"],"allowComments":true,"publishOnMedium":false,"cover":null,"date":"2020-10-01T00:00:00.000Z","id":null,"path":"falling-off-platforms-with-arcade-physics-on-phaser-js-skate-platformer-game-devlog-6","show":true,"title":"Falling off platforms with Arcade Physics on Phaser JS - Skate Platformer Game Devlog #06","hideExcerpt":false,"subtitle":""}}}],"language":"en","intl":{"language":"en","languages":["en","pt-br"],"messages":{"site_title":"pablo.gg","title":"Title","author":"@thepiratepablo","search_placeholder":"Search...","about":"About","photos":"Photos","archive":"Archive","contact":"Contact","close":"Close","contact_page":"Contact page","see_more":"See more posts","built_with":"Built with ","buy_me_a_soda":"Buy me a soda","blog":"Blog","blog_posts":"Blog posts","go_to_post":"Go to post","search":"Search","loading":"Loading...","search_results":"Search results","search_results_for":"{quantity} search results for: \"{query}\"","search_for_query":"Search for \"{query}\"","no_results":"No results","home":"Home","description":"Yet another developer personal blog","go_back":"Go back to the homepage","thats_me":"That's me!","got_it":"Got it!","check_it_out":"Check it out!","we_are":"We are","e3":"E3","away_from_next_sgf":"away from Summer Game Fest 2025","away_from_next_gamescom":"away from Gamescom 2024","sgf_countdown":"Summer Game Fest Countdown","gamescom_countdown":"Gamescom Countdown","e3_paragraph_1":"This page once featured a countdown to the next E3 event, a moment that countless gamers and industry professionals looked forward to each year. E3 was not just an event; it was a celebration of our shared passion for video games, a place where dreams were realized, and memories were made.","e3_paragraph_2":"From the electrifying announcements to the hands-on demos, E3 was the heartbeat of the gaming world. It brought together people from all corners of the globe, united by their love for games. For many, it was a chance to meet their heroes, discover new titles, and experience the thrill of the latest innovations in gaming technology.","e3_paragraph_3":"However, as the gaming landscape has evolved, so too has the way we connect and celebrate our passion. While E3 has come to an end, the spirit of excitement and community it fostered lives on. We now look forward to new ways of coming together, sharing our love for games, and creating new memories.","e3_paragraph_4":"Though the countdown is gone, the legacy of E3 will forever remain in our hearts, reminding us of the incredible journeys we've taken and the bonds we've formed along the way.","sec":"Sec","secs":"Secs","min":"Min","mins":"Mins","hour":"Hour","hours":"Hours","day":"Day","days":"Days","month":"Month","months":"Months","year":"Year","years":"Years","recent_posts":"Recent posts","email":"Email","twitter":"Twitter","name":"Name","page":"Page","fill_this_want_reply":"Fill this in if you want me to contact you back","sorry_this_post_unavailable_language":"Sorry, this post is not available in the language you picked","language":"Language","comment":"Comment","comments":"Comments","no_comments":"No comments yet.","post_comment":"Post comment","send_message":"Send message","message":"Message","post_a_comment":"Post a comment","your_comment_submitted":"Your comment has been successfully submitted.","your_message_submitted":"Your message has been successfully submitted.","on":"on","ok":"Ok","copy":"Copy","copied":"Copied","photo_num":"Photo {num}","the_matrix_has_you":"The Matrix has you...","about_paragraph_1":"A technology enthusiast from an early age, I have always been interested in computers and video games.","about_paragraph_2":"I graduated in Information Technology at Est√°cio de S√° University and always try to find out about new technologies and get involved in new development projects, some of which the code can be found on GitHub.","cookie_banner_consent":"By using this website you agree to our use of cookies to deliver a better experience.","written_in":"Written in ","no_post_this_tag":"No post in English include this tag.","tags":"Tags","tag_colon":"Tag: ","tags_colon":"Tags: ","posts_tagged":"Posts tagged with ","categories":"Categories","category":"Category","category_colon":"Category: ","posts_on_category":"Posts on category ","related_posts":"Related posts","read_time":"üïí {time} min. read","create_post":"Create Post","show":"Show","date":"Date","download":"Download","add_tag":"Add Tag","hide_excerpt":"Hide Excerpt","publish_on_medium":"Publish on Medium","allow_comments":"Allow Comments","subtitle":"Subtitle","you_must_be_truly_desperate":"You must be truly desperate to come to me for help","game.game_title":"pablo.gg - The Game","game.next":"Next","game.ok":"Ok","game.loading_asset_colon":"Loading asset:","game.loading":"Loading...","game.characters.npc_01":"Frost","game.characters.npc_02":"Gavin","game.characters.npc_03":"Giles","game.characters.npc_04":"Godfrey","game.characters.npc_05":"Hugh","game.characters.npc_06":"Ivar","game.characters.npc_07":"Leopold","game.characters.npc_08":"Lucian","game.characters.npc_09":"Gumercindo","game.characters.npc_10":"Mr. Flower","game.characters.npc_11":"Maxim","game.characters.npc_12":"Milo","game.characters.npc_13":"Otto","game.characters.npc_14":"Palmer","game.characters.npc_15":"Quentin","game.characters.npc_16":"Sebastian","game.characters.npc_17":"Neville","game.characters.npc_18":"Cassian","game.characters.npc_19":"Balthasar","game.characters.sign_01":"Sign","game.characters.book_01":"Book","game.characters.home_page_city_sign":"Sign","game.characters.coding_category_city_sign_01":"Sign","game.characters.coding_category_city_sign_02":"Sign","game.characters.events_category_city_sign":"Sign","game.characters.funny_category_city_sign":"Sign","game.characters.gadgets_category_city_sign_01":"Sign","game.characters.gadgets_category_city_sign_02":"Sign","game.characters.games_category_city_sign":"Sign","game.characters.general_category_city_sign":"Sign","game.characters.tips_category_city_sign":"Sign","game.characters.toys_category_city_sign":"Sign","game.characters.sword":"Info","game.characters.push":"Info","game.gamepad.a_button":"A Button","game.gamepad.b_button":"B Button","game.gamepad.d_pad_left":"D-Pad Left","game.gamepad.d_pad_up":"D-Pad Up","game.gamepad.d_pad_right":"D-Pad Right","game.gamepad.d_pad_down":"D-Pad Down","game.gamepad.start_button":"Start Button","game.menu.start":"Start","game.menu.exit":"Exit","game.menu.settings":"Settings","game.game_over.game_over":"Game Over","game.game_over.retry":"Retry","game.game_over.exit":"Exit","game.start_menu.save_game":"Save Game","game.start_menu.exit":"Exit","game.browse_posts.choose_a_post":"Choose a Post to read","game.dialogs.npc_01.01":"Hey, you're finally awake!","game.dialogs.npc_01.02":"What, you don't know where you are?","game.dialogs.npc_01.03":"Don't be silly, you're at the Home Page City, remember?","game.dialogs.npc_01.04":"This city was founded by Pablo Montenegro to be the start of your journey","game.dialogs.npc_01.05":"Go explore the world and find other cities where you can read the accumulated knowledge of our civilization...","game.dialogs.npc_01.06":"... some people call it \"Blog Posts\", I don't know why...","game.dialogs.npc_02.01":"Be careful with the Slimes that live in the wild.","game.dialogs.npc_02.02":"Press SPACE to use your sword","game.dialogs.npc_02.03":"What is SPACE? I have no idea.","game.dialogs.npc_03.01":"Hello, welcome to our library","game.dialogs.npc_03.02":"We only have one book, which contains all of this city category publications.","game.dialogs.npc_03.03":"Go check it out!","game.dialogs.npc_04.01":"I like snails","game.dialogs.npc_05.01":"Incomplete sentences may cause some","game.dialogs.npc_06.01":"Red is greener than purple, for sure.","game.dialogs.npc_07.01":"Having a beard is the new not having a beard","game.dialogs.npc_08.01":"Sup","game.dialogs.npc_09.01":"\" - Cooper, what are you doing?\"\n\" - Docking.\"","game.dialogs.npc_10.01":"I should buy a boat","game.dialogs.npc_11.01":"Have you heard the me neither joke? Me neither.","game.dialogs.npc_12.01":"I clean toilet and rescue princesses, good life, yes?","game.dialogs.npc_13.01":"We want the airwaves back","game.dialogs.npc_14.01":"Save the cheerleader, save the world","game.dialogs.npc_15.01":"Hello, how are you?","game.dialogs.npc_15.02":"Ok bye!","game.dialogs.npc_16.01":"A kangaroo is really just a rabbit on steroids","game.dialogs.npc_17.01":"For the 216th time, he said he would quit drinking soda after this last Coke","game.dialogs.npc_18.01":"Nothing and everything is possimpible","game.dialogs.npc_19.01":"For a city called \"Events\", there isn't much going on...","game.dialogs.sign_01.01":"Congrats, you can read this!","game.dialogs.book_01.01":"Hey, thanks for trying out this very weird way to access my website","game.dialogs.book_01.02":"This project wouldn't be possible without the awesome open-source work of many people, like:","game.dialogs.book_01.03":"ArMM1998 - For the characters sprites and tilesets","game.dialogs.book_01.04":"PixElthen - For the slime sprites","game.dialogs.book_01.05":"pixelartm - For the pirate hat sprites","game.dialogs.book_01.06":"jkjkke - For the Game Over screen background","game.dialogs.book_01.07":"KnoblePersona - For the Main Menu screen background","game.dialogs.book_01.08":"Min - For the open book sprite","game.dialogs.book_01.09":"And of course, Richard Davey for making Phaser.io!","game.dialogs.home_page_city_sign":"City of Home Page","game.dialogs.coding_category_city_sign.01":"City of Coding Category","game.dialogs.coding_category_city_sign.02":"City of Coding Category","game.dialogs.events_category_city_sign":"City of Events Category","game.dialogs.funny_category_city_sign":"City of Funny Category","game.dialogs.gadgets_category_city_sign.01":"City of Gadgets Category","game.dialogs.gadgets_category_city_sign.02":"City of Gadgets Category","game.dialogs.games_category_city_sign":"City of Games Category","game.dialogs.general_category_city_sign":"City of General Category","game.dialogs.tips_category_city_sign":"City of Tips Category","game.dialogs.toys_category_city_sign":"City of Toys Category","game.dialogs.sword_item_description":"You can now attack, press SPACE to use your sword.","game.dialogs.push_item_description":"Now you can push some objects, press SPACE in front of a object to use push it.","zelda_timeline.title":"Zelda Timeline","zelda_timeline.timeline_split":"Timeline Split","zelda_timeline.timeline_unification":"Timeline Unification","zelda_timeline.icons_from":"The icons used on this page are from zeldauniverse.net and game-icons.net","zelda_timeline.creation":"Creation","zelda_timeline.creation_of_land_sky":"The Creation of the Land and Sky","zelda_timeline.goddess_hylia_and_sky_era":"Goddess Hylia and Sky Era","zelda_timeline.skyward_sword":"Skyward Sword","zelda_timeline.the_ancient_battle":"The Ancient Battle and the reincarnation of the Goddess Hylia","zelda_timeline.return_to_surface":"Return to the surface","zelda_timeline.era_of_chaos":"Era of Chaos","zelda_timeline.sacred_realm_sealed":"The Sacred Realm is Sealed","zelda_timeline.era_of_prosperity":"Era of Prosperity","zelda_timeline.establishment_of_hyrule":"The Hyrule Kingdom is established","zelda_timeline.force_era":"Force Era","zelda_timeline.the_minish_cap":"The Minish Cap","zelda_timeline.rise_of_evil_vaati":"The Rise of the Evil Vaati","zelda_timeline.four_swords":"Four Swords","zelda_timeline.resurrection_of_vaati":"The Resurrection of Vaati","zelda_timeline.era_of_the_hero_of_time":"Era of the Hero of Time","zelda_timeline.hyrulean_civil_war":"Hyrulean Civil War","zelda_timeline.ocarina_of_time":"Ocarina of Time","zelda_timeline.sacred_realm_becomes_dark_world":"The Sacred Realm Becomes the Dark World","zelda_timeline.ganondorf_becomes_ganon":"Ganondorf becomes Ganon","zelda_timeline.hero_is_defeated":"Hero is defeated","zelda_timeline.decline_of_last_hero":"The Decline of Hyrule and the Last Hero","zelda_timeline.the_imprisoning_war":"The Imprisoning War","zelda_timeline.era_of_dark_and_light":"Era of Light and Dark","zelda_timeline.a_link_to_the_past":"A Link to the Past","zelda_timeline.resurrection_of_ganon":"The Resurrection of Ganon","zelda_timeline.resurrection_of_ganon_is_prevented":"The Resurrection of Ganon is prevented","zelda_timeline.links_awakening":"Link's Awakening","zelda_timeline.oracle_of_ages_and_seasons":"Oracle of Ages and Oracle of Seasons","zelda_timeline.a_link_between_worlds":"A Link Between Worlds","zelda_timeline.tri_force_heroes":"Tri Force Heroes","zelda_timeline.the_gold_era":"The Gold Era","zelda_timeline.monarchs_of_hyrule_use_triforce":"The Monarchs of Hyrule Use the Triforce","zelda_timeline.era_of_decline":"The Era of Decline","zelda_timeline.tragedy_of_princess_zelda_1":"The Tragedy of Princess Zelda I","zelda_timeline.the_legend_of_zelda":"The Legend of Zelda","zelda_timeline.adventure_of_link":"Adventure of Link","zelda_timeline.hero_defeated":"Hero Defeated","zelda_timeline.child_era":"Child Era","zelda_timeline.adult_era":"Adult Era","zelda_timeline.sacred_realm_protected":"The Sacred Realm Remains Protected","zelda_timeline.twilight_realm_and_legacy_of_hero":"The Twilight Realm and the Legacy of the Hero","zelda_timeline.majoras_mask":"Majora's Mask","zelda_timeline.prince_of_thieves_is_executed":"The Demon Thief, Ganondorf, Is Executed","zelda_timeline.twilight_era":"The Twilight Era","zelda_timeline.twilight_princess":"Twilight Princess","zelda_timeline.shadow_invasion":"The Shadow Invasion","zelda_timeline.shadow_era":"The Shadow Era","zelda_timeline.four_swords_adventures":"Four Swords Adventures","zelda_timeline.reincarnation_of_ganondorf":"The Reincarnation of Ganondorf","zelda_timeline.ganondorf_is_sealed":"Ganondorf is sealed","zelda_timeline.hero_of_wind_and_new_world":"The Hero of Wind and a New World","zelda_timeline.era_without_a_hero":"The Era without a Hero","zelda_timeline.ganondorf_is_resurrected":"Ganondorf is Resurrected","zelda_timeline.hyrule_is_sealed_and_flooded":"Hyrule is sealed and then flooded","zelda_timeline.era_of_the_great_sea":"The Era of the Great Sea","zelda_timeline.the_wind_waker":"The Wind Waker","zelda_timeline.era_of_the_great_voyage":"The Era of the Great Voyage","zelda_timeline.phantom_hourglass":"Phantom Hourglass","zelda_timeline.era_of_hyrule_rebirth":"The Era of Hyrule's Rebirth","zelda_timeline.new_continent_discovered":"New Continent Discovered","zelda_timeline.new_hyrule_is_founded":"A New Hyrule Kingdom is founded","zelda_timeline.spirit_tracks":"Spirit Tracks","zelda_timeline.evil_king_malladus_is_resurrected":"The Evil King Malladus is Resurrected","zelda_timeline.age_of_calamity":"Age of Calamity","zelda_timeline.breath_of_the_wild":"Breath of the Wild","zelda_timeline.era_of_the_wilds":"Era of the Wilds","zelda_timeline.calamity_ganon_is_sealed":"Calamity Ganon is Sealed. Technology is banned, leading some Sheikah to form the Yiga Clan","zelda_timeline.divine_beasts_are_cleansed":"The Divine Beasts are cleansed and Calamity Ganon is Sealed","zelda_timeline.tears_of_the_kingdom":"Tears of the Kingdom","zelda_timeline.hyrule_kingdom_is_teared_apart":"Ganondorf is Resurrected (I think?)","blog_categories.games":"Games","blog_categories.general":"General","blog_categories.tips":"Tips","blog_categories.events":"Events","blog_categories.coding":"Coding","blog_categories.funny":"Funny","blog_categories.toys":"Toys","blog_categories.gadgets":"Gadgets","forty_two_page.title":"Forty Two","forty_two_page.description":"So long and thanks for all the fish!","projects_page.title":"Projects","projects_page.description":"Here is a list of some of my favorites personal projects.","projects_page.gatsbyMaterialUiBlogDescription":"A simple Gatsby Blog Starter with Material UI.","projects_page.contractBuilderDescription":"Contract Builder is a free open-source project that allows anyone to easily maintain and build any kind of contract (legal documents, lawsuit, rent, agreements, construction and so on) using Google Spreadsheets. This was develop as a personal project to help a friend who was struggling spending up to an hour to make a custom contract, now she is able to do it in less than 5 minutes. Hooray!","projects_page.resumeBuilderDescription":"Resume Builder is a free open-source project that allows anyone to easily maintain and build any kind of resume using Google Spreadsheets. This was develop as a personal project to help a friend who was struggling spending up to an hour to make a custom resumes.","projects_page.magentoChatbotDescription":"With this module you can fully integrate your Magento store with the most popular chat apps in the market. This means that by simply installing this module and a few clicks you can have a new way to show and sell your products to your clients. Very easy to use! Try now, it's FREE.","projects_page.jamStackSortenerDescription":"This is a basic URL shortener POC build with Gatsby.","projects_page.gotinhaDescription":"It was always my dream to make my own game, and after trying Unity a couple years ago, I decided to try it again with something I'm more familiar with: Javascript. As a frontend developer, Javascript is already the language that I write most of my code at work and also in my personal projects, and after a quick search I was able to find the amazing PhaserJS Framework for building 2D web games.","e3_2012_photos.title":"E3 2012","e3_2012_photos.description":"On June 2012 I attended E3 as a media press for a full coverage for Nintendo Blast.","e3_2013_photos.title":"E3 2013","e3_2013_photos.description":"On June 2013 I attended E3 as a media press for a full coverage for Game Blast.","e3_2014_photos.title":"E3 2014","e3_2014_photos.description":"On June 2014 I attended E3 as a media press for a full coverage for Game Blast.","e3_2015_photos.title":"E3 2015","e3_2015_photos.description":"On June 2015 I attended E3 as a media press for a full coverage for Game Blast and Game Over TV.","e3_2017_photos.title":"E3 2017","e3_2017_photos.description":"On June 2012 I attended E3 as a media press for a full coverage for PlayReplay and Game Over TV.","e3_2019_photos.title":"E3 2019","e3_2019_photos.description":"On June 2019 I attended E3 as a media press for a full coverage for PlayReplay.","gamescom_2019_photos.title":"Gamescom 2019","gamescom_2019_photos.description":"On August 2019 I attended Gamescom as a media press for a full coverage for PlayReplay.","san_francisco_2019_photos.title":"San Francisco 2019","san_francisco_2019_photos.description":"On September 2019 I've traveled to San Francisco for the Metallica S&M2 concert.","notfound.title":"404: Not found","notfound.header":"404 NOT FOUND","notfound.description":"Sorry, this page doesn't seem to exist. Perhaps the archives are incomplete?","seo_keywords.developer":"developer","seo_keywords.development":"development","seo_keywords.javascript":"javascript","seo_keywords.es6":"es6","seo_keywords.e3":"e3","seo_keywords.sgf":"sgf","seo_keywords.gamescom":"gamescom","seo_keywords.countdown":"countdown","seo_keywords.archive":"archive","seo_keywords.about_me":"about me","seo_keywords.personal_blog":"personal blog","seo_keywords.personal_projects":"personal projects","seo_keywords.travels":"travels","seo_keywords.tips":"tips","seo_keywords.lifehacks":"lifehacks","seo_keywords.reviews":"reviews","seo_keywords.games":"games","seo_keywords.timeline":"timeline","seo_keywords.photos":"photos","cookie_law.we_use_cookies":"We use cookies to ensure you get the best experience on our website. By using our website you agree to our ","cookie_law.title":"Cookie policy","cookie_law.what_are_cookies":"What are cookies?","cookie_law.what_are_cookies_text":"As is common practice with almost all professional websites this site uses cookies, which are tiny files that are downloaded to your computer, to improve your experience. This page describes what information they gather, how we use it and why we sometimes need to store these cookies. We will also share how you can prevent these cookies from being stored however this may downgrade or 'break' certain elements of the sites functionality. For more general information on cookies, please read ","cookie_law.what_are_cookies_more_info_url":"https://en.wikipedia.org/wiki/HTTP_cookie","cookie_law.how_we_use_cookies":"How we use cookies","cookie_law.how_we_use_cookies_text":"We use cookies for a variety of reasons detailed below. Unfortunately in most cases there are no industry standard options for disabling cookies without completely disabling the functionality and features they add to this site. It is recommended that you leave on all cookies if you are not sure whether you need them or not in case they are used to provide a service that you use.","cookie_law.disabling_cookies":"Disabling cookies","cookie_law.disabling_cookies_text":"You can prevent the setting of cookies by adjusting the settings on your browser (see your browser Help for how to do this). Be aware that disabling cookies will affect the functionality of this and many other websites that you visit. Disabling cookies will usually result in also disabling certain functionality and features of the this site. Therefore it is recommended that you do not disable cookies.","cookie_law.the_cookies_we_set":"The cookies we set","cookie_law.site_preferences_cookie":"Site preferences cookies","cookie_law.site_preferences_cookie_text":"In order to provide you with a great experience on this site we provide the functionality to set your preferences for how this site runs when you use it. In order to remember your preferences we need to set cookies so that this information can be called whenever you interact with a page is affected by your preferences.","cookie_law.third_party_cookies":"Third party cookies","cookie_law.third_party_cookies_text":"In some special cases we also use cookies provided by trusted third parties. The following section details which third party cookies you might encounter through this site.","cookie_law.third_party_cookies_item_1":"This site uses Google Analytics which is one of the most widespread and trusted analytics solution on the web for helping us to understand how you use the site and ways that we can improve your experience. These cookies may track things such as how long you spend on the site and the pages that you visit so we can continue to produce engaging content. For more information on Google Analytics cookies, see the official Google Analytics page.","cookie_law.third_party_cookies_item_2":"From time to time we test new features and make subtle changes to the way that the site is delivered. When we are still testing new features these cookies may be used to ensure that you receive a consistent experience whilst on the site whilst ensuring we understand which optimisations our users appreciate the most.","cookie_law.more_information":"More information","cookie_law.more_information_text":"Hopefully that has clarified things for you and as was previously mentioned if there is something that you aren't sure whether you need or not it's usually safer to leave cookies enabled in case it does interact with one of the features you use on our site. However if you are still looking for more information then you can contact us through our "},"routed":true,"originalPath":"/archive/3","redirect":true,"redirectDefaultLanguageToRoot":false,"defaultLanguage":"en","fallbackLanguage":"","ignoredPaths":[]},"locale":"en"}},
    "staticQueryHashes": ["1156153307","1355482417","1591365477","1628619374","2127381735","2288279559","26159077","3566410298","3649515864","3847325417","3982724423","928834867"]}