{
    "componentChunkName": "component---src-templates-tag-page-jsx",
    "path": "/pt-br/blog/tags/node",
    "result": {"pageContext":{"pageType":"tag","title":"node","posts":[{"node":{"html":"<p>Após criar um script Node.js para <a href=\"/pt-br/blog/coding/publicando-reels-no-instagram-usando-nodejs-e-a-arte-de-superar-limitacoes/\">postar automaticamente Reels no Instagram</a> e outro para <a href=\"/pt-br/blog/coding/como-criar-thumbnails-para-seus-videos-automaticamente-com-nodejs/\">gerar automaticamente miniaturas para Reels no Instagram</a>, o que vem a seguir? Gerar automaticamente o conteúdo do vídeo, claro!</p>\n<p>Neste post, vou mostrar como usar o GPT-3.5 da OpenAI para gerar o conteúdo de um vídeo tutorial de programação. Vou usar o mesmo script Node.js que usei nos posts anteriores, além de um <code class=\"language-text\">create-react-app</code> que será usado para digitar o código do tutorial gerado.</p>\n<p><figure class=\"gatsby-resp-image-figure\" style=\"\">\n    <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1024px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 57.03125%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAADKElEQVQozwXBWUzTBwDA4T+DcTnAEKAUWqUDWi5rAaFgBbMqZ01bYAhylk5aOZxU1kKhwEBhKIhYFDBgZIBAq5I5QAScWyRbsiW7spctZG9L9uLDkmXJnvbb9wlRUg1yWTpnM3OxX+7gxfYcvxy8xLt0n5qCCyi1TRwpNnG0uhVphZUjla2IKqxElF0iUn+JaIMFsd5CUEox/qIchFiZlix5Nm3nythxD/L3gRf++5G/DnZxj6+i7VsnzrGGpGsVyexLRJ4fiNv4lXj7BKHv1RKibye0yk6wugr/2HwEkUyLIimbkpJyrg1e5+fvHvHmjx02th/TbhtA23iFQ6dbEDm8FP0Dx/+FuDcQ2zvLO7UODrseIH/4JWEV3fjF5COEywqRHTtNhs5EUccI888esPX9Fs2L65yq/xCxsYfUvmWy7j4j+dE+0Ss/IXvxG0enPCTOrJKz8ZrEtdeEVfbiKz2LECY3ID6hJ73OTp5zEuvdSQY+W6Hy08/JsjpJndxB3uUhvcSCkFTDsYZ7qKdf8e7aLineTdS736Dc3Ceq8RqCzIgQmFqNuKiFAtcw6v5bGO7MYb4ziXFqCcnt31E+/xPZ4rdIbA8JufqU8Cvr5I1tUrj8hLTlFRSLXtK924ibbyIoGhCEjDbiG7spuH4LVb8b2+MVdENuDB+PYVjYI9bUR8r0GrnrX5C79QqV52skM/uY51fRjI4jd1zl5JCLGPM4gsqGEJDRQHjpZTRj81i8HipnF4g03eCMzUW1s5MAZT7Fjh4uToxiGujAPPIRF929WEd7aOw2k1RVTnzNeSKrBxHU/QiBqgZ8dG5iHEsoemeIsN4ktGkYqbGdpGYXhzM1pL1vIt95D/86D4JugZP229RP9JGgKySksJwIQwVB+j6EU8MIvqpWgnVu/BLOEJGsISL3HGH1nYiNzeS02Ui0ucg0WZDqaznR1ImvsoK0Fgel07NElpbhc95EQJ0ZP50TIbMHwVdxAf8sC28n5BF0XEuw/gMktiGSu8ZQLT4n/pNpsm9MIfPuod37iui5ZaJGp4gdneOQsQn/FieBI/d5q2wQH3kr/wMcxNdOxLj/fAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"AI trabalhando\"\n        title=\"AI trabalhando\"\n        src=\"/static/cdcc77b7fb8d6bdf43386ce698ba2c79/42a19/auto-generating-tutorials.png\"\n        srcset=\"/static/cdcc77b7fb8d6bdf43386ce698ba2c79/e3135/auto-generating-tutorials.png 256w,\n/static/cdcc77b7fb8d6bdf43386ce698ba2c79/06341/auto-generating-tutorials.png 512w,\n/static/cdcc77b7fb8d6bdf43386ce698ba2c79/42a19/auto-generating-tutorials.png 1024w,\n/static/cdcc77b7fb8d6bdf43386ce698ba2c79/e8464/auto-generating-tutorials.png 1536w,\n/static/cdcc77b7fb8d6bdf43386ce698ba2c79/445c6/auto-generating-tutorials.png 1792w\"\n        sizes=\"(max-width: 1024px) 100vw, 1024px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\">AI trabalhando</figcaption>\n  </figure></p>\n<h2 id=\"engenharia-de-prompts\" style=\"position:relative;\"><a href=\"#engenharia-de-prompts\" aria-label=\"engenharia de prompts permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Engenharia de prompts</h2>\n<p>A primeira pergunta que tive que me fazer foi: como posso pedir ao GPT-3.5 para gerar um tutorial de programação? Quero dizer, não posso simplesmente pedir para ele gerar um tutorial de programação, certo? Preciso dar um contexto, alguma informação, algo com que ele possa trabalhar.</p>\n<p><figure class=\"gatsby-resp-image-figure\" style=\"\">\n    <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1024px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 58.203125%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAIAAADtbgqsAAAACXBIWXMAAAsTAAALEwEAmpwYAAABpklEQVQoz4WSaY6cMBCF+xg9wwyLjfcFGwxmb6DpZZLc/zwJTdKKlIxGerL8431Vr8o+DNN5udz7cZmW63r7hoiAmBGuEZVhgo5B9Pqe/KtjEAHEDnU3jtPaDXPTncZ5VaYo665q+rxsirIJE/TyFn8KA8Qo1ynhEHMqNEgpFRlmCmKOqAxCcAyip17fkyAEQQhe3uINJlzlZZ3llTJO29I6L3Se5ZXznSkq59u8bKzzvh1M4bmyEG9tkpQyaQ6Yyp0UympbKuMI1zsvs0IZpx7nw1MgKiOAY0hCgDeYSWNdra1j0mR5tZUwrqp7ZQrrvPOtzAqu7N7A+c75zjqvjKMiOwht5/V2uf9wVdsO83S+LZf7OF/60+Kqdlquw7TW3bjevp+vH0132uI8ym2dk5QhqriyKREpEUwaJu2eHFGJmaIioyLjygqdE6ZiSJKURntsKrKq6bV1Zd0X1RYySWmS0t30vO9KUgoQA4jFkGwwxHz/EoTr/YX+Nn2m37DQth2mP5uou3Eb27o6huRrGCCGmcJUIiIQEeQxJCLimfm/iiH5te2fhep7nFSF4lsAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"O futuro está aqui\"\n        title=\"O futuro está aqui\"\n        src=\"/static/f74dd4bc90e600f64b196b06fb41b1db/42a19/programming-2050.png\"\n        srcset=\"/static/f74dd4bc90e600f64b196b06fb41b1db/e3135/programming-2050.png 256w,\n/static/f74dd4bc90e600f64b196b06fb41b1db/06341/programming-2050.png 512w,\n/static/f74dd4bc90e600f64b196b06fb41b1db/42a19/programming-2050.png 1024w,\n/static/f74dd4bc90e600f64b196b06fb41b1db/69083/programming-2050.png 1158w\"\n        sizes=\"(max-width: 1024px) 100vw, 1024px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\">O futuro está aqui</figcaption>\n  </figure></p>\n<p>Nesta nova era de trabalhar com modelos de linguagem, é estranho que, se você quer que o modelo faça algo, você só precisa pedir. Então, comecei criando uma lista de coisas que eu queria que estivessem no vídeo, como:</p>\n<ul>\n<li>Um título</li>\n<li>Uma descrição</li>\n<li>O próprio código</li>\n<li>Uma lista de ideias que já usei antes</li>\n<li>Uma lista de coisas a evitar</li>\n</ul>\n<p>E então comecei a pensar em como eu poderia usar essa informação para pedir ao GPT-3.5 para gerar um tutorial de programação. Cheguei ao seguinte prompt:</p>\n<blockquote>\n<p>Respire fundo, relaxe e pense analiticamente sobre o problema que está tentando resolver.\r\nTenho um arquivo JSON para um script de um tutorial de programação em vídeo para Reels no Instagram, que se parece com isto:\r\n&#x3C;EXEMPLO_JSON_AQUI>\r\nPor favor, use este modelo para gerar um novo script para um tutorial de programação em vídeo para Reels no Instagram.\r\nEvite usar as seguintes ideias:\r\n&#x3C;IDEIAS_UTILIZADAS>\r\nE evite os seguintes tópicos:\r\n&#x3C;TÓPICOS_A_EVITAR>\r\nCertifique-se de responder apenas com um arquivo JSON com a mesma estrutura do que eu te dei e nada mais.</p>\n</blockquote>\n<p>Após elaborar este prompt, testei-o algumas vezes no ChatGPT, e parecia bom, mas como esperado, às vezes a saída não era um formato JSON válido, e foi então que aprendi sobre <a href=\"https://openai.com/blog/function-calling-and-other-api-updates\" target=\"_blank\" rel=\"noreferrer\">chamadas de função</a>.</p>\n<h2 id=\"function-calling\" style=\"position:relative;\"><a href=\"#function-calling\" aria-label=\"function calling permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Function calling</h2>\n<p>Chamadas de função são uma nova funcionalidade da API da OpenAI que permite chamar uma função a partir do prompt, e isso ajuda a garantir que a saída do GPT seja o que você espera.</p>\n<p>No meu caso, criei uma função chamada <code class=\"language-text\">generateTutorialViaOpenAi</code> que recebe o arquivo JSON com o script para o vídeo e retorna um novo arquivo JSON com o script para o vídeo.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> OpenAI <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'openai'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token keyword\">const</span> openai <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">OpenAI</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\r\n  <span class=\"token literal-property property\">apiKey</span><span class=\"token operator\">:</span> process<span class=\"token punctuation\">.</span>env<span class=\"token punctuation\">.</span><span class=\"token constant\">OPENAI_API_KEY</span><span class=\"token punctuation\">,</span>\r\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">generateTutorialViaOpenAi</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">prompt</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n  <span class=\"token keyword\">const</span> schema <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token literal-property property\">type</span><span class=\"token operator\">:</span> <span class=\"token string\">'object'</span><span class=\"token punctuation\">,</span>\r\n    <span class=\"token literal-property property\">required</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'commands'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'files'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'description'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\r\n    <span class=\"token literal-property property\">properties</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\r\n      <span class=\"token literal-property property\">description</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token literal-property property\">type</span><span class=\"token operator\">:</span> <span class=\"token string\">'string'</span><span class=\"token punctuation\">,</span>\r\n        <span class=\"token literal-property property\">description</span><span class=\"token operator\">:</span> <span class=\"token string\">'A nice and catchy description for the tutorial.'</span><span class=\"token punctuation\">,</span>\r\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\r\n      <span class=\"token literal-property property\">commands</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token literal-property property\">type</span><span class=\"token operator\">:</span> <span class=\"token string\">'string'</span><span class=\"token punctuation\">,</span>\r\n        <span class=\"token literal-property property\">description</span><span class=\"token operator\">:</span> <span class=\"token string\">'A string with the code and commands to use for the tutorial. It must not be empty.'</span><span class=\"token punctuation\">,</span>\r\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\r\n      <span class=\"token literal-property property\">files</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token literal-property property\">type</span><span class=\"token operator\">:</span> <span class=\"token string\">'array'</span><span class=\"token punctuation\">,</span>\r\n        <span class=\"token literal-property property\">description</span><span class=\"token operator\">:</span> <span class=\"token string\">'The list of files that are going to be used in the tutorial. One of them MUST be index.html'</span><span class=\"token punctuation\">,</span>\r\n        <span class=\"token literal-property property\">items</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\r\n          <span class=\"token literal-property property\">type</span><span class=\"token operator\">:</span> <span class=\"token string\">'object'</span><span class=\"token punctuation\">,</span>\r\n          <span class=\"token literal-property property\">description</span><span class=\"token operator\">:</span> <span class=\"token string\">'A file that is going to be used in the tutorial'</span><span class=\"token punctuation\">,</span>\r\n          <span class=\"token literal-property property\">required</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'name'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'content'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\r\n          <span class=\"token literal-property property\">properties</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\r\n            <span class=\"token literal-property property\">name</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\r\n              <span class=\"token literal-property property\">type</span><span class=\"token operator\">:</span> <span class=\"token string\">'string'</span><span class=\"token punctuation\">,</span>\r\n              <span class=\"token literal-property property\">description</span><span class=\"token operator\">:</span> <span class=\"token string\">'The name of the file'</span><span class=\"token punctuation\">,</span>\r\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\r\n            <span class=\"token literal-property property\">content</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\r\n              <span class=\"token literal-property property\">type</span><span class=\"token operator\">:</span> <span class=\"token string\">'string'</span><span class=\"token punctuation\">,</span>\r\n              <span class=\"token literal-property property\">description</span><span class=\"token operator\">:</span> <span class=\"token string\">'The content of the file. Should be empty for the file that is going to be typed from the script.'</span><span class=\"token punctuation\">,</span>\r\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\r\n          <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\r\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\r\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\r\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\r\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\r\n\r\n  <span class=\"token keyword\">const</span> reelsCommands <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> openai<span class=\"token punctuation\">.</span>chat<span class=\"token punctuation\">.</span>completions<span class=\"token punctuation\">.</span><span class=\"token function\">create</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\r\n    <span class=\"token literal-property property\">model</span><span class=\"token operator\">:</span> <span class=\"token string\">'gpt-3.5-turbo'</span><span class=\"token punctuation\">,</span>\r\n    <span class=\"token literal-property property\">messages</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\r\n      <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">role</span><span class=\"token operator\">:</span> <span class=\"token string\">'system'</span><span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">content</span><span class=\"token operator\">:</span> <span class=\"token string\">'You are a helpful programming professor.'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\r\n      <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">role</span><span class=\"token operator\">:</span> <span class=\"token string\">'user'</span><span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">content</span><span class=\"token operator\">:</span> prompt <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\r\n    <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\r\n    <span class=\"token literal-property property\">functions</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">name</span><span class=\"token operator\">:</span> <span class=\"token string\">'generate_tutorial'</span><span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">parameters</span><span class=\"token operator\">:</span> schema <span class=\"token punctuation\">}</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\r\n    <span class=\"token literal-property property\">function_call</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">name</span><span class=\"token operator\">:</span> <span class=\"token string\">'generate_tutorial'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\r\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n  <span class=\"token keyword\">return</span> reelsCommands<span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Como você pode ver, o objeto <code class=\"language-text\">schema</code> é a chave aqui, garantindo que a saída do GPT seja o que eu espero.</p>\n<h2 id=\"gerando-o-video\" style=\"position:relative;\"><a href=\"#gerando-o-video\" aria-label=\"gerando o video permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Gerando o vídeo</h2>\n<p>Agora que tenho um arquivo JSON gerado sob demanda pela OpenAI, preciso de alguma forma convertê-lo em um vídeo, e é aqui que o script Puppeteer.js entra em cena.</p>\n<p>Não vou entrar em muitos detalhes aqui porque esta é, na verdade, a parte mais complexa, e merece seu próprio post um dia, mas em resumo, estou usando Puppeteer.js para abrir um navegador Chrome sem cabeçalho, carregar um aplicativo React, e usando <a href=\"https://www.npmjs.com/package/react-ace\" target=\"_blank\" rel=\"noreferrer\">react-ace</a> para o destaque de código, então com Puppeteer.js estou digitando o código e tirando uma captura de tela da página e salvando-a como um arquivo PNG usando o <a href=\"https://chromedevtools.github.io/devtools-protocol/tot/Page/#event-screencastFrame\" target=\"_blank\" rel=\"noreferrer\">‘Page.screencastFrame’</a>.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> allFrames <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">const</span> browser <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> puppeteer<span class=\"token punctuation\">.</span><span class=\"token function\">launch</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>page<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> browser<span class=\"token punctuation\">.</span><span class=\"token function\">pages</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">const</span> client <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> page<span class=\"token punctuation\">.</span><span class=\"token function\">target</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">createCDPSession</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\nclient<span class=\"token punctuation\">.</span><span class=\"token function\">on</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Page.screencastFrame'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span> data<span class=\"token punctuation\">,</span> sessionId <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n  <span class=\"token keyword\">await</span> client<span class=\"token punctuation\">.</span><span class=\"token function\">send</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Page.screencastFrameAck'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> sessionId <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  allFrames<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Depois disso, estou usando <a href=\"https://ffmpeg.org/\" target=\"_blank\" rel=\"noreferrer\">ffmpeg</a> para converter os arquivos PNG em um vídeo.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> ffmpeg <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'fluent-ffmpeg'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">const</span> ffmpegPath <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'ffmpeg-static'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">const</span> ffprobe <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'ffprobe-static'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\nffmpeg<span class=\"token punctuation\">.</span><span class=\"token function\">setFfmpegPath</span><span class=\"token punctuation\">(</span>ffmpegPath<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\nffmpeg<span class=\"token punctuation\">.</span><span class=\"token function\">setFfprobePath</span><span class=\"token punctuation\">(</span>ffprobe<span class=\"token punctuation\">.</span>path<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">createVideoFromFrames</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span>\r\n  <span class=\"token parameter\">fps<span class=\"token punctuation\">,</span>\r\n  frames<span class=\"token punctuation\">,</span>\r\n  outputPath</span>\r\n<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n  <span class=\"token keyword\">const</span> tempOutput <span class=\"token operator\">=</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>outputPath<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">.temp</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token keyword\">await</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Promise</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">resolve<span class=\"token punctuation\">,</span> reject</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token function\">ffmpeg</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\r\n      <span class=\"token punctuation\">.</span><span class=\"token function\">input</span><span class=\"token punctuation\">(</span>frames<span class=\"token punctuation\">)</span>\r\n      <span class=\"token punctuation\">.</span><span class=\"token function\">inputFPS</span><span class=\"token punctuation\">(</span>fps<span class=\"token punctuation\">)</span>\r\n      <span class=\"token punctuation\">.</span><span class=\"token function\">toFormat</span><span class=\"token punctuation\">(</span><span class=\"token string\">'mp4'</span><span class=\"token punctuation\">)</span>\r\n      <span class=\"token punctuation\">.</span><span class=\"token function\">videoCodec</span><span class=\"token punctuation\">(</span><span class=\"token string\">'libx264'</span><span class=\"token punctuation\">)</span>\r\n      <span class=\"token punctuation\">.</span><span class=\"token function\">videoBitrate</span><span class=\"token punctuation\">(</span><span class=\"token string\">'5000k'</span><span class=\"token punctuation\">)</span>\r\n      <span class=\"token punctuation\">.</span><span class=\"token function\">addOption</span><span class=\"token punctuation\">(</span><span class=\"token string\">'-crf'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'23'</span><span class=\"token punctuation\">)</span>\r\n      <span class=\"token punctuation\">.</span><span class=\"token function\">addOption</span><span class=\"token punctuation\">(</span><span class=\"token string\">'-g'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'30'</span><span class=\"token punctuation\">)</span>\r\n      <span class=\"token punctuation\">.</span><span class=\"token function\">addOption</span><span class=\"token punctuation\">(</span><span class=\"token string\">'-profile:v'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'high'</span><span class=\"token punctuation\">)</span>\r\n      <span class=\"token punctuation\">.</span><span class=\"token function\">addOption</span><span class=\"token punctuation\">(</span><span class=\"token string\">'-level'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'4.0'</span><span class=\"token punctuation\">)</span>\r\n      <span class=\"token punctuation\">.</span><span class=\"token function\">on</span><span class=\"token punctuation\">(</span><span class=\"token string\">'end'</span><span class=\"token punctuation\">,</span> resolve<span class=\"token punctuation\">)</span>\r\n      <span class=\"token punctuation\">.</span><span class=\"token function\">on</span><span class=\"token punctuation\">(</span><span class=\"token string\">'error'</span><span class=\"token punctuation\">,</span> reject<span class=\"token punctuation\">)</span>\r\n      <span class=\"token punctuation\">.</span><span class=\"token function\">save</span><span class=\"token punctuation\">(</span>tempOutput<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n  <span class=\"token keyword\">await</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Promise</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">resolve<span class=\"token punctuation\">,</span> reject</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token function\">ffmpeg</span><span class=\"token punctuation\">(</span>tempOutput<span class=\"token punctuation\">)</span>\r\n      <span class=\"token punctuation\">.</span><span class=\"token function\">fps</span><span class=\"token punctuation\">(</span><span class=\"token constant\">FPS</span><span class=\"token punctuation\">)</span>\r\n      <span class=\"token punctuation\">.</span><span class=\"token function\">on</span><span class=\"token punctuation\">(</span><span class=\"token string\">'end'</span><span class=\"token punctuation\">,</span> resolve<span class=\"token punctuation\">)</span>\r\n      <span class=\"token punctuation\">.</span><span class=\"token function\">on</span><span class=\"token punctuation\">(</span><span class=\"token string\">'error'</span><span class=\"token punctuation\">,</span> reject<span class=\"token punctuation\">)</span>\r\n      <span class=\"token punctuation\">.</span><span class=\"token function\">output</span><span class=\"token punctuation\">(</span>outputPath<span class=\"token punctuation\">)</span>\r\n      <span class=\"token punctuation\">.</span><span class=\"token function\">run</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h2 id=\"juntando-tudo\" style=\"position:relative;\"><a href=\"#juntando-tudo\" aria-label=\"juntando tudo permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Juntando tudo</h2>\n<p>Agora que tenho todas as peças, só preciso uni-las. Criei um novo script Node.js que irá:</p>\n<ul>\n<li>Gerar um novo arquivo JSON com o script para o vídeo</li>\n<li>Gerar um novo vídeo com o script para o vídeo</li>\n<li>Gerar uma nova miniatura para o vídeo</li>\n<li>Postar o vídeo no Instagram Reels</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> generateTutorialViaOpenAi <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'./generate-tutorial-via-openai'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">const</span> generateImageForPost <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'./generate-image-for-post'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">const</span> generateVideoForPost <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'./generate-video-for-post'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">const</span> postVideoToInstagramReels <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'./post-video-to-instagram-reels'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">const</span> prompt <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'./prompt'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">generateTutorial</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n  <span class=\"token keyword\">const</span> reelsCommands <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">generateTutorialViaOpenAi</span><span class=\"token punctuation\">(</span>prompt<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> description<span class=\"token punctuation\">,</span> commands<span class=\"token punctuation\">,</span> files <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> reelsCommands<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">.</span>choices<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">;</span>\r\n\r\n  <span class=\"token keyword\">const</span> outputPath <span class=\"token operator\">=</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">./output/</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>Date<span class=\"token punctuation\">.</span><span class=\"token function\">now</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token keyword\">const</span> thumbnailPath <span class=\"token operator\">=</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>outputPath<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">/thumbnail.png</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token keyword\">const</span> videoPath <span class=\"token operator\">=</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>outputPath<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">/video.mp4</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span>\r\n\r\n  <span class=\"token keyword\">await</span> <span class=\"token function\">generateImageForPost</span><span class=\"token punctuation\">(</span>\r\n    <span class=\"token string\">'./assets/background.png'</span><span class=\"token punctuation\">,</span>\r\n    <span class=\"token string\">'./assets/foreground.png'</span><span class=\"token punctuation\">,</span>\r\n    description<span class=\"token punctuation\">,</span>\r\n    thumbnailPath\r\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n  <span class=\"token keyword\">await</span> <span class=\"token function\">generateVideoForPost</span><span class=\"token punctuation\">(</span>commands<span class=\"token punctuation\">,</span> files<span class=\"token punctuation\">,</span> videoPath<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n  <span class=\"token keyword\">await</span> <span class=\"token function\">postVideoToInstagramReels</span><span class=\"token punctuation\">(</span>description<span class=\"token punctuation\">,</span> videoPath<span class=\"token punctuation\">,</span> thumbnailPath<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token function\">generateTutorial</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>O código real que estou usando é um pouco mais complexo, mas essa é a ideia geral.</p>\n<h2 id=\"prova-de-conceito\" style=\"position:relative;\"><a href=\"#prova-de-conceito\" aria-label=\"prova de conceito permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Prova de conceito</h2>\n<p>Claro que depois de fazer todo esse trabalho, eu tinha que testá-lo, então criei uma <a href=\"https://www.instagram.com/anchorarray/\" target=\"_blank\" rel=\"noreferrer\">nova conta no Instagram</a> que postará um novo tutorial todos os dias, e sempre evitará ideias e tópicos existentes, bem, pelo menos em teoria…</p>\n<p><div class=\"instagram-embed\"><iframe src=\"https://instagram.com/p/C1OpOUzsfwd/embed\" frameborder=\"0\" allowfullscreen scrolling=\"no\" allowtransparency width=\"400\" height=\"400\"></iframe></div></p>\n<p>… mas a realidade acabou sendo que os tutoriais gerados não são tão bons, e não tenho certeza se é devido ao prompt que estou usando, ou devido ao próprio modelo, mas tenho certeza que é uma combinação de ambos. Por alguma razão, ele continua gerando os mesmos tutoriais, sempre relacionados a colorir coisas usando CSS.</p>\n<p>Estive executando esta conta por 3 meses agora, e ela obteve apenas 38 seguidores até hoje e alcançou 466 contas nos últimos 30 dias, então não tenho certeza se vale a pena continuar com ela, mesmo que seja totalmente automatizada e o custo total até agora foi de apenas U$1.00.</p>\n<p>Acho que a melhor abordagem aqui é uma híbrida, onde gero meus próprios scripts e uso meu código Node.js para gerar o vídeo e postá-lo no Instagram Reels, o que já automatiza muito do trabalho.</p>\n<h2 id=\"conclusao\" style=\"position:relative;\"><a href=\"#conclusao\" aria-label=\"conclusao permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Conclusão</h2>\n<p>Estou realmente animado com esta nova era de trabalho com modelos de linguagem. Tenho certeza de que veremos muitas coisas legais sendo criadas nos próximos anos.</p>\n<p>Mesmo que este projeto não tenha funcionado como esperado, aprendi muito sobre a API da OpenAI e como usá-la, e tenho certeza de que a usarei no futuro.</p>\n<p>Espero que tenham gostado deste post, e não se esqueçam de conferir como <a href=\"/pt-br/blog/coding/publicando-reels-no-instagram-usando-nodejs-e-a-arte-de-superar-limitacoes/\">postar automaticamente Reels no Instagram usando Node.js</a> e <a href=\"/pt-br/blog/coding/como-criar-thumbnails-para-seus-videos-automaticamente-com-nodejs/\">como gerar automaticamente miniaturas para seus vídeos com Node.js</a>.</p>","fields":{"postHashId":"Y29kaW5ndHJ1ZW51bGwyMDIzLTEyLTIwVDAwOjAwOjAwLjAwMFo=","slug":"/2023/2023-12-20-como-automatizar-a-criacao-de-instagram-reels-usando-gpt-da-openai.pt-br/","path":"/blog/coding/como-automatizar-a-criacao-de-instagram-reels-usando-gpt-da-openai/","locale":"pt-br"},"frontmatter":{"tags":["openai","gpt","javascript","node","nodejs","instagram"],"categories":["coding"],"allowComments":true,"publishOnMedium":false,"cover":null,"date":"2023-12-20T00:00:00.000Z","id":null,"path":"como-automatizar-a-criacao-de-instagram-reels-usando-gpt-da-openai","show":true,"title":"Como automatizar a criação de Instagram Reels usando GPT da OpenAI","hideExcerpt":false,"subtitle":""}}},{"node":{"html":"<p>Apenas na semana passada eu postei sobre <a href=\"/pt-br/blog/coding/publicando-reels-no-instagram-usando-nodejs-e-a-arte-de-superar-limitacoes/\">como fazer upload de Reels para o Instagram usando Node.js</a>, e no código era possível fazer upload de um thumbnail para o vídeo também, mas eu não expliquei como criar esse thumbnail.</p>\n<p>I mean, claro que você pode ir para no <a href=\"https://www.photopea.com/\" target=\"_blank\" rel=\"noreferrer\">Photopea</a> e criar um thumbnail para o seu vídeo, mas e se você quiser automatizar esse processo? E se você quiser criar um thumbnail diferente para todos os seus vídeos automaticamente?</p>\n<p>Bem, é isso que eu vou te mostrar hoje.</p>\n<p><figure class=\"gatsby-resp-image-figure\" style=\"\">\n    <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1024px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 57.03125%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAAsTAAALEwEAmpwYAAACdklEQVQozxXQu27TUACA4RPbcXx8ObaPj+9O7DiXNiRNUqcpzQXVtEFtgBZISUsZ6JWFAaR2oEUVEoKyMQALQkgIgZB4AAYkZgpvgMTEBhti7QDqv3/LDzJyTlOxJkhIwgwvMgJKESNFdK1ey9QaaKIjFcdhJqsJrqd4rkZUETEMTVMnAdkPHC9r6cSUtRTkoJOG/bly3F3vnFmNop34fK/Y5KImKtctwyI2EXgOQi7FJk+wK+YDbcTHPuZlybGMVie8Opg+1azLwXRQXa1EIs3xVoEMh07UUlSDRwqEMEFRAAAQ4BFH8TCUpSSHwtC4NH86OxH5uYtxayxXmBqvtJsNjPJm7zKOY8XIknToYEfhcZJlgeNWMG9CSpQoQRovkelOGYdPb20cf3/769vL4x/vv757OOpNpsbG8EzbhJjnOchBHvI8zwPbCV3X1kQNcaLcLHNxA7BMvzKIq93Pzw9uLsz368u+kgOjWXu2l04XdFOj6QSgAM3QILRyGYOwKTYBgJDzxZV+M2rcXdvffnz45+j1kxeHd+4/W47OWutLdq2mY8siro5MldWSVBIUUclNZpBiasTl83lpZeHKcOPD7Z1/vz9+ebD/9+jNz0+vds+tlW4MFN/VdUMUDVkwECtTgAIuDhRT51VMVMUqBnh+1tvf6PbOHizObcUze4ML16e6+c1luz1t2CWVOFDioAQTicTJbZR1FN3UkYNVJBGN1CfNa4tgb8mz9dnqaMv3wUwV3Vs3i/WQ8wuGZxNTEmU2xdJJBmRRwU55FrKwqqgKQpYRxl3t0ZbT7gMARMHUdjfR9tAOqg7x1EA3DWJgRUEiQzP/AerQaSbt1hVqAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Ilustração\"\n        title=\"Ilustração\"\n        src=\"/static/f8272dae5fedf81e3304107e04988bdb/42a19/instagram-reels-thumbnail-illustration.png\"\n        srcset=\"/static/f8272dae5fedf81e3304107e04988bdb/e3135/instagram-reels-thumbnail-illustration.png 256w,\n/static/f8272dae5fedf81e3304107e04988bdb/06341/instagram-reels-thumbnail-illustration.png 512w,\n/static/f8272dae5fedf81e3304107e04988bdb/42a19/instagram-reels-thumbnail-illustration.png 1024w,\n/static/f8272dae5fedf81e3304107e04988bdb/e8464/instagram-reels-thumbnail-illustration.png 1536w,\n/static/f8272dae5fedf81e3304107e04988bdb/445c6/instagram-reels-thumbnail-illustration.png 1792w\"\n        sizes=\"(max-width: 1024px) 100vw, 1024px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\">Ilustração</figcaption>\n  </figure></p>\n<h2 id=\"encontrando-o-package-certo\" style=\"position:relative;\"><a href=\"#encontrando-o-package-certo\" aria-label=\"encontrando o package certo permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Encontrando o package certo</h2>\n<p>Como um desenvolvedor frontend, a única coisa que eu sei sobre manipulação de imagens é usando canvas, e felizmente existe um package para Node.js que nos permite fazer isso, ele se chama <a href=\"https://www.npmjs.com/package/canvas\" target=\"_blank\" rel=\"noreferrer\">node-canvas</a>.</p>\n<p>Com ele, nós podemos criar um canvas, desenhar imagens, textos, formas, etc. É bem legal, dê uma olhada no exemplo abaixo:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> createCanvas<span class=\"token punctuation\">,</span> loadImage <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'canvas'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> writeFileSync <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'fs'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token keyword\">const</span> canvas <span class=\"token operator\">=</span> <span class=\"token function\">createCanvas</span><span class=\"token punctuation\">(</span><span class=\"token number\">200</span><span class=\"token punctuation\">,</span> <span class=\"token number\">200</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">const</span> ctx <span class=\"token operator\">=</span> canvas<span class=\"token punctuation\">.</span><span class=\"token function\">getContext</span><span class=\"token punctuation\">(</span><span class=\"token string\">'2d'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\nctx<span class=\"token punctuation\">.</span>font <span class=\"token operator\">=</span> <span class=\"token string\">'30px Impact'</span><span class=\"token punctuation\">;</span>\r\nctx<span class=\"token punctuation\">.</span>fillStyle <span class=\"token operator\">=</span> <span class=\"token string\">'#000'</span><span class=\"token punctuation\">;</span>\r\nctx<span class=\"token punctuation\">.</span><span class=\"token function\">fillText</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Hello World!'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\ncanvas<span class=\"token punctuation\">.</span><span class=\"token function\">toBuffer</span><span class=\"token punctuation\">(</span><span class=\"token string\">'image/png'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">err<span class=\"token punctuation\">,</span> buffer</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n  <span class=\"token function\">writeFileSync</span><span class=\"token punctuation\">(</span><span class=\"token string\">'./hello-world.png'</span><span class=\"token punctuation\">,</span> buffer<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h2 id=\"criando-um-design\" style=\"position:relative;\"><a href=\"#criando-um-design\" aria-label=\"criando um design permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Criando um design</h2>\n<p>Eu não sou um designer, então eu não vou te ensinar como criar um bom design, mas eu posso te mostrar como eu criei o design para as minhas thumbnails.</p>\n<p>Eu comecei criando um novo arquivo no Photopea com o mesmo tamanho do vídeo do Instagram Reels, que é 1080x1920px. Então eu adicionei uma imagem de fundo e um texto com o título do vídeo, e também uma cor de fundo para o texto com um pouco de opacidade.</p>\n<p>E para finalizar, eu adicionei uma imagem com fundo transparente com uma imagem minha em pixel art.</p>\n<p><figure class=\"gatsby-resp-image-figure\" style=\"\">\n    <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1024px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 177.734375%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAkCAIAAAAGkY33AAAACXBIWXMAAAsTAAALEwEAmpwYAAAHoUlEQVRIxy1VWXAbWRXtYRbHlmTtliNLvbz3elN3q6VudavV2ndZtuU940kcT8ngCZnYhGBnw3bisZ0EkUwcJeCkTIVMUYGESg0MpCiYqQxkUixf+aKKml9++OCTgiq+MMjk1P295713zz3vYIackwWFZWmEIElRBEHRLOAkmKlFcqOh1AhnVrncOB8v02ZWTeaEwohQmRFqb0fKmWEsGxsaTE2lTKUxGq9UlGJBicUigsADEgASUGSHS4jQsoZiuqxGQ0lTzKYjmiJFZBkDIIhDnEIUx9GKIqRSUipjplJKY0QfqseKpVhUDLMQcCKNEAUAIHFAUEGaBgwLsSwZrhORvKAgDuFEECdIAACEkGFoUWBimiixIUVhEjUmOcSl6kyixGcSJZnXBC6MTY6bmVg4CyKqqAucyLIMQhDRAEIKQEBRACKAEIIA0TTiBaQYfFLLFfWJQXMGy+clSWYliBJSJqs00tF6NGQwkOeQiACNECBJAsdxgjgonAgM4AOBw4Hg4UBwADt82OtyWZ2enq6u151dFp9jIOBBPgfutfv9bsrttPv6Lf4Bp91ut1gsXV1dVqvVYrHarDaXy4VZrbZmc35zc+vWrfbS4tLW5pWTC0vL3zy/vra+tnbp5s2b165tX7x4ttVqnThx4sKFC5VKZWJiolAoWK1WzGazzc8319fXd3Z2isXi1NTUwnsLW9ubc3NzU1OTd+7cabdvNxqjzWZzeXl5dXV1Y2Pj3Llzuq5bLBbM6XRGIpFarRaPxzOZzMhIIx6PFwoFTdO0mFapVHK5XD6f0w/AcRxJkt3d3b29vW63G7Pb7StnVz755OcvXrzY3d29d+9eq9VaWlra29t7+PDhy5cvnz179vTp00ePHu3u7rbb7Uq12tXV5fV6O2+22+2yHJYkyTAMnuc5jpMkCcdxCGE6nVYURT1AOBw2TbNarYZCIfcBOs2BYHBza/uHDx589NGDlZXlvb0f7Oy079+/v7q2un1l+8mTJ3fv3m2321evXn38+NHW1mar1Tp16tSrazMDvqwRmxwbnZgYy2RizeZMs/nO+Hgjm83NzMzMz88fP358enp6cnJydnZ2cHBQ0zTTNB0Ox8HJ3v7lxZNrZ791aXX93MoFTY1tbFwEkLQ7HG6Pu7un+1D3IYulp6enp7u722az2e12q9XqOgDmc+EXz6+1b7dv3r5+fad1+szizZ0PxZAU6ANUgDnsC3g9Xq+3z+V2ut0uj8fjdrs9Hs+rZr+/P+AjPHbXgNNO9XsA7QsiJ4n6SSIACJwMUAEf5feQA33A4/Q5HU63y9NrtzocdrvDjtE0wcnBaCguUzHOCxQksSHW5/cFAv0A+Bk2EIvRERmqsigLLAgGBKgpbIoiAMBZrKxPGtG0GS1n1aFktJRN1FRaChN8iA/TNKJpmuOYSCQUj4dyxXAqGQ1LIVMz40qqbExhRX3MiOTSsXpcNDSVyYzxiSKdUHRTLSYSGscjkiQo6sCbEDAdoJDAJORSxZjCSvHxRKSQ04aL6aISY+PxqJkVy4WhIXPWUHIxyZBEmWFomoYdnx8UhBAhwDAsVtTHzUgpqw7n05l8XolLUZ1OlONHDMFMs7GcMVpM1SJymKRwiCiEII0g3QFCCGD1aCEeN3J6PZsxjXRUZHkJqVl1JCcmUoxQTI0V1NGMWgnzihxSOl8KAhQgKEBACDBTTuo5AUVZq83WbbNDVTUbQ1RYIfyEIcWKxnhBayTkvCHn8kZDo1idjmhyNhyK0jTCjHCp34ljX3nztdffwjCsy+mJpFN8OkPrGs8ZBWU0rwzHRDMZLSejZZ2gDU6rJo42CsfSySQm0DKGYXGy/5dnj1yeTA/0WrA3et7wBelE0gMZyIgZo6hFzLw2YsQSPAQyG87FRsv5mixLmCqkXBarGuz73unR/b/cfd6a/86JkY9Pj2YE2sNLRIjXTVkQOUACnuU7ciEKQDIUCrEsg3n6+jh3b5EOvHWo6yffnt7//Mq/Pt18fuvEtSO5N3usfgo3S0x+kjfyIVnhOAEiiCDszAwhiC3XjfdzyvUbLac/kCN8q8MG4Xe/hmGM1+GyHqLogFnlM+NMuirnh5TCNJ8oMrquKWK803ypEP340rvPP/3ZqfeO//1HK1sz5V4cLR4dl929vX12zeTTDa74Np+tRUsN1awzehFWCvWxzHxaLWPHTPmLu4v7f77z7y/a+3/Y+fIX312/1rp3dW1MwtnObiMhQseydKqgpob4whE+Ueaq2ZGiNqFJSczu9t5bnfvN979xZqK0OVb752fX9r/88a+2mhslZS4dHSApBCBFAAgQLyLFZLQ0V0mN14yZuJzBhvXQh18fv3xmdne9+f5cY2/jq//49QcLw+nb09m0SAdInKEhwxyk1SsWyLFcRNC0cApbrBo33q3dOX90qdn46Vbz5MJ0rl5GRPCdY5FUKaGKSYQQCXAS4uiAhaZfTRsACvvs8uxfH5392+Nzf2o1f3/jawujGau7D0IAGEpT1ZI+NmjOpNWqKhqoE5wEgB2R/u8NbP/z7f/87sr+b6/88WqzxpGLpojwAOrkLKQoigI4y7JRUc+qdU01dDmjigbT8RT4n1T/BXdR/JE3X+zEAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Thumbnail para Reels\"\n        title=\"Thumbnail para Reels\"\n        src=\"/static/352db45cb6eb4b617148e7cfaf35c1dd/42a19/instagram-reels-thumbnail.png\"\n        srcset=\"/static/352db45cb6eb4b617148e7cfaf35c1dd/e3135/instagram-reels-thumbnail.png 256w,\n/static/352db45cb6eb4b617148e7cfaf35c1dd/06341/instagram-reels-thumbnail.png 512w,\n/static/352db45cb6eb4b617148e7cfaf35c1dd/42a19/instagram-reels-thumbnail.png 1024w,\n/static/352db45cb6eb4b617148e7cfaf35c1dd/b4ad3/instagram-reels-thumbnail.png 1080w\"\n        sizes=\"(max-width: 1024px) 100vw, 1024px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\">Thumbnail para Reels</figcaption>\n  </figure></p>\n<h2 id=\"criando-a-thumbnail\" style=\"position:relative;\"><a href=\"#criando-a-thumbnail\" aria-label=\"criando a thumbnail permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Criando a thumbnail</h2>\n<p>Agora que nós temos o design, nós podemos começar a programar. Primeiro, nós precisamos criar uma função que irá criar a thumbnail para nós, e ela irá receber uma imagem de fundo, uma imagem de primeiro plano, um título e o caminho para salvar a thumbnail como parâmetros.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">generateImageForPost</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span>\r\n  <span class=\"token parameter\">backgroundImagePath<span class=\"token punctuation\">,</span>\r\n  foregroundImagePath<span class=\"token punctuation\">,</span>\r\n  title<span class=\"token punctuation\">,</span>\r\n  outputPath</span>\r\n<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n  <span class=\"token keyword\">const</span> backgroundImage <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">loadImage</span><span class=\"token punctuation\">(</span>backgroundImagePath<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token keyword\">const</span> foregroundImage <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">loadImage</span><span class=\"token punctuation\">(</span>foregroundImagePath<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n  <span class=\"token keyword\">const</span> canvas <span class=\"token operator\">=</span> <span class=\"token function\">createCanvas</span><span class=\"token punctuation\">(</span>backgroundImage<span class=\"token punctuation\">.</span>width<span class=\"token punctuation\">,</span> backgroundImage<span class=\"token punctuation\">.</span>height<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token keyword\">const</span> ctx <span class=\"token operator\">=</span> canvas<span class=\"token punctuation\">.</span><span class=\"token function\">getContext</span><span class=\"token punctuation\">(</span><span class=\"token string\">'2d'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n  ctx<span class=\"token punctuation\">.</span><span class=\"token function\">drawImage</span><span class=\"token punctuation\">(</span>foregroundImage<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n  <span class=\"token comment\">// TODO add text</span>\r\n  <span class=\"token comment\">// addCenteredTextWithBackground(ctx, title, canvas.width, canvas.height);</span>\r\n\r\n  <span class=\"token keyword\">await</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Promise</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">resolve<span class=\"token punctuation\">,</span> reject</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">const</span> out <span class=\"token operator\">=</span> <span class=\"token function\">createWriteStream</span><span class=\"token punctuation\">(</span>outputPath<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">const</span> stream <span class=\"token operator\">=</span> canvas<span class=\"token punctuation\">.</span><span class=\"token function\">createPNGStream</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    stream<span class=\"token punctuation\">.</span><span class=\"token function\">pipe</span><span class=\"token punctuation\">(</span>out<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n    out<span class=\"token punctuation\">.</span><span class=\"token function\">on</span><span class=\"token punctuation\">(</span><span class=\"token string\">'finish'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n      console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'The PNG file was created.'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      <span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n    out<span class=\"token punctuation\">.</span><span class=\"token function\">on</span><span class=\"token punctuation\">(</span><span class=\"token string\">'error'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">err</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n      <span class=\"token function\">reject</span><span class=\"token punctuation\">(</span>err<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Esse código irá carregar as imagens de fundo e primeiro plano, criar um canvas com o mesmo tamanho da imagem de fundo, desenhar a imagem de primeiro plano no canvas, e salvar o canvas como um arquivo PNG. Essa foi a parte fácil, agora nós precisamos adicionar o texto.</p>\n<p>O desafio aqui é adicionar o texto no centro do canvas, e garantir que ele não irá ultrapassar o canvas. Vamos ver como podemos fazer isso.</p>\n<h2 id=\"adicionando-o-texto\" style=\"position:relative;\"><a href=\"#adicionando-o-texto\" aria-label=\"adicionando o texto permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Adicionando o texto</h2>\n<p>Primeiro, nós precisamos criar uma função que irá adicionar o texto no centro do canvas, e ela irá receber o texto e o canvas como parâmetros. Nós iremos fazer isso na função <code class=\"language-text\">addCenteredTextWithBackground</code>.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">addCenteredTextWithBackground</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>\r\n  <span class=\"token parameter\">ctx<span class=\"token punctuation\">,</span>\r\n  text<span class=\"token punctuation\">,</span>\r\n  canvasWidth<span class=\"token punctuation\">,</span>\r\n  canvasHeight</span>\r\n<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n  <span class=\"token keyword\">const</span> fontSize <span class=\"token operator\">=</span> <span class=\"token number\">150</span><span class=\"token punctuation\">;</span>\r\n  ctx<span class=\"token punctuation\">.</span>font <span class=\"token operator\">=</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>fontSize<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">px Impact</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token keyword\">const</span> lines <span class=\"token operator\">=</span> text<span class=\"token punctuation\">.</span><span class=\"token function\">split</span><span class=\"token punctuation\">(</span><span class=\"token string\">' '</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n  <span class=\"token keyword\">const</span> textHeight <span class=\"token operator\">=</span> fontSize <span class=\"token operator\">*</span> lines<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">;</span>\r\n  <span class=\"token keyword\">const</span> rectWidth <span class=\"token operator\">=</span> canvasWidth<span class=\"token punctuation\">;</span>\r\n  <span class=\"token keyword\">const</span> rectHeight <span class=\"token operator\">=</span> textHeight <span class=\"token operator\">+</span> <span class=\"token number\">60</span><span class=\"token punctuation\">;</span>\r\n\r\n  <span class=\"token keyword\">const</span> rectX <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>canvasWidth <span class=\"token operator\">-</span> rectWidth<span class=\"token punctuation\">)</span> <span class=\"token operator\">/</span> <span class=\"token number\">2</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token keyword\">const</span> rectY <span class=\"token operator\">=</span> <span class=\"token number\">300</span><span class=\"token punctuation\">;</span>\r\n\r\n  ctx<span class=\"token punctuation\">.</span>fillStyle <span class=\"token operator\">=</span> <span class=\"token string\">'rgba(0, 0, 0, 0.5)'</span><span class=\"token punctuation\">;</span>\r\n  ctx<span class=\"token punctuation\">.</span><span class=\"token function\">fillRect</span><span class=\"token punctuation\">(</span>rectX<span class=\"token punctuation\">,</span> rectY<span class=\"token punctuation\">,</span> rectWidth<span class=\"token punctuation\">,</span> rectHeight<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n  ctx<span class=\"token punctuation\">.</span>fillStyle <span class=\"token operator\">=</span> <span class=\"token string\">'white'</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">,</span> line<span class=\"token punctuation\">]</span> <span class=\"token keyword\">of</span> lines<span class=\"token punctuation\">.</span><span class=\"token function\">entries</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">const</span> textX <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>canvasWidth <span class=\"token operator\">-</span> ctx<span class=\"token punctuation\">.</span><span class=\"token function\">measureText</span><span class=\"token punctuation\">(</span>line<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>width<span class=\"token punctuation\">)</span> <span class=\"token operator\">/</span> <span class=\"token number\">2</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">const</span> textY <span class=\"token operator\">=</span> rectY <span class=\"token operator\">+</span> fontSize <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span>i <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    ctx<span class=\"token punctuation\">.</span><span class=\"token function\">fillText</span><span class=\"token punctuation\">(</span>line<span class=\"token punctuation\">,</span> textX<span class=\"token punctuation\">,</span> textY<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token punctuation\">}</span>\r\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Essa função irá calcular o tamanho do retângulo que será o fundo do texto, e então irá desenhar o retângulo e o texto no canvas. Infelizmente, apenas fazer <code class=\"language-text\">text.split(' ');</code> não irá funcionar, porque dividir o texto por espaços irá simplesmente aumentar a altura do texto, mas não necessariamente irá fazer o texto caber no canvas.</p>\n<p>Então vamos criar uma função chamada <code class=\"language-text\">breakTextToFitCanvas</code> que irá receber o texto, o contexto do canvas e uma largura máxima como parâmetros, e irá retornar um array de strings com o texto dividido em linhas que irão caber no canvas.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">breakTextToFitCanvas</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">ctx<span class=\"token punctuation\">,</span> text<span class=\"token punctuation\">,</span> maxWidth</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n  <span class=\"token keyword\">const</span> words <span class=\"token operator\">=</span> text<span class=\"token punctuation\">.</span><span class=\"token function\">split</span><span class=\"token punctuation\">(</span><span class=\"token string\">' '</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token keyword\">const</span> lines <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token keyword\">let</span> currentLine <span class=\"token operator\">=</span> words<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\r\n\r\n  <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">let</span> i <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> words<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">const</span> word <span class=\"token operator\">=</span> words<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> width <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> ctx<span class=\"token punctuation\">.</span><span class=\"token function\">measureText</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>currentLine<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\"> </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>word<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>width <span class=\"token operator\">&lt;</span> maxWidth<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n      currentLine <span class=\"token operator\">+=</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\"> </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>word<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\r\n      lines<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span>currentLine<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      currentLine <span class=\"token operator\">=</span> word<span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span>\r\n  <span class=\"token punctuation\">}</span>\r\n\r\n  lines<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span>currentLine<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n  <span class=\"token keyword\">return</span> lines<span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h2 id=\"juntando-tudo\" style=\"position:relative;\"><a href=\"#juntando-tudo\" aria-label=\"juntando tudo permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Juntando tudo</h2>\n<p>Agora que nós temos todas as funções que precisamos, nós podemos juntar tudo e criar a thumbnail. Vamos criar uma função chamada <code class=\"language-text\">generateThumbnail</code> que irá receber o título do vídeo e o caminho para salvar a thumbnail como parâmetros.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">generateThumbnail</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">title<span class=\"token punctuation\">,</span> outputPath</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n  <span class=\"token keyword\">const</span> backgroundImagePath <span class=\"token operator\">=</span> <span class=\"token string\">'./background.png'</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token keyword\">const</span> foregroundImagePath <span class=\"token operator\">=</span> <span class=\"token string\">'./foreground.png'</span><span class=\"token punctuation\">;</span>\r\n\r\n  <span class=\"token keyword\">await</span> <span class=\"token function\">generateImageForPost</span><span class=\"token punctuation\">(</span>\r\n    backgroundImagePath<span class=\"token punctuation\">,</span>\r\n    foregroundImagePath<span class=\"token punctuation\">,</span>\r\n    title<span class=\"token punctuation\">,</span>\r\n    outputPath\r\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>E agora nós podemos chamar essa função e criar a thumbnail.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token function\">generateThumbnail</span><span class=\"token punctuation\">(</span><span class=\"token string\">'How to create thumbnails for your videos with Node.js'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'./thumbnail.png'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h2 id=\"conclusao\" style=\"position:relative;\"><a href=\"#conclusao\" aria-label=\"conclusao permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Conclusão</h2>\n<p>E é isso! Agora você pode criar thumbnails para seus vídeos automaticamente. Eu espero que você tenha gostado desse post, e não se esqueça de ver como <a href=\"/pt-br/blog/coding/publicando-reels-no-instagram-usando-nodejs-e-a-arte-de-superar-limitacoes/\">fazer upload de Reels para o Instagram usando Node.js</a>.</p>\n<p>Até a próxima!</p>","fields":{"postHashId":"Y29kaW5ndHJ1ZW51bGwyMDIzLTEwLTI1VDAwOjAwOjAwLjAwMFo=","slug":"/2023/2023-10-25-como-criar-thumbnails-para-seus-videos-automaticamente-com-nodejs.pt-br/","path":"/blog/coding/como-criar-thumbnails-para-seus-videos-automaticamente-com-nodejs/","locale":"pt-br"},"frontmatter":{"tags":["instagram","miniatura","node","nodejs","javascript","canvas","imagem","vídeo"],"categories":["coding"],"allowComments":true,"publishOnMedium":false,"cover":null,"date":"2023-10-25T00:00:00.000Z","id":null,"path":"como-criar-thumbnails-para-seus-videos-automaticamente-com-nodejs","show":true,"title":"Como criar thumbnails para seus vídeos automaticamente com Node.js","hideExcerpt":false,"subtitle":"A melhor forma de criar thumbnails para seus vídeos no Instagram"}}},{"node":{"html":"<p>Fala aí, pessoal! É difícil ser nerd nos dias de hoje, tantos eventos são exclusivos para pessoas da mídia e influenceres - <a href=\"https://www.ign.com/articles/2017/02/08/e3-2017-open-to-the-public-tickets-on-sale-next-week\" target=\"_blank\" rel=\"noreferrer\">até a E3 foi um evento apenas para o comércio por muitos anos</a>. Então, digamos que você já esteja feliz com o seu trabalho e realmente não queira se tornar um jornalista. A sua melhor aposta é se tornar um influencer e talvez ser convidado para o próximo evento de lançamento do <code class=\"language-text\">[insira o nome da franquia de jogos]</code>, certo?</p>\n<p>Tenho muita sorte de ter trabalhado como jornalista freelancer para vários meios de comunicação no Brasil, mas desde que me mudei para a Holanda, não posso mais ir a esses eventos, pois não tenho contatos na mídia aqui e também não falo holandês. Uma das coisas que perdi este ano foi o <a href=\"https://www.youtube.com/watch?v=rkeZx_wDLKs\" target=\"_blank\" rel=\"noreferrer\">evento de lançamento de The Last of Us em Amsterdam</a> e recentemente (semana passada) o <a href=\"https://playsense.nl/558031/prijsvraag-ga-mee-naar-de-marvels-spider-man-2-launchparty/\" target=\"_blank\" rel=\"noreferrer\">evento de Marvel Spider-Man 2 em Hilversum</a>.</p>\n<p>Ok, e agora? Bem, decidi me tornar um influencer e comecei a postar no Instagram, mas realmente não gosto de postar coisas no Instagram. Prefiro passar o meu tempo programando e, claro, se tornar uma celebridade do Instagram hoje em dia não é uma tarefa fácil. Então decidi automatizar algumas partes disso, afinal, a Meta oferece uma API que nos permite fazer muitas coisas, incluindo postar Stories, Reels ou fotos. O que poderia dar errado?</p>\n<p><figure class=\"gatsby-resp-image-figure\" style=\"\">\n    <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1024px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 57.03125%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAAsTAAALEwEAmpwYAAACqklEQVQozwGfAmD9AB4DGR8HJSENLiERNCAVOiAaQCAdRSAhSSAlTh0lTiIwVz9RcjM/ZBgcRRsaRCAYPiETNiENLx8HJR4DGQAeBB0gCyshEjUgFjsfHEMfIkofJ08dKlIcL1cbNFxZb5Bxgqt5jadjdJA3N1gbHUYcGD8iFDcgDCweBB4AHwYiIQ4wIRU5IBpBHyBJHidPHS1VIjtjKEVwO1qDX3qsYHeoTFmMVFFoOCA1UUheOC5MHBQ7Ig8xHwYkAB8HJCERMyAYPh8eRh4kTB4vVy1LdC5ReUFeiEd+tWir42mm2ExTky42Vyg5V08xOjgzUBsXPyIRNB8HJQAfCCYhEjYgG0IfIkkfL1Y3TnQ2U3sxXIZLirxHndVdrN5IbKkmOmxKfZ2Dm60tKEMaJ1EhHkUhFDgfCScAHwkoIRU6IB9GHSdNJj1sMlGCQGKWdqrhgL/yWK3kRIa1OnCXUomnc5u1QztTGTNXHi5VHyJJIRY8HwopACALKyEXPB8hSCUxVTFReCFMbV1ep7uB5cyb6naUyidljSxXfV1vkE0/VjJAVBg+Yh4xVh8mTCEZPiAMLAAhDjAhG0AdJ00cNVY/U3JAWn+Uc4P9gpzRbclKZqAjZIMmWX4bJEkwGS85VGoWRWYbOVodLFEgHUIhDzEAIh9BIjRWJkZlK118OEZmSGGBi7S39tKyzYS5Up24S5qtQHWVOk6DLSFCZ09TPnOMLWJ/J1BuIzhaISBDACY9XTNfeUZ/mz5cmDZHY02Bs06Lz2amynOuzlmdz2m20kZefjJDeiMjSjwcKFhkcEeIokF0jTJcdyU7WwAlMVIuTWw6Z4Q+aYY+ZoxUj7pqrc1UkclEeLlRispknsZdkbRKeKA7WoQtQms1R2gvTm8tR2gpPl4kLE2TfspoXO4w5gAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Automatização\"\n        title=\"Automatização\"\n        src=\"/static/275b237567c6ae515dbfdcf11f91ffc4/42a19/auto-post-instagram.png\"\n        srcset=\"/static/275b237567c6ae515dbfdcf11f91ffc4/e3135/auto-post-instagram.png 256w,\n/static/275b237567c6ae515dbfdcf11f91ffc4/06341/auto-post-instagram.png 512w,\n/static/275b237567c6ae515dbfdcf11f91ffc4/42a19/auto-post-instagram.png 1024w,\n/static/275b237567c6ae515dbfdcf11f91ffc4/e8464/auto-post-instagram.png 1536w,\n/static/275b237567c6ae515dbfdcf11f91ffc4/445c6/auto-post-instagram.png 1792w\"\n        sizes=\"(max-width: 1024px) 100vw, 1024px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\">Automatização</figcaption>\n  </figure></p>\n<h2 id=\"a-api-do-instagram\" style=\"position:relative;\"><a href=\"#a-api-do-instagram\" aria-label=\"a api do instagram permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>A API do Instagram</h2>\n<p>Show, então simplesmente <code class=\"language-text\">npm install axios</code> e começamos a postar no Instagram, certo? Bem… por algum motivo, você não pode enviar vídeos para o Instagram diretamente via API, você precisa fornecer uma URL de onde eles baixarão o seu vídeo… tipo… sério? Quer dizer, <a href=\"https://www.dailymail.co.uk/news/article-3263921/What-mean-no-one-Mars-Scores-people-believe-blockbuster-movie-Martian-based-true-story.html\" target=\"_blank\" rel=\"noreferrer\">enviamos pessoas para Marte</a>, mas não podemos enviar um vídeo para o Instagram sem um link?</p>\n<p>Mas não tema, estou aqui para ajudá-lo a resolver esse problema, caro desenvolvedor. Criei um script Node.js que permitirá que você publique vídeos no Instagram, e vou explicar como funciona.</p>\n<h2 id=\"o-dilema-de-postar-video-no-instagram\" style=\"position:relative;\"><a href=\"#o-dilema-de-postar-video-no-instagram\" aria-label=\"o dilema de postar video no instagram permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>O dilema de postar vídeo no Instagram</h2>\n<p>Antes de mergulharmos de cabeça, vamos preparar as nossas ferramentas. Instale as bibliotecas necessárias:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">npm</span> <span class=\"token function\">install</span> axios @ngrok/ngrok express fluent-ffmpeg ffmpeg-static</code></pre></div>\n<p>Agora, vamos destrinchar o código e entender a mágica por trás dele.</p>\n<p>Primeiro, precisamos configurar o nosso ambiente. Estamos usando <code class=\"language-text\">axios</code> para solicitações HTTP, <code class=\"language-text\">ngrok</code> para expor o nosso servidor local ao mundo (porque, você sabe, o Instagram precisa de um link) e express para servir o nosso vídeo.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> axios <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'axios'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">const</span> ngrok <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'@ngrok/ngrok'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">const</span> express <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'express'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token keyword\">const</span> <span class=\"token constant\">GRAPH_API_VERSION</span> <span class=\"token operator\">=</span> <span class=\"token string\">'v18.0'</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">const</span> <span class=\"token constant\">PORT</span> <span class=\"token operator\">=</span> <span class=\"token number\">3000</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">const</span> expressApp <span class=\"token operator\">=</span> <span class=\"token function\">express</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Este código simplesmente faz uma requisição <code class=\"language-text\">POST</code> para a API do Instagram para criar um container e “fazer o upload” do vídeo para ele.</p>\n<p>O termo “fazer o upload” está entre aspas porque nós não estamos realmente fazendo o upload do vídeo, nós estamos apenas dizendo ao Instagram onde encontrá-lo.</p>\n<p>Agora, vamos para a parte divertida. Precisamos enviar o nosso vídeo para um contêiner no Instagram. Mas lembre-se, não estamos realmente enviando o vídeo. Estamos apenas dizendo ao Instagram onde encontrá-lo. Então, precisamos criar um contêiner e depois enviar o vídeo para ele.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">uploadReelsToContainer</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span>\r\n  <span class=\"token parameter\">accessToken<span class=\"token punctuation\">,</span>\r\n  instagramAccountId<span class=\"token punctuation\">,</span>\r\n  caption<span class=\"token punctuation\">,</span>\r\n  videoUrl<span class=\"token punctuation\">,</span>\r\n  coverUrl</span>\r\n<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n  <span class=\"token keyword\">const</span> response <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> axios<span class=\"token punctuation\">.</span><span class=\"token function\">post</span><span class=\"token punctuation\">(</span>\r\n    <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">https://graph.facebook.com/</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token constant\">GRAPH_API_VERSION</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">/</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>instagramAccountId<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">/media</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\r\n    <span class=\"token punctuation\">{</span>\r\n      <span class=\"token literal-property property\">access_token</span><span class=\"token operator\">:</span> accessToken<span class=\"token punctuation\">,</span>\r\n      caption<span class=\"token punctuation\">,</span>\r\n      <span class=\"token literal-property property\">media_type</span><span class=\"token operator\">:</span> <span class=\"token string\">'REELS'</span><span class=\"token punctuation\">,</span>\r\n      <span class=\"token literal-property property\">video_url</span><span class=\"token operator\">:</span> videoUrl<span class=\"token punctuation\">,</span>\r\n      <span class=\"token literal-property property\">cover_url</span><span class=\"token operator\">:</span> coverUrl<span class=\"token punctuation\">,</span>\r\n    <span class=\"token punctuation\">}</span>\r\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n  <span class=\"token keyword\">return</span> response<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Legal, mas você deve estar pensando, “de onde eu consigo o <code class=\"language-text\">accessToken</code> e <code class=\"language-text\">instagramAccountId</code>?” Bem, você precisa criar um aplicativo no Facebook e depois criar uma conta no Instagram e vincular a sua conta do Instagram ao seu aplicativo do Facebook. Você pode encontrar mais informações sobre isso <a href=\"https://developers.facebook.com/docs/instagram-api/getting-started\" target=\"_blank\" rel=\"noreferrer\">aqui</a>. Para ser honesto, esta é a parte mais difícil do processo, mas uma vez que você consiga fazer funcionar, está tudo certo.</p>\n<p>Ah, espere, você também quer saber como conseguir o <code class=\"language-text\">videoUrl</code> e <code class=\"language-text\">coverUrl</code>, certo? Paciência, meu doce padawan, chegaremos lá.</p>\n<p>Depois que o contêiner é criado, precisamos verificar o seu status. Precisamos esperar até que o vídeo seja totalmente baixado pelo Instagram.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">getStatusOfUpload</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">accessToken<span class=\"token punctuation\">,</span> igContainerId</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n  <span class=\"token keyword\">const</span> response <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> axios<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span>\r\n    <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">https://graph.facebook.com/</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token constant\">GRAPH_API_VERSION</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">/</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>igContainerId<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\r\n    <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">params</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">access_token</span><span class=\"token operator\">:</span> accessToken<span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">fields</span><span class=\"token operator\">:</span> <span class=\"token string\">'status_code'</span> <span class=\"token punctuation\">}</span> <span class=\"token punctuation\">}</span>\r\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n  <span class=\"token keyword\">return</span> response<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">.</span>status_code<span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Se o status for <code class=\"language-text\">FINISHED</code>, então podemos prosseguir para a próxima etapa, que é finalmente publicar o vídeo, ou como a Meta chama: <code class=\"language-text\">publicação de mídia</code>.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">publishMediaContainer</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">accessToken<span class=\"token punctuation\">,</span> instagramAccountId<span class=\"token punctuation\">,</span> creationId</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n  <span class=\"token keyword\">const</span> response <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> axios<span class=\"token punctuation\">.</span><span class=\"token function\">post</span><span class=\"token punctuation\">(</span>\r\n    <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">https://graph.facebook.com/</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token constant\">GRAPH_API_VERSION</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">/</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>instagramAccountId<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">/media_publish</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\r\n    <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">access_token</span><span class=\"token operator\">:</span> accessToken<span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">creation_id</span><span class=\"token operator\">:</span> creationId <span class=\"token punctuation\">}</span>\r\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n  <span class=\"token keyword\">return</span> response<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>E qual é o propósito de postar isso e obter todos esses IDs estranhos? O que realmente queremos é a URL da postagem do Instagram, certo? Para isso, precisamos obter o <code class=\"language-text\">permalink_url</code> da resposta.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">fetchPermalink</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">accessToken<span class=\"token punctuation\">,</span> mediaId</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n  <span class=\"token keyword\">const</span> response <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> axios<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span>\r\n    <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">https://graph.facebook.com/</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token constant\">GRAPH_API_VERSION</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">/</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>mediaId<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\r\n    <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">params</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">access_token</span><span class=\"token operator\">:</span> accessToken<span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">fields</span><span class=\"token operator\">:</span> <span class=\"token string\">'permalink'</span> <span class=\"token punctuation\">}</span> <span class=\"token punctuation\">}</span>\r\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n  <span class=\"token keyword\">return</span> response<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h2 id=\"vamos-ajuntar-tudo\" style=\"position:relative;\"><a href=\"#vamos-ajuntar-tudo\" aria-label=\"vamos ajuntar tudo permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Vamos “ajuntar” tudo</h2>\n<p>Eu tenho adiado essa parte por um tempo, mas agora é hora de explicar como obter o <code class=\"language-text\">videoUrl</code> e <code class=\"language-text\">coverUrl</code>, e é aqui que o <code class=\"language-text\">ngrok</code> entra em jogo. Precisamos criar um servidor local <code class=\"language-text\">express</code> que fornecerá o nosso vídeo e capa, e então expô-lo ao mundo usando <code class=\"language-text\">ngrok</code>.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\">expressApp<span class=\"token punctuation\">.</span><span class=\"token function\">listen</span><span class=\"token punctuation\">(</span>port<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\nexpressApp<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/video'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">req<span class=\"token punctuation\">,</span> res</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> res<span class=\"token punctuation\">.</span><span class=\"token function\">sendFile</span><span class=\"token punctuation\">(</span>videoFilePath<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\nexpressApp<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/cover'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">req<span class=\"token punctuation\">,</span> res</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> res<span class=\"token punctuation\">.</span><span class=\"token function\">sendFile</span><span class=\"token punctuation\">(</span>thumbnailFilePath<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Com este código, serviremos o nosso vídeo e capa em <code class=\"language-text\">http://localhost:3000/video</code> e <code class=\"language-text\">http://localhost:3000/cover</code>, respectivamente. As variáveis <code class=\"language-text\">videoFilePath</code> e <code class=\"language-text\">thumbnailFilePath</code> devem conter um caminho local para os arquivos de vídeo e capa.</p>\n<p>Agora vamos expor isso ao mundo usando <code class=\"language-text\">ngrok</code>. Isso nos dará uma URL que podemos usar para fazer upload do nosso vídeo no Instagram.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> listener <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> ngrok<span class=\"token punctuation\">.</span><span class=\"token function\">connect</span><span class=\"token punctuation\">(</span>port<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">const</span> url <span class=\"token operator\">=</span> listener<span class=\"token punctuation\">.</span><span class=\"token function\">url</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token keyword\">const</span> videoUrl <span class=\"token operator\">=</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>url<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">/video</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">const</span> coverUrl <span class=\"token operator\">=</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>url<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">/cover</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>E agora juntando tudo:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">postInstagramReel</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span>\r\n  <span class=\"token parameter\">accessToken<span class=\"token punctuation\">,</span>\r\n  pageId<span class=\"token punctuation\">,</span>\r\n  description<span class=\"token punctuation\">,</span>\r\n  thumbnailFilePath<span class=\"token punctuation\">,</span>\r\n  videoFilePath</span>\r\n<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n  <span class=\"token keyword\">const</span> expressApp <span class=\"token operator\">=</span> <span class=\"token function\">express</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  expressApp<span class=\"token punctuation\">.</span><span class=\"token function\">listen</span><span class=\"token punctuation\">(</span><span class=\"token constant\">PORT</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n  expressApp<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/video'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">req<span class=\"token punctuation\">,</span> res</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> res<span class=\"token punctuation\">.</span><span class=\"token function\">sendFile</span><span class=\"token punctuation\">(</span>videoFilePath<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  expressApp<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/cover'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">req<span class=\"token punctuation\">,</span> res</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> res<span class=\"token punctuation\">.</span><span class=\"token function\">sendFile</span><span class=\"token punctuation\">(</span>thumbnailFilePath<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n  <span class=\"token keyword\">const</span> listener <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> ngrok<span class=\"token punctuation\">.</span><span class=\"token function\">connect</span><span class=\"token punctuation\">(</span><span class=\"token constant\">PORT</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token keyword\">const</span> url <span class=\"token operator\">=</span> listener<span class=\"token punctuation\">.</span><span class=\"token function\">url</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">id</span><span class=\"token operator\">:</span> containerId <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">uploadReelsToContainer</span><span class=\"token punctuation\">(</span>\r\n    accessToken<span class=\"token punctuation\">,</span>\r\n    pageId<span class=\"token punctuation\">,</span>\r\n    description<span class=\"token punctuation\">,</span>\r\n    <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>url<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">/video</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\r\n    <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>url<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">/cover</span><span class=\"token template-punctuation string\">`</span></span>\r\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n  <span class=\"token keyword\">let</span> status <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token keyword\">const</span> <span class=\"token constant\">TWO_MINUTES</span> <span class=\"token operator\">=</span> <span class=\"token number\">2</span> <span class=\"token operator\">*</span> <span class=\"token number\">60</span> <span class=\"token operator\">*</span> <span class=\"token number\">1000</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token keyword\">const</span> startTime <span class=\"token operator\">=</span> Date<span class=\"token punctuation\">.</span><span class=\"token function\">now</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n  <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span>status <span class=\"token operator\">!==</span> <span class=\"token string\">'FINISHED'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>Date<span class=\"token punctuation\">.</span><span class=\"token function\">now</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span> startTime <span class=\"token operator\">></span> <span class=\"token constant\">TWO_MINUTES</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n      <span class=\"token keyword\">await</span> ngrok<span class=\"token punctuation\">.</span><span class=\"token function\">disconnect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Error</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Upload took longer than 2 minutes.'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span>\r\n\r\n    status <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">getStatusOfUpload</span><span class=\"token punctuation\">(</span>accessToken<span class=\"token punctuation\">,</span> containerId<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">await</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Promise</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">r</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">setTimeout</span><span class=\"token punctuation\">(</span>r<span class=\"token punctuation\">,</span> <span class=\"token number\">1000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token punctuation\">}</span>\r\n\r\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">id</span><span class=\"token operator\">:</span> creationId <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">publishMediaContainer</span><span class=\"token punctuation\">(</span>accessToken<span class=\"token punctuation\">,</span> pageId<span class=\"token punctuation\">,</span> containerId<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> permalink <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">fetchPermalink</span><span class=\"token punctuation\">(</span>accessToken<span class=\"token punctuation\">,</span> creationId<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n  <span class=\"token keyword\">await</span> ngrok<span class=\"token punctuation\">.</span><span class=\"token function\">disconnect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span> creationId<span class=\"token punctuation\">,</span> permalink <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Esta função iniciará o servidor do <code class=\"language-text\">express</code> e definirá a URL do <code class=\"language-text\">ngrok</code>. Em seguida, ele “fará o upload” do vídeo para o Instagram e aguardará até que o vídeo seja totalmente baixado. Depois disso, ele publicará o vídeo e retornará a URL da postagem do Instagram.</p>\n<p>E é isso! Agora você pode postar vídeos no Instagram usando Node.js. Espero que tenha gostado.</p>\n<p>Espere, o quê? Ah… você quer saber por que fiz você instalar o <code class=\"language-text\">ffmpeg</code>? Ok, vamos falar sobre isso.</p>\n<h2 id=\"garantindo-que-o-video-esteja-pronto-para-o-instagram\" style=\"position:relative;\"><a href=\"#garantindo-que-o-video-esteja-pronto-para-o-instagram\" aria-label=\"garantindo que o video esteja pronto para o instagram permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Garantindo que o vídeo esteja pronto para o Instagram</h2>\n<p>Tudo está bom e o código está bonito e elegante, mas há mais uma coisa que precisamos fazer antes de postar nosso vídeo no Instagram. Precisamos garantir que o vídeo esteja no formato correto. O Instagram tem alguns <a href=\"https://developers.facebook.com/docs/video-api/guides/publishing\" target=\"_blank\" rel=\"noreferrer\">requisitos</a> para vídeos, e precisamos garantir que nosso vídeo atenda a esses requisitos. Para isso, usaremos o <code class=\"language-text\">ffmpeg</code>.</p>\n<p>Existem dois pacotes do NPM ótimos que nos permitem usar o <code class=\"language-text\">ffmpeg</code> no Node.js: <code class=\"language-text\">fluent-ffmpeg</code> e <code class=\"language-text\">ffmpeg-static</code>. O primeiro é um wrapper em torno do <code class=\"language-text\">ffmpeg</code>, e o segundo é uma compilação estática do <code class=\"language-text\">ffmpeg</code> que podemos usar no nosso código.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">processVideo</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">inputPath<span class=\"token punctuation\">,</span> outputPath</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n  <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Promise</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">resolve<span class=\"token punctuation\">,</span> reject</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token function\">ffmpeg</span><span class=\"token punctuation\">(</span>inputPath<span class=\"token punctuation\">)</span>\r\n      <span class=\"token punctuation\">.</span><span class=\"token function\">toFormat</span><span class=\"token punctuation\">(</span><span class=\"token string\">'mp4'</span><span class=\"token punctuation\">)</span>\r\n      <span class=\"token punctuation\">.</span><span class=\"token function\">size</span><span class=\"token punctuation\">(</span><span class=\"token string\">'1080x1920'</span><span class=\"token punctuation\">)</span>\r\n      <span class=\"token punctuation\">.</span><span class=\"token function\">aspect</span><span class=\"token punctuation\">(</span><span class=\"token string\">'9:16'</span><span class=\"token punctuation\">)</span>\r\n      <span class=\"token punctuation\">.</span><span class=\"token function\">videoCodec</span><span class=\"token punctuation\">(</span><span class=\"token string\">'libx264'</span><span class=\"token punctuation\">)</span>\r\n      <span class=\"token punctuation\">.</span><span class=\"token function\">audioCodec</span><span class=\"token punctuation\">(</span><span class=\"token string\">'aac'</span><span class=\"token punctuation\">)</span>\r\n      <span class=\"token punctuation\">.</span><span class=\"token function\">audioChannels</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span>\r\n      <span class=\"token punctuation\">.</span><span class=\"token function\">audioFrequency</span><span class=\"token punctuation\">(</span><span class=\"token number\">48000</span><span class=\"token punctuation\">)</span>\r\n      <span class=\"token punctuation\">.</span><span class=\"token function\">audioBitrate</span><span class=\"token punctuation\">(</span><span class=\"token string\">'128k'</span><span class=\"token punctuation\">)</span>\r\n      <span class=\"token punctuation\">.</span><span class=\"token function\">on</span><span class=\"token punctuation\">(</span><span class=\"token string\">'end'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Processing finished. Output saved to </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>outputPath<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\r\n      <span class=\"token punctuation\">.</span><span class=\"token function\">on</span><span class=\"token punctuation\">(</span><span class=\"token string\">'error'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">err</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">reject</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">Error</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Error processing video: </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>err<span class=\"token punctuation\">.</span>message<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\r\n      <span class=\"token punctuation\">.</span><span class=\"token function\">save</span><span class=\"token punctuation\">(</span>outputPath<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Este código garantirá que o vídeo esteja no formato correto. Ele converterá o vídeo para <code class=\"language-text\">mp4</code>, redimensionará para <code class=\"language-text\">1080x1920</code> e garantirá que a proporção seja <code class=\"language-text\">9:16</code>. Também garantirá que o codec de vídeo seja <code class=\"language-text\">libx264</code> e que o codec de áudio seja <code class=\"language-text\">aac</code>. Além disso, garantirá que o áudio tenha 2 canais, uma frequência de <code class=\"language-text\">48000</code> e uma taxa de bits de <code class=\"language-text\">128k</code>.</p>\n<h2 id=\"conclusao\" style=\"position:relative;\"><a href=\"#conclusao\" aria-label=\"conclusao permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Conclusão</h2>\n<p>E é isso, com um pouco de código e astúcia, agora podemos postar vídeos no Instagram usando Node.js. Valeu a pena as horas que passei pesquisando e codificando isso? Provavelmente não, mas me diverti e aprendi muito, então acho que valeu a pena. Uhmn…</p>\n<p>Ah, e não se esqueça de me seguir no Instagram em <a href=\"https://www.instagram.com/opablopirata/\" target=\"_blank\" rel=\"noreferrer\">@opablopirata</a> e me ajude a me tornar um influencer. Eu prometo que vou postar com frequência. Eu sou apenas um pouco preguiçoso, mas vou chegar lá.</p>\n<p>Espero que tenha gostado e que isso tenha sido útil para você de alguma forma. Até a próxima! Saúde!</p>","fields":{"postHashId":"Y29kaW5ndHJ1ZW51bGwyMDIzLTEwLTE0VDAwOjAwOjAwLjAwMFo=","slug":"/2023/2023-10-14-publicando-reels-no-instagram-usando-nodejs-e-a-arte-de-superar-limitacoes.pt-br/","path":"/blog/coding/publicando-reels-no-instagram-usando-nodejs-e-a-arte-de-superar-limitacoes/","locale":"pt-br"},"frontmatter":{"tags":["instagram","node","nodejs","javascript","axios","ngrok","ffmpeg","automação"],"categories":["coding"],"allowComments":true,"publishOnMedium":false,"cover":null,"date":"2023-10-14T00:00:00.000Z","id":null,"path":"publicando-reels-no-instagram-usando-nodejs-e-a-arte-de-superar-limitacoes","show":true,"title":"Publicando Reels no Instagram usando Node.js e a arte de superar limitações","hideExcerpt":false,"subtitle":"Afinal, por que gastar 30 segundos fazendo algo manualmente quando você pode gastar 30 horas automatizando-o?"}}},{"node":{"html":"<p>Quer alcançar os seus objetivos de fitness, como perder peso ou ganhar músculos? Tudo se resume a saber quantas calorias você queima em um dia, o que é chamado de Gasto Energético Diário Total (TDEE).</p>\n<p>Pense no TDEE como o número dourado que guia as suas escolhas de alimentação e treino. Você precisa conhecê-lo para descobrir quanto comer se quiser manter, ganhar alguns quilos ou emagrecer.</p>\n<p>Agora, existem várias ferramentas online que podem estimar o seu TDEE, mas obter dados do seu próprio corpo lhe dará o valor real.</p>\n<p>Eu entendo, calcular esses números pode ser chato, especialmente se a matemática não for a sua praia. Mas ei, a Google Fitness API está aqui para te ajudar nessa!</p>\n<p>Neste post, mostraremos como usar a Google Fitness API para calcular o seu TDEE e acompanhar o seu progresso ao longo do tempo.</p>\n<p>Claro, para que isso funcione, você precisa monitorar consistentemente o seu peso e ingestão de alimentos. Eu recomendo obter uma balança de bioimpedância, que pode medir o seu peso, percentual de gordura corporal e massa muscular e o aplicativo <a href=\"https://lifesum.com/\" target=\"_blank\" rel=\"noreferrer\">Lifesum</a> para rastrear a sua alimentação.</p>\n<h2 id=\"usando-a-google-fitness-api\" style=\"position:relative;\"><a href=\"#usando-a-google-fitness-api\" aria-label=\"usando a google fitness api permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Usando a Google Fitness API</h2>\n<p>Já entendeu o básico sobre o TDEE? Show, agora vamos mergulhar em como podemos obter essas informações usando a Google Fitness API. Essa ferramenta bacana permite que programadores obtenham dados do Google Fit – esse é o aplicativo que coleta informações de saúde do seu telefone, smartwatches e outros aplicativos.</p>\n<p>Para começar com a Google Fitness API, primeiro, vá ao Google Cloud Console e ative a Fitness API. Depois, precisaremos criar credenciais para o nosso projeto, para podermos acessar a API. Para obter mais detalhes, consulte o <a href=\"https://developers.google.com/fit/rest/v1/get-started?hl=pt-br\" target=\"_blank\" rel=\"noreferrer\">Guia de primeiros passos</a>.</p>\n<p>Uma vez que tudo esteja configurado, é só usar a API para colocar as mãos em alguns dados suculentos do Google Fit. Estamos falando de estatísticas de peso e alimentação, que nos ajudarão a acertar o cálculo do nosso TDEE.</p>\n<h2 id=\"recuperando-e-analisando-os-dados\" style=\"position:relative;\"><a href=\"#recuperando-e-analisando-os-dados\" aria-label=\"recuperando e analisando os dados permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Recuperando e Analisando os Dados</h2>\n<p>Agora que temos a nossa Google Fitness API configurada e pronta para usar, é hora de começar a recuperar e analisar os dados de que precisamos para calcular o nosso TDEE. O primeiro passo é fazer uma solicitação à API, pedindo os nossos dados de peso e nutrição dos últimos 30 dias.</p>\n<p>Aqui está um exemplo de como essa solicitação pode ser feita:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> google <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'googleapis'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">fetchData</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n  <span class=\"token keyword\">const</span> auth <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> google<span class=\"token punctuation\">.</span>auth<span class=\"token punctuation\">.</span><span class=\"token function\">fromJSON</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\r\n    <span class=\"token literal-property property\">type</span><span class=\"token operator\">:</span> process<span class=\"token punctuation\">.</span>env<span class=\"token punctuation\">.</span><span class=\"token constant\">TOKEN_TYPE</span><span class=\"token punctuation\">,</span>\r\n    <span class=\"token literal-property property\">client_id</span><span class=\"token operator\">:</span> process<span class=\"token punctuation\">.</span>env<span class=\"token punctuation\">.</span><span class=\"token constant\">CLIENT_ID</span><span class=\"token punctuation\">,</span>\r\n    <span class=\"token literal-property property\">client_secret</span><span class=\"token operator\">:</span> process<span class=\"token punctuation\">.</span>env<span class=\"token punctuation\">.</span><span class=\"token constant\">CLIENT_SECRET</span><span class=\"token punctuation\">,</span>\r\n    <span class=\"token literal-property property\">refresh_token</span><span class=\"token operator\">:</span> process<span class=\"token punctuation\">.</span>env<span class=\"token punctuation\">.</span><span class=\"token constant\">REFRESH_TOKEN</span><span class=\"token punctuation\">,</span>\r\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n  auth<span class=\"token punctuation\">.</span>scopes <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>\r\n    <span class=\"token string\">'https://www.googleapis.com/auth/fitness.nutrition.read'</span><span class=\"token punctuation\">,</span>\r\n    <span class=\"token string\">'https://www.googleapis.com/auth/fitness.body.read'</span><span class=\"token punctuation\">,</span>\r\n  <span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\r\n\r\n\r\n  <span class=\"token keyword\">const</span> endDate <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Date</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token keyword\">const</span> startDate <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Date</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  startDate<span class=\"token punctuation\">.</span><span class=\"token function\">setDate</span><span class=\"token punctuation\">(</span>startDate<span class=\"token punctuation\">.</span><span class=\"token function\">getDate</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span> <span class=\"token number\">30</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// past 30 days</span>\r\n  <span class=\"token keyword\">const</span> startTimeNs <span class=\"token operator\">=</span> startDate<span class=\"token punctuation\">.</span><span class=\"token function\">getTime</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token number\">1000000</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token keyword\">const</span> endTimeNs <span class=\"token operator\">=</span> endDate<span class=\"token punctuation\">.</span><span class=\"token function\">getTime</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token number\">1000000</span><span class=\"token punctuation\">;</span>\r\n\r\n  <span class=\"token keyword\">const</span> weightData <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">fetchDataForDataSource</span><span class=\"token punctuation\">(</span>\r\n    <span class=\"token string\">'derived:com.google.weight:com.google.android.gms:merge_weight'</span><span class=\"token punctuation\">,</span>\r\n    auth<span class=\"token punctuation\">,</span>\r\n    startTimeNs<span class=\"token punctuation\">,</span>\r\n    endTimeNs\r\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n  <span class=\"token keyword\">const</span> fatPercentageData <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">fetchDataForDataSource</span><span class=\"token punctuation\">(</span>\r\n    <span class=\"token string\">'derived:com.google.body.fat.percentage:com.google.android.gms:merged'</span><span class=\"token punctuation\">,</span>\r\n    auth<span class=\"token punctuation\">,</span>\r\n    startTimeNs<span class=\"token punctuation\">,</span>\r\n    endTimeNs\r\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n  <span class=\"token keyword\">const</span> nutritionData <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">fetchDataForDataSource</span><span class=\"token punctuation\">(</span>\r\n    <span class=\"token string\">'derived:com.google.nutrition:com.google.android.gms:merged'</span><span class=\"token punctuation\">,</span>\r\n    auth<span class=\"token punctuation\">,</span>\r\n    startTimeNs<span class=\"token punctuation\">,</span>\r\n    endTimeNs\r\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>A função <code class=\"language-text\">google.auth.fromJSON</code> é usada para criar um objeto de autenticação que pode ser utilizado para fazer solicitações à Google Fitness API. Em seguida, definimos os escopos para os quais queremos solicitar dados, que neste caso são <code class=\"language-text\">https://www.googleapis.com/auth/fitness.nutrition.read</code> e <code class=\"language-text\">https://www.googleapis.com/auth/fitness.body.read</code>. Depois disso, definimos a data de início e a data de término para a nossa solicitação, que são 30 dias atrás e hoje, respectivamente. Finalmente, chamamos a função <code class=\"language-text\">fetchDataForDataSource</code> três vezes, uma para os dados de peso, uma para os dados de percentual de gordura e uma para os dados de nutrição.</p>\n<p>Mas o que a função <code class=\"language-text\">fetchDataForDataSource</code> faz? Vamos dar uma olhada:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> fitness <span class=\"token operator\">=</span> google<span class=\"token punctuation\">.</span><span class=\"token function\">fitness</span><span class=\"token punctuation\">(</span><span class=\"token string\">'v1'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">fetchDataForDataSource</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">dataSourceId<span class=\"token punctuation\">,</span> auth<span class=\"token punctuation\">,</span> startTimeNs<span class=\"token punctuation\">,</span> endTimeNs</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n  <span class=\"token keyword\">const</span> response <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> fitness<span class=\"token punctuation\">.</span>users<span class=\"token punctuation\">.</span>dataSources<span class=\"token punctuation\">.</span>datasets<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\r\n    <span class=\"token literal-property property\">userId</span><span class=\"token operator\">:</span> <span class=\"token string\">'me'</span><span class=\"token punctuation\">,</span>\r\n    dataSourceId<span class=\"token punctuation\">,</span>\r\n    <span class=\"token literal-property property\">datasetId</span><span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>startTimeNs<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">-</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>endTimeNs<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\r\n    auth<span class=\"token punctuation\">,</span>\r\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n  <span class=\"token keyword\">return</span> response<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Com a API de fitness do <code class=\"language-text\">googleapis</code>, podemos fazer solicitações à Google Fitness API. Neste caso, estamos usando o método <code class=\"language-text\">users.dataSources.datasets.get</code> para obter dados de uma fonte de dados específica. Passamos o <code class=\"language-text\">userId</code> como <code class=\"language-text\">me</code> para obter dados do usuário atual, o <code class=\"language-text\">dataSourceId</code> que queremos obter dados, e o <code class=\"language-text\">datasetId</code>, que é uma combinação do horário de início e término em nanossegundos. Finalmente, passamos o objeto de autenticação que criamos anteriormente.</p>\n<h2 id=\"agregando-os-dados\" style=\"position:relative;\"><a href=\"#agregando-os-dados\" aria-label=\"agregando os dados permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Agregando os Dados</h2>\n<p>Vamos dar uma olhada nos dados que recebemos da Google Fitness API:</p>\n<h3 id=\"weight\" style=\"position:relative;\"><a href=\"#weight\" aria-label=\"weight permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Weight</h3>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\r\n  <span class=\"token property\">\"minStartTimeNs\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"1690662651313000000\"</span><span class=\"token punctuation\">,</span>\r\n  <span class=\"token property\">\"maxEndTimeNs\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"1691008251313000000\"</span><span class=\"token punctuation\">,</span>\r\n  <span class=\"token property\">\"dataSourceId\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"derived:com.google.weight:com.google.android.gms:merge_weight\"</span><span class=\"token punctuation\">,</span>\r\n  <span class=\"token property\">\"point\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\r\n    <span class=\"token punctuation\">{</span>\r\n      <span class=\"token property\">\"startTimeNanos\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"1690961397000000000\"</span><span class=\"token punctuation\">,</span>\r\n      <span class=\"token property\">\"endTimeNanos\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"1690961397000000000\"</span><span class=\"token punctuation\">,</span>\r\n      <span class=\"token property\">\"dataTypeName\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"com.google.weight\"</span><span class=\"token punctuation\">,</span>\r\n      <span class=\"token property\">\"originDataSourceId\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"raw:com.google.weight:cn.fitdays.fitdays:\"</span><span class=\"token punctuation\">,</span>\r\n      <span class=\"token property\">\"value\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\r\n        <span class=\"token punctuation\">{</span>\r\n          <span class=\"token property\">\"fpVal\"</span><span class=\"token operator\">:</span> <span class=\"token number\">77.59</span><span class=\"token punctuation\">,</span>\r\n          <span class=\"token property\">\"mapVal\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\r\n        <span class=\"token punctuation\">}</span>\r\n      <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\r\n      <span class=\"token property\">\"modifiedTimeMillis\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"1690963181330\"</span>\r\n    <span class=\"token punctuation\">}</span>\r\n  <span class=\"token punctuation\">]</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h3 id=\"fat-percentage\" style=\"position:relative;\"><a href=\"#fat-percentage\" aria-label=\"fat percentage permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Fat Percentage</h3>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\r\n  <span class=\"token property\">\"minStartTimeNs\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"1690662651313000000\"</span><span class=\"token punctuation\">,</span>\r\n  <span class=\"token property\">\"maxEndTimeNs\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"1691008251313000000\"</span><span class=\"token punctuation\">,</span>\r\n  <span class=\"token property\">\"dataSourceId\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"derived:com.google.body.fat.percentage:com.google.android.gms:merged\"</span><span class=\"token punctuation\">,</span>\r\n  <span class=\"token property\">\"point\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\r\n    <span class=\"token punctuation\">{</span>\r\n      <span class=\"token property\">\"startTimeNanos\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"1690961397000000000\"</span><span class=\"token punctuation\">,</span>\r\n      <span class=\"token property\">\"endTimeNanos\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"1690961397000000000\"</span><span class=\"token punctuation\">,</span>\r\n      <span class=\"token property\">\"dataTypeName\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"com.google.body.fat.percentage\"</span><span class=\"token punctuation\">,</span>\r\n      <span class=\"token property\">\"originDataSourceId\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"raw:com.google.body.fat.percentage:cn.fitdays.fitdays:\"</span><span class=\"token punctuation\">,</span>\r\n      <span class=\"token property\">\"value\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\r\n        <span class=\"token punctuation\">{</span>\r\n          <span class=\"token property\">\"fpVal\"</span><span class=\"token operator\">:</span> <span class=\"token number\">20</span><span class=\"token punctuation\">,</span>\r\n          <span class=\"token property\">\"mapVal\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\r\n        <span class=\"token punctuation\">}</span>\r\n      <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\r\n      <span class=\"token property\">\"modifiedTimeMillis\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"1690963181468\"</span>\r\n    <span class=\"token punctuation\">}</span>\r\n  <span class=\"token punctuation\">]</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h3 id=\"nutrition\" style=\"position:relative;\"><a href=\"#nutrition\" aria-label=\"nutrition permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Nutrition</h3>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\r\n  <span class=\"token property\">\"minStartTimeNs\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"1690662651313000000\"</span><span class=\"token punctuation\">,</span>\r\n  <span class=\"token property\">\"maxEndTimeNs\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"1691008251313000000\"</span><span class=\"token punctuation\">,</span>\r\n  <span class=\"token property\">\"dataSourceId\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"derived:com.google.nutrition:com.google.android.gms:merged\"</span><span class=\"token punctuation\">,</span>\r\n  <span class=\"token property\">\"point\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\r\n    <span class=\"token punctuation\">{</span>\r\n      <span class=\"token property\">\"startTimeNanos\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"1690961397000000000\"</span><span class=\"token punctuation\">,</span>\r\n      <span class=\"token property\">\"endTimeNanos\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"1690961397000000000\"</span><span class=\"token punctuation\">,</span>\r\n      <span class=\"token property\">\"dataTypeName\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"com.google.nutrition\"</span><span class=\"token punctuation\">,</span>\r\n      <span class=\"token property\">\"originDataSourceId\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"raw:com.google.nutrition:com.sillens.shapeupclub:health_platform\"</span><span class=\"token punctuation\">,</span>\r\n      <span class=\"token property\">\"value\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\r\n        <span class=\"token punctuation\">{</span>\r\n          <span class=\"token property\">\"mapVal\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\r\n            <span class=\"token punctuation\">{</span>\r\n              <span class=\"token property\">\"key\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"fat.total\"</span><span class=\"token punctuation\">,</span>\r\n              <span class=\"token property\">\"value\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\r\n                <span class=\"token property\">\"fpVal\"</span><span class=\"token operator\">:</span> <span class=\"token number\">16.349998474121094</span>\r\n              <span class=\"token punctuation\">}</span>\r\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\r\n            <span class=\"token punctuation\">{</span>\r\n              <span class=\"token property\">\"key\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"sodium\"</span><span class=\"token punctuation\">,</span>\r\n              <span class=\"token property\">\"value\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\r\n                <span class=\"token property\">\"fpVal\"</span><span class=\"token operator\">:</span> <span class=\"token number\">0</span>\r\n              <span class=\"token punctuation\">}</span>\r\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\r\n            <span class=\"token punctuation\">{</span>\r\n              <span class=\"token property\">\"key\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"potassium\"</span><span class=\"token punctuation\">,</span>\r\n              <span class=\"token property\">\"value\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\r\n                <span class=\"token property\">\"fpVal\"</span><span class=\"token operator\">:</span> <span class=\"token number\">0</span>\r\n              <span class=\"token punctuation\">}</span>\r\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\r\n            <span class=\"token punctuation\">{</span>\r\n              <span class=\"token property\">\"key\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"fat.unsaturated\"</span><span class=\"token punctuation\">,</span>\r\n              <span class=\"token property\">\"value\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\r\n                <span class=\"token property\">\"fpVal\"</span><span class=\"token operator\">:</span> <span class=\"token number\">3</span>\r\n              <span class=\"token punctuation\">}</span>\r\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\r\n            <span class=\"token punctuation\">{</span>\r\n              <span class=\"token property\">\"key\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"fat.saturated\"</span><span class=\"token punctuation\">,</span>\r\n              <span class=\"token property\">\"value\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\r\n                <span class=\"token property\">\"fpVal\"</span><span class=\"token operator\">:</span> <span class=\"token number\">13.34999942779541</span>\r\n              <span class=\"token punctuation\">}</span>\r\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\r\n            <span class=\"token punctuation\">{</span>\r\n              <span class=\"token property\">\"key\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"protein\"</span><span class=\"token punctuation\">,</span>\r\n              <span class=\"token property\">\"value\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\r\n                <span class=\"token property\">\"fpVal\"</span><span class=\"token operator\">:</span> <span class=\"token number\">5.25</span>\r\n              <span class=\"token punctuation\">}</span>\r\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\r\n            <span class=\"token punctuation\">{</span>\r\n              <span class=\"token property\">\"key\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"carbs.total\"</span><span class=\"token punctuation\">,</span>\r\n              <span class=\"token property\">\"value\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\r\n                <span class=\"token property\">\"fpVal\"</span><span class=\"token operator\">:</span> <span class=\"token number\">60.45000076293945</span>\r\n              <span class=\"token punctuation\">}</span>\r\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\r\n            <span class=\"token punctuation\">{</span>\r\n              <span class=\"token property\">\"key\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"cholesterol\"</span><span class=\"token punctuation\">,</span>\r\n              <span class=\"token property\">\"value\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\r\n                <span class=\"token property\">\"fpVal\"</span><span class=\"token operator\">:</span> <span class=\"token number\">0</span>\r\n              <span class=\"token punctuation\">}</span>\r\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\r\n            <span class=\"token punctuation\">{</span>\r\n              <span class=\"token property\">\"key\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"calories\"</span><span class=\"token punctuation\">,</span>\r\n              <span class=\"token property\">\"value\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\r\n                <span class=\"token property\">\"fpVal\"</span><span class=\"token operator\">:</span> <span class=\"token number\">412.5</span>\r\n              <span class=\"token punctuation\">}</span>\r\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\r\n            <span class=\"token punctuation\">{</span>\r\n              <span class=\"token property\">\"key\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"sugar\"</span><span class=\"token punctuation\">,</span>\r\n              <span class=\"token property\">\"value\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\r\n                <span class=\"token property\">\"fpVal\"</span><span class=\"token operator\">:</span> <span class=\"token number\">42.599998474121094</span>\r\n              <span class=\"token punctuation\">}</span>\r\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\r\n            <span class=\"token punctuation\">{</span>\r\n              <span class=\"token property\">\"key\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"dietary_fiber\"</span><span class=\"token punctuation\">,</span>\r\n              <span class=\"token property\">\"value\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\r\n                <span class=\"token property\">\"fpVal\"</span><span class=\"token operator\">:</span> <span class=\"token number\">0</span>\r\n              <span class=\"token punctuation\">}</span>\r\n            <span class=\"token punctuation\">}</span>\r\n          <span class=\"token punctuation\">]</span>\r\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\r\n        <span class=\"token punctuation\">{</span>\r\n          <span class=\"token property\">\"intVal\"</span><span class=\"token operator\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span>\r\n          <span class=\"token property\">\"mapVal\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\r\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\r\n        <span class=\"token punctuation\">{</span>\r\n          <span class=\"token property\">\"stringVal\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Salted caramel cornetto\"</span><span class=\"token punctuation\">,</span>\r\n          <span class=\"token property\">\"mapVal\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\r\n        <span class=\"token punctuation\">}</span>\r\n      <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\r\n      <span class=\"token property\">\"modifiedTimeMillis\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"1690805813623\"</span>\r\n    <span class=\"token punctuation\">}</span>\r\n  <span class=\"token punctuation\">]</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Como você pode ver, os dados estão num formato que não é muito fácil de trabalhar. Precisamos analisar esses dados e agregá-los num formato utilizável.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> curatedWeightData <span class=\"token operator\">=</span> <span class=\"token function\">extractBodyData</span><span class=\"token punctuation\">(</span>weightData<span class=\"token punctuation\">,</span> <span class=\"token string\">'weight'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">const</span> curatedFatPercentageData <span class=\"token operator\">=</span> <span class=\"token function\">extractBodyData</span><span class=\"token punctuation\">(</span>fatPercentageData<span class=\"token punctuation\">,</span> <span class=\"token string\">'fatPercentage'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">const</span> curatedNutritionData <span class=\"token operator\">=</span> <span class=\"token function\">aggregateNutritionData</span><span class=\"token punctuation\">(</span><span class=\"token function\">extractNutritionData</span><span class=\"token punctuation\">(</span>nutritionData<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Após usar essas funções misteriosas, os seus dados ficarão assim:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\">console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>curatedWeightData<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token comment\">// [{ date: '02/08/2023', weight: 77.5999984741211 }]</span>\r\nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>curatedFatPercentageData<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token comment\">// [{ date: '02/08/2023', fatPercentage: 20 }]</span>\r\nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>curatedNutritionData<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token comment\">// [{ date: '02/08/2023', foods: ['Salted caramel cornetto'], protein: 5.25, fat: 16.349998474121094, carbs: 60.45000076293945, fiber: 0, sugar: 42.599998474121094 }]</span></code></pre></div>\n<p>Ok, agora vamos escrever as funções que fazem essa mágica, ou melhor, vamos pedir ao Chat GPT para fazer isso para nós.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">nanosToDateString</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">nanos</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n  <span class=\"token keyword\">const</span> milliseconds <span class=\"token operator\">=</span> <span class=\"token function\">parseInt</span><span class=\"token punctuation\">(</span>nanos<span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">/</span> <span class=\"token number\">1000000</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Date</span><span class=\"token punctuation\">(</span>milliseconds<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toLocaleDateString</span><span class=\"token punctuation\">(</span><span class=\"token string\">'en-GB'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span>\r\n\r\n<span class=\"token keyword\">function</span> <span class=\"token function\">extractBodyData</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">jsonArray<span class=\"token punctuation\">,</span> type</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n  <span class=\"token keyword\">return</span> jsonArray<span class=\"token punctuation\">.</span>point<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">dataPoint</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">const</span> date <span class=\"token operator\">=</span> <span class=\"token function\">nanosToDateString</span><span class=\"token punctuation\">(</span>dataPoint<span class=\"token punctuation\">.</span>startTimeNanos<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">const</span> data <span class=\"token operator\">=</span> dataPoint<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>fpVal<span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span> date<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>type<span class=\"token punctuation\">]</span><span class=\"token operator\">:</span> data <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>E para a agregação de dados nutricionais:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">aggregateNutritionData</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">nutritionArray</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n  <span class=\"token keyword\">const</span> aggregatedData <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\r\n\r\n  nutritionArray<span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">nutrition</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> date<span class=\"token punctuation\">,</span> foodName<span class=\"token punctuation\">,</span> <span class=\"token operator\">...</span>nutritionValues <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> nutrition<span class=\"token punctuation\">;</span>\r\n\r\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>aggregatedData<span class=\"token punctuation\">[</span>date<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n      aggregatedData<span class=\"token punctuation\">[</span>date<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\r\n        date<span class=\"token punctuation\">,</span>\r\n        <span class=\"token literal-property property\">foods</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>foodName<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\r\n        <span class=\"token operator\">...</span>nutritionValues<span class=\"token punctuation\">,</span>\r\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\r\n      aggregatedData<span class=\"token punctuation\">[</span>date<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>foods<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span>foodName<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n      Object<span class=\"token punctuation\">.</span><span class=\"token function\">keys</span><span class=\"token punctuation\">(</span>nutritionValues<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">key</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">Object</span><span class=\"token punctuation\">.</span>prototype<span class=\"token punctuation\">.</span><span class=\"token function\">hasOwnProperty</span><span class=\"token punctuation\">.</span><span class=\"token function\">call</span><span class=\"token punctuation\">(</span>nutritionValues<span class=\"token punctuation\">,</span> key<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n          aggregatedData<span class=\"token punctuation\">[</span>date<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>key<span class=\"token punctuation\">]</span> <span class=\"token operator\">+=</span> nutritionValues<span class=\"token punctuation\">[</span>key<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token punctuation\">}</span>\r\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span>\r\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n  <span class=\"token keyword\">return</span> Object<span class=\"token punctuation\">.</span><span class=\"token function\">values</span><span class=\"token punctuation\">(</span>aggregatedData<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>A última coisa a fazer é mesclar essas 3 matrizes em uma e classificá-la por data.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">mergeDataArrays</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token operator\">...</span>arrays</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n  <span class=\"token keyword\">const</span> mergedData <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\r\n\r\n  arrays<span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">array</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n    array<span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">item</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n      <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> date<span class=\"token punctuation\">,</span> <span class=\"token operator\">...</span>rest <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> item<span class=\"token punctuation\">;</span>\r\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>mergedData<span class=\"token punctuation\">[</span>date<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n        mergedData<span class=\"token punctuation\">[</span>date<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span> date<span class=\"token punctuation\">,</span> <span class=\"token operator\">...</span>rest <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\r\n      <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\r\n        Object<span class=\"token punctuation\">.</span><span class=\"token function\">assign</span><span class=\"token punctuation\">(</span>mergedData<span class=\"token punctuation\">[</span>date<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> rest<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      <span class=\"token punctuation\">}</span>\r\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n  <span class=\"token keyword\">return</span> Object<span class=\"token punctuation\">.</span><span class=\"token function\">values</span><span class=\"token punctuation\">(</span>mergedData<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span>\r\n\r\nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token function\">mergeDataArrays</span><span class=\"token punctuation\">(</span>curatedWeightData<span class=\"token punctuation\">,</span> curatedFatPercentageData<span class=\"token punctuation\">,</span> curatedNutritionData<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token comment\">// [{\"date\":\"02/08/2023\",\"weight\":77.5999984741211,\"fatPercentage\":20,\"foods\":[\"Salted caramel cornetto\"],\"protein\":5.25,\"fat\":16.349998474121094,\"carbs\":60.45000076293945,\"fiber\":0,\"sugar\":42.599998474121094}]</span></code></pre></div>\n<p><del>Tudo bem, é hora de usar esses dados para obter algumas informações.</del> Na verdade, precisamos de mais uma coisa antes de podermos fazer isso.</p>\n<h2 id=\"massa-muscular-e-composicao-de-gordura-corporal\" style=\"position:relative;\"><a href=\"#massa-muscular-e-composicao-de-gordura-corporal\" aria-label=\"massa muscular e composicao de gordura corporal permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Massa muscular e composição de gordura corporal</h2>\n<p>Antes de mergulhar nos cálculos, precisamos entender como o músculo e a gordura estão distribuídos no corpo.</p>\n<p>Eu queria descobrir quantas calorias existem em 1kg de músculo e 1kg de gordura, então comecei a procurar livros no <a href=\"https://www.google.com/books\" target=\"_blank\" rel=\"noreferrer\">Google Books</a> para encontrar a composição exata do tecido muscular e da gordura, e encontrei algumas informações em <a href=\"https://www.google.com/books/edition/The_Nutritionist/olIsBgAAQBAJ?hl=en&#x26;gbpv=1&#x26;pg=PA148&#x26;printsec=frontcover\" target=\"_blank\" rel=\"noreferrer\">The Nutritionist Food, Nutrition, and Optimal Health By Robert Wildman</a>.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1024px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 61.71875%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAIAAADtbgqsAAAACXBIWXMAAAsTAAALEwEAmpwYAAABzElEQVQoz3WRS4+iUBSE+xebuCBR4/PvTFy4cKkhKkZU5KmJROV1CQJyLxcQFAkyaXWc6emZ2n+nqk59IISWy6XjOOfzeTwe/3hoNBrFcRxFkeu6zEOLxcIwDIxxlmXFL31cr1eO4wzDgBDOZrPhcDgYDCaTSRiGURQBAEiSpCiKJElZlk+nU5IkRVHc7/cXzDAMAMDzPEmSeJ7nOI7n+SAI4jg+HA6NRqNarRIEQdO07/uXy+W38+12kyTJMAzXdS3Lwhj7vg8A8H3/CbdarXq9XqlU5vM5xphhGFEUdV2PougjTVOO4wAAjuNgjJ8nEULfYZqmMcbT6XS1WgmC4HneK7Zpmn/Cnuf90xkhJMvydrsVRfETfju7rvuGIYQY4yRJFEVpt9tv2Pd9lmUlSbIsKwzDz87fY0MI/9eZZdn1eg0hfMGCIPwV+w0ritLpdJrNZq1We8Z+fvs1VZZlm81G13XbtiGEeZ5nWeY4DkIojuPdbkcQRLlcLpVKFEUhhJ47v6YqikJVVQAAxtg0TU3TVFU1DCMMwyAIbNvu9/u9Xq/b7SqKghBK0/QLnOd5URRxHMuyrGna4aEoip5v3+/3CCHXdY/HY/FVPwEsxGsqnk8+zAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"muscle and fat composition\"\n        title=\"muscle and fat composition\"\n        src=\"/static/78e0682ff9af97a8ebc8b291b53f97a9/42a19/muscle-and-fat-composition.png\"\n        srcset=\"/static/78e0682ff9af97a8ebc8b291b53f97a9/e3135/muscle-and-fat-composition.png 256w,\n/static/78e0682ff9af97a8ebc8b291b53f97a9/06341/muscle-and-fat-composition.png 512w,\n/static/78e0682ff9af97a8ebc8b291b53f97a9/42a19/muscle-and-fat-composition.png 1024w,\n/static/78e0682ff9af97a8ebc8b291b53f97a9/775e3/muscle-and-fat-composition.png 1189w\"\n        sizes=\"(max-width: 1024px) 100vw, 1024px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>Mas eu ainda precisava saber qual é o custo energético para construir esse 1kg de músculo e 1kg de gordura, então, para isso, perguntei ao ChatGPT (em inglês e traduzido para essa postagem).</p>\n<blockquote>\n<p>Olá. Qual é a composição exata em porcentagens de 1kg de músculo esquelético e 1kg de tecido adiposo? Além disso, forneça a fonte da informação. Por favor, me dê uma resposta curta, obrigado.</p>\n</blockquote>\n<blockquote>\n<p>Claro! Aqui está uma resposta curta para a composição geral de 1kg de músculo esquelético e 1kg de tecido adiposo:</p>\n<p>Músculo Esquelético (1kg):</p>\n<ul>\n<li>Água: ~75%</li>\n<li>Proteína: ~20%</li>\n<li>Gorduras: ~5%</li>\n<li>Outros (minerais, glicogênio, etc.): Quantidades vestigiais</li>\n</ul>\n<p>Tecido Adiposo (1kg):</p>\n<ul>\n<li>Lipídios: ~80-90%</li>\n<li>Água: ~10-20%</li>\n<li>Proteína: ~2%</li>\n<li>Outros (minerais, etc.): Quantidades vestigiais</li>\n</ul>\n<p>Por favor, note que esses valores podem variar dependendo de fatores como idade, sexo, dieta e saúde geral. A informação é baseada no entendimento científico geral e pode ser encontrada em vários livros de fisiologia e anatomia humana, como “Human Anatomy &#x26; Physiology” de Elaine N. Marieb e Katja Hoehn.</p>\n</blockquote>\n<blockquote>\n<p>E qual é a eficiência de síntese em porcentagem para construir 1 grama de proteína muscular e 1 grama de lipídios? Além disso, forneça a fonte da informação. Por favor, me dê uma resposta curta, obrigado.</p>\n</blockquote>\n<blockquote>\n<p>A eficiência de síntese para construir proteína muscular e lipídios varia amplamente dependendo de fatores como espécie, dieta, idade e saúde. No entanto, uma estimativa geral pode ser fornecida:</p>\n<ul>\n<li>Para proteína muscular, a eficiência é geralmente em torno de 20-25%. Isso significa que apenas cerca de 20-25% dos aminoácidos consumidos são incorporados à proteína muscular.</li>\n<li>Para lipídios, a eficiência de conversão de gorduras dietéticas pode ser maior, em torno de 90-95%.</li>\n</ul>\n<p>Esses números são estimativas aproximadas e podem variar significativamente. A informação é derivada do conhecimento geral em bioquímica nutricional e pode ser encontrada em livros como “Biochemical, Physiological, and Molecular Aspects of Human Nutrition” de Martha H. Stipanuk e Marie A. Caudill, e artigos científicos sobre o assunto. Sempre consulte pesquisas específicas ou um profissional da área para informações mais precisas adaptadas a uma situação particular.</p>\n</blockquote>\n<p>Legal. Vamos fazer alguns cálculos agora!</p>\n<h3 id=\"calculo-do-musculo\" style=\"position:relative;\"><a href=\"#calculo-do-musculo\" aria-label=\"calculo do musculo permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Cálculo do músculo</h3>\n<p>Agora que sabemos que um quilograma de músculo é composto por 20% de proteína e 5% de gordura. Com 1g de proteína tendo 4 calorias e 1g de gordura contendo 9 calorias, isso significa que 1kg de músculo tem 800 calorias de proteína e 450 de gordura, totalizando 1250 calorias.</p>\n<h3 id=\"calculo-de-gordura\" style=\"position:relative;\"><a href=\"#calculo-de-gordura\" aria-label=\"calculo de gordura permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Cálculo de gordura</h3>\n<p>Quanto à gordura, um quilograma é composto por 85% de lipídios e 2% de proteína. Com 1g de lipídios tendo 9 calorias, 1g de proteína tendo 4 calorias, isso significa que 1kg de gordura tem 7650 calorias de lipídios e 80 calorias de proteína, totalizando 7730 calorias.</p>\n<h3 id=\"custo-de-sintese\" style=\"position:relative;\"><a href=\"#custo-de-sintese\" aria-label=\"custo de sintese permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Custo de síntese</h3>\n<p>Quando se trata de construir os componentes essenciais do nosso corpo, a eficiência varia para diferentes substâncias.</p>\n<p>Para proteínas, a eficiência do nosso corpo é de cerca de ~23%. Isso significa que para cada 1g de proteína, que tem 4kcal, precisamos de cerca de ~17kcal para produzi-la. Pense assim: 4kcal vão para os aminoácidos reais na proteína, e as outras 13kcal são a energia usada no processo de construção.</p>\n<p>Agora, os lipídios são uma história diferente. Nosso corpo é um pouco mais eficiente aqui, em ~93%. Então, para 1g de lipídios, que tem 9kcal, só leva cerca de 10kcal para produzi-lo. São 9kcal para os aminoácidos nos lipídios, e apenas 1kcal para a síntese.</p>\n<h3 id=\"calculando-o-custo-energetico\" style=\"position:relative;\"><a href=\"#calculando-o-custo-energetico\" aria-label=\"calculando o custo energetico permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Calculando o custo energético</h3>\n<p>Então, vamos entender todos esses números e ver o que eles significam para o custo energético de construir músculo e gordura.</p>\n<p>Para o músculo, temos 1kg com 200g de proteína e 50g de lipídios. Como leva cerca de 17kcal para fazer 1g de proteína e 10kcal para 1g de lipídios, o custo energético total para 1kg de músculo é:</p>\n<ul>\n<li>Proteína: 200 x 17 = 3400kcal</li>\n<li>Gordura: 50 x 10 = 500kcal</li>\n<li>Total Geral: 3400 + 500 = 3900kcal</li>\n</ul>\n<p>Agora, para a gordura corporal, com 1kg tendo 850g de lipídios e 20g de proteína, o custo energético total é:</p>\n<ul>\n<li>Lipídios: 850 x 10 = 8500kcal</li>\n<li>Proteína: 20 x 17 = 340kcal</li>\n<li>Total Geral: 8500 + 340 = 8840kcal</li>\n</ul>\n<p>Então, aí está! Com esses números, vou adicionar as seguintes constantes ao meu código:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> <span class=\"token constant\">CALORIES_STORED_KG_FAT</span> <span class=\"token operator\">=</span> <span class=\"token number\">7730</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">const</span> <span class=\"token constant\">CALORIES_BUILD_KG_FAT</span> <span class=\"token operator\">=</span> <span class=\"token number\">8840</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">const</span> <span class=\"token constant\">CALORIES_STORED_KG_MUSCLE</span> <span class=\"token operator\">=</span> <span class=\"token number\">1250</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">const</span> <span class=\"token constant\">CALORIES_BUILD_KG_MUSCLE</span> <span class=\"token operator\">=</span> <span class=\"token number\">3900</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Lembrete rápido de que essas são todas estimativas, e os números reais podem variar dependendo da composição do seu corpo, dieta e outros fatores. Além disso, eu não sou médico nem nutricionista, então, por favor, não tome isso como um conselho médico.</p>\n<h2 id=\"calculando-o-tdee\" style=\"position:relative;\"><a href=\"#calculando-o-tdee\" aria-label=\"calculando o tdee permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Calculando o TDEE</h2>\n<p>Agora que temos os nossos dados de peso e percentual de gordura analisados e agregados em um formato utilizável, podemos começar a calcular o nosso TDEE.</p>\n<p>Para calcular o seu TDEE, siga estas etapas:</p>\n<ol>\n<li>Obtenha o número total de calorias consumidas durante o período de 30 dias.</li>\n<li>Calcule a diferença de peso entre o início e o fim do período de 30 dias.</li>\n<li>Converta a diferença de peso em calorias multiplicando-a pelo número de músculo/gordura ganho/perdido.</li>\n<li>Subtraia o resultado da etapa 3 do total de calorias consumidas no período de 30 dias.</li>\n<li>Divida o resultado da etapa 4 por 30 para obter a sua ingestão média diária de calorias, que deve ser o seu TDEE.</li>\n</ol>\n<p>Aqui está o código para calcular o TDEE e mais usando o código:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">calculateStatistics</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">dataArray</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n  <span class=\"token keyword\">const</span> totalDays <span class=\"token operator\">=</span> dataArray<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">;</span>\r\n\r\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span>\r\n    totalFat<span class=\"token punctuation\">,</span>\r\n    totalFiber<span class=\"token punctuation\">,</span>\r\n    totalCarbs<span class=\"token punctuation\">,</span>\r\n    finalWeight<span class=\"token punctuation\">,</span>\r\n    totalProtein<span class=\"token punctuation\">,</span>\r\n    totalCalories<span class=\"token punctuation\">,</span>\r\n    initialWeight<span class=\"token punctuation\">,</span>\r\n    initialFatPercentage<span class=\"token punctuation\">,</span>\r\n    finalFatPercentage<span class=\"token punctuation\">,</span>\r\n    initialDate<span class=\"token punctuation\">,</span>\r\n    finalDate<span class=\"token punctuation\">,</span>\r\n  <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">accumulateData</span><span class=\"token punctuation\">(</span>dataArray<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span>\r\n    fatDifference<span class=\"token punctuation\">,</span>\r\n    weightDifference<span class=\"token punctuation\">,</span>\r\n    muscleDifference<span class=\"token punctuation\">,</span>\r\n    fatDifferencePercentage<span class=\"token punctuation\">,</span>\r\n  <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">calculateWeightDifference</span><span class=\"token punctuation\">(</span>initialWeight<span class=\"token punctuation\">,</span> finalWeight<span class=\"token punctuation\">,</span> initialFatPercentage<span class=\"token punctuation\">,</span> finalFatPercentage<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> muscleCalories<span class=\"token punctuation\">,</span> fatCalories <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">calculateMuscleAndFatCalories</span><span class=\"token punctuation\">(</span>muscleDifference<span class=\"token punctuation\">,</span> fatDifference<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token keyword\">const</span> tdee <span class=\"token operator\">=</span> <span class=\"token function\">calculateTDEE</span><span class=\"token punctuation\">(</span>totalCalories<span class=\"token punctuation\">,</span> muscleCalories<span class=\"token punctuation\">,</span> fatCalories<span class=\"token punctuation\">,</span> totalDays<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">[</span>\r\n    <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">*From </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>initialDate<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\"> to </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>finalDate<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">*\\n</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\r\n    <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Days Range: </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>totalDays<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\r\n    <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">TDEE: </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>tdee<span class=\"token operator\">?.</span><span class=\"token function\">toFixed</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\"> kcal</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\r\n    <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Average Calories: </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token punctuation\">(</span>totalCalories <span class=\"token operator\">/</span> totalDays<span class=\"token punctuation\">)</span><span class=\"token operator\">?.</span><span class=\"token function\">toFixed</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\"> kcal</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\r\n    <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Average Protein: </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token punctuation\">(</span>totalProtein <span class=\"token operator\">/</span> totalDays<span class=\"token punctuation\">)</span><span class=\"token operator\">?.</span><span class=\"token function\">toFixed</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\"> g</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\r\n    <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Average Carbs: </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token punctuation\">(</span>totalCarbs <span class=\"token operator\">/</span> totalDays<span class=\"token punctuation\">)</span><span class=\"token operator\">?.</span><span class=\"token function\">toFixed</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\"> g</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\r\n    <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Average Fat: </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token punctuation\">(</span>totalFat <span class=\"token operator\">/</span> totalDays<span class=\"token punctuation\">)</span><span class=\"token operator\">?.</span><span class=\"token function\">toFixed</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\"> g</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\r\n    <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Average Fiber: </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token punctuation\">(</span>totalFiber <span class=\"token operator\">/</span> totalDays<span class=\"token punctuation\">)</span><span class=\"token operator\">?.</span><span class=\"token function\">toFixed</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\"> g</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\r\n    <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Weight Difference: </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>weightDifference <span class=\"token operator\">></span> <span class=\"token number\">0</span> <span class=\"token operator\">?</span> <span class=\"token string\">'+'</span> <span class=\"token operator\">:</span> <span class=\"token string\">''</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>weightDifference<span class=\"token operator\">?.</span><span class=\"token function\">toFixed</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\"> kg (</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>initialWeight<span class=\"token operator\">?.</span><span class=\"token function\">toFixed</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\"> -> </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>finalWeight<span class=\"token operator\">?.</span><span class=\"token function\">toFixed</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">)</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\r\n    <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Fat Difference: </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>fatDifference <span class=\"token operator\">></span> <span class=\"token number\">0</span> <span class=\"token operator\">?</span> <span class=\"token string\">'+'</span> <span class=\"token operator\">:</span> <span class=\"token string\">''</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>fatDifference<span class=\"token operator\">?.</span><span class=\"token function\">toFixed</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\"> kg</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\r\n    <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Non-Fat Difference: </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>muscleDifference <span class=\"token operator\">></span> <span class=\"token number\">0</span> <span class=\"token operator\">?</span> <span class=\"token string\">'+'</span> <span class=\"token operator\">:</span> <span class=\"token string\">''</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>muscleDifference<span class=\"token operator\">?.</span><span class=\"token function\">toFixed</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\"> kg</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\r\n    <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Fat Percentage Difference: </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>fatDifferencePercentage <span class=\"token operator\">></span> <span class=\"token number\">0</span> <span class=\"token operator\">?</span> <span class=\"token string\">'+'</span> <span class=\"token operator\">:</span> <span class=\"token string\">''</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>fatDifferencePercentage<span class=\"token operator\">?.</span><span class=\"token function\">toFixed</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">%  (</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>initialFatPercentage<span class=\"token operator\">?.</span><span class=\"token function\">toFixed</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\"> -> </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>finalFatPercentage<span class=\"token operator\">?.</span><span class=\"token function\">toFixed</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">)</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\r\n  <span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">join</span><span class=\"token punctuation\">(</span><span class=\"token string\">'\\n'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Esta função retorna uma <code class=\"language-text\">string</code> com detalhes para um período de 30 dias, incluindo o número de dias, TDEE, ingestão média diária de calorias, proteínas, carboidratos, gordura e fibras, bem como as diferenças de peso, gordura, não gordura e percentual de gordura entre o início e o fim do período.</p>\n<p>Quanto às funções ausentes <code class=\"language-text\">accumulateData</code>, <code class=\"language-text\">calculateWeightDifference</code> e <code class=\"language-text\">calculateTDEE</code>, aqui estão elas:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">accumulateData</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">dataArray</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n  <span class=\"token keyword\">const</span> lastOccurrence <span class=\"token operator\">=</span> dataArray<span class=\"token punctuation\">[</span>dataArray<span class=\"token punctuation\">.</span>length <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token keyword\">const</span> firstOccurrence <span class=\"token operator\">=</span> dataArray<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\r\n\r\n  <span class=\"token keyword\">const</span> accumulator <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token literal-property property\">totalCalories</span><span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span>\r\n    <span class=\"token literal-property property\">totalProtein</span><span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span>\r\n    <span class=\"token literal-property property\">totalCarbs</span><span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span>\r\n    <span class=\"token literal-property property\">totalFat</span><span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span>\r\n    <span class=\"token literal-property property\">totalFiber</span><span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span>\r\n    <span class=\"token literal-property property\">initialWeight</span><span class=\"token operator\">:</span> firstOccurrence<span class=\"token operator\">?.</span>weight<span class=\"token punctuation\">,</span>\r\n    <span class=\"token literal-property property\">finalWeight</span><span class=\"token operator\">:</span> lastOccurrence<span class=\"token operator\">?.</span>weight<span class=\"token punctuation\">,</span>\r\n    <span class=\"token literal-property property\">initialFatPercentage</span><span class=\"token operator\">:</span> firstOccurrence<span class=\"token operator\">?.</span>fatPercentage<span class=\"token punctuation\">,</span>\r\n    <span class=\"token literal-property property\">finalFatPercentage</span><span class=\"token operator\">:</span> lastOccurrence<span class=\"token operator\">?.</span>fatPercentage<span class=\"token punctuation\">,</span>\r\n    <span class=\"token literal-property property\">initialDate</span><span class=\"token operator\">:</span> firstOccurrence<span class=\"token operator\">?.</span>date <span class=\"token operator\">||</span> <span class=\"token string\">''</span><span class=\"token punctuation\">,</span>\r\n    <span class=\"token literal-property property\">finalDate</span><span class=\"token operator\">:</span> lastOccurrence<span class=\"token operator\">?.</span>date <span class=\"token operator\">||</span> <span class=\"token string\">''</span><span class=\"token punctuation\">,</span>\r\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\r\n\r\n  dataArray<span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">data</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n    accumulator<span class=\"token punctuation\">.</span>totalCalories <span class=\"token operator\">+=</span> data<span class=\"token punctuation\">.</span>caloriesConsumed<span class=\"token punctuation\">;</span>\r\n    accumulator<span class=\"token punctuation\">.</span>totalProtein <span class=\"token operator\">+=</span> data<span class=\"token punctuation\">.</span>protein<span class=\"token punctuation\">;</span>\r\n    accumulator<span class=\"token punctuation\">.</span>totalCarbs <span class=\"token operator\">+=</span> data<span class=\"token punctuation\">.</span>carbs<span class=\"token punctuation\">;</span>\r\n    accumulator<span class=\"token punctuation\">.</span>totalFat <span class=\"token operator\">+=</span> data<span class=\"token punctuation\">.</span>fat<span class=\"token punctuation\">;</span>\r\n    accumulator<span class=\"token punctuation\">.</span>totalFiber <span class=\"token operator\">+=</span> data<span class=\"token punctuation\">.</span>fiber<span class=\"token punctuation\">;</span>\r\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n  <span class=\"token keyword\">return</span> accumulator<span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span>\r\n\r\n<span class=\"token keyword\">function</span> <span class=\"token function\">calculateWeightDifference</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">initialWeight<span class=\"token punctuation\">,</span> finalWeight<span class=\"token punctuation\">,</span> initialFatPercentage<span class=\"token punctuation\">,</span> finalFatPercentage</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n  <span class=\"token keyword\">const</span> weightDifference <span class=\"token operator\">=</span> finalWeight <span class=\"token operator\">-</span> initialWeight<span class=\"token punctuation\">;</span>\r\n  <span class=\"token keyword\">const</span> initialFat <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>initialFatPercentage <span class=\"token operator\">*</span> initialWeight<span class=\"token punctuation\">)</span> <span class=\"token operator\">/</span> <span class=\"token number\">100</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token keyword\">const</span> finalFat <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>finalFatPercentage <span class=\"token operator\">*</span> finalWeight<span class=\"token punctuation\">)</span> <span class=\"token operator\">/</span> <span class=\"token number\">100</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token keyword\">const</span> fatDifference <span class=\"token operator\">=</span> finalFat <span class=\"token operator\">-</span> initialFat<span class=\"token punctuation\">;</span>\r\n  <span class=\"token keyword\">const</span> muscleDifference <span class=\"token operator\">=</span> weightDifference <span class=\"token operator\">-</span> fatDifference<span class=\"token punctuation\">;</span>\r\n  <span class=\"token keyword\">const</span> fatDifferencePercentage <span class=\"token operator\">=</span> finalFatPercentage <span class=\"token operator\">-</span> initialFatPercentage<span class=\"token punctuation\">;</span>\r\n\r\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span> weightDifference<span class=\"token punctuation\">,</span> fatDifference<span class=\"token punctuation\">,</span> muscleDifference<span class=\"token punctuation\">,</span> fatDifferencePercentage <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span>\r\n\r\n<span class=\"token keyword\">function</span> <span class=\"token function\">calculateTDEE</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">totalCalories<span class=\"token punctuation\">,</span> muscleCalories<span class=\"token punctuation\">,</span> fatCalories<span class=\"token punctuation\">,</span> totalDays</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n  <span class=\"token keyword\">const</span> caloriesDifference <span class=\"token operator\">=</span> fatCalories <span class=\"token operator\">+</span> muscleCalories<span class=\"token punctuation\">;</span>\r\n\r\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>totalCalories <span class=\"token operator\">-</span> caloriesDifference<span class=\"token punctuation\">)</span> <span class=\"token operator\">/</span> totalDays<span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Como você pode ver, a função <code class=\"language-text\">calculateStatistics</code> chama a função <code class=\"language-text\">accumulateData</code> para obter o total de calorias, proteínas, carboidratos, gordura e fibras consumidas durante o período de 30 dias, bem como o peso inicial e final e o percentual de gordura.</p>\n<p>Em seguida, ela chama a função <code class=\"language-text\">calculateWeightDifference</code> para calcular as diferenças de peso, gordura, não gordura e percentual de gordura entre o início e o fim do período.</p>\n<p>Finalmente, ela chama a função <code class=\"language-text\">calculateTDEE</code> para calcular o TDEE.</p>\n<h2 id=\"enviar-os-dados-para-o-telegram\" style=\"position:relative;\"><a href=\"#enviar-os-dados-para-o-telegram\" aria-label=\"enviar os dados para o telegram permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Enviar os dados para o Telegram</h2>\n<p>Após calcular o seu TDEE, você pode querer compartilhar essa informação com outras pessoas, como um personal trainer ou um amigo. Uma maneira fácil de fazer isso é enviando os dados para um grupo de chat no Telegram. Isso pode ser feito usando a API do Bot do Telegram.</p>\n<p>Aqui está um exemplo de trecho de código que envia o resultado do TDEE para um grupo de chat no Telegram:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> text <span class=\"token operator\">=</span> <span class=\"token function\">calculateStatistics</span><span class=\"token punctuation\">(</span>agragatedData<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">await</span> <span class=\"token function\">nodeFetch</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">https://api.telegram.org/bot</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>process<span class=\"token punctuation\">.</span>env<span class=\"token punctuation\">.</span><span class=\"token constant\">TELEGRAM_BOT_ID</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">/sendMessage</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\r\n  <span class=\"token literal-property property\">method</span><span class=\"token operator\">:</span> <span class=\"token string\">'POST'</span><span class=\"token punctuation\">,</span>\r\n  <span class=\"token literal-property property\">headers</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\r\n  <span class=\"token string-property property\">'Content-Type'</span><span class=\"token operator\">:</span> <span class=\"token string\">'application/json'</span><span class=\"token punctuation\">,</span>\r\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\r\n  <span class=\"token literal-property property\">body</span><span class=\"token operator\">:</span> <span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">stringify</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\r\n  text<span class=\"token punctuation\">,</span>\r\n  <span class=\"token literal-property property\">chat_id</span><span class=\"token operator\">:</span> process<span class=\"token punctuation\">.</span>env<span class=\"token punctuation\">.</span><span class=\"token constant\">TELEGRAM_GROUP_ID</span><span class=\"token punctuation\">,</span>\r\n  <span class=\"token literal-property property\">parse_mode</span><span class=\"token operator\">:</span> <span class=\"token string\">'markdown'</span><span class=\"token punctuation\">,</span>\r\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\r\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Neste código, estamos usando o pacote <code class=\"language-text\">node-fetch</code> para fazer uma requisição HTTP POST ao método sendMessage da API do Bot do Telegram. Passamos o resultado do TDEE como o campo de texto no corpo da requisição, junto com o chat_id do grupo do Telegram para o qual queremos enviar a mensagem. Também definimos o campo <code class=\"language-text\">parse_mode</code> como <code class=\"language-text\">markdown</code> para habilitar a formatação na mensagem.</p>\n<p>Note que, para usar esse código, você precisará definir as variáveis de ambiente <code class=\"language-text\">TELEGRAM_BOT_ID</code> e <code class=\"language-text\">TELEGRAM_GROUP_ID</code> com os valores apropriados.</p>\n<h2 id=\"bonus\" style=\"position:relative;\"><a href=\"#bonus\" aria-label=\"bonus permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Bônus</h2>\n<p>Você pode copiar o texto que obteve deste script e enviá-lo para o ChatGPT para obter ainda mais insights 👀.</p>\n<blockquote>\n<p>Olá. O que você acha desses dados do meu acompanhamento de saúde pessoal dos últimos 30 dias ou mais? Você pode me dar uma análise curta e concisa sobre o que estou fazendo bem e onde devo melhorar? Obrigado\r\n&#x3C;- Meus Dados em Texto -></p>\n</blockquote>\n<blockquote>\n<p>Claro! Com base nos dados que você forneceu, aqui está uma análise breve:</p>\n<p>O Que Você Está Fazendo Bem:\r\nEquilíbrio Calórico: A sua ingestão calórica média está muito próxima do seu Gasto Energético Diário Total (TDEE), o que sugere que você está mantendo seu peso efetivamente.\r\nPerda de Peso: Você perdeu 0,80 kg no último mês, o que é uma taxa de perda de peso saudável e sustentável, se esse for o seu objetivo.\r\nIngestão de Proteína: A sua ingestão média de proteína parece estar em uma boa faixa, especialmente se você está praticando atividades físicas que requerem reparo e crescimento muscular.</p>\n<p>Áreas para Melhoria:\r\nAumento da Porcentagem de Gordura: O aumento na porcentagem de gordura e na massa gorda pode ser uma preocupação se você estiver buscando reduzir a gordura corporal. Isso pode estar relacionado ao tipo de alimentos que você está consumindo ou ao equilíbrio de macronutrientes.\r\nIngestão de Fibras: Sua ingestão média de fibras está um pouco baixa. Aumentar a ingestão de fibras consumindo mais grãos integrais, frutas e vegetais pode auxiliar na digestão e pode ajudar no controle do peso.</p>\n<p>Lembre-se, esses insights são baseados nos dados fornecidos e nas diretrizes gerais. As necessidades individuais podem variar amplamente, então é sempre uma boa ideia consultar um profissional de saúde ou nutricionista para obter orientação personalizada.</p>\n</blockquote>\n<h2 id=\"conclusao\" style=\"position:relative;\"><a href=\"#conclusao\" aria-label=\"conclusao permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Conclusão</h2>\n<p>Pronto, agora você sempre saberá exatamente qual é o seu TDEE. Você pode usar essa informação para ajustar a sua dieta e rotina de exercícios para alcançar os seus objetivos de fitness, você pode até colocar este script num fluxo de trabalho do GitHub Actions para executá-lo automaticamente todos os dias e enviar os resultados para um grupo de chat no Telegram.</p>\n<p>Se você quiser ver o código completo, <a href=\"https://github.com/blopa/google-fit-telegram/\" target=\"_blank\" rel=\"noreferrer\">você pode encontrá-lo no meu GitHub</a>, que inclui um workflow do GitHub Action que executa o script diariamente e envia os resultados para um chat do Telegram, portanto, sinta-se à vontade para simplesmente clonar o repositório e usá-lo.</p>\n<p>Espero que você tenha achado este artigo útil. Se tiver alguma dúvida ou comentário, fique à vontade para <a href=\"/pt-br/contact\">entrar em contato</a> ou deixar o sua opinião na seção de comentários abaixo.</p>","fields":{"postHashId":"Y29kaW5ndHJ1ZW51bGwyMDIzLTA4LTAyVDAwOjAwOjAwLjAwMFo=","slug":"/2023/2023-08-02-usando-google-fitness-api-para-calcular-meu-tdee-e-mais.pt-br/","path":"/blog/coding/usando-google-fitness-api-para-calcular-meu-tdee-e-mais/","locale":"pt-br"},"frontmatter":{"tags":["google cloud","fitness api","google fit","nodejs","node","javascript"],"categories":["coding"],"allowComments":true,"publishOnMedium":false,"cover":null,"date":"2023-08-02T00:00:00.000Z","id":null,"path":"usando-google-fitness-api-para-calcular-meu-tdee-e-mais","show":true,"title":"Usando Google Fitness API para calcular meu TDEE e mais","hideExcerpt":false,"subtitle":"De calorias para código: Integrando Google Fitness API para insights personalizados de saúde"}}},{"node":{"html":"<p>Eu constantemente escrevo sobre programação e compartilho trechos de código nos meus posts, e copiar e colar código é uma habilidade essencial para qualquer programador, e como selecionar um texto e pressionar <code class=\"language-text\">CTRL + C</code> então <code class=\"language-text\">CTRL + V</code> é muito trabalhoso, eu decidi adicionar um botão de cópia a todos os meus códigos para facilitar a vida de todos os meus colegas programadores da internet.</p>\n<h2 id=\"possiveis-solucoes\" style=\"position:relative;\"><a href=\"#possiveis-solucoes\" aria-label=\"possiveis solucoes permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Possíveis soluções</h2>\n<p>A maneira correta de fazer isso é criar um plugin para acessar o processo de geração de HTML do Gatsby e acessar o objeto que contém o código na estrutura de dados AST. Existe um <a href=\"https://thundermiracle.medium.com/add-copy-button-to-your-gatsbyjs-blogs-code-block-a2711364a229\" target=\"_blank\" rel=\"noreferrer\">tutorial muito bom</a> feito pelo <a href=\"https://thundermiracle.medium.com/\" target=\"_blank\" rel=\"noreferrer\">@thundermiracle</a> sobre como fazer isso.</p>\n<p>Claro, eu decidi fazer isso do jeito preguiçoso e com gambiarras, que é alterando a string HTML na função <code class=\"language-text\">createPages</code> no arquivo <code class=\"language-text\">gatsby-node.js</code>.</p>\n<h2 id=\"o-codigo\" style=\"position:relative;\"><a href=\"#o-codigo\" aria-label=\"o codigo permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>O código</h2>\n<p>Dentro do loop que cria as páginas dos posts, eu adicionei o seguinte código no arquivo <code class=\"language-text\">gatsby-node.js</code>:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\">exports<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">createPages</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">async</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span> actions<span class=\"token punctuation\">,</span> graphql <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> data <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">graphql</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\"> /* some graphQL query */ </span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    data<span class=\"token punctuation\">.</span>allMarkdownRemark<span class=\"token punctuation\">.</span>edges<span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">edge</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token keyword\">const</span> alternativeHtml <span class=\"token operator\">=</span> <span class=\"token function\">generateAlternativeHtml</span><span class=\"token punctuation\">(</span>edge<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">.</span>html<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        actions<span class=\"token punctuation\">.</span><span class=\"token function\">createPage</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\r\n            <span class=\"token literal-property property\">component</span><span class=\"token operator\">:</span> require<span class=\"token punctuation\">.</span><span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">./src/templates/PostTemplate.jsx</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\r\n            <span class=\"token literal-property property\">context</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> alternativeHtml <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\r\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\r\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Para a função <code class=\"language-text\">generateAlternativeHtml</code>, usarei o pacote <a href=\"https://www.npmjs.com/package/jsdom\" target=\"_blank\" rel=\"noreferrer\">jsdom</a> para analisar a string HTML e convertê-la em um objeto DOM e usar o método <code class=\"language-text\">querySelectorAll</code> para encontrar todos os nodes com código no post e adicione o botão de cópia a eles.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">generateAlternativeHtml</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">html</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">const</span> dom <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">JSDOM</span><span class=\"token punctuation\">(</span>html<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> document <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> dom<span class=\"token punctuation\">.</span>window<span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">const</span> codeSnippets <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">querySelectorAll</span><span class=\"token punctuation\">(</span><span class=\"token string\">'.gatsby-highlight'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n    codeSnippets<span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">codeSnippet</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token keyword\">const</span> wrapper <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">createElement</span><span class=\"token punctuation\">(</span><span class=\"token string\">'div'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        wrapper<span class=\"token punctuation\">.</span>classList<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token string\">'copy-code-block'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n        <span class=\"token comment\">// add your own css styles here, css classes, etc.</span>\r\n        <span class=\"token keyword\">const</span> copyButton <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">createElement</span><span class=\"token punctuation\">(</span><span class=\"token string\">'button'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        copyButton<span class=\"token punctuation\">.</span>innerHTML <span class=\"token operator\">=</span> <span class=\"token string\">'Copy'</span><span class=\"token punctuation\">;</span>\r\n        codeSnippet<span class=\"token punctuation\">.</span><span class=\"token function\">insertAdjacentHTML</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">afterend</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span> copyButton<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n    <span class=\"token keyword\">return</span> document<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span>innerHTML<span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Agora todos os nodes de código terão um botão de cópia, mas o botão não faz nada. Para resolver isso, vou adicionar eventos <code class=\"language-text\">onclick</code> aos botões de cópia para quando o botão for clicado, copiar o código. Isso precisa ser feito na parte <code class=\"language-text\">React</code> do código com um <code class=\"language-text\">useEffect</code> no arquivo <code class=\"language-text\">PostTemplate.jsx</code>.</p>\n<p>Para copiar o código usarei o pacote <a href=\"https://www.npmjs.com/package/clipboard-copy\" target=\"_blank\" rel=\"noreferrer\">clipboard-copy</a>.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> copy <span class=\"token keyword\">from</span> <span class=\"token string\">'clipboard-copy'</span><span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">BlogPostTemplate</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span> data<span class=\"token punctuation\">,</span> pageContext <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> alternativeHtml <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> pageContext<span class=\"token punctuation\">;</span>\r\n\r\n    <span class=\"token function\">useEffect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token keyword\">const</span> codeSnippets <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">querySelectorAll</span><span class=\"token punctuation\">(</span><span class=\"token string\">'.copy-code-block button'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        codeSnippets<span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">elementWrapper</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n            codeSnippet<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'click'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n                <span class=\"token keyword\">const</span> codeSnippet <span class=\"token operator\">=</span> elementWrapper<span class=\"token punctuation\">.</span>parentElement<span class=\"token punctuation\">.</span><span class=\"token function\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token string\">'.gatsby-highlight'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                <span class=\"token keyword\">const</span> code <span class=\"token operator\">=</span> codeSnippet<span class=\"token punctuation\">.</span>innerHTML<span class=\"token punctuation\">;</span>\r\n                <span class=\"token function\">copy</span><span class=\"token punctuation\">(</span>code<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\r\n        <span class=\"token operator\">&lt;</span>section<span class=\"token operator\">></span>\r\n            <span class=\"token operator\">&lt;</span>h1<span class=\"token operator\">></span><span class=\"token punctuation\">{</span>data<span class=\"token punctuation\">.</span>markdownRemark<span class=\"token punctuation\">.</span>frontmatter<span class=\"token punctuation\">.</span>title<span class=\"token punctuation\">}</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>h1<span class=\"token operator\">></span>\r\n            <span class=\"token operator\">&lt;</span>div dangerouslySetInnerHTML<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">__html</span><span class=\"token operator\">:</span> alternativeHtml <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span>\r\n        <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>section<span class=\"token operator\">></span>\r\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Feito! Super gambiarrado, but hey, it works! :)</p>\n<h2 id=\"conclusao\" style=\"position:relative;\"><a href=\"#conclusao\" aria-label=\"conclusao permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Conclusão</h2>\n<p>Essa solução adiciona um pouco de sobrecarga ao processo Static Site Generator e alguma manipulação de DOM no cliente, mas é uma boa solução por enquanto. Se você está procurando uma solução rápida e fácil, este é o melhor jeito de fazer.</p>\n<p>É isso pessoal, espero que esse post tenha sido útil para você.</p>","fields":{"postHashId":"Y29kaW5ndHJ1ZW51bGwyMDIyLTA1LTA1VDAwOjAwOjAwLjAwMFo=","slug":"/2022/2022-05-05-adicionando-botao-para-copiar-code-snippets-no-gatsby-gambiarra.pt-br/","path":"/blog/coding/adicionando-botao-para-copiar-code-snippets-no-gatsby-gambiarra/","locale":"pt-br"},"frontmatter":{"tags":["gatsby","html","code snippets","node","nodejs","javascript","dom","ast"],"categories":["coding"],"allowComments":true,"publishOnMedium":false,"cover":null,"date":"2022-05-05T00:00:00.000Z","id":null,"path":"adicionando-botao-para-copiar-code-snippets-no-gatsby-gambiarra","show":true,"title":"Adicionando botão para copiar code snippets no Gatsby (gambiarra)","hideExcerpt":false,"subtitle":"Não quer criar um plugin para o Gatsby? Então este post é para você."}}},{"node":{"html":"<p>Webpack é o <em>bundler</em> de módulos mais popular para JavaScript, é uma ferramenta para agrupar módulos em um único arquivo e mais.</p>\n<p>Uma coisa que sempre me deixou curioso foi como ele resolve os <em>imports</em> dinâmicos, quer dizer, eu sabia que não era mágica, mas não sabia como funcionava, e sempre esquecia de pesquisar depois… até agora.</p>\n<p><figure class=\"gatsby-resp-image-figure\" style=\"\">\n    <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1007px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 38.67187499999999%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAAsTAAALEwEAmpwYAAABNklEQVQY022QXW6DMBCEuU1VAokxxMTBib22sdeGQP7al6oX6Al6/IpQ0aqqNNqX0czufkkBmDVmtdcph5TDaq8X5cLmws7uv0oKiPmhpToWEHJhFyPlQCEc+jtV+Lv0u+sxk8r0RCJzY+3PzA1ZY9aHNmvM5uhYe2ritXbDnEk55MISFTYSqY5EYlL7cdsOFCJzQ+3HpXvnR/fyvvPjsb8T6anCtbCZsKXpiMLKnogKSY0X5oat7anutu60hDme5fBKIZQ6ljoWCol0ubAUIlFh2qwwmbxHkuoouvtqP51dKNy5YR8urD1tbZ81Zj47E3bnRwqR47k0XUIklrZv4o1InIGlHEodK9OV02OeQvgDOeXwxGTKIeF4IQrzxj6QwoJ01ubofmKNea6Plb/ePj7D6xtr+y/liXJ/sFdToQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Mágica?\"\n        title=\"Mágica?\"\n        src=\"/static/e6e021a037da7763c8f6affd02c34110/b82a7/webpack-magic.png\"\n        srcset=\"/static/e6e021a037da7763c8f6affd02c34110/e3135/webpack-magic.png 256w,\n/static/e6e021a037da7763c8f6affd02c34110/06341/webpack-magic.png 512w,\n/static/e6e021a037da7763c8f6affd02c34110/b82a7/webpack-magic.png 1007w\"\n        sizes=\"(max-width: 1007px) 100vw, 1007px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\">Mágica?</figcaption>\n  </figure></p>\n<h2 id=\"como-funciona-o-import-de-arquivos\" style=\"position:relative;\"><a href=\"#como-funciona-o-import-de-arquivos\" aria-label=\"como funciona o import de arquivos permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Como funciona o import de arquivos</h2>\n<p>Sempre que você importar um arquivo em seu código, o Webpack irá procurá-lo na pasta do projeto e copiá-lo para a pasta de <code class=\"language-text\">build</code> com um novo nome, então o Webpack substituirá o código que importa esse arquivo em seu arquivo JavaScript pelo <em>path</em> para o arquivo recém-copiado.</p>\n<p>Aqui está um exemplo super simplificado:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">// import on your app.js file</span>\r\n<span class=\"token keyword\">import</span> utils <span class=\"token keyword\">from</span> <span class=\"token string\">'./helpers/utils.js'</span><span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token comment\">// import on the bundled file</span>\r\n<span class=\"token keyword\">import</span> utils <span class=\"token keyword\">from</span> <span class=\"token string\">'./build/09wdj0wjd.bundle.0.js'</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h2 id=\"o-que-e-um-import-dinamico\" style=\"position:relative;\"><a href=\"#o-que-e-um-import-dinamico\" aria-label=\"o que e um import dinamico permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>O que é um import dinâmico?</h2>\n<p>Às vezes você não quer que o browser baixe o arquivo imediatamente, você quer carregá-lo apenas quando for necessário, e para isso, você pode usar um <em>import</em> dinâmico.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> button <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">createElement</span><span class=\"token punctuation\">(</span><span class=\"token string\">'button'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\nbutton<span class=\"token punctuation\">.</span>innerHTML <span class=\"token operator\">=</span> <span class=\"token string\">'Click me'</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token comment\">// when the button is clicked, a dynamic import will happen</span>\r\nbutton<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">onclick</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token keyword\">import</span><span class=\"token punctuation\">(</span><span class=\"token string\">'./helpers/utils.js'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Dynamic import'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>É possível usar <em>import</em> dinâmicos com praticamente qualquer arquivo, por isso é bastante útil para imagens ou arquivos de áudio grandes, por exemplo.</p>\n<p>Mas o que acontece quando você quer importar um arquivo com um <em>path</em> variável?</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> fileName <span class=\"token operator\">=</span> <span class=\"token string\">'image.jpg'</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">const</span> button <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">createElement</span><span class=\"token punctuation\">(</span><span class=\"token string\">'button'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\nbutton<span class=\"token punctuation\">.</span>innerHTML <span class=\"token operator\">=</span> <span class=\"token string\">'Click me'</span><span class=\"token punctuation\">;</span>\r\nbutton<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">onclick</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token keyword\">import</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">./assets/images/</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>fileName<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Como o Webpack sabe qual arquivo copiar para a pasta <code class=\"language-text\">build</code>? Bem, existe uma maneira de dizer ao Webpack para ignorar o <em>import</em> e deixar o browser resolve-lo como quiser com o comentário <code class=\"language-text\">/* webpackIgnore: true */</code>.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> path <span class=\"token operator\">=</span> <span class=\"token string\">'assets/images/image.jpg'</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token comment\">// the browser will resolve this import and fail if the file doesn't exist</span>\r\n<span class=\"token keyword\">const</span> module <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token keyword\">import</span><span class=\"token punctuation\">(</span><span class=\"token comment\">/*webpackIgnore: true*/</span> path<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Isso é bem maneiro, mas de alguma forma também é possível não fazer isso e deixar o Webpack descobrir o <em>path</em> para o arquivo. Mas como?</p>\n<p><img src=\"/6061b99ae0d312b222b91b3f265dbe9e/magic.gif\" alt=\"Magic\"></p>\n<h2 id=\"o-truque-de-magica\" style=\"position:relative;\"><a href=\"#o-truque-de-magica\" aria-label=\"o truque de magica permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>O truque de mágica</h2>\n<p>Na verdade, não é tão complicado, mas vem com algumas ressalvas. Por exemplo, se você importar um arquivo com um <em>path</em> variável, pelo menos uma parte desse <em>path</em> precisa ser explícito no código, por exemplo:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">// this works</span>\r\n<span class=\"token keyword\">const</span> fileName <span class=\"token operator\">=</span> <span class=\"token string\">'image.jpg'</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">let</span> module <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token keyword\">import</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">./assets/images/</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>fileName<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token comment\">// this doesn't work</span>\r\n<span class=\"token keyword\">const</span> path <span class=\"token operator\">=</span> <span class=\"token string\">'./assets/images/image.jpg'</span><span class=\"token punctuation\">;</span>\r\nmodule <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token keyword\">import</span><span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Por que isso? A maneira como o Webpack faz isso é analisando o <em>path</em> da string interpolada durante o processo de compilação, e ele obterá a parte explícita da string, neste exemplo <code class=\"language-text\">assets/images/</code>, e então copiará todos os arquivos dessa pasta para a pasta <code class=\"language-text\">build</code>.</p>\n<p>O Webpack faz isso de uma maneira muito inteligente também, se o <em>import</em> incluir a extensão do arquivo, ele copiará apenas os arquivos com essa extensão, por exemplo <code class=\"language-text\">import(`./assets/images/${fileName}.png`)</code> só copiará arquivos <code class=\"language-text\">PNG</code>.</p>\n<p>Como o Webpack faz isso analisando a string no <em>import</em>, ele não é capaz de saber quais arquivos copiar quando o <em>path</em> inteiro é uma variável sem uma parte explícita.</p>\n<h2 id=\"conclusao\" style=\"position:relative;\"><a href=\"#conclusao\" aria-label=\"conclusao permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Conclusão</h2>\n<p>O Webpack pode ter uma configuração complicada e, às vezes, pode parecer feitiçaria, mas é uma ferramenta muito poderosa com muitos recursos e, se você se aprofundar o suficiente, descobrirá que sua implementação não é tão complicada.</p>\n<p>Se você quiser saber mais sobre o Webpack, você pode conferir a <a href=\"https://webpack.js.org/\" target=\"_blank\" rel=\"noreferrer\">documentação oficial</a>, e você pode ler mais sobre <a href=\"https://webpack.js.org/api/module-methods/\" target=\"_blank\" rel=\"noreferrer\"><strong>Module Methods</strong> aqui</a> e <a href=\"https://webpack.js.org/guides/code-splitting/#dynamic-imports\" target=\"_blank\" rel=\"noreferrer\"><strong>Dynamic Imports</strong> aqui</a>.</p>","fields":{"postHashId":"Y29kaW5ndHJ1ZW51bGwyMDIyLTA0LTExVDAwOjAwOjAwLjAwMFo=","slug":"/2022/2022-04-11-como-o-webpack-resolve-imports-dinamicos-com-paths-variaveis.pt-br/","path":"/blog/coding/como-o-webpack-resolve-imports-dinamicos-com-paths-variaveis/","locale":"pt-br"},"frontmatter":{"tags":["webpack","esm","javascript","node","nodejs","programação","import dinâmico"],"categories":["coding"],"allowComments":true,"publishOnMedium":false,"cover":null,"date":"2022-04-11T00:00:00.000Z","id":null,"path":"como-o-webpack-resolve-imports-dinamicos-com-paths-variaveis","show":true,"title":"Como o Webpack resolve imports dinâmicos com paths variáveis","hideExcerpt":false,"subtitle":"Não é mágica, eu prometo"}}},{"node":{"html":"<p>Se você quer alugar ou comprar uma casa na Holanda, é melhor se preparar porque não é uma tarefa fácil, especialmente se você estiver procurando em Amsterdam.</p>\n<p>Candidatar-se para alugar ou comprar uma casa é como uma entrevista de emprego ou como obter um visto para outro país. Você precisa fornecer seus contracheques, contrato de trabalho, recomendações de proprietários anteriores e muito mais.</p>\n<p>Não só isso, mas muitas vezes você nem tem a chance de ir ver a casa, porque eles já têm tantos pedidos de pessoas querendo ir ver a casa que eles não precisam aceitar mais. Às vezes, dentro de 2 dias após a casa ser listada no <a href=\"https://funda.nl/\" target=\"_blank\" rel=\"noreferrer\">Funda.nl</a>, eles já não estão agendando visitas.</p>\n<p>Se você pelo menos conseguir marcar uma visita, verá a casa com muitas outras pessoas e <a href=\"https://dutchreview.com/traveling/cities/amsterdam/an-amsterdam-apartment-with-fair-rent-queue-stretches-around-the-block/\" target=\"_blank\" rel=\"noreferrer\">às vezes até fazer fila para isso</a>.</p>\n<p>Por causa disso, eu tive que abrir constantemente o Funda.nl e verificar novas casas, para que assim que uma nova casa estivesse disponível eu pudesse marcar uma visita.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 857px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.25%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAAsTAAALEwEAmpwYAAACSUlEQVQoz2WQ60tTYQDG91f0B4i57Vze97xnO26zmwSGIllqNGGrkPBajlnWpg6ZWE4r0lo3IlIqocgv9VVEKFSUcLqFY+u4tjw7Z5d2ds42bxUZXoLMH8/XH8/Do5BWN6TVDUHOCXIums7IPzefvXiJaKTT6TSIYGigQYBCCEBII5JGJAVJDMN3UPBSjpdygrwWk9ejUi6+su4P8xcbWquqqo8a6MN6pNXSDKPV0oiCJNoOBOSuLMhyPPs7IIzNhRyJ7K+EvBbm2OdDttMV5UUM0iNQqKGL9LQWgS2ZAjS15f9tlteT2c3JYP/4vHpZ3vRLgocfCmbcF1rPH2SOw+JSHCJMrcIw/J/s7lZE4qOplYmpkGns04Hx8FSd60HnLddlR1d9W4epyXbuUnu59QbUHcJUSpwg8L0oQtHr79+Y3o7UeOZrveKTM+Zm56myvlqzvbzkXkvDU2tdk7m2qKZJnZ9HEOT/cjjRPVCv7a3MD0Y6uWTXq5kRa/8d50N3W5/L4b7f0NFrbOkuaekBOAYA3CfHeyZmrvp8jf6A08/aZ1njPN/n5Qe9/CAruXvcjUqmuPDIMUhBktzXnFnLXPOkLZO+pe+iIImBGMunhIScionJVFb8FuPLTlSolQUQAmKbPXLaM3xy9GPz9OLch9eRlDchfY6KXk5c4MSFSNIj/fjyeNiuKsgzMJRGg2hag+Nbb+8crigduG171H7FZbnbX/lu8eZc2PaVs7CcdWk77LJlevFstdGgVBKAIklAAEBCAAGABEH8AX6ULwUbFNkZAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"funda scraper\"\n        title=\"funda scraper\"\n        src=\"/static/82fc245c2e60c74dd352f6bb36dfa4f4/87817/funda-scraper.png\"\n        srcset=\"/static/82fc245c2e60c74dd352f6bb36dfa4f4/e3135/funda-scraper.png 256w,\n/static/82fc245c2e60c74dd352f6bb36dfa4f4/06341/funda-scraper.png 512w,\n/static/82fc245c2e60c74dd352f6bb36dfa4f4/87817/funda-scraper.png 857w\"\n        sizes=\"(max-width: 857px) 100vw, 857px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h2 id=\"partiu-automatizar\" style=\"position:relative;\"><a href=\"#partiu-automatizar\" aria-label=\"partiu automatizar permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Partiu automatizar!</h2>\n<p>O bom do Funda.nl é que eles possuem uma grande variedade de filtros para a busca, e esses filtros ficam salvos na URL. Nice!</p>\n<p>Por exemplo, <a href=\"https://www.funda.nl/en/huur/amsterdam/beschikbaar/0-2000/40+woonopp/2+slaapkamers/1-dag/\" target=\"_blank\" rel=\"noreferrer\">este link</a> listará todas as casas publicadas desde 1 dia atrás, com 2 quartos, no mínimo 40m² e no máximo €2000 de aluguel.</p>\n<p>Os resultados nesta página estão listados em um elemento HTML <code class=\"language-text\">li</code> com uma classe <code class=\"language-text\">search-result</code>, com isso dá para obter todos os elementos com o <code class=\"language-text\">document.querySelectorAll('.search-result')</code> e dentro de cada um dos desses elementos, posso obter o link para a casa com <code class=\"language-text\">element.querySelectorAll('a').[0].href</code>.</p>\n<p>Agora com o <code class=\"language-text\">puppeteer.js</code> eu posso automatizar um processo de ir a essa URL e verificar se alguma casa nova apareceu e salvá-la em um arquivo. Como este é um script Node.js, usarei o <code class=\"language-text\">jsdom</code> para trabalhar com os elementos DOM.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> writeFileSync <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'fs'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">const</span> puppeteer <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'puppeteer'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">const</span> jsdom <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'jsdom'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">runTask</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n  <span class=\"token keyword\">const</span> url <span class=\"token operator\">=</span> <span class=\"token string\">'https://www.funda.nl/en/huur/amsterdam/beschikbaar/0-2000/40+woonopp/2+slaapkamers/1-dag/'</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token keyword\">const</span> browser <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> puppeteer<span class=\"token punctuation\">.</span><span class=\"token function\">launch</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\r\n    <span class=\"token literal-property property\">headless</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\r\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n  <span class=\"token keyword\">const</span> page <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> browser<span class=\"token punctuation\">.</span><span class=\"token function\">newPage</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token keyword\">await</span> page<span class=\"token punctuation\">.</span><span class=\"token function\">goto</span><span class=\"token punctuation\">(</span>url<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">waitUntil</span><span class=\"token operator\">:</span> <span class=\"token string\">'domcontentloaded'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n  <span class=\"token keyword\">const</span> htmlString <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> page<span class=\"token punctuation\">.</span><span class=\"token function\">content</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token keyword\">const</span> dom <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">jsdom<span class=\"token punctuation\">.</span>JSDOM</span><span class=\"token punctuation\">(</span>htmlString<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token keyword\">const</span> result <span class=\"token operator\">=</span> dom<span class=\"token punctuation\">.</span>window<span class=\"token punctuation\">.</span>document<span class=\"token punctuation\">.</span><span class=\"token function\">querySelectorAll</span><span class=\"token punctuation\">(</span><span class=\"token string\">'.search-result'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n  <span class=\"token keyword\">const</span> urls <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">const</span> element <span class=\"token keyword\">of</span> result<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    urls<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span>element<span class=\"token operator\">?.</span><span class=\"token function\">querySelectorAll</span><span class=\"token punctuation\">(</span><span class=\"token string\">'a'</span><span class=\"token punctuation\">)</span><span class=\"token operator\">?.</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token operator\">?.</span>href<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token punctuation\">}</span>\r\n\r\n  <span class=\"token function\">writeFileSync</span><span class=\"token punctuation\">(</span><span class=\"token string\">'urls.json'</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">stringify</span><span class=\"token punctuation\">(</span>urls<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span>\r\n\r\n<span class=\"token function\">runTask</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Agora eu posso simplesmente executar <code class=\"language-text\">node script.js</code> e terei todas as URLs em um arquivo <code class=\"language-text\">urls.json</code>.</p>\n<h2 id=\"enviando-novas-urls-para-o-telegram\" style=\"position:relative;\"><a href=\"#enviando-novas-urls-para-o-telegram\" aria-label=\"enviando novas urls para o telegram permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Enviando novas URLs para o Telegram</h2>\n<p>Em vez de salvar as URLs em um arquivo <code class=\"language-text\">urls.json</code>, quero que essas URLs sejam enviadas para um grupo do Telegram usando um bot, para isso precisarei usar o <code class=\"language-text\">node-fetch</code>.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> nodeFetch <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'node-fetch'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">runTask</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n  <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">const</span> element <span class=\"token keyword\">of</span> result<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token function\">nodeFetch</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">https://api.telegram.org/bot</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token constant\">BOT_API</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">/sendMessage</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\r\n      <span class=\"token literal-property property\">method</span><span class=\"token operator\">:</span> <span class=\"token string\">'POST'</span><span class=\"token punctuation\">,</span>\r\n      <span class=\"token literal-property property\">headers</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token string-property property\">'Content-Type'</span><span class=\"token operator\">:</span> <span class=\"token string\">'application/json'</span><span class=\"token punctuation\">,</span>\r\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\r\n      <span class=\"token literal-property property\">body</span><span class=\"token operator\">:</span> <span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">stringify</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\r\n        <span class=\"token literal-property property\">text</span><span class=\"token operator\">:</span> element<span class=\"token operator\">?.</span><span class=\"token function\">querySelectorAll</span><span class=\"token punctuation\">(</span><span class=\"token string\">'a'</span><span class=\"token punctuation\">)</span><span class=\"token operator\">?.</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token operator\">?.</span>href<span class=\"token punctuation\">,</span>\r\n        <span class=\"token literal-property property\">chat_id</span> <span class=\"token operator\">:</span> <span class=\"token constant\">CHAT_ID</span><span class=\"token punctuation\">,</span>\r\n        <span class=\"token literal-property property\">parse_mode</span> <span class=\"token operator\">:</span> <span class=\"token string\">'markdown'</span><span class=\"token punctuation\">,</span>\r\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\r\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n  <span class=\"token punctuation\">}</span>\r\n<span class=\"token punctuation\">}</span>\r\n\r\n<span class=\"token function\">runTask</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Isso é ótimo, mas não é muito útil porque não quero ter que executar o script manualmente, então partiu corrigir isso.</p>\n<h2 id=\"usando-o-github-actions\" style=\"position:relative;\"><a href=\"#usando-o-github-actions\" aria-label=\"usando o github actions permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Usando o GitHub Actions</h2>\n<p>GitHub Actions é ótimo, eu uso o tempo todo para tarefas como testes e builds do meu blog, mas também pode ter <a href=\"https://docs.github.com/en/actions/using-workflows/events-that-trigger-workflows#schedule\" target=\"_blank\" rel=\"noreferrer\">scripts rodando periódicamente</a> usando <code class=\"language-text\">cron</code>.</p>\n<p>Para este script, preciso usar <a href=\"https://github.com/actions/checkout\" target=\"_blank\" rel=\"noreferrer\">actions/checkout</a> para fazer o checkout do meu código e <a href=\"https://github.com/stefanzweifel/git-auto-commit-action\" target=\"_blank\" rel=\"noreferrer\">stefanzweifel/git-auto-commit-action</a> para persistir uma lista das URLs que já foram enviadas ao Telegram.</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Run Task\r\n<span class=\"token key atrule\">on</span><span class=\"token punctuation\">:</span>\r\n  <span class=\"token key atrule\">workflow_dispatch</span><span class=\"token punctuation\">:</span>\r\n  <span class=\"token key atrule\">schedule</span><span class=\"token punctuation\">:</span>\r\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">cron</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"*/30 * * * *\"</span>\r\n\r\n<span class=\"token key atrule\">jobs</span><span class=\"token punctuation\">:</span>\r\n  <span class=\"token key atrule\">build-and-deploy</span><span class=\"token punctuation\">:</span>\r\n    <span class=\"token key atrule\">runs-on</span><span class=\"token punctuation\">:</span> ubuntu<span class=\"token punctuation\">-</span>latest\r\n\r\n    <span class=\"token key atrule\">steps</span><span class=\"token punctuation\">:</span>\r\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Checkout\r\n        <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> actions/checkout@v2.4.0\r\n        <span class=\"token key atrule\">with</span><span class=\"token punctuation\">:</span>\r\n          <span class=\"token key atrule\">ref</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> github.head_ref <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\r\n\r\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Running\r\n        <span class=\"token key atrule\">run</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">|</span><span class=\"token scalar string\">\r\n          npm cache clean --force\r\n          npm install\r\n          npm run task</span>\r\n        <span class=\"token key atrule\">env</span><span class=\"token punctuation\">:</span>\r\n          <span class=\"token key atrule\">CHAT_ID</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> secrets.CHAT_ID <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\r\n          <span class=\"token key atrule\">BOT_API</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> secrets.BOT_API <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\r\n\r\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> stefanzweifel/git<span class=\"token punctuation\">-</span>auto<span class=\"token punctuation\">-</span>commit<span class=\"token punctuation\">-</span>action@v4\r\n        <span class=\"token key atrule\">with</span><span class=\"token punctuation\">:</span>\r\n          <span class=\"token key atrule\">commit_message</span><span class=\"token punctuation\">:</span> Update db.json\r\n          <span class=\"token key atrule\">branch</span><span class=\"token punctuation\">:</span> main</code></pre></div>\n<p>E é isso! Agora, sempre que uma nova casa estiver listada na minha URL, receberei uma mensagem no Telegram 🎉.</p>\n<h2 id=\"bonus\" style=\"position:relative;\"><a href=\"#bonus\" aria-label=\"bonus permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Bonus</h2>\n<p><figure class=\"gatsby-resp-image-figure\" style=\"\">\n    <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 547px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 107.03125%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAVCAIAAADJt1n/AAAACXBIWXMAAAsTAAALEwEAmpwYAAAEEElEQVQ4y23USWwbVRgH8AjEqXZsOV4SK4snY88be2Y89sy82Tz2jGefccZ2SJyQRApr2SGiRJVoVKgqLkSQYlrRqi1BiAviwAEEHMsBQZWITeWGRBOpwIkThRa4gONEpRV/vcO7/PTpPX3fNxCJRsOhULZQgHW9rNRKkgwAwACGYRgAIJvNopM5dBJDEHTi9gwNDQ1EIpFwOJzNZgVBYPcCIeR6gRBCnueJPEMWIA7oDJJB/pN4PL6PURQVRXHPcDRNQwgFQehXyGT65za5j6PRaCgUomm60+k0Gg3f91utpmVZrutpqkaS5MTEnexOTBCE73me6/qeZ9u2bdm1mqppGsdxCIKgKDp5kP/BFEU2pgLdsEzLUdV6TVWJQiGXzcZisXh8KJlMjIyMjI6OptPpg//K3MIFnJqf9h5a9JYXnMMPdlafX9k41T177kL39Jlu9/T6+qsrK886ltKZneZYii3TZZpMJBI9fCgUIvOlh+ftw4vGXIt5YEl56YVHL54/s7219edff1/d2f32uyvn3nzt6SeWj6w8aZl1RRYUGaZSqf3KeUBN6cJCu+aoZGATjyxWH7vf7W6cvP77Hzdu3Pzx6u7bm28FvtEMfMvUaxUo8n0ciYbCoTwoyixlVai5QJ0N5IZNtqfY+XvFrcuXfvn5p7WjzyzM+romqKrqeoFcUauVWiqZPHhzvlSFRQ3iywvtwK52Wna9VtQq2Im1x4+vHRXYHM8CSRJtr+147VKZF6Xq8PBwHx8qFLiaooiw6Nqmo2vTrXZdN+RqfWZm5r6FJQbKgqKzUFZ13/Q7DFRYTkwmkwORSK8yDkocJ1AUSTM8y3GQF3TTKRbJbvf1Cxc3dct1/GlRMYLZ5YrmjyGgxErJROKgt1ECxzCQQwiSwHCixMm2487OLXx+ZeeTS5clkcdxkpDbgIIIiqfSYwgKEn08OBjOThaKNC1WFNO0JZ73DM2x7dXj61/+8Ov2zm9n3v3QdIJINJYF1CSKxqLhzPj4LYxkcIbhqppp6npNgmpFMAzj5VOb31y7+fXu9Q8++/65FzeaM0tQrALOl402lOuxWOzgw/JlkijQBOboNR5yZYZRasaxV85/+tW1j7d33vnoi9WTbzy1ekLRp8ZzJWX6SEZaHorvdVgkGsmhJGT0IlkCIJfDsFwOA3ieKpY5QS5zAsMJRZohKJousxiWG0MwBAW93h4cHLzn7rvygG4GbdO0TNM0TMOyTMMwTNNwHUfTNFVVe4NmW5qm0jQ9PjaayUz0cCqdZqrVQp4JgsD1eiMZBFO2bXue12w2W62W04vr+w1d10VRhBBKksSybA9jDHvsvfdxoiSJkiiKgiBUKhVBEPfuPM/3br1lRBD9wc71noUBgP+7w/4B5DorbrXMqwIAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Agora corre pra marcar uma visita na casa!\"\n        title=\"Agora corre pra marcar uma visita na casa!\"\n        src=\"/static/b167f6a479ff3551a706ec1719572d7d/25257/telegram-funda-message-with-stats.png\"\n        srcset=\"/static/b167f6a479ff3551a706ec1719572d7d/e3135/telegram-funda-message-with-stats.png 256w,\n/static/b167f6a479ff3551a706ec1719572d7d/06341/telegram-funda-message-with-stats.png 512w,\n/static/b167f6a479ff3551a706ec1719572d7d/25257/telegram-funda-message-with-stats.png 547w\"\n        sizes=\"(max-width: 547px) 100vw, 547px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\">Agora corre pra marcar uma visita na casa!</figcaption>\n  </figure></p>\n<p>Existe uma <a href=\"https://github.com/nikitaindik/funda-neighbourhoods\" target=\"_blank\" rel=\"noreferrer\">extensão para Chrome de código aberto muito boa</a> que adiciona muitos dados novos ao Funda.nl sobre a casa, então copiei algumas partes do código desse projeto para adicione informações extras às casas enviadas para o Telegram.</p>\n<p>Você pode <a href=\"https://github.com/blopa/funda-scraper\" target=\"_blank\" rel=\"noreferrer\">clonar este projeto no GitHub</a>, adicionar sua própria lista de URLs do Funda.nl e o script será executado automaticamente a cada 30 minutos para verificar novas casas e enviá-las para o Telegram.</p>\n<p>Até a próxima, pessoal!</p>","fields":{"postHashId":"Y29kaW5ndHJ1ZW51bGwyMDIyLTAzLTEyVDAwOjAwOjAwLjAwMFo=","slug":"/2022/2022-03-12-usando-nodejs-e-github-action-para-encontrar-uma-casa-no-fundanl.pt-br/","path":"/blog/coding/usando-nodejs-e-github-action-para-encontrar-uma-casa-no-fundanl/","locale":"pt-br"},"frontmatter":{"tags":["funda","casa","apartamento","node","javascript","github actions","github","cronjob","yml","telegram","puppeteer.js"],"categories":["coding"],"allowComments":true,"publishOnMedium":false,"cover":null,"date":"2022-03-12T00:00:00.000Z","id":null,"path":"usando-nodejs-e-github-action-para-encontrar-uma-casa-no-fundanl","show":true,"title":"Usando Node.js e GitHub Action para encontrar uma casa no Funda.nl","hideExcerpt":false,"subtitle":""}}},{"node":{"html":"<p>Quando eu estava trabalhando nos videos dos meus Game Devlogs, eu ficava pensando se seria possível criar automaticamente videos dos meus códigos, que dai ficaria bem mais fácil para criar os meus vídeos, mas como não achei nada relacionado a isso na internet, eu meio que desisti dessa idéia.</p>\n<p>Até que algumas semanas atrás eu estava mexendo com <a href=\"https://en.wikipedia.org/wiki/Abstract_syntax_tree\" target=\"_blank\" rel=\"noreferrer\">AST</a> e renderizando componentes em <code class=\"language-text\">React</code> usando <code class=\"language-text\">Node.js</code> e <code class=\"language-text\">Babel</code> e eu percebi que seria possível usar a função <code class=\"language-text\">renderToStaticMarkup</code> para renderizar um HTML com os meus códigos em um headless browser com o Puppeteer e fazer uma gravação dessa página.</p>\n<p>O objetivo é conseguir criar um vídeo como o do GIF abaixo.</p>\n<p><img src=\"/63cbac7ef35f31c0b11e205782860106/code-to-video-v1.gif\" alt=\"\"></p>\n<h2 id=\"partiu-programar\" style=\"position:relative;\"><a href=\"#partiu-programar\" aria-label=\"partiu programar permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Partiu programar</h2>\n<p>Vou começar criando um arquivo <code class=\"language-text\">script.js</code> onde vou executar pela linha de comando.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'@babel/register'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> readFileSync <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'fs'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">const</span> puppeteer <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'puppeteer'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> PuppeteerScreenRecorder <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'puppeteer-screen-recorder'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token comment\">// Utils</span>\r\n<span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> generateHtml <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'./utils'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token comment\">// Constants</span>\r\n<span class=\"token keyword\">const</span> <span class=\"token constant\">SCALE</span> <span class=\"token operator\">=</span> <span class=\"token number\">4</span><span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">generateVideo</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">filePath</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token comment\">// TODO</span>\r\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token comment\">// get node script param</span>\r\n<span class=\"token keyword\">const</span> filePath <span class=\"token operator\">=</span>\r\n    process<span class=\"token punctuation\">.</span>argv<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">||</span> <span class=\"token string\">'./examples/Test.jsx'</span><span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token function\">generateVideo</span><span class=\"token punctuation\">(</span>filePath<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Esse código vai usar <code class=\"language-text\">ES Modules</code>, então eu preciso instalar o pacote <a href=\"https://www.npmjs.com/package/esm\" target=\"_blank\" rel=\"noreferrer\">esm</a> para eu poder rodar o meu script com o comando <code class=\"language-text\">node -r esm src/script.js my_file.js</code>.</p>\n<p>Para a função <code class=\"language-text\">generateVideo</code>, seguirei o <a href=\"https://github.com/puppeteer/puppeteer/blob/v13.0.1/docs/api.md#class-puppeteer\" target=\"_blank\" rel=\"noreferrer\">exemplo de básico do Puppeteer</a> para abrir um headless browser e, em seguida, começar a gravar a sessão com o <a href=\"https://github.com/prasanaworld/puppeteer-screen-recorder#example\" target=\"_blank\" rel=\"noreferrer\">puppeteer-screen-recorder</a>.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">generateVideo</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">filePath</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token comment\">// load file content</span>\r\n    <span class=\"token keyword\">const</span> code <span class=\"token operator\">=</span> <span class=\"token function\">readFileSync</span><span class=\"token punctuation\">(</span>filePath<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token literal-property property\">encoding</span><span class=\"token operator\">:</span> <span class=\"token string\">'utf8'</span><span class=\"token punctuation\">,</span>\r\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">const</span> lines <span class=\"token operator\">=</span> code<span class=\"token punctuation\">.</span><span class=\"token function\">split</span><span class=\"token punctuation\">(</span><span class=\"token string\">'\\n'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n    <span class=\"token comment\">// Puppeteer config</span>\r\n    <span class=\"token keyword\">const</span> browser <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> puppeteer<span class=\"token punctuation\">.</span><span class=\"token function\">launch</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\r\n        <span class=\"token literal-property property\">headless</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\r\n        <span class=\"token literal-property property\">args</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'--window-size=1920,1080'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\r\n        <span class=\"token literal-property property\">defaultViewport</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\r\n            <span class=\"token literal-property property\">width</span><span class=\"token operator\">:</span> <span class=\"token number\">1920</span><span class=\"token punctuation\">,</span>\r\n            <span class=\"token literal-property property\">height</span><span class=\"token operator\">:</span> <span class=\"token number\">1080</span><span class=\"token punctuation\">,</span>\r\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\r\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n    <span class=\"token comment\">// open a new empty page</span>\r\n    <span class=\"token keyword\">const</span> page <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> browser<span class=\"token punctuation\">.</span><span class=\"token function\">newPage</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">const</span> config <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token literal-property property\">followNewTab</span><span class=\"token operator\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\r\n        <span class=\"token literal-property property\">fps</span><span class=\"token operator\">:</span> <span class=\"token number\">25</span><span class=\"token punctuation\">,</span>\r\n        <span class=\"token literal-property property\">ffmpeg_Path</span><span class=\"token operator\">:</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">,</span>\r\n        <span class=\"token literal-property property\">videoFrame</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\r\n            <span class=\"token literal-property property\">width</span><span class=\"token operator\">:</span> <span class=\"token number\">1920</span><span class=\"token punctuation\">,</span>\r\n            <span class=\"token literal-property property\">height</span><span class=\"token operator\">:</span> <span class=\"token number\">1080</span><span class=\"token punctuation\">,</span>\r\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\r\n        <span class=\"token literal-property property\">aspectRatio</span><span class=\"token operator\">:</span> <span class=\"token string\">'16:9'</span><span class=\"token punctuation\">,</span>\r\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\r\n\r\n    <span class=\"token keyword\">const</span> recorder <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">PuppeteerScreenRecorder</span><span class=\"token punctuation\">(</span>\r\n        page<span class=\"token punctuation\">,</span>\r\n        config\r\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n    <span class=\"token comment\">// start recording</span>\r\n    <span class=\"token keyword\">await</span> recorder<span class=\"token punctuation\">.</span><span class=\"token function\">start</span><span class=\"token punctuation\">(</span><span class=\"token string\">'./output.mp4'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">await</span> page<span class=\"token punctuation\">.</span><span class=\"token function\">setContent</span><span class=\"token punctuation\">(</span><span class=\"token string\">'&lt;p>Hello World&lt;/p>'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n    <span class=\"token keyword\">await</span> page<span class=\"token punctuation\">.</span><span class=\"token function\">waitForTimeout</span><span class=\"token punctuation\">(</span><span class=\"token number\">1000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n    <span class=\"token keyword\">await</span> recorder<span class=\"token punctuation\">.</span><span class=\"token function\">stop</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">await</span> browser<span class=\"token punctuation\">.</span><span class=\"token function\">close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Esse código vai abrir uma aba no headless browser, definir o HTML da página para <code class=\"language-text\">&lt;p>Hello World&lt;/p></code> e gravar um vídeo de um segundo. Não é bem isso que eu quero, mas estou chegando lá.</p>\n<h2 id=\"renderizando-um-componente-em-react\" style=\"position:relative;\"><a href=\"#renderizando-um-componente-em-react\" aria-label=\"renderizando um componente em react permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Renderizando um componente em React</h2>\n<p>Agora eu vou criar uma função para renderizar o meu componente em <code class=\"language-text\">React</code>. Essa função vai receber como parâmetro o meu código e retornar um HTML com a sintaxe do código toda colorida pelo <a href=\"https://prismjs.com/\" target=\"_blank\" rel=\"noreferrer\">Prism.js</a>.</p>\n<p>Com a função <code class=\"language-text\">Prism.highlight</code> eu pego o HTML com a sintaxe do código colorida e passo para o meu componente em <code class=\"language-text\">React</code>, que então vai adicionar outras tags de HTML e o CSS. Para renderizar esse componente em <code class=\"language-text\">React</code>, vou usar a função <code class=\"language-text\">renderToStaticMarkup</code>, que vai transformar o componente em uma string de HTML. Na real eu nem precisava usar o <code class=\"language-text\">React</code> para esse projeto, mas como tudo começou com eu mexendo com <code class=\"language-text\">React</code> e <code class=\"language-text\">Babel</code>, eu deixei como está.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> React <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> renderToStaticMarkup <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'react-dom/server'</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> <span class=\"token constant\">JSDOM</span> <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'jsdom'</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> readFileSync <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'fs'</span><span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token comment\">// Prism.js</span>\r\n<span class=\"token keyword\">import</span> Prism <span class=\"token keyword\">from</span> <span class=\"token string\">'prismjs'</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">import</span> loadLanguages <span class=\"token keyword\">from</span> <span class=\"token string\">'prismjs/components/'</span><span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token comment\">// My custom React component</span>\r\n<span class=\"token keyword\">import</span> CodeHighlighter <span class=\"token keyword\">from</span> <span class=\"token string\">'./CodeHighlighter.jsx'</span><span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token keyword\">const</span> styling <span class=\"token operator\">=</span> <span class=\"token function\">readFileSync</span><span class=\"token punctuation\">(</span>\r\n    <span class=\"token string\">'./node_modules/prism-themes/themes/prism-material-dark.css'</span><span class=\"token punctuation\">,</span>\r\n    <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">encoding</span><span class=\"token operator\">:</span> <span class=\"token string\">'utf8'</span> <span class=\"token punctuation\">}</span>\r\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">generateHtml</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>\r\n    <span class=\"token parameter\">code<span class=\"token punctuation\">,</span>\r\n    currentLine<span class=\"token punctuation\">,</span>\r\n    totalLines<span class=\"token punctuation\">,</span>\r\n    language</span>\r\n<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token function\">loadLanguages</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>language<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">const</span> codeHtml <span class=\"token operator\">=</span> Prism<span class=\"token punctuation\">.</span><span class=\"token function\">highlight</span><span class=\"token punctuation\">(</span>\r\n        code<span class=\"token punctuation\">,</span>\r\n        Prism<span class=\"token punctuation\">.</span>languages<span class=\"token punctuation\">[</span>language<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\r\n        language\r\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n    <span class=\"token comment\">// get HTML string</span>\r\n    <span class=\"token keyword\">const</span> html <span class=\"token operator\">=</span> <span class=\"token function\">renderToStaticMarkup</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>\r\n        <span class=\"token operator\">&lt;</span>CodeHighlighter\r\n            codeHtml<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>codeHtml<span class=\"token punctuation\">}</span>\r\n            totalLines<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>totalLines<span class=\"token punctuation\">}</span>\r\n            currentLine<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>currentLine<span class=\"token punctuation\">}</span>\r\n        <span class=\"token operator\">/</span><span class=\"token operator\">></span>\r\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n    <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> window <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">JSDOM</span><span class=\"token punctuation\">(</span>html<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> document <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> window<span class=\"token punctuation\">;</span>\r\n\r\n    <span class=\"token comment\">// Add Prism.js styling to the HTML document</span>\r\n    <span class=\"token keyword\">const</span> style <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">createElement</span><span class=\"token punctuation\">(</span><span class=\"token string\">'style'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    style<span class=\"token punctuation\">.</span>textContent <span class=\"token operator\">=</span> styling<span class=\"token punctuation\">;</span>\r\n    document<span class=\"token punctuation\">.</span>head<span class=\"token punctuation\">.</span><span class=\"token function\">appendChild</span><span class=\"token punctuation\">(</span>style<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n    <span class=\"token keyword\">return</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementsByTagName</span><span class=\"token punctuation\">(</span><span class=\"token string\">'html'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>outerHTML<span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Além da variável <code class=\"language-text\">code</code>, a função <code class=\"language-text\">generateHtml</code> também recebe <code class=\"language-text\">currentLine</code> e <code class=\"language-text\">totalLines</code> como parâmetros. A variável <code class=\"language-text\">currentLine</code> será usada para destacar a linha de código atual, e <code class=\"language-text\">totalLines</code> para mostrar os números das linhas à esquerda.</p>\n<h2 id=\"o-componente-em-react\" style=\"position:relative;\"><a href=\"#o-componente-em-react\" aria-label=\"o componente em react permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>O componente em React</h2>\n<p>A implementação básica do <code class=\"language-text\">CodeHighlighter</code> eu simplesmente retornarei uma tag <code class=\"language-text\">code</code> com o atributo <code class=\"language-text\">dangerouslySetInnerHTML</code> definido para o HTML do Prism.js.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> React <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span><span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token keyword\">const</span> <span class=\"token constant\">SCALE</span> <span class=\"token operator\">=</span> <span class=\"token number\">4</span><span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token keyword\">function</span> <span class=\"token function\">CodeHighlighter</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span>\r\n    codeHtml<span class=\"token punctuation\">,</span>\r\n    totalLines<span class=\"token punctuation\">,</span>\r\n    currentLine<span class=\"token punctuation\">,</span>\r\n<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\r\n        <span class=\"token operator\">&lt;</span>html lang<span class=\"token operator\">=</span><span class=\"token string\">\"en\"</span><span class=\"token operator\">></span>\r\n            <span class=\"token operator\">&lt;</span>body\r\n                style<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span>\r\n                    <span class=\"token literal-property property\">width</span><span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token number\">1920</span> <span class=\"token operator\">/</span> <span class=\"token constant\">SCALE</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">px</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\r\n                    <span class=\"token literal-property property\">height</span><span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token number\">1080</span> <span class=\"token operator\">/</span> <span class=\"token constant\">SCALE</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">px</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\r\n                    <span class=\"token literal-property property\">background</span><span class=\"token operator\">:</span> <span class=\"token string\">'#272822'</span><span class=\"token punctuation\">,</span>\r\n                    <span class=\"token literal-property property\">transform</span><span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">scale(</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token constant\">SCALE</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">)</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\r\n                    <span class=\"token literal-property property\">transformOrigin</span><span class=\"token operator\">:</span> <span class=\"token string\">'0% 0% 0px'</span><span class=\"token punctuation\">,</span>\r\n                    <span class=\"token literal-property property\">margin</span><span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span>\r\n                <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\r\n            <span class=\"token operator\">></span>\r\n                <span class=\"token operator\">&lt;</span>div\r\n                    style<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span>\r\n                        <span class=\"token literal-property property\">display</span><span class=\"token operator\">:</span> <span class=\"token string\">'flex'</span><span class=\"token punctuation\">,</span>\r\n                        <span class=\"token literal-property property\">margin</span><span class=\"token operator\">:</span> <span class=\"token string\">'20px 0 0 2px'</span><span class=\"token punctuation\">,</span>\r\n                    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\r\n                <span class=\"token operator\">></span>\r\n                    <span class=\"token operator\">&lt;</span>pre\r\n                        style<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span>\r\n                            <span class=\"token literal-property property\">margin</span><span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span>\r\n                        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\r\n                    <span class=\"token operator\">></span>\r\n                        <span class=\"token operator\">&lt;</span>code\r\n                            style<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span>\r\n                                <span class=\"token literal-property property\">fontFamily</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Consolas,Monaco,'Andale Mono','Ubuntu Mono',monospace\"</span><span class=\"token punctuation\">,</span>\r\n                            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\r\n                            dangerouslySetInnerHTML<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span>\r\n                                <span class=\"token literal-property property\">__html</span><span class=\"token operator\">:</span> codeHtml<span class=\"token punctuation\">,</span>\r\n                            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\r\n                        <span class=\"token operator\">/</span><span class=\"token operator\">></span>\r\n                    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>pre<span class=\"token operator\">></span>\r\n                <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\r\n            <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>body<span class=\"token operator\">></span>\r\n        <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>html<span class=\"token operator\">></span>\r\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span>\r\n\r\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> CodeHighlighter<span class=\"token punctuation\">;</span></code></pre></div>\n<p>O código acima ainda está faltando o destaque da linha de código atual e os números das linhas, para isso usarei a variável <code class=\"language-text\">totalLines</code> para criar os números da linhas, e <code class=\"language-text\">currentLine</code> para criar uma <code class=\"language-text\">div</code> com largura total da página e movê-la para cima ou para baixo com a propriedade <code class=\"language-text\">margem-top</code> do CSS. Verifique o código completo para este componente <a href=\"https://github.com/blopa/code-video-creator/blob/fc6836c497d5dd0a13a00f1f779fd2d482ebc611/src/CodeHighlighter.jsx\" target=\"_blank\" rel=\"noreferrer\">no GitHub</a>.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> React <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span><span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token keyword\">const</span> <span class=\"token constant\">SCALE</span> <span class=\"token operator\">=</span> <span class=\"token number\">4</span><span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token keyword\">function</span> <span class=\"token function\">CodeHighlighter</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span>\r\n    codeHtml<span class=\"token punctuation\">,</span>\r\n    totalLines<span class=\"token punctuation\">,</span>\r\n    currentLine<span class=\"token punctuation\">,</span>\r\n<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token comment\">// add the line numbers</span>\r\n    <span class=\"token keyword\">const</span> lines <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Array</span><span class=\"token punctuation\">(</span>totalLines<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">fill</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">v<span class=\"token punctuation\">,</span> index</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>\r\n        <span class=\"token operator\">&lt;</span>span\r\n            key<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>index<span class=\"token punctuation\">}</span>\r\n            style<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span>\r\n                <span class=\"token literal-property property\">height</span><span class=\"token operator\">:</span> <span class=\"token string\">'16px'</span><span class=\"token punctuation\">,</span>\r\n                <span class=\"token literal-property property\">width</span><span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token number\">8</span> <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span>totalLines<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>length<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">px</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\r\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\r\n        <span class=\"token operator\">></span>\r\n            <span class=\"token punctuation\">{</span>index <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">}</span>\r\n        <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>span<span class=\"token operator\">></span>\r\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\r\n        <span class=\"token operator\">&lt;</span>html lang<span class=\"token operator\">=</span><span class=\"token string\">\"en\"</span><span class=\"token operator\">></span>\r\n            <span class=\"token operator\">&lt;</span>style\r\n                dangerouslySetInnerHTML<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span>\r\n                    <span class=\"token literal-property property\">__html</span><span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">\r\n                    body { color: white; }\r\n                </span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\r\n                <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\r\n            <span class=\"token operator\">/</span><span class=\"token operator\">></span>\r\n            <span class=\"token operator\">&lt;</span>body\r\n                style<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span>\r\n                    <span class=\"token literal-property property\">width</span><span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token number\">1920</span> <span class=\"token operator\">/</span> <span class=\"token constant\">SCALE</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">px</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\r\n                    <span class=\"token literal-property property\">height</span><span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token number\">1080</span> <span class=\"token operator\">/</span> <span class=\"token constant\">SCALE</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">px</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\r\n                    <span class=\"token literal-property property\">background</span><span class=\"token operator\">:</span> <span class=\"token string\">'#272822'</span><span class=\"token punctuation\">,</span>\r\n                    <span class=\"token literal-property property\">transform</span><span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">scale(</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token constant\">SCALE</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">)</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\r\n                    <span class=\"token literal-property property\">transformOrigin</span><span class=\"token operator\">:</span> <span class=\"token string\">'0% 0% 0px'</span><span class=\"token punctuation\">,</span>\r\n                    <span class=\"token literal-property property\">margin</span><span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span>\r\n                <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\r\n            <span class=\"token operator\">></span>\r\n                <span class=\"token operator\">&lt;</span>div\r\n                    style<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span>\r\n                        <span class=\"token literal-property property\">display</span><span class=\"token operator\">:</span> <span class=\"token string\">'flex'</span><span class=\"token punctuation\">,</span>\r\n                        <span class=\"token literal-property property\">margin</span><span class=\"token operator\">:</span> <span class=\"token string\">'20px 0 0 2px'</span><span class=\"token punctuation\">,</span>\r\n                    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\r\n                <span class=\"token operator\">></span>\r\n                    <span class=\"token operator\">&lt;</span>div\r\n                        style<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span>\r\n                            <span class=\"token literal-property property\">width</span><span class=\"token operator\">:</span> <span class=\"token string\">'100%'</span><span class=\"token punctuation\">,</span>\r\n                            <span class=\"token literal-property property\">position</span><span class=\"token operator\">:</span> <span class=\"token string\">'absolute'</span><span class=\"token punctuation\">,</span>\r\n                            <span class=\"token literal-property property\">height</span><span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token number\">4</span> <span class=\"token operator\">*</span> <span class=\"token constant\">SCALE</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">px</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\r\n                            <span class=\"token literal-property property\">backgroundColor</span><span class=\"token operator\">:</span> <span class=\"token string\">'#44463a'</span><span class=\"token punctuation\">,</span>\r\n                            <span class=\"token literal-property property\">zIndex</span><span class=\"token operator\">:</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span>\r\n                            <span class=\"token literal-property property\">marginTop</span><span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token number\">16</span> <span class=\"token operator\">*</span> currentLine<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">px</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\r\n                        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\r\n                    <span class=\"token operator\">/</span><span class=\"token operator\">></span>\r\n                    <span class=\"token operator\">&lt;</span>div\r\n                        style<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span>\r\n                            <span class=\"token literal-property property\">display</span><span class=\"token operator\">:</span> <span class=\"token string\">'grid'</span><span class=\"token punctuation\">,</span>\r\n                            <span class=\"token literal-property property\">margin</span><span class=\"token operator\">:</span> <span class=\"token string\">'0 5px 0 2px'</span><span class=\"token punctuation\">,</span>\r\n                            <span class=\"token literal-property property\">color</span><span class=\"token operator\">:</span> <span class=\"token string\">'#DD6'</span><span class=\"token punctuation\">,</span>\r\n                        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\r\n                    <span class=\"token operator\">></span>\r\n                        <span class=\"token punctuation\">{</span>lines<span class=\"token punctuation\">}</span>\r\n                    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\r\n                    <span class=\"token operator\">&lt;</span>pre\r\n                        style<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span>\r\n                            <span class=\"token literal-property property\">margin</span><span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span>\r\n                        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\r\n                    <span class=\"token operator\">></span>\r\n                        <span class=\"token operator\">&lt;</span>code\r\n                            style<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span>\r\n                                <span class=\"token literal-property property\">fontFamily</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Consolas,Monaco,'Andale Mono','Ubuntu Mono',monospace\"</span><span class=\"token punctuation\">,</span>\r\n                            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\r\n                            dangerouslySetInnerHTML<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span>\r\n                                <span class=\"token literal-property property\">__html</span><span class=\"token operator\">:</span> codeHtml<span class=\"token punctuation\">,</span>\r\n                            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\r\n                        <span class=\"token operator\">/</span><span class=\"token operator\">></span>\r\n                    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>pre<span class=\"token operator\">></span>\r\n                <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\r\n            <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>body<span class=\"token operator\">></span>\r\n        <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>html<span class=\"token operator\">></span>\r\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span>\r\n\r\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> CodeHighlighter<span class=\"token punctuation\">;</span></code></pre></div>\n<p>Agora eu posso pegar a string desse HTML, com toda a sintaxe de código colorida e números de linhas, e colocar como o HTML do headless browser pelo Puppeteer.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> page <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> browser<span class=\"token punctuation\">.</span><span class=\"token function\">newPage</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token keyword\">const</span> html <span class=\"token operator\">=</span> <span class=\"token function\">generateHtml</span><span class=\"token punctuation\">(</span>\r\n    code<span class=\"token punctuation\">,</span>\r\n    <span class=\"token number\">0</span><span class=\"token punctuation\">,</span>\r\n    lines<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">,</span>\r\n    <span class=\"token string\">'javascript'</span>\r\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token keyword\">await</span> page<span class=\"token punctuation\">.</span><span class=\"token function\">setContent</span><span class=\"token punctuation\">(</span>html<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h2 id=\"mostrando-o-codigo-linha-por-linha\" style=\"position:relative;\"><a href=\"#mostrando-o-codigo-linha-por-linha\" aria-label=\"mostrando o codigo linha por linha permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Mostrando o código linha por linha</h2>\n<p>Por enquanto, estou colocando todo o código no componente <code class=\"language-text\">React</code> de uma vez só, mas idealmente, o código deve ser mostrado linha por linha, e para isso irei percorrer a array de linhas e, em seguida, adicionar linha por linha a uma nova array e passá-la para a função <code class=\"language-text\">generateHtml</code>.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> page <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> browser<span class=\"token punctuation\">.</span><span class=\"token function\">newPage</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token keyword\">let</span> index <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">let</span> codeToParse <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">const</span> scrollThreshold <span class=\"token operator\">=</span> <span class=\"token number\">9</span><span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">const</span> line <span class=\"token keyword\">of</span> lines<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    codeToParse<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span>line<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n    <span class=\"token keyword\">const</span> html <span class=\"token operator\">=</span> <span class=\"token function\">generateHtml</span><span class=\"token punctuation\">(</span>\r\n        codeToParse<span class=\"token punctuation\">.</span><span class=\"token function\">join</span><span class=\"token punctuation\">(</span><span class=\"token string\">'\\n'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\r\n        index<span class=\"token punctuation\">,</span>\r\n        lines<span class=\"token punctuation\">.</span>length <span class=\"token operator\">+</span> scrollThreshold<span class=\"token punctuation\">,</span>\r\n        language\r\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n    <span class=\"token keyword\">await</span> page<span class=\"token punctuation\">.</span><span class=\"token function\">setContent</span><span class=\"token punctuation\">(</span>html<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n    <span class=\"token keyword\">await</span> page<span class=\"token punctuation\">.</span><span class=\"token function\">waitForTimeout</span><span class=\"token punctuation\">(</span><span class=\"token number\">1000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    index <span class=\"token operator\">+=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span>\r\n\r\n<span class=\"token keyword\">await</span> browser<span class=\"token punctuation\">.</span><span class=\"token function\">close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Isso funciona, mas o problema é que se o código for muito longo, o browser precisa rolar para baixo para seguir as novas linhas, e para isso eu preciso usar a variável <code class=\"language-text\">index</code> do meu loop para acompanhar a linha atual e usar a função <code class=\"language-text\">page.evaluate()</code> do Puppeteer para rolar a página para baixo usando a função <code class=\"language-text\">window.scrollTo()</code>.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> page <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> browser<span class=\"token punctuation\">.</span><span class=\"token function\">newPage</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token keyword\">let</span> index <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">let</span> prevPosY <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">const</span> basePosY <span class=\"token operator\">=</span> <span class=\"token number\">7</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">let</span> codeToParse <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">const</span> scrollThreshold <span class=\"token operator\">=</span> <span class=\"token number\">8</span><span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">const</span> line <span class=\"token keyword\">of</span> lines<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    codeToParse<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span>line<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n    <span class=\"token comment\">// get full page HTML</span>\r\n    <span class=\"token keyword\">const</span> html <span class=\"token operator\">=</span> <span class=\"token function\">generateHtml</span><span class=\"token punctuation\">(</span>\r\n        codeToParse<span class=\"token punctuation\">.</span><span class=\"token function\">join</span><span class=\"token punctuation\">(</span><span class=\"token string\">'\\n'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\r\n        index<span class=\"token punctuation\">,</span>\r\n        lines<span class=\"token punctuation\">.</span>length <span class=\"token operator\">+</span> scrollThreshold<span class=\"token punctuation\">,</span>\r\n        language\r\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n    <span class=\"token comment\">// set page HTML</span>\r\n    <span class=\"token keyword\">await</span> page<span class=\"token punctuation\">.</span><span class=\"token function\">setContent</span><span class=\"token punctuation\">(</span>html<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n    <span class=\"token keyword\">const</span> diff <span class=\"token operator\">=</span> index <span class=\"token operator\">-</span> scrollThreshold<span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">const</span> posY <span class=\"token operator\">=</span> Math<span class=\"token punctuation\">.</span><span class=\"token function\">max</span><span class=\"token punctuation\">(</span>\r\n        <span class=\"token punctuation\">(</span>basePosY <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span><span class=\"token number\">16</span> <span class=\"token operator\">*</span> diff<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token constant\">SCALE</span><span class=\"token punctuation\">,</span>\r\n        <span class=\"token number\">0</span>\r\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n    <span class=\"token comment\">// scroll down or up if needed</span>\r\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>prevPosY <span class=\"token operator\">!==</span> posY<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token keyword\">await</span> page<span class=\"token punctuation\">.</span><span class=\"token function\">evaluate</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">posY</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n            window<span class=\"token punctuation\">.</span><span class=\"token function\">scrollTo</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\r\n                <span class=\"token literal-property property\">top</span><span class=\"token operator\">:</span> posY<span class=\"token punctuation\">,</span>\r\n                <span class=\"token literal-property property\">behavior</span><span class=\"token operator\">:</span> <span class=\"token string\">'smooth'</span><span class=\"token punctuation\">,</span>\r\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> posY<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span>\r\n\r\n    <span class=\"token keyword\">await</span> page<span class=\"token punctuation\">.</span><span class=\"token function\">waitForTimeout</span><span class=\"token punctuation\">(</span><span class=\"token number\">1000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    prevPosY <span class=\"token operator\">=</span> posY<span class=\"token punctuation\">;</span>\r\n    index <span class=\"token operator\">+=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span>\r\n\r\n<span class=\"token keyword\">await</span> browser<span class=\"token punctuation\">.</span><span class=\"token function\">close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h2 id=\"conclusao\" style=\"position:relative;\"><a href=\"#conclusao\" aria-label=\"conclusao permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Conclusão</h2>\n<p>Você pode acessar o código completo desta postagem do blog no meu repositório GitHub na hash <a href=\"https://github.com/blopa/code-video-creator/tree/d595cf30cec13021fb857f9acb83a853e26610d7\" target=\"_blank\" rel=\"noreferrer\">d595cf30cec13021fb857f9acb83a853e26610d7</a> do <code class=\"language-text\">git</code>.</p>\n<p>O projeto começou com o código desse post, mas agora cresceu um pouco mais, e o código atual no branch <code class=\"language-text\">main</code> do repositório tem um efeito de digitação para cada letra, que faz o vídeo ficar bem mais maneiro. Sinta-se à vontade para mergulhar no código fonte na página do projeto <a href=\"https://github.com/blopa/code-video-creator/\" target=\"_blank\" rel=\"noreferrer\">code-video-creator</a>.</p>\n<p><img src=\"/7b9e49e1375d50b5c5e0ca29e78a0a62/code-to-video-v2.gif\" alt=\"\"></p>\n<p>Espero que esse post tenha sido útil para você. Deixe um comentário se tiver alguma dúvida e até a próxima!</p>","fields":{"postHashId":"Y29kaW5ndHJ1ZW51bGwyMDIyLTAxLTA0VDAwOjAwOjAwLjAwMFo=","slug":"/2022/2022-01-04-crie-videos-dos-seus-codigos-de-programacao-com-esse-script-de-nodejs.pt-br/","path":"/blog/coding/crie-videos-dos-seus-codigos-de-programacao-com-esse-script-de-nodejs/","locale":"pt-br"},"frontmatter":{"tags":["node","nodejs","javascript","código","programação","puppeteer"],"categories":["coding"],"allowComments":true,"publishOnMedium":false,"cover":null,"date":"2022-01-04T00:00:00.000Z","id":null,"path":"crie-videos-dos-seus-codigos-de-programacao-com-esse-script-de-nodejs","show":true,"title":"Crie videos dos seus códigos de programação com esse script de Node.js","hideExcerpt":false,"subtitle":""}}},{"node":{"html":"<p>Criar mapas com o Tiled é ótimo e da pra usá-los em praticamente qualquer game engine, incluindo a minha favorita, Phaser JS 😊</p>\n<p>Para carregar um mapa com Phaser JS é bem simples, primeiro, você carrega todos os arquivos na função <code class=\"language-text\">preload</code>, depois cria um novo mapa com a função <code class=\"language-text\">this.make.tilemap()</code> e pronto. Veja abaixo um <a href=\"https://blog.ourcade.co/posts/2020/phaser-3-noob-guide-loading-tiled-tilemaps/\" target=\"_blank\" rel=\"noreferrer\">snippet de código do blog Ourcade</a>:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token function\">preload</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token punctuation\">{</span>\r\n    <span class=\"token comment\">// load the PNG file</span>\r\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>load<span class=\"token punctuation\">.</span><span class=\"token function\">image</span><span class=\"token punctuation\">(</span><span class=\"token string\">'base_tiles'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'assets/base_tiles.png'</span><span class=\"token punctuation\">)</span>\r\n    <span class=\"token comment\">// load the JSON file</span>\r\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>load<span class=\"token punctuation\">.</span><span class=\"token function\">tilemapTiledJSON</span><span class=\"token punctuation\">(</span><span class=\"token string\">'tilemap'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'assets/base_tiles.json'</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token punctuation\">}</span>\r\n\r\n<span class=\"token function\">create</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token punctuation\">{</span>\r\n    <span class=\"token comment\">// create the Tilemap</span>\r\n    <span class=\"token keyword\">const</span> map <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>make<span class=\"token punctuation\">.</span><span class=\"token function\">tilemap</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">key</span><span class=\"token operator\">:</span> <span class=\"token string\">'tilemap'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\r\n    <span class=\"token comment\">// add the tileset image we are using</span>\r\n    <span class=\"token keyword\">const</span> tileset <span class=\"token operator\">=</span> map<span class=\"token punctuation\">.</span><span class=\"token function\">addTilesetImage</span><span class=\"token punctuation\">(</span><span class=\"token string\">'standard_tiles'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'base_tiles'</span><span class=\"token punctuation\">)</span>\r\n    <span class=\"token comment\">// create the layers we want in the right order</span>\r\n    map<span class=\"token punctuation\">.</span><span class=\"token function\">createStaticLayer</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Background'</span><span class=\"token punctuation\">,</span> tileset<span class=\"token punctuation\">)</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Mas, infelizmente, nem tudo é perfeito, pois, para que isso funcione, você precisa que o seu <code class=\"language-text\">tileset</code> esteja embutido no mapa do Tiled.</p>\n<p><figure class=\"gatsby-resp-image-figure\" style=\"\">\n    <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 518px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 59.375%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAIAAADtbgqsAAAACXBIWXMAAAsTAAALEwEAmpwYAAACV0lEQVQoz3XRy1LTUBgH8Ox9CDc+gT6AOo6Wneg449ChilZALr2ALRSQS9PQc07SJg0pEQqdkgOlleKQQG6YtqFNW+oiFRe8j1NW4uhv5vt2/5nvQmCMFUWWZdmyLMM0DU3XdePcsgzDMHRdPTszTUNVNcuy6jdqtZpt247jmKZJbOd2kiRcXFhhWEYQhASXTiOQZRlxUxS3tnlBzO3s8jy/J0mlUunw8LBYLH49OjpVFFVVCSG5NjjgffbkxcCAJzwbvf/Wu7C8NDUxuRQJJj9H1hdnUGIVIRqCWyiKSqVSxBcazHmHJsfCXp/fM/bhzt17nvHRBw+fvvYO5Tf59aVPDLmAEE336xYIIZETC8vv38Wia2yS+TgfGfGN+AMB//hEKBzOCxkGMggk0b/0w3t5PDw8PujxHucPspkM4rM0l43GSAhRAsANkU0C8N+whA98I1Oh4DyJUiwDDRA4oabJNy+5lYgQC+apEMfSN1P/DQBA7ONiKrErcVyZIemZ6bNZT4MabkK/nIqmqVW4GJsbCwEqyTDMnwsjhDiO64fng+z6WjqT5Z8/eux7NVQCscrqqA4CACFIM3OTsxSZgPDWvePxeC6XIyqVb7tbhdzOsWnVEKAFNlMpSvuF/MFeHmOp/9lyCWMs3cAYFwoFjHG5XFYUhahWq67r9Ez1Z02/apx3tRNbOW12Oo7TdlpO02m1Wu1Op9Ptdi/7+r3nutfX167rEhe2XbWb7Q3+RxZeinSDjrdK5brj2PV648I2rMap9t3QtWbTabf6rn5d9Xo9TVNlWf4Nd4mgdymyqM4AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Embed Tileset\"\n        title=\"Embedding a tileset on Tiled\"\n        src=\"/static/51df513f0b0acbe195eb3327398273b4/2f227/tiled-embed-tileset.png\"\n        srcset=\"/static/51df513f0b0acbe195eb3327398273b4/e3135/tiled-embed-tileset.png 256w,\n/static/51df513f0b0acbe195eb3327398273b4/06341/tiled-embed-tileset.png 512w,\n/static/51df513f0b0acbe195eb3327398273b4/2f227/tiled-embed-tileset.png 518w\"\n        sizes=\"(max-width: 518px) 100vw, 518px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\">Embedding a tileset on Tiled</figcaption>\n  </figure></p>\n<p>O problema com isso é que quando você tem muitos mapas, cada um deles terá sua própria versão do <code class=\"language-text\">tileset</code>, então caso qualquer alteração seja feita em um deles, todos os outros mapas ficarão desatualizados.</p>\n<p>Na verdade, eu já meio que falei sobre isso neste blog há <a href=\"/pt-br/blog/games/importando-arquivo-de-tileset-externo-no-phaser-js-com-webpack-skate-platformer-game-devlog-7/\">um ano atrás, no meu Game Devlog #7</a>, mas essa solução foi embutir programaticamente um <code class=\"language-text\">tileset</code> externo em um mapa do Tiled, hoje eu vou pegar um <code class=\"language-text\">tileset</code> que já está embutido em um mapa e copiá-lo para todos os meus outros mapas, vamos ver como.</p>\n<h2 id=\"o-codigo\" style=\"position:relative;\"><a href=\"#o-codigo\" aria-label=\"o codigo permalink\" class=\"post-headers-link before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>O código</h2>\n<p>Meu script recebera um parâmetro com o nome do mapa de onde o <code class=\"language-text\">tileset</code> precisa ser copiado, e o objetivo é executar o script usando <code class=\"language-text\">node copy-tileset-data.js nomeDoArquivoDoMapa</code>.</p>\n<p>Primeiro, vou importar todas as funções necessárias do package <code class=\"language-text\">fs</code> e declarar o meu diretório de mapas com <code class=\"language-text\">path.resolve</code>:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> readdirSync<span class=\"token punctuation\">,</span> readFileSync<span class=\"token punctuation\">,</span> writeFileSync <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'fs'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">const</span> path <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'path'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token keyword\">const</span> <span class=\"token constant\">TILESETS_PATH</span> <span class=\"token operator\">=</span> path<span class=\"token punctuation\">.</span><span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span>\r\n    __dirname<span class=\"token punctuation\">,</span>\r\n    <span class=\"token string\">'..'</span><span class=\"token punctuation\">,</span>\r\n    <span class=\"token string\">'content'</span><span class=\"token punctuation\">,</span>\r\n    <span class=\"token string\">'assets'</span><span class=\"token punctuation\">,</span>\r\n    <span class=\"token string\">'sprites'</span><span class=\"token punctuation\">,</span>\r\n    <span class=\"token string\">'maps'</span>\r\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token comment\">// Call the function with the script parameter</span>\r\n<span class=\"token function\">copyTilesetData</span><span class=\"token punctuation\">(</span>process<span class=\"token punctuation\">.</span>argv<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token keyword\">async</span> <span class=\"token keyword\">function</span> <span class=\"token function\">copyTilesetData</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">tilesetName <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token comment\">// TODO</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Agora, para a função <code class=\"language-text\">copyTilesetData</code>, vou percorrer todas as minhas pastas de mapas (<code class=\"language-text\">maps_dir_1</code>, <code class=\"language-text\">maps_dir_2</code>, etc) e procurar o mapa com o <code class=\"language-text\">tileset</code> que quero, e quando achar, vou carregar o arquivo <code class=\"language-text\">JSON</code> com a função <code class=\"language-text\">readFileSync</code> e salvar o atributo <code class=\"language-text\">tilesets</code> em uma variável local para usar mais tarde.</p>\n<p>Em seguida farei um loop nos outros mapas para carregar o <code class=\"language-text\">tileset</code> que salvei antes neles, e em seguida, salvar essas alterações nos arquivos com o <code class=\"language-text\">writeFileSync</code>.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">async</span> <span class=\"token keyword\">function</span> <span class=\"token function\">copyTilesetData</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">tilesetName <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>tilesetName<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n        console<span class=\"token punctuation\">.</span><span class=\"token function\">error</span><span class=\"token punctuation\">(</span><span class=\"token string\">'No Tileset passed'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span>\r\n\r\n    <span class=\"token keyword\">const</span> allFiles <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">let</span> sourceTilesetData <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token comment\">// eslint-disable-next-line no-restricted-syntax</span>\r\n    <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">const</span> tilesetPath <span class=\"token keyword\">of</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'maps_dir_1'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'maps_dir_2'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token keyword\">const</span> filePath <span class=\"token operator\">=</span> path<span class=\"token punctuation\">.</span><span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span><span class=\"token constant\">TILESETS_PATH</span><span class=\"token punctuation\">,</span> tilesetPath<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token comment\">// eslint-disable-next-line no-await-in-loop</span>\r\n        <span class=\"token keyword\">const</span> spritesFiles <span class=\"token operator\">=</span> <span class=\"token function\">readdirSync</span><span class=\"token punctuation\">(</span>filePath<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token comment\">// eslint-disable-next-line no-restricted-syntax</span>\r\n        <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">const</span> spritesFile <span class=\"token keyword\">of</span> spritesFiles<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>spritesFile <span class=\"token operator\">===</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>tilesetName<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">.json</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n                <span class=\"token comment\">// eslint-disable-next-line no-await-in-loop</span>\r\n                <span class=\"token keyword\">const</span> jsonData <span class=\"token operator\">=</span> <span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">parse</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">await</span> <span class=\"token function\">readFileSync</span><span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">.</span><span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span>filePath<span class=\"token punctuation\">,</span> spritesFile<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n                sourceTilesetData <span class=\"token operator\">=</span> jsonData<span class=\"token punctuation\">.</span>tilesets<span class=\"token punctuation\">;</span>\r\n            <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\r\n                allFiles<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">.</span><span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span>filePath<span class=\"token punctuation\">,</span> spritesFile<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n            <span class=\"token punctuation\">}</span>\r\n        <span class=\"token punctuation\">}</span>\r\n    <span class=\"token punctuation\">}</span>\r\n\r\n    <span class=\"token comment\">// eslint-disable-next-line no-restricted-syntax</span>\r\n    <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">const</span> jsonFile <span class=\"token keyword\">of</span> allFiles<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token comment\">// eslint-disable-next-line no-await-in-loop</span>\r\n        <span class=\"token keyword\">const</span> jsonData <span class=\"token operator\">=</span> <span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">parse</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">await</span> <span class=\"token function\">readFileSync</span><span class=\"token punctuation\">(</span>\r\n            jsonFile\r\n        <span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n        jsonData<span class=\"token punctuation\">.</span>tilesets <span class=\"token operator\">=</span> sourceTilesetData<span class=\"token punctuation\">;</span>\r\n\r\n        <span class=\"token comment\">// eslint-disable-next-line no-await-in-loop</span>\r\n        <span class=\"token keyword\">await</span> <span class=\"token function\">writeFileSync</span><span class=\"token punctuation\">(</span>\r\n            jsonFile<span class=\"token punctuation\">,</span>\r\n            <span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">stringify</span><span class=\"token punctuation\">(</span>jsonData<span class=\"token punctuation\">,</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span>\r\n        <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>E é isso! Espero que este script ajude bastante você do mesmo jeito que me ajuda. Até a próxima galera!</p>","fields":{"postHashId":"Z2FtZXN0cnVlbnVsbDIwMjEtMTAtMDJUMDA6MDA6MDAuMDAwWg==","slug":"/2021/2021-10-02-atualize-automaticamente-o-tileset-embutido-do-seu-mapa-no-tiled-com-um-script-nodejs.pt-br/","path":"/blog/games/atualize-automaticamente-o-tileset-embutido-do-seu-mapa-no-tiled-com-um-script-nodejs/","locale":"pt-br"},"frontmatter":{"tags":["programação","jogos","javascript","phaser","phaser 3","nodejs","node","tiled","mapa","tilemap","tileset"],"categories":["games"],"allowComments":true,"publishOnMedium":null,"cover":null,"date":"2021-10-02T00:00:00.000Z","id":null,"path":"atualize-automaticamente-o-tileset-embutido-do-seu-mapa-no-tiled-com-um-script-nodejs","show":true,"title":"Atualize automaticamente o Tileset embutido do seu mapa no Tiled com um script Node.js.","hideExcerpt":null,"subtitle":null}}},{"node":{"html":"<p><a href=\"/pt-br/blog/games/segundo-game-devlog-do-skate-platformer/\">Em um de meus primeiros devlogs do jogo Super Ollie</a>, eu expliquei como automatizar a geração de sprite sheets para o Phaser 3 usando Webpack, mas acho que seria mais útil se eu tivesse um script externo para fazer isso, para que qualquer pessoa pudesse usá-lo.</p>\n<p>Mas porque não simplesmente usar um daqueles sites que combinam arquivos <code class=\"language-text\">PNG</code> em um sprite sheet? Bem, porque o Phaser não precisa apenas do sprite sheet em <code class=\"language-text\">PNG</code>, mas também de um arquivo atlas em <code class=\"language-text\">JSON</code> com todos os detalhes do sprite sheet, como o nome do frame e as dimensões da imagem.</p>\n<p><figure class=\"gatsby-resp-image-figure\" style=\"\">\n    <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 658px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 42.1875%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAAsTAAALEwEAmpwYAAABZElEQVQY011RS0/qUBD2p7sxcePKhQv/ghoFvNH4SIyJIkrKJfcqURQoWEopfdD2nJ5zOvOZWkzUbzUzyffKrAHIjFrIFIAiUw7M+Ab+XPnnscIagJY72O1eAXgMnB3rkogKKsCYZvHJ8F+YZ2f2YyxKdf5SUUoRUUlue8O9/gOI32L/oN/WxlTClmdv3h1bnr1+c/i2cAEYU5iiMMasyMw8n8+d8XuapFEQ2oORlLLZvN3f258bcT55GqdBfdidRAsAuVJPvV4mhNZ65RzI9O90BCBR0nIGAJrN29pRLSZde+2Mk+Dgpb3MythCyHq9sUyWxpiiIt97o+3OBRjP8WyrfZobXcX+v3A2W3+up/2NVmMYzAAQ0+/OPf+98WJpradJeNzvyDwnIjDcNDoZdJ9952rc85MIxEopledaayHEqnMUhO7EkTJP4qVjT6QQ1Y8AyEyEnk9FacjMUsiZOxNCVv4fvWi9umk4FTEAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Sprites feito por kenney.nl\"\n        title=\"Sprites feito por kenney.nl\"\n        src=\"/static/8a32f26bd9206da785dc3795034528f5/e7930/hero-sprite-sheet.png\"\n        srcset=\"/static/8a32f26bd9206da785dc3795034528f5/e3135/hero-sprite-sheet.png 256w,\n/static/8a32f26bd9206da785dc3795034528f5/06341/hero-sprite-sheet.png 512w,\n/static/8a32f26bd9206da785dc3795034528f5/e7930/hero-sprite-sheet.png 658w\"\n        sizes=\"(max-width: 658px) 100vw, 658px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\">Sprites feito por kenney.nl</figcaption>\n  </figure></p>\n<p>Para isso, vou usar o package <a href=\"https://www.npmjs.com/package/free-tex-packer-core\" target=\"_blank\" rel=\"noreferrer\">free-tex-packer-core</a> feito pelo <a href=\"https://github.com/odrick\" target=\"_blank\" rel=\"noreferrer\">odrick</a>. O uso básico em sua documentação é o seguinte:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> packAsync <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'free-tex-packer-core'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token keyword\">const</span> images <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>\r\n    <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">path</span><span class=\"token operator\">:</span> <span class=\"token string\">\"img1.png\"</span><span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">contents</span><span class=\"token operator\">:</span> fs<span class=\"token punctuation\">.</span><span class=\"token function\">readFileSync</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"./img1.png\"</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\r\n    <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">path</span><span class=\"token operator\">:</span> <span class=\"token string\">\"img2.png\"</span><span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">contents</span><span class=\"token operator\">:</span> fs<span class=\"token punctuation\">.</span><span class=\"token function\">readFileSync</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"./img2.png\"</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\r\n    <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">path</span><span class=\"token operator\">:</span> <span class=\"token string\">\"img3.png\"</span><span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">contents</span><span class=\"token operator\">:</span> fs<span class=\"token punctuation\">.</span><span class=\"token function\">readFileSync</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"./img3.png\"</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">}</span>\r\n<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token keyword\">const</span> options <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">allowRotation</span><span class=\"token operator\">:</span> <span class=\"token boolean\">false</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token keyword\">async</span> <span class=\"token keyword\">function</span> <span class=\"token function\">packImages</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token keyword\">const</span> files <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">packAsync</span><span class=\"token punctuation\">(</span>images<span class=\"token punctuation\">,</span> options<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">let</span> item <span class=\"token keyword\">of</span> files<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n            console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>item<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">,</span> item<span class=\"token punctuation\">.</span>buffer<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token punctuation\">}</span>\r\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n        console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Isso por si só já é super útil, mas eu quero melhorar isso e gerar sprite sheets para todos os meus sprites, e a estrutura como tenho meus arquivos e pastas é:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">- original-files\r\n  - sprites\r\n    - hero\r\n      - hero_walking_1.png\r\n      - hero_walking_2.png\r\n      - hero_walking_3.png\r\n      - hero_jumping_1.png\r\n      - hero_jumping_2.png\r\n    - enemy\r\n      - enemy_walking_1.png\r\n      - enemy_walking_2.png</code></pre></div>\n<p>Com essa estrutura de diretórios, eu posso ter o seguinte script que percorrerá todos os diretórios no meu diretório de sprites e pegará as imagens dentro de cada um deles:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> packAsync <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'free-tex-packer-core'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">const</span> path <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'path'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> readFileSync<span class=\"token punctuation\">,</span> readdirSync<span class=\"token punctuation\">,</span> writeFileSync <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'fs'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token keyword\">const</span> <span class=\"token constant\">SOURCE_SPRITES_PATH</span> <span class=\"token operator\">=</span> path<span class=\"token punctuation\">.</span><span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span>__dirname<span class=\"token punctuation\">,</span> <span class=\"token string\">'original-files'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'sprites'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">const</span> <span class=\"token constant\">SPRITES_PATH</span> <span class=\"token operator\">=</span> path<span class=\"token punctuation\">.</span><span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span>__dirname<span class=\"token punctuation\">,</span> <span class=\"token string\">'assets'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'sprites'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token keyword\">async</span> <span class=\"token keyword\">function</span> <span class=\"token function\">generateAtlasFiles</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">assetName</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">let</span> spritesFolders<span class=\"token punctuation\">;</span>\r\n\r\n    <span class=\"token comment\">// use the parameter or get all folders from a directory</span>\r\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>assetName<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n        spritesFolders <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>assetName<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\r\n        spritesFolders <span class=\"token operator\">=</span> <span class=\"token function\">readdirSync</span><span class=\"token punctuation\">(</span><span class=\"token constant\">SOURCE_SPRITES_PATH</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span>\r\n\r\n    <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">const</span> spritesFolder <span class=\"token keyword\">of</span> spritesFolders<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token keyword\">const</span> spritesFiles <span class=\"token operator\">=</span> <span class=\"token function\">readdirSync</span><span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">.</span><span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span>__dirname<span class=\"token punctuation\">,</span> <span class=\"token constant\">SOURCE_SPRITES_PATH</span><span class=\"token punctuation\">,</span> spritesFolder<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token keyword\">const</span> images <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\r\n        spritesFiles<span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">spritesFile</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n            images<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\r\n                <span class=\"token literal-property property\">path</span><span class=\"token operator\">:</span> spritesFile<span class=\"token punctuation\">,</span>\r\n                <span class=\"token literal-property property\">contents</span><span class=\"token operator\">:</span> <span class=\"token function\">readFileSync</span><span class=\"token punctuation\">(</span>\r\n                    path<span class=\"token punctuation\">.</span><span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span>__dirname<span class=\"token punctuation\">,</span> <span class=\"token constant\">SOURCE_SPRITES_PATH</span><span class=\"token punctuation\">,</span> spritesFolder<span class=\"token punctuation\">,</span> spritesFile<span class=\"token punctuation\">)</span>\r\n                <span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\r\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n        <span class=\"token keyword\">await</span> <span class=\"token function\">packImages</span><span class=\"token punctuation\">(</span>images<span class=\"token punctuation\">,</span> spritesFolder<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span>\r\n<span class=\"token punctuation\">}</span>\r\n\r\n<span class=\"token keyword\">async</span> <span class=\"token keyword\">function</span> <span class=\"token function\">packImages</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">images<span class=\"token punctuation\">,</span> spriteName</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token keyword\">const</span> files <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">packAsync</span><span class=\"token punctuation\">(</span>images<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">allowRotation</span><span class=\"token operator\">:</span> <span class=\"token boolean\">false</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n        <span class=\"token comment\">// let's save the png and json files</span>\r\n        <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">const</span> item <span class=\"token keyword\">of</span> files<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n            <span class=\"token comment\">// get the file extension</span>\r\n            <span class=\"token keyword\">const</span> fileExt <span class=\"token operator\">=</span> item<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">.</span><span class=\"token function\">split</span><span class=\"token punctuation\">(</span><span class=\"token string\">'.'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">at</span><span class=\"token punctuation\">(</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n            <span class=\"token comment\">// save the file in the sprites directory</span>\r\n            <span class=\"token keyword\">await</span> <span class=\"token function\">writeFileSync</span><span class=\"token punctuation\">(</span>\r\n                path<span class=\"token punctuation\">.</span><span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span>__dirname<span class=\"token punctuation\">,</span> <span class=\"token constant\">SPRITES_PATH</span><span class=\"token punctuation\">,</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>spriteName<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">.</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>fileExt<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\r\n                item<span class=\"token punctuation\">.</span>buffer\r\n            <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token punctuation\">}</span>\r\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n        console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span>\r\n<span class=\"token punctuation\">}</span>\r\n\r\n<span class=\"token comment\">// process.argv[2] is the argument from the command when you run `node script.js arg`</span>\r\n<span class=\"token function\">generateAtlasFiles</span><span class=\"token punctuation\">(</span>process<span class=\"token punctuation\">.</span>argv<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Este script irá criar os arquivos <code class=\"language-text\">my-sprite.png</code> e <code class=\"language-text\">my-sprite.json</code> para cada um de seus sprites em sua pasta de sprites ao executar <code class=\"language-text\">node generate-sprites.js</code>, ou <code class=\"language-text\">node generate-sprites.js hero</code> para gerar sprites sheets para apenas um sprite, neste caso o sprite <code class=\"language-text\">hero</code>.</p>\n<p>Espero que esse post tenha sido útil para você, até a próxima.</p>","fields":{"postHashId":"Z2FtZXN0cnVlbnVsbDIwMjEtMDYtMjJUMDA6MDA6MDAuMDAwWg==","slug":"/2021/2021-06-22-como-gerar-sprite-sheets-automaticamente-para-o-seu-jogo-feito-com-phaser-js.pt-br/","path":"/blog/games/como-gerar-sprite-sheets-automaticamente-para-o-seu-jogo-feito-com-phaser-js/","locale":"pt-br"},"frontmatter":{"tags":["programação","jogos","javascript","phaser","phaser 3","nodejs","node","atlas","sprite sheet"],"categories":["games"],"allowComments":true,"publishOnMedium":null,"cover":null,"date":"2021-06-22T00:00:00.000Z","id":null,"path":"como-gerar-sprite-sheets-automaticamente-para-o-seu-jogo-feito-com-phaser-js","show":true,"title":"Como gerar sprite sheets automaticamente para o seu jogo feito com Phaser JS","hideExcerpt":null,"subtitle":null}}},{"node":{"html":"<p>Ora ora ora, esse Telegram tá que tá, eim? Menos de 7 dias depois de <a href=\"/pt-br/blog/general/tinha-que-ser-o-whatsapp-de-novo/\">não conseguir restaurar o backup das minhas mensagens no Whatsapp</a>, o Telegram anunciou que agora você pode <a href=\"https://telegram.org/blog/move-history/pt-br\" target=\"_blank\" rel=\"noreferrer\">importar mensagens de outros aplicativos de chat</a>. Tinha que ser o Telegram denovo, não é mesmo? Como o Telegram consegue ser tão foda? Desde a última atualização você pode importar seu histórico de mensagens do WhatsApp, Line e KakaoTalk, para isso você precisa exportar seu chat do Whatsapp (por exemplo) e compartilhá-lo com o contato equivalente no Telegram.</p>\n<p><img src=\"/a1e04df6ad4fb7475359d1ae76aacc63/importing-to-telegram.gif\" alt=\"Importando para o Telegram\"></p>\n<p>O Telegram disse que eventualmente disponibilizará uma API para que você possa construir seus próprios scripts e importar mensagens de qualquer aplicativo de chat, next level foda! Mas… temos mesmo que esperar essa atualização? Uhmn acho que não eim. Vamos dar uma olhada como é esse arquivo <code class=\"language-text\">.txt</code> exportado do Whatsapp:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">8/13/10, 12:11 - Scott Pilgrim: Qual é o site da Amazon.ca?\r\n8/13/10, 12:12 - Wallace Wells: Amazon.ca..</code></pre></div>\n<p>Então digamos que, como eu, você só tenha acesso ao seu arquivo <code class=\"language-text\">msgstore.db</code> do Whatsapp, não é possível exportar o chat do Whatsapp, certo? Neste caso você pode usar a ferramenta <a href=\"https://github.com/andreas-mausch/whatsapp-viewer\" target=\"_blank\" rel=\"noreferrer\">Whatsapp Viewer</a> para exportar suas mensagens para um arquivo <code class=\"language-text\">JSON</code>, que fica nesse formato:</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\r\n    <span class=\"token property\">\"key\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"0000000000000@s.whatsapp.net\"</span><span class=\"token punctuation\">,</span>\r\n    <span class=\"token property\">\"contactName\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Wallace Wells\"</span><span class=\"token punctuation\">,</span>\r\n    <span class=\"token property\">\"messages\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\r\n        <span class=\"token punctuation\">{</span>\r\n            <span class=\"token property\">\"timestamp\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"2010-08-13T12:11:00Z\"</span><span class=\"token punctuation\">,</span>\r\n            <span class=\"token property\">\"fromMe\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\r\n            <span class=\"token property\">\"type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"text\"</span><span class=\"token punctuation\">,</span>\r\n            <span class=\"token property\">\"text\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Qual é o site da Amazon.ca?\"</span>\r\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\r\n        <span class=\"token punctuation\">{</span>\r\n            <span class=\"token property\">\"timestamp\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"2010-08-13T12:12:00Z\"</span><span class=\"token punctuation\">,</span>\r\n            <span class=\"token property\">\"fromMe\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\r\n            <span class=\"token property\">\"type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"text\"</span><span class=\"token punctuation\">,</span>\r\n            <span class=\"token property\">\"text\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Amazon.ca..\"</span>\r\n        <span class=\"token punctuation\">}</span>\r\n    <span class=\"token punctuation\">]</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Agora tudo que você precisa fazer é carregar este arquivo <code class=\"language-text\">JSON</code> com um script qualquer e converte-lo para um <code class=\"language-text\">.txt</code> naquele formato. Vamos tentar fazer isso usando <code class=\"language-text\">Node.js</code>:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span>\r\n    readFileSync<span class=\"token punctuation\">,</span>\r\n    writeFileSync<span class=\"token punctuation\">,</span>\r\n<span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'fs'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token keyword\">const</span> yourName <span class=\"token operator\">=</span> <span class=\"token string\">'Scott Pilgrim'</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// TODO put your name here</span>\r\n\r\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">convertMessageObjToTxt</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">messageObj<span class=\"token punctuation\">,</span> sender</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token comment\">// format \"2010-08-13T12:11:00Z\"</span>\r\n    <span class=\"token keyword\">const</span> dateObj <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Date</span><span class=\"token punctuation\">(</span>messageObj<span class=\"token punctuation\">.</span>timestamp<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">const</span> date <span class=\"token operator\">=</span> dateObj<span class=\"token punctuation\">.</span><span class=\"token function\">toLocaleDateString</span><span class=\"token punctuation\">(</span><span class=\"token string\">'en-US'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">const</span> time <span class=\"token operator\">=</span> dateObj<span class=\"token punctuation\">.</span><span class=\"token function\">toLocaleTimeString</span><span class=\"token punctuation\">(</span><span class=\"token string\">'en-US'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">hour12</span><span class=\"token operator\">:</span> <span class=\"token boolean\">false</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">slice</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n    <span class=\"token comment\">// format is \"M/DD/YY, HH:MM - Sender's Name: Message\"</span>\r\n    <span class=\"token keyword\">return</span> date <span class=\"token operator\">+</span> <span class=\"token string\">', '</span> <span class=\"token operator\">+</span> time <span class=\"token operator\">+</span> <span class=\"token string\">' - '</span> <span class=\"token operator\">+</span> sender <span class=\"token operator\">+</span> <span class=\"token string\">': '</span> <span class=\"token operator\">+</span> messageObj<span class=\"token punctuation\">.</span>text <span class=\"token operator\">+</span> <span class=\"token string\">'\\n'</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span>\r\n\r\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>process<span class=\"token punctuation\">.</span>argv<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token comment\">// read the JSON file</span>\r\n    <span class=\"token keyword\">const</span> chatJson <span class=\"token operator\">=</span> <span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">parse</span><span class=\"token punctuation\">(</span><span class=\"token function\">readFileSync</span><span class=\"token punctuation\">(</span>process<span class=\"token punctuation\">.</span>argv<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'utf8'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token keyword\">let</span> txtContent <span class=\"token operator\">=</span> <span class=\"token string\">''</span><span class=\"token punctuation\">;</span>\r\n\r\n    chatJson<span class=\"token punctuation\">.</span>messages<span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">message</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n        txtContent <span class=\"token operator\">+=</span> <span class=\"token function\">convertMessageObjToTxt</span><span class=\"token punctuation\">(</span>\r\n            message<span class=\"token punctuation\">,</span>\r\n            message<span class=\"token punctuation\">.</span>fromMe <span class=\"token operator\">?</span> yourName <span class=\"token operator\">:</span> chatJson<span class=\"token punctuation\">.</span>contactName\r\n        <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n    <span class=\"token comment\">// save is as a .txt</span>\r\n    <span class=\"token function\">writeFileSync</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>process<span class=\"token punctuation\">.</span>argv<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">.txt</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span> txtContent<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Execute esse script com o comando <code class=\"language-text\">node script.js seu-arquivo-json.json</code> e o resultado será um arquivo <code class=\"language-text\">.txt</code> que você pode importar para o Telegram. Facinho, né? O único problema é que você precisa importar este <code class=\"language-text\">.txt</code> pelo app de celular do Telegram.</p>\n<p>Então é isso! Enquanto o WhatsApp pede que você ceda sua privacidade por um aplicativo super merda, o Telegram continua a ser gratuito, com código aberto (o aplicativo, não seus servidores) e com uma API incrível que permite fazer quase tudo. Muito foda!</p>","fields":{"postHashId":"Z2VuZXJhbHRydWVudWxsMjAyMS0wMS0zMVQwMDowMDowMC4wMDBa","slug":"/2021/2021-01-31-tinha-que-ser-o-telegram-de-novo.pt-br/","path":"/blog/general/tinha-que-ser-o-telegram-de-novo/","locale":"pt-br"},"frontmatter":{"tags":["whatsapp","sqlite","programação","backup","javascript","telegram","signal","nodejs","node"],"categories":["general"],"allowComments":true,"publishOnMedium":false,"cover":null,"date":"2021-01-31T00:00:00.000Z","id":null,"path":"tinha-que-ser-o-telegram-de-novo","show":true,"title":"Tinha que ser o Telegram de novo!","hideExcerpt":false,"subtitle":""}}}],"ogImage":"/static/cdcc77b7fb8d6bdf43386ce698ba2c79/42a19/auto-generating-tutorials.png","language":"pt-br","intl":{"language":"pt-br","languages":["en","pt-br"],"messages":{"site_title":"pablo.gg","title":"Título","author":"@thepiratepablo","search_placeholder":"Buscar...","about":"Sobre","photos":"Fotos","archive":"Arquivo","contact":"Contato","close":"Fechar","contact_page":"Página de contato","see_more":"Veja mais posts","built_with":"Feito com ","buy_me_a_soda":"Me pague uma bebida","blog":"Blog","blog_posts":"Posts do blog","go_to_post":"Ir para o post","search":"Busca","loading":"Carregando...","search_results":"Resultados de busca","search_results_for":"{quantity} resultados de busca para: \"{query}\"","search_for_query":"Buscar por \"{query}\"","no_results":"Sem resultados","home":"Home","description":"Apenas mais um blog pessoal","go_back":"Voltar para home","thats_me":"Esse sou eu!","got_it":"Entendi!","check_it_out":"Confira!","we_are":"Faltam","e3":"E3","away_from_next_sgf":"para a Summer Game Fest 2025","away_from_next_gamescom":"para a Gamescom 2024","sgf_countdown":"Contador para Summer Game Fest","gamescom_countdown":"Contador para Gamescom","e3_paragraph_1":"Esta página já contou com uma contagem regressiva para o próximo evento E3, um momento que inúmeros jogadores e profissionais da indústria aguardavam ansiosamente a cada ano. E3 não era apenas um evento; era uma celebração da nossa paixão compartilhada por videogames, um lugar onde sonhos se realizavam e memórias eram feitas.","e3_paragraph_2":"Desde os anúncios eletrizantes até as demos práticas, a E3 era o coração do mundo dos jogos. Ela reunia pessoas de todos os cantos do globo, unidas pelo amor aos jogos. Para muitos, era uma chance de conhecer seus heróis, descobrir novos títulos e experimentar a emoção das últimas inovações em tecnologia de jogos.","e3_paragraph_3":"No entanto, à medida que o cenário dos jogos evoluiu, também evoluiu a maneira como nos conectamos e celebramos nossa paixão. Embora a E3 tenha chegado ao fim, o espírito de excitação e comunidade que ela promoveu continua vivo. Agora esperamos por novas maneiras de nos reunir, compartilhar nosso amor pelos jogos e criar novas memórias.","e3_paragraph_4":"Embora a contagem regressiva tenha acabado, o legado da E3 permanecerá para sempre em nossos corações, nos lembrando das jornadas incríveis que fizemos e dos laços que formamos ao longo do caminho.","sec":"Seg","secs":"Segs","min":"Min","mins":"Mins","hour":"Hora","hours":"Horas","day":"Dia","days":"Dias","month":"Mês","months":"Meses","year":"Ano","years":"Anos","recent_posts":"Posts recentes","email":"E-mail","twitter":"Twitter","name":"Nome","page":"Página","fill_this_want_reply":"Preencha isso se quiser que eu entre em contato com você","sorry_this_post_unavailable_language":"Desculpe, este post não está disponível no idioma que você escolheu","language":"Idioma","comment":"Comentário","comments":"Comentários","no_comments":"Nenhum comentário.","post_comment":"Publicar comentário","send_message":"Enviar mensagem","message":"Mensagem","post_a_comment":"Publicar um comentário","your_comment_submitted":"Seu comentário foi enviado com sucesso.","your_message_submitted":"Sua mensagem foi enviada com sucesso.","on":"em","ok":"Ok","copy":"Copiar","copied":"Copiado","photo_num":"Foto {num}","the_matrix_has_you":"The Matrix has you...","about_paragraph_1":"Entusiasta de tecnologia desde pequeno, sempre me interessei por computadores e videogames.","about_paragraph_2":"Me formei em Tecnologia da Informação na Faculdade Estácio de Sá e sempre procuro me informar sobre novas tecnologias e me envolver em novos projetos de desenvolvimento, alguns deles o código fonte pode ser encontrado no GitHub.","cookie_banner_consent":"Ao usar este site, você concorda com o uso de cookies para oferecer uma melhor experiência.","written_in":"Escrito em ","no_post_this_tag":"Nenhum post em Português contém essa tag.","tags":"Tags","tag_colon":"Tag: ","tags_colon":"Tags: ","posts_tagged":"Posts com a tag ","categories":"Categorias","category":"Categoria","category_colon":"Categoria: ","posts_on_category":"Posts na categoria ","related_posts":"Posts relacionados","read_time":"🕒 {time} min. de leitura","create_post":"Criar Post","show":"Mostrar","date":"Data","download":"Download","add_tag":"Adicionar Tag","hide_excerpt":"Esconder Excerpt","publish_on_medium":"Publicar no Medium","allow_comments":"Permitir Comentários","subtitle":"Subtítulo","you_must_be_truly_desperate":"Você deve estar muito desesperado para me pedir ajuda","game.game_title":"pablo.gg - O Jogo","game.next":"Próxima","game.ok":"Ok","game.loading_asset_colon":"Carregando asset:","game.loading":"Carregando...","game.characters.npc_01":"Frost","game.characters.npc_02":"Gavin","game.characters.npc_03":"Giles","game.characters.npc_04":"Godfrey","game.characters.npc_05":"Hugh","game.characters.npc_06":"Ivar","game.characters.npc_07":"Leopold","game.characters.npc_08":"Lucian","game.characters.npc_09":"Gumercindo","game.characters.npc_10":"Mr. Flower","game.characters.npc_11":"Maxim","game.characters.npc_12":"Milo","game.characters.npc_13":"Otto","game.characters.npc_14":"Palmer","game.characters.npc_15":"Quentin","game.characters.npc_16":"Sebastian","game.characters.npc_17":"Neville","game.characters.npc_18":"Cassian","game.characters.npc_19":"Balthasar","game.characters.sign_01":"Placa","game.characters.book_01":"Livro","game.characters.home_page_city_sign":"Placa","game.characters.coding_category_city_sign_01":"Placa","game.characters.coding_category_city_sign_02":"Placa","game.characters.events_category_city_sign":"Placa","game.characters.funny_category_city_sign":"Placa","game.characters.gadgets_category_city_sign_01":"Placa","game.characters.gadgets_category_city_sign_02":"Placa","game.characters.games_category_city_sign":"Placa","game.characters.general_category_city_sign":"Placa","game.characters.tips_category_city_sign":"Placa","game.characters.toys_category_city_sign":"Placa","game.characters.sword":"Info","game.characters.push":"Info","game.gamepad.a_button":"Botão A","game.gamepad.b_button":"Botão B","game.gamepad.d_pad_left":"D-Pad Esquerda","game.gamepad.d_pad_up":"D-Pad Cima","game.gamepad.d_pad_right":"D-Pad Direita","game.gamepad.d_pad_down":"D-Pad Baixo","game.gamepad.start_button":"Botão Start","game.menu.start":"Começar","game.menu.exit":"Sair","game.menu.settings":"Configurações","game.start_menu.save_game":"Salvar Jogo","game.start_menu.exit":"Sair","game.game_over.game_over":"Game Over","game.game_over.retry":"Tentar Novamente","game.game_over.exit":"Sair","game.browse_posts.choose_a_post":"Escolha um post para ler","game.dialogs.npc_01.01":"Ei, você finalmente acordou!","game.dialogs.npc_01.02":"O quê, você não sabe onde está?","game.dialogs.npc_01.03":"Não seja bobo, você está na Cidade Página Inicial, lembra?","game.dialogs.npc_01.04":"Esta cidade foi fundada por Pablo Montenegro para ser o início de sua jornada","game.dialogs.npc_01.05":"Explore o mundo e encontre outras cidades onde você possa ler o conhecimento acumulado de nossa civilização...","game.dialogs.npc_01.06":"... algumas pessoas chamam de \"Posts do Blog\", não sei por quê...","game.dialogs.npc_02.01":"Tenha cuidado com os Slimes que vivem no mundo aberto.","game.dialogs.npc_02.02":"Pressione ESPAÇO para usar sua espada","game.dialogs.npc_02.03":"O que é ESPAÇO? Eu não faço ideia.","game.dialogs.npc_03.01":"Olá, bem vindo a nossa biblioteca","game.dialogs.npc_03.02":"Temos apenas um livro, que contém todas as publicações da categoria dessa cidade.","game.dialogs.npc_03.03":"Vá dar uma olhada!","game.dialogs.npc_04.01":"Eu gosto de caracóis","game.dialogs.npc_05.01":"Frases incompletas podem causar","game.dialogs.npc_06.01":"O vermelho é mais verde do que o roxo, com certeza.","game.dialogs.npc_07.01":"Ter barba é o novo não ter barba","game.dialogs.npc_08.01":"E aí","game.dialogs.npc_09.01":"\" - Cooper, o que está fazendo?\"\n\" - Atracando.\"","game.dialogs.npc_10.01":"Eu deveria comprar um barco","game.dialogs.npc_11.01":"Conhece a piada do não nem eu? Não? Nem eu!","game.dialogs.npc_12.01":"Eu limpo o banheiro e resgato a princesas, vida boa, certo?","game.dialogs.npc_13.01":"Queremos as ondas de rádio de volta","game.dialogs.npc_14.01":"Salve a líder de torcida, salve o mundo","game.dialogs.npc_15.01":"Olá, como vai?","game.dialogs.npc_15.02":"OK, tchau!","game.dialogs.npc_16.01":"Um canguru é realmente apenas um coelho com esteróides","game.dialogs.npc_17.01":"Pela 216ª vez, ele disse que pararia de beber refrigerante após esta última Coca","game.dialogs.npc_18.01":"Nada e tudo é possímpossivel","game.dialogs.npc_19.01":"Para uma cidade chamada \"Eventos\", não há muito acontecendo...","game.dialogs.sign_01.01":"Parabéns, você pode ler isso!","game.dialogs.book_01.01":"Hey, obrigado por testar esse novo jeito bem esquisito de acessar o meu site","game.dialogs.book_01.02":"Este projeto não seria possível sem o incrível trabalho de muitas pessoas, como:","game.dialogs.book_01.03":"ArMM1998 - Pelos sprites dos personagens e os tilesets","game.dialogs.book_01.04":"PixElthen - Pelos sprites do slime","game.dialogs.book_01.05":"pixelartm - Pelos sprites do chapéu de pirata","game.dialogs.book_01.06":"jkjkke - Pela imagem da tela de Game Over","game.dialogs.book_01.07":"KnoblePersona - Pela imagem da tela do menu inicial","game.dialogs.book_01.08":"Min - Pelo sprite do livro aberto","game.dialogs.book_01.09":"E claro, ao Richard Davey por ter criado o Phaser.io!","game.dialogs.home_page_city_sign":"Cidade Página Inicial","game.dialogs.coding_category_city_sign.01":"Cidade da Categoria Programação","game.dialogs.coding_category_city_sign.02":"Cidade da Categoria Programação","game.dialogs.events_category_city_sign":"Cidade da Categoria Eventos","game.dialogs.funny_category_city_sign":"Cidade da Categoria Engraçado","game.dialogs.gadgets_category_city_sign.01":"Cidade da Categoria Eletrónicos","game.dialogs.gadgets_category_city_sign.02":"Cidade da Categoria Eletrónicos","game.dialogs.games_category_city_sign":"Cidade da Categoria Jogos","game.dialogs.general_category_city_sign":"Cidade da Categoria Geral","game.dialogs.tips_category_city_sign":"Cidade da Categoria Dicas","game.dialogs.toys_category_city_sign":"Cidade da Categoria Brinquedos","game.dialogs.sword_item_description":"Agora você pode atacar, pressione ESPAÇO para usar sua espada.","game.dialogs.push_item_description":"Agora você pode empurrar alguns objetos, pressione ESPAÇO na frente de um objeto para empurrá-lo.","zelda_timeline.title":"Timeline de Zelda","zelda_timeline.timeline_split":"Divisão da Timeline","zelda_timeline.timeline_unification":"Timeline Unificada","zelda_timeline.icons_from":"Os ícones usados nesta página são do zeldauniverse.net e game-icons.net","zelda_timeline.creation":"Criação","zelda_timeline.creation_of_land_sky":"A Criação da Terra e do Céu","zelda_timeline.goddess_hylia_and_sky_era":"Deusa Hylia e a Era do Céu","zelda_timeline.skyward_sword":"Skyward Sword","zelda_timeline.the_ancient_battle":"A Antiga Batalha e a reencarnação da Deusa Hylia","zelda_timeline.return_to_surface":"O retorno à superfície","zelda_timeline.era_of_chaos":"Era do caos","zelda_timeline.sacred_realm_sealed":"O Sacred Realm é selado","zelda_timeline.era_of_prosperity":"Era da Prosperidade","zelda_timeline.establishment_of_hyrule":"O Reino de Hyrule é estabelecido","zelda_timeline.force_era":"Era da Força","zelda_timeline.the_minish_cap":"The Minish Cap","zelda_timeline.rise_of_evil_vaati":"A Ascensão do Maligno Vaati","zelda_timeline.four_swords":"Four Swords","zelda_timeline.resurrection_of_vaati":"A Ressurreição de Vaati","zelda_timeline.era_of_the_hero_of_time":"Era do Herói do Tempo","zelda_timeline.hyrulean_civil_war":"Guerra Civil Hyruleana","zelda_timeline.ocarina_of_time":"Ocarina of Time","zelda_timeline.sacred_realm_becomes_dark_world":"O Sacred Realm se torna o Dark World","zelda_timeline.ganondorf_becomes_ganon":"Ganondorf se torna Ganon","zelda_timeline.hero_is_defeated":"O herói é derrotado","zelda_timeline.decline_of_last_hero":"O declínio de Hyrule e o último herói","zelda_timeline.the_imprisoning_war":"A Guerra do Aprisionamento","zelda_timeline.era_of_dark_and_light":"Era de Luz e Escuridão","zelda_timeline.a_link_to_the_past":"A Link to the Past","zelda_timeline.resurrection_of_ganon":"A Ressurreição de Ganon","zelda_timeline.resurrection_of_ganon_is_prevented":"A ressurreição de Ganon é evitada","zelda_timeline.links_awakening":"Link's Awakening","zelda_timeline.oracle_of_ages_and_seasons":"Oracle of Ages e Oracle of Seasons","zelda_timeline.a_link_between_worlds":"A Link Between Worlds","zelda_timeline.tri_force_heroes":"Tri Force Heroes","zelda_timeline.the_gold_era":"The Gold Era","zelda_timeline.monarchs_of_hyrule_use_triforce":"Os Monarcas de Hyrule usam a Triforce","zelda_timeline.era_of_decline":"A Era do Declínio","zelda_timeline.tragedy_of_princess_zelda_1":"A Tragédia da Princesa Zelda I","zelda_timeline.the_legend_of_zelda":"The Legend of Zelda","zelda_timeline.adventure_of_link":"Adventure of Link","zelda_timeline.hero_defeated":"Hero Derrotado","zelda_timeline.child_era":"Era Infantil","zelda_timeline.adult_era":"Era Adulta","zelda_timeline.sacred_realm_protected":"Sacred Realm está protegido","zelda_timeline.twilight_realm_and_legacy_of_hero":"O Twilight Realm e o legado do Herói","zelda_timeline.majoras_mask":"Majora's Mask","zelda_timeline.prince_of_thieves_is_executed":"O Príncipe dos Ladrões Ganondorf é executado","zelda_timeline.twilight_era":"A Era do Twilight","zelda_timeline.twilight_princess":"Twilight Princess","zelda_timeline.shadow_invasion":"A invasão das sombras","zelda_timeline.shadow_era":"A Era das Sombras","zelda_timeline.four_swords_adventures":"Four Swords Adventures","zelda_timeline.reincarnation_of_ganondorf":"A Reencarnação de Ganondorf","zelda_timeline.ganondorf_is_sealed":"Ganondorf é selado","zelda_timeline.hero_of_wind_and_new_world":"O Herói do Vento e um Novo Mundo","zelda_timeline.era_without_a_hero":"A era sem um herói","zelda_timeline.ganondorf_is_resurrected":"Ganondorf é ressuscitado","zelda_timeline.hyrule_is_sealed_and_flooded":"Hyrule é selado e então inundado","zelda_timeline.era_of_the_great_sea":"A Era do Great Sea","zelda_timeline.the_wind_waker":"The Wind Waker","zelda_timeline.era_of_the_great_voyage":"A Era da Grande Viagem","zelda_timeline.phantom_hourglass":"Phantom Hourglass","zelda_timeline.era_of_hyrule_rebirth":"A Era do Renascimento de Hyrule","zelda_timeline.new_continent_discovered":"Novo continente descoberto","zelda_timeline.new_hyrule_is_founded":"Um novo reino de Hyrule é fundado","zelda_timeline.spirit_tracks":"Spirit Tracks","zelda_timeline.evil_king_malladus_is_resurrected":"O Rei Maligno Malladus é ressuscitado","zelda_timeline.age_of_calamity":"Age of Calamity","zelda_timeline.breath_of_the_wild":"Breath of the Wild","zelda_timeline.era_of_the_wilds":"A Era dos Selvagens","zelda_timeline.calamity_ganon_is_sealed":"Calamity Ganon é Selado. A tecnologia é proibida, levando alguns Sheikah a formar o Yiga Clan","zelda_timeline.divine_beasts_are_cleansed":"As Bestas Divinas são purificadas e Calamity Ganon é Selado","zelda_timeline.tears_of_the_kingdom":"Tears of the Kingdom","zelda_timeline.hyrule_kingdom_is_teared_apart":"Ganondorf é ressuscitado (Será?)","blog_categories.games":"Jogos","blog_categories.general":"Geral","blog_categories.tips":"Dicas","blog_categories.events":"Eventos","blog_categories.coding":"Programação","blog_categories.funny":"Engraçado","blog_categories.toys":"Brinquedos","blog_categories.gadgets":"Eletrónicos","e3_2012_photos.title":"E3 2012","e3_2012_photos.description":"Em junho de 2012 participei da E3 como imprensa para uma cobertura completa para o Nintendo Blast.","e3_2013_photos.title":"E3 2013","e3_2013_photos.description":"Em junho de 2013 participei da E3 como imprensa para uma cobertura completa para o Game Blast.","e3_2014_photos.title":"E3 2014","e3_2014_photos.description":"Em junho de 2014 participei da E3 como imprensa para uma cobertura completa para o Game Blast.","e3_2015_photos.title":"E3 2015","e3_2015_photos.description":"Em junho de 2015 participei da E3 como imprensa para uma cobertura completa para o Game Blast e Game Over TV.","e3_2017_photos.title":"E3 2017","e3_2017_photos.description":"Em junho de 2017 participei da E3 como imprensa para uma cobertura completa para o PlayReplay e Game Over TV.","e3_2019_photos.title":"E3 2019","e3_2019_photos.description":"Em junho de 2019 participei da E3 como imprensa para uma cobertura completa para o PlayReplay.","gamescom_2019_photos.title":"Gamescom 2019","gamescom_2019_photos.description":"Em agosto de 2019 participei da Gamescom como imprensa para uma cobertura completa para o PlayReplay.","san_francisco_2019_photos.title":"San Francisco 2019","san_francisco_2019_photos.description":"Em setembro de 2019, viajei para San Francisco para o show do Metallica S&M2.","forty_two_page.title":"Quarenta e Dois","forty_two_page.description":"Até mais, e obrigado pelos peixes!","projects_page.title":"Projetos","projects_page.description":"Aqui está uma lista de alguns dos meus projetos pessoais favoritos.","projects_page.gatsbyMaterialUiBlogDescription":"Um simples Gatsby Blog Starter com Material UI.","projects_page.contractBuilderDescription":"O Contract Builder é um projeto de código aberto gratuito que permite a qualquer pessoa manter e construir facilmente qualquer tipo de contrato (documentos legais, processos judiciais, aluguel, acordos, construção e assim por diante) usando o Google Spreadsheets. Este foi desenvolvido como um projeto pessoal para ajudar uma amiga que estava com dificuldades de gastar até uma hora para fazer um contrato personalizado, agora ela consegue fazer em menos de 5 minutos. Hooray!","projects_page.resumeBuilderDescription":"Resume Builder é um projeto de código aberto gratuito que permite a qualquer pessoa manter e construir facilmente qualquer tipo de currículo usando o Google Spreadsheets. Este foi desenvolvido como um projeto pessoal para ajudar um amigo que estava com dificuldades de gastar até uma hora para fazer um currículo personalizado.","projects_page.magentoChatbotDescription":"Com este módulo, você pode integrar totalmente a sua loja Magento com os aplicativos de chat mais populares do mercado. Isso significa que simplesmente instalando este módulo e alguns cliques você pode ter uma nova forma de mostrar e vender seus produtos aos seus clientes. Muito fácil de usar! Experimente agora, é GRÁTIS.","projects_page.jamStackSortenerDescription":"Este é um POC de um encurtador de URL básico desenvolvido com Gatsby.","projects_page.gotinhaDescription":"Sempre foi meu sonho fazer meu próprio jogo, e depois de experimentar o Unity alguns anos atrás, decidi tentar novamente com algo com o qual estou mais familiarizado: Javascript. Como desenvolvedor front-end, Javascript já é a linguagem com a qual escrevo a maior parte do meu código no trabalho e também em meus projetos pessoais, e após uma rápida pesquisa consegui encontrar o incrível PhaserJS Framework para construção de jogos web 2D.","notfound.title":"404: Não encontrado","notfound.header":"404 NÃO ENCONTRADO","notfound.description":"Desculpe, esta página parece não existir. Talvez os arquivos estejam incompletos?","seo_keywords.developer":"desenvolvedor","seo_keywords.development":"desenvolvimento","seo_keywords.javascript":"javascript","seo_keywords.es6":"es6","seo_keywords.e3":"e3","seo_keywords.sgf":"sgf","seo_keywords.gamescom":"gamescom","seo_keywords.countdown":"contador","seo_keywords.archive":"arquivo","seo_keywords.about_me":"sobre mim","seo_keywords.personal_blog":"blog pessoal","seo_keywords.personal_projects":"projetos pessoais","seo_keywords.travels":"viagens","seo_keywords.tips":"dicas","seo_keywords.lifehacks":"truques de produtividade","seo_keywords.reviews":"analises","seo_keywords.games":"games","seo_keywords.timeline":"linha do tempo","seo_keywords.photos":"fotos","cookie_law.we_use_cookies":"Usamos cookies para garantir que você obtenha a melhor experiência em nosso site. Ao usar nosso site, você concorda com nossa ","cookie_law.title":"Política de cookies","cookie_law.what_are_cookies":"O que são cookies?","cookie_law.what_are_cookies_text":"Como é prática comum em quase todos os sites profissionais, este site usa cookies, que são pequenos arquivos baixados para o seu computador, para melhorar a sua experiência. Esta página descreve quais informações eles coletam, como as usamos e por que às vezes precisamos armazenar esses cookies. Também compartilharemos como você pode evitar que esses cookies sejam armazenados, no entanto, isso pode diminuir ou 'quebrar' certos elementos da funcionalidade do site. Para obter mais informações gerais sobre cookies, leia ","cookie_law.what_are_cookies_more_info_url":"https://pt.wikipedia.org/wiki/Cookie_(informática)","cookie_law.how_we_use_cookies":"Como usamos cookies","cookie_law.how_we_use_cookies_text":"Usamos cookies por vários motivos detalhados abaixo. Infelizmente, na maioria dos casos, não há opções padrão da indústria para desabilitar cookies sem desabilitar completamente a funcionalidade e os recursos que eles adicionam a este site. Recomenda-se que você deixe todos os cookies se não tiver certeza se precisa deles ou não, caso sejam usados para fornecer um serviço que você usa.","cookie_law.disabling_cookies":"Desativando cookies","cookie_law.disabling_cookies_text":"Você pode impedir a configuração de cookies ajustando as configurações do seu navegador (consulte a Ajuda do navegador para saber como fazer isso). Esteja ciente de que a desativação de cookies afetará a funcionalidade deste e de muitos outros sites que você visita. A desativação dos cookies normalmente resultará na desativação de certas funcionalidades e recursos deste site. Portanto, é recomendável que você não desative os cookies.","cookie_law.the_cookies_we_set":"Os cookies que definimos","cookie_law.site_preferences_cookie":"Cookies de preferências do site","cookie_law.site_preferences_cookie_text":"Para lhe proporcionar uma excelente experiência neste site, fornecemos a funcionalidade para definir as suas preferências de funcionamento deste site quando o utiliza. Para lembrar suas preferências, precisamos definir cookies para que essas informações possam ser chamadas sempre que você interagir com uma página afetada por suas preferências.","cookie_law.third_party_cookies":"Cookies de terceiros","cookie_law.third_party_cookies_text":"Em alguns casos especiais, também usamos cookies fornecidos por terceiros confiáveis. A seção a seguir detalha quais cookies de terceiros você pode encontrar neste site.","cookie_law.third_party_cookies_item_1":"Este site usa o Google Analytics, que é uma das soluções de análise mais difundidas e confiáveis na web para nos ajudar a entender como você usa o site e como podemos melhorar sua experiência. Esses cookies podem rastrear coisas como quanto tempo você passa no site e as páginas que você visita para que possamos continuar a produzir conteúdo envolvente. Para obter mais informações sobre os cookies do Google Analytics, consulte a página oficial do Google Analytics.","cookie_law.third_party_cookies_item_2":"De vez em quando, testamos novos recursos e fazemos mudanças sutis na maneira como o site é fornecido. Quando ainda estamos testando novos recursos, esses cookies podem ser usados para garantir que você receba uma experiência consistente enquanto estiver no site, garantindo que entendemos quais otimizações nossos usuários mais apreciam.","cookie_law.more_information":"Mais informações","cookie_law.more_information_text":"Esperamos que isso tenha esclarecido as coisas para você e, conforme mencionado anteriormente, se há algo que você não tem certeza se precisa ou não, geralmente é mais seguro deixar os cookies ativados, caso eles interajam com um dos recursos que você usa em nosso site. No entanto, se você ainda estiver procurando por mais informações, entre em contato conosco através de nossa "},"routed":true,"originalPath":"/blog/tags/node","redirect":true,"redirectDefaultLanguageToRoot":false,"defaultLanguage":"en","fallbackLanguage":"","ignoredPaths":[]},"locale":"pt-br"}},
    "staticQueryHashes": ["1156153307","1355482417","1591365477","1628619374","2127381735","2288279559","26159077","3566410298","3649515864","3847325417","3982724423","928834867"]}